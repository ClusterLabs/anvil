"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78],{13089:function(e,n,t){t.d(n,{S:function(){return L},M:function(){return $}});var r=t(85893),s=t(53183),l=t(24378),o=t(12641),i=t(55278),c=t(89262),a=t(14440),u=t(94246),d=t(5152),x=t.n(d),h=t(67294),f=t(65895);let v="0xffe3",m="0xffe9";var p=[{keys:"Ctrl + Alt + Delete",scans:[]},{keys:"Ctrl + Alt + F1",scans:[v,m,"0xffbe"]},{keys:"Ctrl + Alt + F2",scans:[v,m,"0xffbf"]},{keys:"Ctrl + Alt + F3",scans:[v,m,"0xffc0"]},{keys:"Ctrl + Alt + F4",scans:[v,m,"0xffc1"]},{keys:"Ctrl + Alt + F5",scans:[v,m,"0xffc2"]},{keys:"Ctrl + Alt + F6",scans:[v,m,"0xffc3"]},{keys:"Ctrl + Alt + F7",scans:[v,m,"0xffc4"]},{keys:"Ctrl + Alt + F8",scans:[v,m,"0xffc5"]},{keys:"Ctrl + Alt + F9",scans:[v,m,"0xffc6"]}],g=t(67732),j=t(23833),C=t(23930),w=t(5552),Z=t(98484),b=t(14789),k=t(99429),y=t(60207),P=e=>{let{children:n,containedButtonProps:t,iconButtonProps:s,muiMenuProps:l,onButtonClick:o,onItemClick:i,variant:c="icon",...u}=e,[d,x]=(0,h.useState)(null),f=(0,h.useMemo)(()=>!!d,[d]),v=(0,h.useMemo)(()=>n||("icon"===c?(0,r.jsx)(b.Z,{fontSize:null==s?void 0:s.size}):"Options"),[n,null==s?void 0:s.size,c]),m=(0,h.useCallback)(function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let{0:{currentTarget:r}}=n;return x(r),null==o?void 0:o.call(null,...n)},[o]),p=(0,h.useMemo)(()=>"contained"===c?(0,r.jsx)(k.Z,{onClick:m,...t,children:v}):(0,r.jsx)(y.Z,{onClick:m,...s,children:v}),[m,v,t,s,c]),j=(0,h.useCallback)(function(e,n){for(var t=arguments.length,r=Array(t>2?t-2:0),s=2;s<t;s++)r[s-2]=arguments[s];return x(null),null==i?void 0:i.call(null,e,n,...r)},[i]);return(0,r.jsxs)(a.Z,{children:[p,(0,r.jsx)(g.Z,{muiMenuProps:{anchorEl:d,keepMounted:!0,onClose:()=>x(null),...l},onItemClick:j,open:f,...u})]})},S=t(97607),A=t(59278),F=t(2188),I=e=>{var n;let{getItemDisabled:t,items:s,onItemClick:l,renderItem:o,serverName:i,serverState:c,serverUuid:u,...d}=e,{confirmDialog:x,setConfirmDialogOpen:f,setConfirmDialogProps:v,finishConfirm:m}=(0,F.Z)(),p=(0,h.useMemo)(()=>({"force-off":{colour:"red",description:(0,r.jsx)(r.Fragment,{children:"This is equal to pulling the power cord, which may cause data loss or system corruption."}),label:"Force off",path:"/command/stop-server/".concat(u,"?force=1")},"power-off":{description:(0,r.jsx)(r.Fragment,{children:"This is equal to pushing the power button. If the server doesn't respond to the corresponding signals, you may have to manually shut it down."}),label:"Power off",path:"/command/stop-server/".concat(u)},"power-on":{description:(0,r.jsx)(r.Fragment,{children:"This is equal to pushing the power button."}),label:"Power on",path:"/command/start-server/".concat(u)}}),[u]);return(0,r.jsxs)(a.Z,{children:[(0,r.jsx)(P,{getItemDisabled:e=>"running"===c===e.includes("on"),items:p,onItemClick:(e,n)=>{let{colour:t,description:s,label:l,path:o}=n,c=l.toLocaleLowerCase();v({actionProceedText:l,content:(0,r.jsx)(A.Ac,{children:s}),onProceedAppend:()=>{v(e=>({...e,loading:!0})),Z.Z.put(o).then(()=>{m("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully registered ",c," job on ",i,"."]})})}).catch(e=>{let n=(0,S.Z)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to register ",c," job on ",i,"; CAUSE:"," ",n.children,"."]}),m("Error",n)})},proceedColour:t,titleText:"".concat(l," server ").concat(i,"?")}),f(!0)},renderItem:(e,n)=>{let t;let{colour:s,label:l}=n;return s&&(t=k.D[s]),(0,r.jsx)(A.Ac,{inheritColour:!0,color:t,children:l})},...d,children:(0,r.jsx)(w.Z,{fontSize:null==d?void 0:null===(n=d.iconButtonProps)||void 0===n?void 0:n.size})}),x]})},B=t(25137),M=t(6946),_=t(6631);let z="FullSize",E={displayBox:"".concat(z,"-displayBox"),spinnerBox:"".concat(z,"-spinnerBox")},T=(0,c.ZP)("div")(()=>({["& .".concat(E.displayBox)]:{width:"75vw",height:"75vh"},["& .".concat(E.spinnerBox)]:{flexDirection:"column",width:"75vw",height:"75vh",alignItems:"center",justifyContent:"center"}})),U=x()(()=>Promise.all([t.e(460),t.e(724)]).then(t.bind(t,38724)),{loadableGenerated:{webpack:()=>[38724]},ssr:!1}),N={1e3:"in-use by another process?",1006:"destination is down?"},D=(e,n)=>"ws://".concat(e,"/ws/server/vnc/").concat(n);var L=e=>{let{onClickCloseButton:n,serverUUID:t,serverName:c,vncReconnectTimerStart:d=10}=e,{buildCookieJar:x}=(0,M.Z)(),v=(0,_.Z)(),[m,w]=(0,h.useState)(null),[Z,b]=(0,h.useState)(void 0),[k,y]=(0,h.useState)(!1),[P,S]=(0,h.useState)(!1),[F,z]=(0,h.useState)(),[L,R]=(0,h.useState)(),[q,G]=(0,h.useState)(d),O=(0,h.useRef)(null),H=(0,h.useRef)(null),K=e=>{w(e.currentTarget)},V=e=>{if(O.current){if(e.length){for(let n=0;n<=e.length-1;n+=1)O.current.sendKey(e[n],1);for(let n=e.length-1;n>=0;n-=1)O.current.sendKey(e[n],0)}else O.current.sendCtrlAltDel();w(null)}},J=(0,h.useCallback)(()=>{y(!0),S(!1),b({url:D(window.location.host,t)})},[t]),W=(0,h.useCallback)(()=>{(null==O?void 0:O.current)&&(O.current.disconnect(),O.current=null),b(void 0)},[]),$=(0,h.useCallback)(()=>{W(),J()},[J,W]),Q=(0,h.useCallback)(()=>{let e=setInterval(()=>{G(n=>{let t=n-1;return t<1&&clearInterval(e),t})},1e3)},[]),X=(0,h.useCallback)(()=>{y(!1)},[]),Y=(0,h.useCallback)(e=>{let{detail:n}=e,{clean:t}=n;t||(y(!1),S(!0),Q())},[Q]),ee=(0,h.useCallback)(e=>{if(!e){z(void 0);return}let{code:n,reason:r}=e,s="ws: ".concat(n),l=N[n];l&&(s+=" (".concat(l,")")),r&&(s+=", ".concat(r)),z(s);let o=x()["suiapi.vncerror.".concat(t)];if(!o){R(void 0);return}let{code:i,message:c}=o;R("api: ".concat(i,", ").concat(c))},[x,t]),en=(0,h.useMemo)(()=>!k&&!P,[k,P]),et=(0,h.useMemo)(()=>(0,r.jsx)(a.Z,{children:(0,r.jsx)(f.Z,{onClick:()=>{var e;null===(e=H.current)||void 0===e||e.requestFullscreen()},children:(0,r.jsx)(s.Z,{})})}),[]),er=(0,h.useMemo)(()=>(0,r.jsxs)(a.Z,{children:[(0,r.jsx)(f.Z,{onClick:K,children:(0,r.jsx)(l.Z,{})}),(0,r.jsx)(g.Z,{muiMenuProps:{anchorEl:m,keepMounted:!0,onClose:()=>w(null)},open:!!m,children:p.map(e=>{let{keys:n,scans:t}=e;return(0,r.jsx)(j.Z,{onClick:()=>V(t),children:(0,r.jsx)(u.Z,{variant:"subtitle1",children:n})},n)})})]}),[m]),es=(0,h.useMemo)(()=>(0,r.jsx)(a.Z,{children:(0,r.jsx)(f.Z,{onClick:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];W(),null==n||n.call(null,...t)},children:(0,r.jsx)(o.Z,{})})}),[W,n]),el=(0,h.useMemo)(()=>(0,r.jsx)(a.Z,{children:(0,r.jsx)(f.Z,{onClick:()=>{window&&(W(),window.location.assign("/"))},children:(0,r.jsx)(i.Z,{})})}),[W]),eo=(0,h.useMemo)(()=>en&&(0,r.jsxs)(r.Fragment,{children:[et,er,(0,r.jsx)(I,{serverName:c,serverState:"running",serverUuid:t}),el,es]}),[et,er,el,c,t,en,es]);return(0,h.useEffect)(()=>{0===q&&(G(d),$())},[$,q,d]),(0,h.useEffect)(()=>{v&&J()},[J,v]),(0,r.jsxs)(C.s_,{children:[(0,r.jsxs)(C.V9,{children:[(0,r.jsx)(A.z,{text:"Server: ".concat(c)}),eo]}),(0,r.jsxs)(T,{children:[(0,r.jsx)(a.Z,{display:en?"flex":"none",className:E.displayBox,children:(0,r.jsx)(U,{onConnect:X,onDisconnect:Y,onWsClose:ee,rfb:O,rfbConnectArgs:Z,rfbScreen:H})}),!en&&(0,r.jsxs)(a.Z,{display:"flex",className:E.spinnerBox,textAlign:"center",children:[k&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(A.z,{children:["Connecting to ",c,"."]}),(0,r.jsx)(B.Z,{})]}),P&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.z,{children:"Can't connect to the server."}),(0,r.jsx)(A.Ac,{children:L}),(0,r.jsx)(A.Ac,{children:F}),(0,r.jsxs)(A.z,{mt:".5em",children:["Retrying in ",q,"."]})]})]})]})]})},R=t(59826),q=t(80594),G=t(77831),O=t(56903),H=t(41021);let K={externalPreview:"",externalTimestamp:0,headerEndAdornment:null,hrefPreview:void 0,isExternalLoading:!1,isExternalPreviewStale:!1,isFetchPreview:!0,isShowControls:!0,isUseInnerPanel:!1,onClickPreview:void 0,serverName:"",serverState:"",slotProps:{}},V=e=>{let{children:n,isUseInnerPanel:t,slotProps:s}=e;return t?(0,r.jsx)(C.Lg,{...s.innerPanel,children:n}):(0,r.jsx)(C.s_,{...s.panel,children:n})},J=e=>{let{children:n,isUseInnerPanel:t,text:s}=e;return t?(0,r.jsxs)(C.CH,{children:[s?(0,r.jsx)(A.Ac,{text:s}):(0,r.jsx)(r.Fragment,{}),n]}):(0,r.jsxs)(C.V9,{children:[s?(0,r.jsx)(A.z,{text:s}):(0,r.jsx)(r.Fragment,{}),n]})},W=e=>{let{externalPreview:n=K.externalPreview,externalTimestamp:t=K.externalTimestamp,headerEndAdornment:s,hrefPreview:l,isExternalLoading:o=K.isExternalLoading,isExternalPreviewStale:i=K.isExternalPreviewStale,isFetchPreview:c=K.isFetchPreview,isShowControls:u=K.isShowControls,isUseInnerPanel:d=K.isUseInnerPanel,onClickPreview:x,serverName:f=K.serverName,serverState:v=K.serverState,serverUUID:m,slotProps:p=K.slotProps}=e,[g,j]=(0,h.useState)(!0),[C,w]=(0,h.useState)(!1),[b,k]=(0,h.useState)(""),[y,P]=(0,h.useState)(0),S=(0,H.zO)(),F=(0,h.useMemo)(()=>"running"===v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Z,{alt:"Preview is temporarily unavailable, but the server is ".concat(v,"."),component:"img",src:"data:image;base64,".concat(b),sx:{height:"auto",minHeight:b?void 0:"10em",opacity:C?"0.4":"1",padding:d?".2em":0,width:"100%"}}),C&&(e=>{let{unit:n,value:t}=(0,H._J)(S-e);return(0,r.jsxs)(A.Ac,{position:"absolute",children:["Updated ~",t," ",n," ago"]})})(y)]}):(0,r.jsx)(R.Z,{sx:{color:G.UZ,height:"80%",width:"80%"}}),[C,d,S,b,y,v]),M=(0,h.useMemo)(()=>{if(g)return(0,r.jsx)(B.Z,{mb:"1em",mt:"1em"});let e=!b,n={borderRadius:G.n_,color:G.s7,padding:0};return l?(0,r.jsx)(q.Z,{disabled:e,href:l,sx:n,children:F}):(0,r.jsx)(q.Z,{component:"span",disabled:e,onClick:x,sx:n,children:F})},[l,g,b,F,x]);return(0,h.useEffect)(()=>{c?(async()=>{try{let{data:e}=await Z.Z.get("/server/".concat(m,"?ss=1")),{screenshot:n,timestamp:t}=e;k(n),P(t),w(!(0,H.Z$)(t,300))}catch(e){w(!0)}finally{j(!1)}})():o||(k(n),P(t),w(i),j(!1))},[n,t,o,i,c,m]),(0,r.jsxs)(V,{isUseInnerPanel:d,slotProps:p,children:[(0,r.jsxs)(J,{isUseInnerPanel:d,text:f,children:[s,u&&(0,r.jsx)(I,{iconButtonProps:{size:d?"small":void 0},serverName:f,serverState:v,serverUuid:m})]}),(0,r.jsx)(O.Z,{row:!0,sx:{"& > :first-child":{flexGrow:1}},children:(0,r.jsx)(a.Z,{textAlign:"center",children:M})})]})};W.defaultProps=K;var $=W},2188:function(e,n,t){var r=t(85893),s=t(67294),l=t(77583),o=t(99576);n.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:n="",content:t="",titleText:i="",...c}={}}=e,a=(0,s.useRef)(null),[u,d]=(0,s.useState)({actionProceedText:n,content:t,titleText:i}),x=(0,s.useCallback)(e=>d(n=>{let{loading:t,...r}=n;return{...r,loading:e}}),[]),h=(0,s.useCallback)(e=>{var n,t;return null==a?void 0:null===(t=a.current)||void 0===t?void 0:null===(n=t.setOpen)||void 0===n?void 0:n.call(null,e)},[]),f=(0,s.useCallback)((e,n)=>d({actionProceedText:"",content:(0,r.jsx)(o.Z,{...n}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,s.useMemo)(()=>(0,r.jsx)(l.Z,{...c,...u,ref:a}),[u,c]),confirmDialogRef:a,setConfirmDialogLoading:x,setConfirmDialogOpen:h,setConfirmDialogProps:d,finishConfirm:f}}},92643:function(e,n){n.Z=e=>{let{allocated:n,available:t,reserved:r,total:s}=e,l=BigInt(n);return{allocated:l,available:BigInt(t),reserved:BigInt(r),total:BigInt(s)}}},97733:function(e,n){n.Z=e=>{let{storage_groups:n,total_free:t,total_size:r}=e,s=BigInt(t),l=BigInt(r);return n.reduce((e,n)=>{let{storage_group_free:t,storage_group_name:r,storage_group_total:s,storage_group_uuid:l}=n,o=BigInt(t),i=BigInt(s);return e.storageGroups[l]={free:o,name:r,size:i,used:i-o,uuid:l},e},{storageGroups:{},totalFree:s,totalSize:l,totalUsed:l-s})}}}]);