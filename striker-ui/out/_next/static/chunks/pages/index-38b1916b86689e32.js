(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(29401)}])},82777:function(e,n,t){"use strict";var s=t(85893),i=t(67294),r=t(99514),l=t(14440);n.Z=e=>{let{calculateItemBreakpoints:n=()=>({xs:1}),layout:t,wrapperBoxProps:c,...a}=e,o=(0,i.useMemo)(()=>Object.entries(t).map((e,t)=>{let[s,l]=e;return l?(0,i.createElement)(r.ZP,{...n(t,s),key:s,item:!0,...l}):void 0}),[n,t]);return(0,s.jsx)(l.Z,{...c,children:(0,s.jsx)(r.ZP,{container:!0,...a,children:o})})}},86549:function(e,n,t){"use strict";var s=t(85893),i=t(11632),r=t(77574),l=t(77831),c=t(56903);n.Z=e=>{let{children:n,sx:t,...a}=e;return(0,s.jsx)(r.Z,{underline:"hover",variant:"subtitle1",...a,sx:{color:l.lD,textDecorationColor:l.s7,...t},children:(0,s.jsxs)(c.Z,{row:!0,children:[n,(0,s.jsx)(i.Z,{sx:{marginLeft:".3em"}})]})})}},59752:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var s=e=>e.reduce((e,n)=>{let{hostName:t,hostType:s,hostUUID:i}=n;return e[i]={name:t,type:s,uuid:i},e},{}),i=e=>e.reduce((e,n)=>{let{anvilDescription:t,anvilName:i,anvilUUID:r,hosts:l}=n;return e[r]={description:t,hosts:s(l),name:i,uuid:r},e},{})},29401:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return V}});var s=t(85893),i=t(14440),r=t(9008),l=t.n(r),c=t(84501),a=t(67294),o=t(99514),d=t(54490),h=t(77831),x=e=>{let{anvil_name:n,anvil_state:t,anvil_uuid:s,hosts:i}=e;return{hosts:i.reduce((e,n)=>{let{host_name:t,host_uuid:s,maintenance_mode:i,server_count:r,state:l,state_percent:c}=n;return e[s]={name:t,maintenance:i,serverCount:r,state:l,stateProgress:c,uuid:s},e},{}),name:n,state:t,uuid:s}},u=t(92643),j=t(97733),m=t(29535),v=t(56903),Z=t(25137),p=t(38196),g=t(59278),f=t(77510);let P=BigInt(100),w={degraded:h.hM,not_ready:h.Wd,optimal:h.Ej},_={offline:h.Wd,online:h.Ej};var b=e=>{let{anvilUuid:n,refreshInterval:t=5e3}=e,{altData:i,loading:r}=(0,f.Z)("/anvil/".concat(n),{mod:x,refreshInterval:t}),{data:l,loading:b}=(0,f.Z)("/anvil/".concat(n,"/cpu"),{refreshInterval:t}),y=(0,a.useMemo)(()=>l&&Object.values(l.hosts),[l]),{altData:C,loading:S}=(0,f.Z)("/anvil/".concat(n,"/memory"),{mod:u.Z,refreshInterval:t}),{altData:A,loading:M}=(0,f.Z)("/anvil/".concat(n,"/store"),{mod:j.Z,refreshInterval:t}),N=(0,a.useMemo)(()=>[r,b,S,M].some(e=>e),[r,b,S,M]),k=(0,a.useMemo)(()=>i&&(0,s.jsx)(g.$_,{inheritColour:!0,color:w[i.state],children:i.state}),[i]),E=(0,a.useMemo)(()=>i&&(0,s.jsx)(o.ZP,{columns:1,container:!0,children:Object.values(i.hosts).map(e=>{var n;let{name:t,serverCount:i,state:r,stateProgress:l,uuid:c}=e,a=null!==(n=_[r])&&void 0!==n?n:h.s7,d=r;return["offline","online"].includes(r)||(d="".concat(l,"%")),(0,s.jsxs)(o.ZP,{alignItems:"center",columnSpacing:"0.5em",container:!0,sx:{},children:[(0,s.jsx)(o.ZP,{item:!0,xs:"auto",children:(0,s.jsx)(g.Ac,{variant:"caption",whiteSpace:"nowrap",children:t})}),(0,s.jsx)(o.ZP,{item:!0,xs:"auto",children:(0,s.jsx)(g.$_,{inheritColour:!0,color:a,children:d})}),(0,s.jsx)(o.ZP,{item:!0,xs:!0,children:(0,s.jsx)(m.Z,{})}),(0,s.jsx)(o.ZP,{item:!0,xs:"auto",children:(0,s.jsxs)(o.ZP,{alignItems:"center",columns:2,container:!0,width:"4em",children:[(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{variant:"caption",children:"Servers"})}),(0,s.jsx)(o.ZP,{display:"flex",item:!0,justifyContent:"flex-end",xs:1,children:(0,s.jsx)(g.$_,{variant:"caption",children:i})})]})})]},"subnode-".concat(c))})}),[i]),I=(0,a.useMemo)(()=>l&&y&&(0,s.jsxs)(v.Z,{row:!0,rowSpacing:".5em",children:[(0,s.jsxs)(g.Ac,{variant:"caption",whiteSpace:"nowrap",children:["Vendor"," ",(0,s.jsx)(g.Q0,{sx:{paddingRight:0},children:y[0].vendor})]}),(0,s.jsx)(m.Z,{sx:{flexGrow:1}}),(0,s.jsxs)(o.ZP,{alignItems:"center",columns:2,container:!0,width:"4em",children:[(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{variant:"caption",children:"Cores"})}),(0,s.jsx)(o.ZP,{display:"flex",item:!0,justifyContent:"flex-end",xs:1,children:(0,s.jsx)(g.$_,{variant:"caption",children:l.cores})}),(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{variant:"caption",children:"Threads"})}),(0,s.jsx)(o.ZP,{display:"flex",item:!0,justifyContent:"flex-end",xs:1,children:(0,s.jsx)(g.$_,{variant:"caption",children:l.threads})})]})]}),[l,y]),U=(0,a.useMemo)(()=>C&&(0,s.jsxs)(v.Z,{spacing:0,children:[(0,s.jsx)(v.Z,{row:!0,justifyContent:"flex-end",children:(0,s.jsxs)(g.Ac,{mb:"-.3em",variant:"caption",children:["Free",(0,s.jsx)(g.Q0,{children:(0,d._d)(C.available,{toUnit:"ibyte"})}),"/",(0,s.jsx)(g.Q0,{sx:{paddingRight:0},children:(0,d._d)(C.total,{toUnit:"ibyte"})})]})}),(0,s.jsx)(p.Z,{thin:!0,value:{reserved:{value:Number(C.reserved*P/C.total)},allocated:{value:Number((C.reserved+C.allocated)*P/C.total),colour:{0:h.Ej,70:h.Wd,90:h.hM}}}})]}),[C]),D=(0,a.useMemo)(()=>A&&(0,s.jsxs)(v.Z,{spacing:0,children:[(0,s.jsx)(v.Z,{row:!0,justifyContent:"flex-end",children:(0,s.jsxs)(g.Ac,{mb:"-.3em",variant:"caption",children:["Total free",(0,s.jsx)(g.Q0,{children:(0,d._d)(A.totalFree,{toUnit:"ibyte"})}),"/",(0,s.jsx)(g.Q0,{sx:{paddingRight:0},children:(0,d._d)(A.totalSize,{toUnit:"ibyte"})})]})}),(0,s.jsx)(p.Z,{thin:!0,value:{allocated:{value:Number((A.totalSize-A.totalFree)*P/A.totalSize),colour:{0:h.Ej,70:h.Wd,90:h.hM}}}})]}),[A]);return N?(0,s.jsx)(Z.Z,{mt:0}):(0,s.jsxs)(o.ZP,{alignItems:"center",columns:4,container:!0,sx:{["& > .".concat(c.Z.item,":nth-child(odd)")]:{alignItems:"center",display:"flex",height:"2.2em"}},children:[(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{children:"Node"})}),(0,s.jsx)(o.ZP,{item:!0,xs:3,children:k}),(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{children:"Subnodes"})}),(0,s.jsx)(o.ZP,{item:!0,xs:3,children:E}),(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{children:"CPU"})}),(0,s.jsx)(o.ZP,{item:!0,xs:3,children:I}),(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{children:"Memory"})}),(0,s.jsx)(o.ZP,{item:!0,xs:3,children:U}),(0,s.jsx)(o.ZP,{item:!0,xs:1,children:(0,s.jsx)(g.Ac,{children:"Storage"})}),(0,s.jsx)(o.ZP,{item:!0,xs:3,children:D})]})},y=t(59752),C=t(82777),S=t(23930),A=e=>{let{refreshInterval:n=5e3}=e,{data:t,loading:i}=(0,f.Z)("/anvil",{refreshInterval:n}),r=(0,a.useMemo)(()=>t&&(0,y.Z)(t),[t]),l=(0,a.useMemo)(()=>r&&(0,s.jsx)(C.Z,{columns:{xs:1,sm:2,md:3,xl:4},layout:Object.values(r).reduce((e,t)=>{let{description:i,name:r,uuid:l}=t;return e["anvil-".concat(l)]={children:(0,s.jsxs)(S.Lg,{height:"100%",mv:0,children:[(0,s.jsx)(S.CH,{children:(0,s.jsxs)(g.Ac,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:[r,": ",i]})}),(0,s.jsx)(S.bc,{children:(0,s.jsx)(b,{anvilUuid:l,refreshInterval:n})})]})},e},{}),spacing:"1em",sx:{alignContent:"stretch",["& > .".concat(c.Z.item)]:{minWidth:"20em"}}}),[r,n]);return(0,s.jsxs)(S.s_,{children:[(0,s.jsx)(S.V9,{children:(0,s.jsx)(g.z,{children:"Nodes"})}),i?(0,s.jsx)(Z.Z,{}):l]})},M=t(35497),N=t(34730),k=t(23279),E=t.n(k),I=t(65895),U=t(99576),D=t(15627),O=t(98337),W=t(89262),z=t(37156),$=t(86549);let F=(0,W.ZP)(z.$x)(e=>{let{theme:n}=e,t="calc(100vw - 4.88em)",s="calc(50vw - 3.1em)",i="calc(100vw / 3 - 2.52em)",r="calc(25vw - 2.22em)",l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";return"calc(".concat(e," * 0.8)")};return{[n.breakpoints.up("xs")]:{height:l(t),width:t},[n.breakpoints.up("sm")]:{height:l(s),width:s},[n.breakpoints.up("md")]:{height:l(i),width:i},[n.breakpoints.up("lg")]:{height:l(r),width:r}}}),Q=e=>(0,s.jsx)(o.ZP,{item:!0,children:(0,s.jsx)(z.bC,{getHeader:e=>{let{anvil:n,jobs:t,name:i}=e;return(0,s.jsxs)(s.Fragment,{children:[t?(0,s.jsx)(g.Ac,{noWrap:!0,children:i}):(0,s.jsx)($.Z,{href:"/server?name=".concat(i),noWrap:!0,children:i}),(0,s.jsx)($.Z,{href:"/anvil?anvil_uuid=".concat(n.uuid),noWrap:!0,sx:{opacity:.7},children:n.name})]})},server:e,showControls:!e.jobs,children:(0,s.jsx)(z.MB,{server:e,slots:{screenshotBox:(0,s.jsx)(F,{})}})},"".concat(e.uuid,"-preview"))});var R=e=>{let{groups:n,servers:t}=e;return(0,s.jsxs)(o.ZP,{container:!0,spacing:"1em",children:[n.match.map(e=>Q(t[e])),n.match.length>0&&(0,s.jsx)(o.ZP,{item:!0,width:"100%",children:(0,s.jsx)(m.Z,{flexItem:!0,orientation:"horizontal"})}),n.none.map(e=>Q(t[e]))]})};let T=(e,n)=>{let t={match:[],none:[]};if(!e)return t;let s=Object.keys(e);return n?s.reduce((t,s)=>{let i=e[s],r=RegExp(n,"i"),l=JSON.stringify(i);return r.test(l)?t.match.push(s):t.none.push(s),t},t):t.none=s,t};var B=()=>{let[e,n]=(0,a.useState)(""),[t,i]=(0,a.useState)(),[r,l]=(0,a.useState)(!1),{data:c,loading:o,error:d}=(0,f.Z)("/server",{refreshInterval:4e3,onSuccess:n=>{i(T(n,e))}}),x=(0,a.useMemo)(()=>E()(function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];i(T(...n))},500),[]);return o?(0,s.jsx)(S.s_,{children:(0,s.jsx)(Z.Z,{mt:0})}):c&&t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(S.s_,{children:[(0,s.jsxs)(S.V9,{children:[(0,s.jsx)(g.z,{children:"Servers"}),(0,s.jsx)(I.Z,{mapPreset:"add",onClick:()=>{l(!0)}}),(0,s.jsx)(D.Z,{onChange:e=>{let{value:t}=e.target;n(t),x(c,t)},startAdornment:(0,s.jsx)(N.Z,{sx:{color:h.d,marginRight:".4em"}}),sx:{width:"20em"},value:e})]}),(0,s.jsx)(R,{groups:t,servers:c})]}),(0,s.jsx)(O.Z,{dialogProps:{open:r},onClose:()=>{l(!1)}})]}):(0,s.jsx)(S.s_,{children:(0,s.jsxs)(U.Z,{type:"warning",children:["Couldn't get the list of servers. ",null==d?void 0:d.message]})})},V=()=>(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"Dashboard"})}),(0,s.jsx)(M.Z,{}),(0,s.jsx)(B,{}),(0,s.jsx)(A,{})]})}},function(e){e.O(0,[340,433,618,74,287,62,497,93,185,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);