(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{88668:function(e,n,t){var r=t(83369),i=t(90619),o=t(72385);function l(e){var n=-1,t=null==e?0:e.length;for(this.__data__=new r;++n<t;)this.add(e[n])}l.prototype.add=l.prototype.push=i,l.prototype.has=o,e.exports=l},82908:function(e){e.exports=function(e,n){for(var t=-1,r=null==e?0:e.length;++t<r;)if(n(e[t],t,e))return!0;return!1}},90939:function(e,n,t){var r=t(2492),i=t(37005);e.exports=function e(n,t,o,l,s){return n===t||(null!=n&&null!=t&&(i(n)||i(t))?r(n,t,o,l,e,s):n!=n&&t!=t)}},2492:function(e,n,t){var r=t(46384),i=t(67114),o=t(18351),l=t(16096),s=t(64160),a=t(1469),u=t(44144),d=t(36719),c="[object Arguments]",m="[object Array]",p="[object Object]",h=Object.prototype.hasOwnProperty;e.exports=function(e,n,t,x,f,v){var g=a(e),j=a(n),Z=g?m:s(e),b=j?m:s(n);Z=Z==c?p:Z,b=b==c?p:b;var y=Z==p,w=b==p,C=Z==b;if(C&&u(e)){if(!u(n))return!1;g=!0,y=!1}if(C&&!y)return v||(v=new r),g||d(e)?i(e,n,t,x,f,v):o(e,n,Z,t,x,f,v);if(!(1&t)){var A=y&&h.call(e,"__wrapped__"),P=w&&h.call(n,"__wrapped__");if(A||P){var O=A?e.value():e,_=P?n.value():n;return v||(v=new r),f(O,_,t,x,v)}}return!!C&&(v||(v=new r),l(e,n,t,x,f,v))}},74757:function(e){e.exports=function(e,n){return e.has(n)}},67114:function(e,n,t){var r=t(88668),i=t(82908),o=t(74757);e.exports=function(e,n,t,l,s,a){var u=1&t,d=e.length,c=n.length;if(d!=c&&!(u&&c>d))return!1;var m=a.get(e),p=a.get(n);if(m&&p)return m==n&&p==e;var h=-1,x=!0,f=2&t?new r:void 0;for(a.set(e,n),a.set(n,e);++h<d;){var v=e[h],g=n[h];if(l)var j=u?l(g,v,h,n,e,a):l(v,g,h,e,n,a);if(void 0!==j){if(j)continue;x=!1;break}if(f){if(!i(n,function(e,n){if(!o(f,n)&&(v===e||s(v,e,t,l,a)))return f.push(n)})){x=!1;break}}else if(!(v===g||s(v,g,t,l,a))){x=!1;break}}return a.delete(e),a.delete(n),x}},18351:function(e,n,t){var r=t(62705),i=t(11149),o=t(77813),l=t(67114),s=t(68776),a=t(21814),u=r?r.prototype:void 0,d=u?u.valueOf:void 0;e.exports=function(e,n,t,r,u,c,m){switch(t){case"[object DataView]":if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)break;e=e.buffer,n=n.buffer;case"[object ArrayBuffer]":if(e.byteLength!=n.byteLength||!c(new i(e),new i(n)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+n);case"[object Error]":return e.name==n.name&&e.message==n.message;case"[object RegExp]":case"[object String]":return e==n+"";case"[object Map]":var p=s;case"[object Set]":var h=1&r;if(p||(p=a),e.size!=n.size&&!h)break;var x=m.get(e);if(x)return x==n;r|=2,m.set(e,n);var f=l(p(e),p(n),r,u,c,m);return m.delete(e),f;case"[object Symbol]":if(d)return d.call(e)==d.call(n)}return!1}},16096:function(e,n,t){var r=t(58234),i=Object.prototype.hasOwnProperty;e.exports=function(e,n,t,o,l,s){var a=1&t,u=r(e),d=u.length;if(d!=r(n).length&&!a)return!1;for(var c=d;c--;){var m=u[c];if(!(a?m in n:i.call(n,m)))return!1}var p=s.get(e),h=s.get(n);if(p&&h)return p==n&&h==e;var x=!0;s.set(e,n),s.set(n,e);for(var f=a;++c<d;){var v=e[m=u[c]],g=n[m];if(o)var j=a?o(g,v,m,n,e,s):o(v,g,m,e,n,s);if(!(void 0===j?v===g||l(v,g,t,o,s):j)){x=!1;break}f||(f="constructor"==m)}if(x&&!f){var Z=e.constructor,b=n.constructor;Z!=b&&"constructor"in e&&"constructor"in n&&!("function"==typeof Z&&Z instanceof Z&&"function"==typeof b&&b instanceof b)&&(x=!1)}return s.delete(e),s.delete(n),x}},68776:function(e){e.exports=function(e){var n=-1,t=Array(e.size);return e.forEach(function(e,r){t[++n]=[r,e]}),t}},90619:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},72385:function(e){e.exports=function(e){return this.__data__.has(e)}},21814:function(e){e.exports=function(e){var n=-1,t=Array(e.size);return e.forEach(function(e){t[++n]=e}),t}},18446:function(e,n,t){var r=t(90939);e.exports=function(e,n){return r(e,n)}},24084:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mail-config",function(){return t(86901)}])},34635:function(e,n,t){"use strict";var r=t(85893),i=t(99576);n.Z=function(){let{sx:e,text:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.jsx)(r.Fragment,{children:n&&(0,r.jsx)(i.Z,{...t,sx:{marginTop:".4em",...e},text:n})})}},23833:function(e,n,t){"use strict";var r=t(85893),i=t(73970),o=t(85959),l=t(77831);n.Z=e=>{let{children:n,sx:t}=e,s={backgroundColor:l.lD,paddingRight:"3em",["&.".concat(i.Z.selected)]:{backgroundColor:l.s7,fontWeight:400,["&.".concat(i.Z.focusVisible)]:{backgroundColor:l.s7},"&:hover":{backgroundColor:l.s7}},["&.".concat(i.Z.focusVisible)]:{backgroundColor:l.s7},"&:hover":{backgroundColor:l.s7},...t};return(0,r.jsx)(o.Z,{...e,sx:s,children:n})}},15627:function(e,n,t){"use strict";t.d(n,{Z:function(){return p}});var r=t(85893),i=t(19607),o=t(58811),l=t(80594),s=t(28721),a=t(61481),u=t(67294),d=t(77831),c=t(37842);let m=e=>{let{disableAutofill:n=!1,endAdornment:t,label:m,onPasswordVisibilityAppend:p,sx:h,inputProps:{type:x,...f}={},type:v=x,...g}=e,[j,Z]=(0,u.useState)(v),b=(0,u.useMemo)(()=>{let e=v===c.Z.password,n=j===c.Z.password;return(0,r.jsx)(r.Fragment,{children:e&&(0,r.jsx)(l.Z,{onClick:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=n?c.Z.text:c.Z.password;Z(i),null==p||p.call(null,i,...t)},children:n?(0,r.jsx)(i.Z,{}):(0,r.jsx)(o.Z,{})})})},[v,p,j]),y=(0,u.useMemo)(()=>({color:d.s7,["& .".concat(s.Z.notchedOutline)]:{borderColor:d.UZ},["& .".concat(s.Z.input)]:{color:d.lD},"&:hover":{["& .".concat(s.Z.notchedOutline)]:{borderColor:d.s7}},["&.".concat(s.Z.focused)]:{color:d.lD,["& .".concat(s.Z.notchedOutline)]:{borderColor:d.s7,"& legend":{paddingRight:m?"1.2em":0}}},...h}),[m,h]),w=(0,u.useMemo)(()=>{let e;if("object"==typeof t){let{props:{children:n=[],...i}}=t;e=(0,u.cloneElement)(t,{...i,children:(0,r.jsxs)(r.Fragment,{children:[b,n]})})}return e},[b,t]),C=(0,u.useMemo)(()=>n?{onFocus:function(){for(var e,n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];let[i]=t;i.target.readOnly=!1,null==g||null===(e=g.onFocus)||void 0===e||e.call(null,...t)},readOnly:!0}:void 0,[n,null==g?void 0:g.onFocus]);return(0,r.jsx)(a.Z,{endAdornment:w,label:m,inputProps:{type:j,...f},...g,...C,sx:y})};m.defaultProps={disableAutofill:!1,onPasswordVisibilityAppend:void 0};var p=m},79237:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(85893),i=t(21182),o=t(73315),l=t(69375),s=t(72341),a=t(14440),u=t(77831),d=e=>{let{children:n,isNotifyRequired:t,sx:d,variant:c="outlined",...m}=e,p={color:"".concat(u.s7,"9F"),["& .".concat(o.Z.root)]:{color:u.s7},["&.".concat(l.Z.focused)]:{backgroundColor:u.s7,borderRadius:u.n_,color:u.E5,padding:".1em .6em"},["&.".concat(l.Z.shrink," .").concat(o.Z.root)]:{display:"none"},...d};return(0,r.jsx)(s.Z,{variant:c,...m,sx:p,children:(0,r.jsxs)(a.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row"},children:[t&&(0,r.jsx)(i.Z,{sx:{marginLeft:"-.2rem",marginRight:".4rem"}}),n]})})}},91029:function(e,n,t){"use strict";var r=t(85893),i=t(77970),o=t(51714),l=t(99657),s=t(80543),a=t(80594),u=t(67294),d=t(77831),c=t(34635),m=t(15627),p=t(79237);let h={baseInputProps:void 0,formControlProps:{},helpMessageBoxProps:{},id:"",inputProps:{},inputLabelProps:{},messageBoxProps:{},onHelp:void 0,onHelpAppend:void 0,required:!1,type:void 0,value:""},x=e=>{let{baseInputProps:n,disableAutofill:t,formControlProps:x=h.formControlProps,helpMessageBoxProps:f=h.helpMessageBoxProps,id:v=h.id,inputProps:{endAdornment:g,...j}=h.inputProps,inputLabelProps:Z=h.inputLabelProps,label:b,messageBoxProps:y=h.messageBoxProps,name:w,onBlur:C,onChange:A,onFocus:P,onHelp:O,onHelpAppend:_,required:M=h.required,type:F,value:k=h.value}=e,{text:S=""}=f,[I,D]=(0,u.useState)(!1),V=(0,u.useMemo)(()=>I&&(0,r.jsx)(c.Z,{onClose:()=>{D(!1)},...f}),[f,I]),q=(0,u.useMemo)(()=>void 0!==O||S.length>0,[S,O]),E=(0,u.useCallback)(()=>{let e;return O?e=O:S.length>0&&(e=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];D(e=>!e),null==_||_.call(null,...n)}),e},[S,O,_]),R=(0,u.useMemo)(E,[E]);return(0,r.jsxs)(o.Z,{fullWidth:!0,...x,children:[(0,r.jsx)(p.Z,{htmlFor:v,isNotifyRequired:M,...Z,children:b}),(0,r.jsx)(m.Z,{disableAutofill:t,endAdornment:(0,r.jsxs)(l.Z,{position:"end",sx:{display:"flex",flexDirection:"row",["& > .".concat(s.Z.root)]:{color:d.s7,padding:".2em"},["& > :not(:first-child, .".concat(s.Z.root,")")]:{marginLeft:".3em"}},children:[g,q&&(0,r.jsx)(a.Z,{onClick:R,tabIndex:-1,children:(0,r.jsx)(i.Z,{})})]}),fullWidth:x.fullWidth,id:v,inputProps:n,label:b,name:w,onBlur:C,onChange:A,onFocus:P,type:F,value:k,...j}),V,(0,r.jsx)(c.Z,{...y})]})};x.defaultProps=h,n.Z=x},6189:function(e,n,t){"use strict";t.d(n,{Z:function(){return b}});var r=t(85893),i=t(84799),o=t(20869),l=t(51714),s=t(67294),a=t(34635),u=t(23833),d=t(15627),c=t(79237),m=t(12641),p=t(49440),h=t(80543),x=t(79588),f=t(99657),v=t(80594),g=t(64242),j=t(77831),Z=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[o]=n,{onClearIndicatorClick:l,...a}=o,{sx:u,value:d,...c}=a,Z=(0,s.useMemo)(()=>({["& .".concat(i.Z.icon)]:{color:j.s7},["& .".concat(p.Z.root)]:{marginRight:".8em"},["& .".concat(h.Z.root)]:{color:j.s7,visibility:"hidden"},["&:hover .".concat(p.Z.root," .").concat(h.Z.root,",\n      &.").concat(x.Z.focused," .").concat(p.Z.root," .").concat(h.Z.root)]:{visibility:"visible"},...u}),[u]),b=(0,s.useMemo)(()=>String(d).length>0&&l&&(0,r.jsx)(f.Z,{position:"end",children:(0,r.jsx)(v.Z,{onClick:l,children:(0,r.jsx)(m.Z,{fontSize:"small"})})}),[l,d]);return(0,r.jsx)(g.Z,{endAdornment:b,value:d,...c,sx:Z})},b=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[m]=n,{id:p,label:h,selectItems:x,checkItem:f,disableItem:v,formControlProps:g,hideItem:j,inputLabelProps:b={},isReadOnly:y=!1,messageBoxProps:w={},name:C,onBlur:A,onChange:P,onFocus:O,required:_,selectProps:{multiple:M,sx:F,...k}={},value:S,isCheckableItems:I=M}=m,D=(0,s.useMemo)(()=>y?{["& .".concat(i.Z.icon)]:{visibility:"hidden"},...F}:F,[y,F]),V=(0,s.useCallback)(e=>I&&(0,r.jsx)(o.Z,{checked:null==f?void 0:f.call(null,e)}),[f,I]),q=(0,s.useCallback)((e,n)=>(0,r.jsxs)(u.Z,{disabled:null==v?void 0:v.call(null,e),sx:{display:(null==j?void 0:j.call(null,e))?"none":void 0},value:e,children:[V(e),n]},"".concat(p,"-").concat(e)),[V,v,j,p]),E=(0,s.useMemo)(()=>"".concat(p,"-select-element"),[p]),R=(0,s.useMemo)(()=>(0,r.jsx)(d.Z,{id:p,label:h}),[p,h]),U=(0,s.useMemo)(()=>h&&(0,r.jsx)(c.Z,{htmlFor:E,isNotifyRequired:_,...b,children:h}),[b,_,h,E]),L=(0,s.useMemo)(()=>x.map(e=>{if("string"==typeof e)return q(e,e);let{value:n,displayValue:t=String(n)}=e;return q(n,t)}),[q,x]);return(0,r.jsxs)(l.Z,{fullWidth:!0,...g,children:[U,(0,r.jsx)(Z,{id:E,input:R,multiple:M,name:C,onBlur:A,onChange:P,onFocus:O,readOnly:y,value:S,...k,sx:D,children:L}),(0,r.jsx)(a.Z,{...w})]})}},59752:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=e=>e.reduce((e,n)=>{let{hostName:t,hostType:r,hostUUID:i}=n;return e[i]={name:t,type:r,uuid:i},e},{}),i=e=>e.reduce((e,n)=>{let{anvilDescription:t,anvilName:i,anvilUUID:o,hosts:l}=n;return e[o]={description:t,hosts:r(l),name:i,uuid:o},e},{})},37842:function(e,n){"use strict";n.Z={checkbox:"checkbox",number:"number",password:"password",text:"text"}},86901:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Y}});var r=t(85893),i=t(99514),o=t(9008),l=t.n(o),s=t(39937),a=t(60166),u=t(67294),d=t(25934),c=t(4845),m=t(98484),p=t(56903),h=t(44089),x=t(97607),f=t(16310),v=t(36026),g=t(74077);let j=f.Rx().oneOf([0,1,2,3,4]),Z=f.Ry({delete:f.O7().optional(),level:j.required(),target:f.Ry({type:f.Z_().oneOf(["node","subnode"]).required(),uuid:(0,g.u)().required()}),uuid:(0,g.u)().optional()}),b=f.Vo(e=>f.Ry((0,v.Z)(e,Z))),y=f.Ry({alertOverrides:b,email:f.Z_().email().required(),language:f.Z_().oneOf(["en_CA"]).optional(),level:j.required(),name:f.Z_().required(),uuid:(0,g.u)().optional()}),w=f.Vo(e=>f.Ry((0,v.Z)(e,y)));var C=t(96674),A=t(65895),P=t(6189),O=t(59278),_=t(12387);let M=[{displayValue:"Ignore",value:0},{displayValue:"Critical",value:1},{displayValue:"Warning",value:2},{displayValue:"Notice",value:3},{displayValue:"Info",value:4}];var F=e=>{let{alertOverrideTargetOptions:n,alertOverrideValueId:t,mailRecipientUuid:o,formikUtils:l}=e,s=(0,u.useMemo)(()=>null!=t?t:(0,d.Z)(),[t]),{formik:a}=l,{values:{[o]:c}}=a,{alertOverrides:{[s]:m}}=c,h=(0,u.useMemo)(()=>"".concat(o,".alertOverrides.").concat(s),[s,o]),x=(0,u.useMemo)(()=>"".concat(h,".remove"),[h]),f=(0,u.useMemo)(()=>"".concat(h,".target"),[h]),v=(0,u.useMemo)(()=>"".concat(h,".level"),[h]);return(0,r.jsxs)(i.ZP,{alignItems:"center",columns:{xs:1,sm:10},container:!0,justifyContent:"stretch",spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:6,children:(0,r.jsx)(C.Z,{getOptionLabel:e=>e.name,id:f,isOptionEqualToValue:(e,n)=>e.uuid===n.uuid,label:"Target",noOptionsText:"No node or subnode found.",onChange:(e,n)=>a.setFieldValue(f,n,!0),openOnFocus:!0,options:n,renderOption:(e,n)=>(0,u.createElement)("li",{...e,key:"".concat(n.node,"-").concat(n.uuid)},"node"===n.type?(0,r.jsxs)(p.Z,{spacing:0,children:[(0,r.jsx)(O.Ac,{inheritColour:!0,children:n.name}),(0,r.jsx)(O.KI,{inheritColour:!0,children:n.description})]}):(0,r.jsx)(O.Ac,{inheritColour:!0,paddingLeft:".6em",children:n.name})),value:m.target})}),(0,r.jsx)(i.ZP,{item:!0,flexGrow:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(P.Z,{id:v,label:"Alert level",name:v,onChange:a.handleChange,selectItems:M,value:m.level})})}),(0,r.jsx)(i.ZP,{item:!0,width:"min-content",children:(0,r.jsx)(A.Z,{mapPreset:"delete",onClick:()=>{m.uuids?a.setFieldValue(x,!0,!0):a.setValues(e=>{let n={...e},{[o]:t}=n,{[s]:r,...i}=t.alertOverrides;return t.alertOverrides={...i},n})},size:"small"})})]})},k=t(83916),S=e=>{let{alertOverrideTargetOptions:n,formikUtils:t,mailRecipientUuid:i}=e,{formik:o}=t,{values:{[i]:l}}=o,{alertOverrides:s}=l;return(0,r.jsx)(k.Z,{allowAddItem:!0,edit:!0,header:"Alert override rules",listEmpty:"No alert overrides(s)",listItems:s,onAdd:()=>{let e=(0,d.Z)();o.setValues(n=>{let t={...n},{[i]:r}=t;return r.alertOverrides={...r.alertOverrides,[e]:{level:2,target:null}},t})},renderListItem:(e,o)=>!o.remove&&(0,r.jsx)(F,{alertOverrideTargetOptions:n,alertOverrideValueId:e,formikUtils:t,mailRecipientUuid:i})})},I=t(81208),D=t(91029),V=t(82547);let q=[{displayValue:(0,r.jsxs)(p.Z,{spacing:0,children:[(0,r.jsx)(O.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Critical"}),(0,r.jsx)(O.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that could lead to imminent service interruption or unexpected loss of redundancy."})]}),value:1},{displayValue:(0,r.jsxs)(p.Z,{spacing:0,children:[(0,r.jsx)(O.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Warning"}),(0,r.jsx)(O.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that require attention from administrators, such as redundancy loss due to load shedding, hardware in pre-failure, input power loss, temperature anomalies, etc."})]}),value:2},{displayValue:(0,r.jsxs)(p.Z,{spacing:0,children:[(0,r.jsx)(O.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Notice"}),(0,r.jsx)(O.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that are generally safe to ignore, but might provide early warnings of developing issues or insight into system behaviour."})]}),value:3},{displayValue:(0,r.jsxs)(p.Z,{spacing:0,children:[(0,r.jsx)(O.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Info"}),(0,r.jsx)(O.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that are almost always safe to ignore, but may be useful in testing and debugging."})]}),value:4}],E={1:"Critical",2:"Warning",3:"Notice",4:"Info"},R=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/alert-override",{uuid:r}=e;return r?Object.values(e.alertOverrides).reduce((e,n)=>{let{remove:i,level:o,target:l,uuids:s}=n;if(s&&e.push(...Object.keys(s).map(e=>({method:"delete",url:"".concat(t,"/").concat(e)}))),l&&!i){var a;let n=null!==(a=l.subnodes)&&void 0!==a?a:[l.uuid];e.push(...n.map(e=>({body:{hostUuid:e,level:o,mailRecipientUuid:r},method:"post",url:t})))}return e},[]):[]};var U=e=>{let{alertOverrideTargetOptions:n,mailRecipientUuid:t,previousFormikValues:o,tools:l}=e,s=(0,u.useMemo)(()=>null!=t?t:(0,d.Z)(),[t]),p=(0,V.Z)({initialValues:null!=o?o:{[s]:{alertOverrides:{},email:"",language:"en_CA",level:2,name:""}},onSubmit:(e,n)=>{let{setSubmitting:t}=n,{[s]:i}=e,a="Add",u=(0,r.jsx)(r.Fragment,{children:"Failed to add mail recipient."}),d="post",c=(0,r.jsx)(r.Fragment,{children:"Mail recipient added."}),p="Add mail recipient with the following?",f="/mail-recipient";o&&(a="Update",u=(0,r.jsx)(r.Fragment,{children:"Failed to update mail server."}),d="put",c=(0,r.jsx)(r.Fragment,{children:"Mail recipient updated."}),p="Update ".concat(i.name," with the following?"),f+="/".concat(s));let{alertOverrides:v,uuid:g,...j}=i;l.confirm.prepare({actionProceedText:a,content:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{entries:j}),(0,r.jsx)(h.Z,{entries:{alertOverrides:Object.entries(v).reduce((e,n)=>{let[t,r]=n;return r.remove||!r.target||(e[t]={level:r.level,name:r.target.name}),e},{})}})]}),onCancelAppend:()=>t(!1),onProceedAppend:async()=>{l.confirm.loading(!0);let e=e=>{let n=(0,x.Z)(e);n.children=(0,r.jsxs)(r.Fragment,{children:[u," ",n.children]}),l.confirm.finish("Error",n),t(!1)};m.Z[d](f,j).then(n=>{let{data:t}=n,r={...i};t&&(r.uuid=t.uuid),Promise.all(R(r,o&&o[s]).map(e=>m.Z[e.method](e.url,e.body))).then(()=>{l.confirm.finish("Success",{children:c}),l["post"===d?"add":"edit"].open(!1)}).catch(e)}).catch(e)},titleText:p}),l.confirm.open(!0)},validationSchema:w}),{disabledSubmit:f,formik:v,formikErrors:g,handleChange:j}=p,Z=(0,u.useMemo)(()=>"".concat(s,".email"),[s]),b=(0,u.useMemo)(()=>"".concat(s,".level"),[s]),y=(0,u.useMemo)(()=>"".concat(s,".name"),[s]);return(0,r.jsxs)(i.ZP,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),v.submitForm()},spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{id:y,label:"Recipient name",name:y,onChange:j,required:!0,value:v.values[s].name})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{id:Z,label:"Recipient email",name:Z,onChange:j,required:!0,value:v.values[s].email})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(P.Z,{id:b,label:"Alert level",name:b,onChange:v.handleChange,required:!0,selectItems:q,selectProps:{MenuProps:{sx:{["& .".concat(a.Z.paper)]:{maxWidth:{md:"60%",lg:"40%"}}}},renderValue:e=>E[e]},value:v.values[s].level})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(S,{alertOverrideTargetOptions:n,formikUtils:p,mailRecipientUuid:s})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(I.Z,{count:1,messages:g})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(c.Z,{actions:[{background:"blue",children:o?"Update":"Add",disabled:f,type:"submit"}]})})]})},L=t(59752),N=t(78533),T=e=>(0,r.jsx)(U,{...e}),W=t(68805),H=t(77510),B=()=>{let[e,n]=(0,u.useState)(),{altData:t,loading:i}=(0,H.Z)("/anvil",{mod:L.Z}),o=(0,u.useMemo)(()=>t&&Object.values(t).sort((e,n)=>e.name.localeCompare(n.name)).reduce((e,n)=>{let t={description:n.description,name:n.name,node:n.uuid,subnodes:[],type:"node",uuid:n.uuid},r=Object.values(n.hosts).sort((e,n)=>e.name.localeCompare(n.name)).reduce((e,r)=>{var i;return"dr"===r.type||(e.push({name:r.name,node:n.uuid,type:"subnode",uuid:r.uuid}),null===(i=t.subnodes)||void 0===i||i.push(r.uuid)),e},[]);return e.push(t,...r),e},[]),[t]),{fetch:l,loading:s}=(0,W.Z)({onData:e=>n(e),url:"/alert-override"}),a=(0,u.useMemo)(()=>{if(t&&e)return Object.entries(Object.values(e).reduce((e,n)=>{let{node:{uuid:t}}=n;return e[t]?e[t].push(n):e[t]=[n],e},{})).reduce((e,n)=>{let[r,i]=n,[o,...l]=i;if(i.length>1&&l.every(e=>{let{level:n}=e;return n===o.level})){let{0:{level:n}}=i,{[r]:o}=t;e[r]={level:n,target:{description:o.description,name:o.name,node:o.uuid,subnodes:i.map(e=>{let{subnode:{uuid:n}}=e;return n}),type:"node",uuid:o.uuid},uuids:i.reduce((e,n)=>{let{subnode:t,uuid:r}=n;return e[r]=t.uuid,e},{})}}else i.forEach(n=>{let{level:t,node:r,subnode:i,uuid:o}=n;e[i.uuid]={level:t,target:{name:i.name,node:r.uuid,type:"subnode",uuid:i.uuid},uuids:{[o]:i.uuid}}});return e},{})},[e,t]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N.Z,{addHeader:"Add mail recipient",editHeader:e=>"Update ".concat(null==e?void 0:e.name),entriesUrl:"/mail-recipient",getAddLoading:e=>e||i,getDeleteErrorMessage:e=>{let{children:n,...t}=e;return{...t,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete mail recipient(s). ",n]})}},getDeleteHeader:e=>"Delete the following ".concat(e," mail recipient(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted mail recipient(s)."})}),getEditLoading:e=>e||s,listEmpty:"No mail recipient(s) found.",onItemClick:function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];let[,i]=t;e(...t),l(void 0,{params:{"mail-recipient":i}})},renderAddForm:e=>o&&(0,r.jsx)(U,{alertOverrideTargetOptions:o,tools:e}),renderDeleteItem:(e,n)=>{let{key:t}=n,i=null==e?void 0:e[t];return(0,r.jsx)(O.Ac,{children:null==i?void 0:i.name})},renderEditForm:(e,n)=>o&&n&&a&&(0,r.jsx)(T,{alertOverrideTargetOptions:o,mailRecipientUuid:n.uuid,previousFormikValues:{[n.uuid]:{alertOverrides:a,...n}},tools:e}),renderListItem:(e,n)=>{let{name:t}=n;return(0,r.jsx)(O.Ac,{children:t})}})})};let z=f.Ry({address:f.Z_().required(),authentication:f.Z_().oneOf(["none","plain-text","encrypted"]),confirmPassword:f.Z_().when("password",(e,n)=>String(e).length>0?n.required().oneOf([f.iH("password")]):n.optional()),heloDomain:f.Z_().required(),password:f.Z_().optional(),port:f.Rx().required(),security:f.Z_().oneOf(["none","starttls","tls-ssl"]),username:f.Z_().optional(),uuid:(0,g.u)().required()}),K=f.Vo(e=>f.Ry((0,v.Z)(e,z)));var X=e=>{let{localhostDomain:n="",mailServerUuid:t,previousFormikValues:o,tools:l}=e,s=(0,u.useMemo)(()=>null!=t?t:(0,d.Z)(),[t]),{disabledSubmit:a,formik:p,formikErrors:f,handleChange:v}=(0,V.Z)({initialValues:null!=o?o:{[s]:{address:"",authentication:"none",heloDomain:n,port:587,security:"none",uuid:s}},onSubmit:(e,n)=>{let{setSubmitting:t}=n,{[s]:i}=e,a="Add",u=(0,r.jsx)(r.Fragment,{children:"Failed to add mail server."}),d="post",c=(0,r.jsx)(r.Fragment,{children:"Mail server added."}),p="Add mail server with the following?",f="/mail-server";o&&(a="Update",u=(0,r.jsx)(r.Fragment,{children:"Failed to update mail server."}),d="put",c=(0,r.jsx)(r.Fragment,{children:"Mail server updated."}),p="Update ".concat(i.address,":").concat(i.port," with the following?"),f+="/".concat(s));let{confirmPassword:v,uuid:g,...j}=i;l.confirm.prepare({actionProceedText:a,content:(0,r.jsx)(h.Z,{entries:j}),onCancelAppend:()=>t(!1),onProceedAppend:()=>{l.confirm.loading(!0),m.Z[d](f,i).then(()=>{l.confirm.finish("Success",{children:c}),l["post"===d?"add":"edit"].open(!1)}).catch(e=>{let n=(0,x.Z)(e);n.children=(0,r.jsxs)(r.Fragment,{children:[u," ",n.children]}),l.confirm.finish("Error",n),t(!1)})},titleText:p}),l.confirm.open(!0)},validationSchema:K}),g=(0,u.useMemo)(()=>"".concat(s,".address"),[s]),j=(0,u.useMemo)(()=>"".concat(s,".authentication"),[s]),Z=(0,u.useMemo)(()=>"".concat(s,".confirmPassword"),[s]),b=(0,u.useMemo)(()=>"".concat(s,".heloDomain"),[s]),y=(0,u.useMemo)(()=>"".concat(s,".password"),[s]),w=(0,u.useMemo)(()=>"".concat(s,".port"),[s]),C=(0,u.useMemo)(()=>"".concat(s,".security"),[s]),A=(0,u.useMemo)(()=>"".concat(s,".username"),[s]);return(0,r.jsxs)(i.ZP,{component:"form",onSubmit:e=>{e.preventDefault(),p.submitForm()},container:!0,columns:{xs:1,sm:2},spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{id:g,label:"Server address",name:g,onChange:v,required:!0,value:p.values[s].address})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{id:w,label:"Server port",name:w,onChange:v,required:!0,type:"number",value:p.values[s].port})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(P.Z,{id:C,label:"Server security type",name:C,onChange:v,required:!0,selectItems:["none","starttls","tls-ssl"],value:p.values[s].security})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(P.Z,{id:j,label:"Server authentication method",name:j,onChange:v,required:!0,selectItems:["none","plain-text","encrypted"],value:p.values[s].authentication})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{id:b,label:"HELO domain",name:b,onChange:v,required:!0,value:p.values[s].heloDomain})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:A,label:"Server username",name:A,onChange:v,value:p.values[s].username})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:y,label:"Server password",name:y,onChange:v,type:"password",value:p.values[s].password})})}),(0,r.jsx)(i.ZP,{display:{xs:"none",sm:"initial"},item:!0,sm:1}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(_.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:Z,label:"Confirm password",name:Z,onChange:v,type:"password",value:p.values[s].confirmPassword})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(I.Z,{count:1,messages:f})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(c.Z,{actions:[{background:"blue",children:o?"Update":"Add",disabled:a,type:"submit"}]})})]})},G=e=>(0,r.jsx)(X,{...e}),J=()=>{let{data:e,loading:n}=(0,H.Z)("/host/local");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(N.Z,{addHeader:"Add mail server",editHeader:e=>"Update ".concat(null==e?void 0:e.address,":").concat(null==e?void 0:e.port),entriesUrl:"/mail-server",getAddLoading:e=>e||n,getDeleteErrorMessage:e=>{let{children:n,...t}=e;return{...t,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete mail server(s). ",n]})}},getDeleteHeader:e=>"Delete the following ".concat(e," mail server(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted mail server(s)."})}),listEmpty:"No mail server(s) found",renderAddForm:n=>e&&(0,r.jsx)(X,{localhostDomain:e.domain,tools:n}),renderDeleteItem:(e,n)=>{let{key:t}=n,i=null==e?void 0:e[t];return(0,r.jsxs)(O.Ac,{children:[null==i?void 0:i.address,":",null==i?void 0:i.port]})},renderEditForm:(e,n)=>n&&(0,r.jsx)(G,{mailServerUuid:n.uuid,previousFormikValues:{[n.uuid]:n},tools:e}),renderListItem:(e,n)=>{let{address:t,port:i}=n;return(0,r.jsxs)(O.Ac,{children:[t,":",i]})}})})},Q=t(23930),Y=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:"Mail Config"})}),(0,r.jsx)(s.Z,{}),(0,r.jsxs)(i.ZP,{container:!0,columns:{xs:1,md:6,lg:4},children:[(0,r.jsx)(i.ZP,{item:!0,xs:1}),(0,r.jsx)(i.ZP,{item:!0,xs:1,md:4,lg:2,children:(0,r.jsxs)(Q.s_,{children:[(0,r.jsx)(Q.V9,{children:(0,r.jsx)(O.z,{children:"Mail config"})}),(0,r.jsx)(Q.TZ,{expandInitially:!0,header:"Manage mail servers",children:(0,r.jsx)(J,{})}),(0,r.jsx)(Q.TZ,{expandInitially:!0,header:"Manage mail recipients",children:(0,r.jsx)(B,{})})]})})]})]})}},function(e){e.O(0,[162,442,318,206,74,461,602,26,321,777,888,774,179],function(){return e(e.s=24084)}),_N_E=e.O()}]);