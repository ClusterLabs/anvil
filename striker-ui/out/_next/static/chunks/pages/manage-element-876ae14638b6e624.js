(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{29582:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-element",function(){return n(82657)}])},73846:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(66389),i=n(45036),a=n(11100),o=n(18541),c=n(71108),d=n(81013),u=n(40657),h=n(5499);let m=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"==typeof e?e(...n):e};t.Z=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[p]=t,{addHeader:x,editHeader:f,entriesUrl:j,formDialogProps:g,getAddLoading:v,getDeleteErrorMessage:Z,getDeleteHeader:b,getDeletePromiseChain:w=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},getDeleteSuccessMessage:k,getEditLoading:y=e=>e,listEmpty:P,listProps:M,onItemClick:C=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},onValidateEntriesChange:S,refreshInterval:I=5e3,renderAddForm:A,renderDeleteItem:F,renderEditForm:T,renderListItem:O,entryUrlPrefix:U=j}=p,N=(0,s.useRef)(null),R=(0,s.useRef)(null),{confirmDialog:q,finishConfirm:E,setConfirmDialogLoading:D,setConfirmDialogOpen:_,setConfirmDialogProps:H}=(0,u.Z)({initial:{scrollContent:!0}}),[B,V]=(0,s.useState)(!1),[L,z]=(0,s.useState)(),{data:$,mutate:W,loading:G,validating:J}=(0,h.Z)(j,{refreshInterval:I}),{fetch:Q,loading:K}=(0,c.Z)({onData:e=>z(e),url:U});(0,s.useEffect)(()=>{null==S||S.call(null,J)},[S,J]);let X=(0,s.useMemo)(()=>m(x),[x]),Y=(0,s.useMemo)(()=>m(f,L),[L,f]),ee=(0,s.useMemo)(()=>({add:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==N?void 0:null===(e=N.current)||void 0===e?void 0:e.setOpen(t)}},confirm:{finish:E,loading:D,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return _(e)},prepare:H},edit:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==R?void 0:null===(e=R.current)||void 0===e?void 0:e.setOpen(t)}}}),[E,D,_,H]),{buildDeleteDialogProps:et,checks:en,getCheck:er,hasAllChecks:es,hasChecks:el,multipleItems:ei,resetChecks:ea,setAllChecks:eo,setCheck:ec}=(0,d.Z)({list:$});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{allowCheckAll:ei,allowEdit:!0,allowItemButton:B,disableDelete:!el,edit:B,getListCheckboxProps:()=>({checked:es,onChange:(e,t)=>eo(t)}),getListItemCheckboxProps:e=>({checked:er(e),onChange:(t,n)=>ec(e,n)}),header:!0,listEmpty:P,listItems:$,loading:G,onAdd:()=>{var e;return null==N?void 0:null===(e=N.current)||void 0===e?void 0:e.setOpen(!0)},onDelete:()=>{H(et({onProceedAppend:()=>{D(!0),Promise.all(w((e,t)=>e.map(e=>l.Z.delete("".concat(t,"/").concat(e))),en,j)).then(()=>{E("Success",k()),W()}).catch(e=>{E("Error",Z((0,a.Z)(e)))}).finally(()=>{ea()})},getConfirmDialogTitle:b,renderEntry:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return F($,...t)}})),_(!0)},onEdit:()=>V(e=>!e),onItemClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return C((e,t)=>{var n;null==R||null===(n=R.current)||void 0===n||n.setOpen(!0),Q("/".concat(t))},...t)},renderListItem:O,...M}),(0,r.jsx)(i.Js,{header:X,loading:null==v?void 0:v.call(null),ref:N,showClose:!0,...null==g?void 0:g.common,...null==g?void 0:g.add,children:A(ee)}),(0,r.jsx)(i.Js,{header:Y,loading:y(K),ref:R,showClose:!0,...null==g?void 0:g.common,...null==g?void 0:g.edit,children:T(ee,L)}),q]})}},18950:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(47177);let i=(0,s.forwardRef)((e,t)=>{let{children:n,contentContainerProps:i,dialogProps:a,onSubmitAppend:o,proceedButtonProps:c,scrollBoxProps:d,scrollContent:u,...h}=e,m=(0,s.useMemo)(()=>({...i,component:"form",onSubmit:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r]=t;r.preventDefault(),null==o||o.call(null,...t)}}),[i,o]),p=(0,s.useMemo)(()=>({...d,sx:u?{overflowX:"hidden",paddingTop:".6em",...null==d?void 0:d.sx}:null==d?void 0:d.sx}),[d,u]);return(0,r.jsx)(l.Z,{dialogProps:a,contentContainerProps:m,proceedButtonProps:{...c,type:"submit"},scrollContent:u,scrollBoxProps:p,wide:!0,...h,ref:t,children:n})});i.displayName="FormDialog",t.Z=i},76740:function(e,t,n){"use strict";var r=n(85893),s=n(90642),l=n(19304),i=n(47407),a=n(41609),o=n.n(a),c=n(35338),d=n(44400),u=n(5387),h=n(57882);let m=e=>{let{entry:t}=e;return(0,r.jsx)(h.$_,{whiteSpace:"nowrap",children:String(t)})},p=e=>{let{entry:t,key:n}=e;return c.JW.test(n)?(0,r.jsx)(h.PJ,{wrapper:"mono",children:String(t)}):m(e)},x=e=>{let{entry:t,hasPassword:n}=e;return o()(t)?(0,r.jsx)(h.Ac,{children:"none"}):n?p(e):m(e)},f=e=>{let{depth:t,entry:n,getLabel:l,hasPassword:i,key:a,nest:o,renderValue:c}=e;return(0,r.jsxs)(u.Z,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,r.jsx)(h.Ac,{children:l({cap:d.Z,depth:t,entry:n,hasPassword:i,key:a})}),(0,r.jsx)(s.Z,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!o&&c(x,{depth:t,entry:n,hasPassword:i,key:a})})]})},j=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},g=e=>null!==e&&"object"==typeof e&&!o()(e),v=e=>{let{depth:t=0,entries:n,getEntryLabel:s,getListProps:a,getListItemProps:o,hasPassword:c,listKey:d,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:p}=e,x=[];Object.entries(n).forEach(e=>{let[n,i]=e,a=g(i),d=a?null:i,f={depth:t,entry:d,hasPassword:c,key:n};p(j,f)||x.push((0,r.jsx)(l.ZP,{sx:{paddingLeft:"".concat(t,"em")},...null==o?void 0:o.call(null,f),children:h({depth:t,entry:d,getLabel:s,hasPassword:c,key:n,nest:a,renderValue:m})},"form-summary-entry-".concat(n))),a&&t<u&&x.push(v({depth:t+1,entries:i,getEntryLabel:s,hasPassword:c,listKey:n,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:p}))});let f="form-summary-list-".concat(null!=d?d:"root");return(0,r.jsx)(i.Z,{dense:!0,disablePadding:!0,...null==a?void 0:a.call(null,{depth:t,entries:n,key:d}),children:x},f)};t.Z=e=>{let{entries:t,getEntryLabel:n=e=>{let{cap:t,key:n}=e;return t(n)},getListProps:r,getListItemProps:s,hasPassword:l=!1,maxDepth:i=3,renderEntry:a=f,renderEntryValue:o=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},skip:c=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)}}=e;return v({entries:t,getEntryLabel:n,getListProps:r,getListItemProps:s,hasPassword:l,maxDepth:i,renderEntry:a,renderEntryValue:o,skip:c})}},16562:function(e,t,n){"use strict";var r=n(85893),s=n(77527),l=n(50385),i=n(13539),a=n(67294),o=n(39971),c=n(57882);let d=(0,s.ZP)(l.Z)({height:"3.5em",marginLeft:0,width:"100%"});t.Z=e=>{let{baseInputProps:t,checked:n,formControlLabelProps:s,id:l,label:u,name:h,onChange:m,switchProps:p}=e,x=(0,a.useMemo)(()=>"string"==typeof u?(0,r.jsx)(c.Ac,{inheritColour:!0,color:"".concat(o.s7,"AF"),children:u}):(0,r.jsx)(r.Fragment,{children:u}),[u]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{componentsProps:{typography:{flexGrow:1}},control:(0,r.jsx)(i.Z,{checked:n,edge:"end",name:h,onChange:m,...p}),label:x,labelPlacement:"start",...s}),(0,r.jsx)("input",{checked:n,hidden:!0,id:l,readOnly:!0,...t})]})}},19166:function(e,t,n){"use strict";var r=n(85893),s=n(77527),l=n(58918),i=n(80483),a=n(67294),o=n(39971),c=n(57882);let d=(0,s.ZP)(l.Z)({borderRadius:o.n_,color:o.s7,padding:".4em .8em",textTransform:"none",["&.".concat(i.Z.selected)]:{color:o.Ej}});t.Z=e=>{let{label:t,...n}=e,s=(0,a.useMemo)(()=>"string"==typeof t?(0,r.jsx)(c.Ac,{inheritColour:!0,children:t}):t,[t]);return(0,r.jsx)(d,{label:s,...n})}},17428:function(e,t,n){"use strict";var r=n(85893),s=n(90642),l=n(67294);t.Z=e=>{let{changingTabId:t,children:n,retain:i=!1,tabId:a}=e,o=(0,l.useMemo)(()=>t===a,[t,a]),c=(0,l.useMemo)(()=>i?(0,r.jsx)(s.Z,{sx:{display:o?"initial":"none"},children:n}):o&&n,[n,o,i]);return(0,r.jsx)(r.Fragment,{children:c})}},22143:function(e,t,n){"use strict";var r=n(85893),s=n(77527),l=n(14221),i=n(93465),a=n(80483),o=n(18745),c=n(89540),d=n(67294),u=n(39971);let h="1.8em",m=(0,s.ZP)(l.Z)({minHeight:"1em",["&.".concat(i.Z.vertical)]:{minHeight:h,["& .".concat(a.Z.root)]:{alignItems:"flex-start",minHeight:h,paddingLeft:"2em"},["& .".concat(i.Z.indicator)]:{right:"initial"}},["& .".concat(a.Z.root)]:{minHeight:"1em"},["& .".concat(i.Z.indicator)]:{backgroundColor:u.Ej,borderRadius:u.n_}});t.Z=e=>{let{orientation:t,variant:n="fullWidth",...s}=e,l=(0,o.Z)(),i=(0,d.useCallback)(e=>l.breakpoints.up(e),[l]),a=(0,c.Z)(i("xs")),u=(0,c.Z)(i("sm")),h=(0,c.Z)(i("md")),p=(0,c.Z)(i("lg")),x=(0,c.Z)(i("xl")),f=(0,d.useMemo)(()=>[["xs",a],["sm",u],["md",h],["lg",p],["xl",x]],[p,h,u,x,a]),j=(0,d.useMemo)(()=>{let e;return"object"==typeof t?f.some(n=>{let[r,s]=n;return s&&t[r]&&(e=t[r]),!s}):e=t,e},[f,t]);return(0,r.jsx)(m,{orientation:j,variant:n,...s})}},71108:function(e,t,n){"use strict";var r=n(67294),s=n(66389),l=n(11100);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{config:t,onError:n,onData:i,url:a=""}=e,[o,c]=(0,r.useState)(!1);return{fetch:(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,o="".concat(a).concat(e);o&&(c(!0),s.Z.get(o,{...t,...r}).then(e=>{let{data:t}=e;null==i||i.call(null,t)}).catch(e=>{let t=(0,l.Z)(e);null==n||n.call(null,t)}).finally(()=>{c(!1)}))},[a,t,i,n]),loading:o}}},81013:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(95996),i=n(76740);t.Z=e=>{let{list:t={}}=e,[n,a]=(0,s.useState)({}),o=(0,s.useMemo)(()=>Object.keys(t),[t]),c=(0,s.useMemo)(()=>Object.keys(n),[n]),d=(0,s.useMemo)(()=>c.length===o.length,[c.length,o.length]),u=(0,s.useMemo)(()=>c.length>0,[c.length]),h=(0,s.useMemo)(()=>o.length>1,[o.length]),m=(0,s.useCallback)(e=>{let{confirmDialogProps:t={},formSummaryProps:s={},getConfirmDialogTitle:l,onProceedAppend:a,renderEntry:o}=e;return{actionProceedText:"Delete",content:(0,r.jsx)(i.Z,{entries:n,maxDepth:0,renderEntry:o,...s}),onProceedAppend:a,proceedColour:"red",titleText:l(c.length),...t}},[n,c.length]),p=(0,s.useCallback)(e=>!!n[e],[n]);return{buildDeleteDialogProps:m,checklist:n,checks:c,getCheck:p,hasAllChecks:d,hasChecks:u,multipleItems:h,resetChecks:(0,s.useCallback)(()=>a({}),[]),setAllChecks:(0,s.useCallback)(e=>a(o.reduce((t,n)=>(e&&(t[n]=e),t),{})),[o]),setCheck:(0,s.useCallback)((e,t)=>a((0,l.ZP)(e,t||void 0)),[])}}},84337:function(e,t,n){"use strict";var r=n(67294);t.Z=function(){let{actionProceedText:e="",content:t="",titleText:n="",...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useState)({actionProceedText:e,content:t,titleText:n,...s})}},99246:function(e,t,n){"use strict";var r=n(67294);t.Z=()=>{let e=(0,r.useRef)(!0);return e.current?(e.current=!1,!0):e.current}},82657:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ni}});var r=n(85893),s=n(9008),l=n.n(s),i=n(11163),a=n(67294),o=function(e){let{fallbackValue:t="",joinSeparator:n="",limit:r=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof Array?e.slice(0,r).join(n):null!=e?e:t},c=n(25436),d=n(35338),u=n(90642),h=n(48801),m=n(77527),p=n(21038),x=n(46315),f=n(5387),j=n(2911),g=n(23852),v=n(65375),Z=n(37628),b=n(16562),w=n(68007),k=n(57882);let y=["1","on"],P=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,setMessage:n},id:r,label:s}=e,l=t(r),i=()=>{n(r)};return"ip"===s.toLowerCase()?(0,w._)(s,i,{onFinishBatch:l},e=>{n(r,{children:e})}):{defaults:{onSuccess:i},onFinishBatch:l,tests:[{test:w.HJ}]}},M=e=>{let{formUtils:t,id:n,isRequired:s,label:l="",name:i=n,value:a}=e,{buildFinishInputTestBatchFunction:o,buildInputFirstRenderFunction:c,setMessage:d}=t;return(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:n,label:l,name:i,value:a}),inputTestBatch:(0,w.qY)(l,()=>{d(n)},{onFinishBatch:o(n)},e=>{d(n,{children:e})}),onFirstRender:c(n),required:s,valueType:"number"},"".concat(n,"-wrapper"))},C={boolean:e=>{let{id:t,isChecked:n=!1,label:s,name:l=t}=e;return(0,r.jsx)(j.Z,{input:(0,r.jsx)(b.Z,{checked:n,id:t,label:s,name:l}),valueType:"boolean"},"".concat(t,"-wrapper"))},integer:M,second:M,select:e=>{let{formUtils:t,id:n,isRequired:s,label:l,name:i=n,selectOptions:a=[],value:o=""}=e,{buildFinishInputTestBatchFunction:c,buildInputFirstRenderFunction:d,setMessage:u}=t;return(0,r.jsx)(j.Z,{input:(0,r.jsx)(Z.Z,{id:n,label:l,name:i,selectItems:a,value:o}),inputTestBatch:{defaults:{onSuccess:()=>{u(n)}},onFinishBatch:c(n),tests:[{test:w.HJ}]},onFirstRender:d(n),required:s},"".concat(n,"-wrapper"))},string:e=>{let t;let{formUtils:n,id:s,isRequired:l,isSensitive:i=!1,label:a="",name:o=s,value:c}=e,{buildInputFirstRenderFunction:d}=n;return i&&(t=x.Z.password),(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:s,label:a,name:o,type:t,value:c}),inputTestBatch:P({formUtils:n,id:s,label:a}),onFirstRender:d(s),required:l},"".concat(s,"-wrapper"))}},S=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("-")},I=(0,m.ZP)(f.Z)({margin:".4em 0"});var A=e=>{let{fenceId:t,fenceParameterTooltipProps:n,fenceTemplate:s,formUtils:l,previousFenceName:i,previousFenceParameters:o}=e,{buildFinishInputTestBatchFunction:c,buildInputFirstRenderFunction:h,setMessage:m}=l,x=(0,a.useMemo)(()=>{let e;if(s&&t){let{parameters:a}=s[t],x={};o&&(x=Object.entries(o).reduce((e,n)=>{let[r,s]=n;return e[S(t,r)]=s,e},{}));let{optional:Z,required:b}=Object.entries(a).sort((e,t)=>{let[n]=e,[r]=t;return n>r?1:-1}).reduce((e,s)=>{var i,a;let[o,{content_type:c,default:h,deprecated:m,description:f,options:j,replacement:g,required:v}]=s;if([1===Number(m),g].some(e=>e))return e;let{optional:Z,required:b}=e,w=null!==(i=C[c])&&void 0!==i?i:C.string,P=S(t,o),M=null!==(a=x[P])&&void 0!==a?a:h,I=!/plug|port/i.test(o)&&1===Number(v),A=d.JW.test(o),F=w({formUtils:l,id:P,isChecked:y.includes(M),isRequired:I,isSensitive:A,label:o,selectOptions:j,value:M}),T=(0,r.jsx)(p.Z,{componentsProps:{tooltip:{sx:{maxWidth:{md:"62.6em"}}}},disableInteractive:!0,placement:"top-start",title:(0,r.jsx)(k.Ac,{children:f}),...n,children:(0,r.jsx)(u.Z,{children:F})},"".concat(P,"-tooltip"));return I?b.push(T):Z.push(T),e},{optional:[],required:[]}),P=S(t,"name"),M="Fence device name";e=(0,r.jsxs)(f.Z,{sx:{"& > div:first-child":{marginTop:0},"& > div":{marginBottom:0}},children:[(0,r.jsx)(v.TZ,{expandInitially:!0,header:"Required parameters",children:(0,r.jsxs)(I,{children:[(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:P,label:M,name:P,value:i}),inputTestBatch:(0,w.Gn)(M,()=>{m(P)},{onFinishBatch:c(P)},e=>{m(P,{children:e})}),onFirstRender:h(P),required:!0},"".concat(P,"-wrapper")),b]})}),(0,r.jsx)(v.TZ,{header:"Optional parameters",children:(0,r.jsx)(I,{children:Z})})]})}return e},[c,h,t,n,s,l,i,o,m]);return(0,r.jsx)(r.Fragment,{children:x})},F=n(90209),T=n(99246);let O="add-fence-input-agent";var U=e=>{let{fenceTemplate:t,formUtils:n,loading:s}=e,{setValidity:l}=n,i=(0,T.Z)(),[o,c]=(0,a.useState)(null),d=(0,a.useMemo)(()=>t?Object.entries(t).sort((e,t)=>{let[n]=e,[r]=t;return n>r?1:-1}).map(e=>{let[t,{description:n}]=e;return{fenceDescription:"string"==typeof n?n:"No description.",fenceId:t,label:t}}):[],[t]),m=(0,a.useMemo)(()=>(0,r.jsx)(h.Z,{id:O,isOptionEqualToValue:(e,t)=>e.fenceId===t.fenceId,label:"Fence device type",onChange:(e,t)=>{l(O,null!==t),c(t)},openOnFocus:!0,options:d,renderOption:(e,t,n)=>{let{fenceDescription:s,fenceId:l}=t,{selected:i}=n;return(0,r.jsxs)(u.Z,{component:"li",sx:{display:"flex",flexDirection:"column","& > *":{width:"100%"}},...e,children:[(0,r.jsx)(k.Ac,{inverted:!0,sx:{fontSize:"1.2em",fontWeight:i?400:void 0},children:l}),(0,r.jsx)(k.Ac,{selected:!1,children:s})]})},sx:{marginTop:".3em"},value:o}),[d,o,l]),p=(0,a.useMemo)(()=>(0,r.jsx)(A,{fenceId:null==o?void 0:o.fenceId,fenceTemplate:t,formUtils:n}),[t,null==o?void 0:o.fenceId,n]),x=(0,a.useMemo)(()=>s?(0,r.jsx)(F.Z,{}):(0,r.jsxs)(f.Z,{children:[m,p]}),[m,p,s]);return(0,a.useEffect)(()=>{i&&l(O,null!==o)},[o,i,l]),(0,r.jsx)(r.Fragment,{children:x})},N=n(66389),R=n(47177),q=e=>{let{fenceId:t,fenceTemplate:n,formUtils:s,loading:l,previousFenceName:i,previousFenceParameters:o}=e,c=(0,a.useMemo)(()=>l?(0,r.jsx)(F.Z,{}):(0,r.jsx)(A,{fenceId:t,fenceTemplate:n,formUtils:s,previousFenceName:i,previousFenceParameters:o}),[n,t,s,l,i,o]);return(0,r.jsx)(r.Fragment,{children:c})},E=n(18950),D=n(76740),_=n(11100),H=n(18541),B=n(18050),V=n(81013),L=n(84337),z=n(5499),$=n(95275);let W=e=>{let{id:t}=e,n=new RegExp("^(fence[^-]+)".concat("-","([^\\s]+)$")),r=t.match(n);if(!r)throw Error("Not target input element");return r},G=(e,t,n)=>{if("name"===e)throw t.name=n,Error("Not child parameter")},J=e=>{if(!e)throw Error("Not parameter specification")},Q=(e,t)=>{if([t,"",null,void 0].some(t=>e===t))throw Error("Skippable parameter value")},K=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[{target:s}]=n,{elements:l}=s;return Object.values(l).reduce((t,n)=>{try{let[,r,s]=W(n);t.agent=r;let{checked:l,value:i}=n;G(s,t,i);let{[r]:{parameters:{[s]:a}}}=e;J(a);let{content_type:o,default:c}=a,d=i;"boolean"===o&&(d=l?"1":""),Q(d,c),t.parameters[s]=d}catch(e){}return t},{agent:"",name:"",parameters:{}})};var X=()=>{let e=(0,T.Z)(),t=(0,a.useRef)({}),n=(0,a.useRef)({}),s=(0,a.useRef)({}),[l,i]=(0,L.Z)(),[o,c]=(0,L.Z)(),[u,h]=(0,a.useState)(),[m,p]=(0,a.useState)(),[x,j]=(0,a.useState)(!1),[g,Z]=(0,a.useState)(!0),{loading:b}=(0,z.Z)("/fence",{onSuccess:e=>h(e),refreshInterval:6e4}),w=(0,a.useCallback)(()=>{N.Z.get("/fence").then(e=>{let{data:t}=e;h(t)})},[h]),y=(0,$.Z)([O],s),{isFormInvalid:P,isFormSubmitting:M,submitForm:C}=y,{buildDeleteDialogProps:S,checks:I,getCheck:A,hasChecks:W,resetChecks:G,setCheck:J}=(0,V.Z)({list:u}),Q=(0,a.useCallback)(e=>{let{cap:t,depth:n,key:r}=e;return 0===n?t(r):r},[]),X=(0,a.useMemo)(()=>(0,r.jsx)(H.Z,{allowEdit:!0,allowItemButton:x,disableDelete:!W,edit:x,header:!0,listEmpty:"No fence device(s) registered.",listItems:u,onAdd:()=>{var e;c({actionProceedText:"Add",content:(0,r.jsx)(U,{fenceTemplate:m,formUtils:y}),onSubmitAppend:e=>{var n;if(!m)return;let s=K(m,e),{agent:l,name:a}=s;i({actionProceedText:"Add",content:(0,r.jsx)(D.Z,{entries:s,hasPassword:!0,getEntryLabel:Q}),onProceedAppend:()=>{C({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add fence device. ",e]}),method:"post",onSuccess:()=>w(),successMsg:"Added fence device ".concat(a),url:"/fence"})},titleText:(0,r.jsxs)(k.z,{children:["Add a"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:l})," ","fence device with the following parameters?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:"Add a fence device"}),null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var e;i(S({getConfirmDialogTitle:e=>"Delete ".concat(e," fence device(s)?"),onProceedAppend:()=>{C({body:{uuids:I},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to delete fence device(s). ",e]}),method:"delete",onSuccess:()=>{w(),G()},url:"/fence"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(k.Ac,{children:null==u?void 0:u[t].fenceName})}})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>{j(e=>!e)},onItemCheckboxChange:(e,t,n)=>{J(e,n)},onItemClick:e=>{var s;let{fenceAgent:l,fenceName:a,fenceParameters:o,fenceUUID:d}=e;c({actionProceedText:"Update",content:(0,r.jsx)(q,{fenceId:l,fenceTemplate:m,formUtils:y,previousFenceName:a,previousFenceParameters:o}),onSubmitAppend:e=>{var n;if(!m)return;let s=K(m,e);i({actionProceedText:"Update",content:(0,r.jsx)(D.Z,{entries:s,hasPassword:!0,getEntryLabel:Q}),onProceedAppend:()=>{C({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update fence device. ",e]}),method:"put",onSuccess:()=>w(),successMsg:"Updated fence device ".concat(a),url:"/fence/".concat(d)})},titleText:(0,r.jsxs)(k.z,{children:["Update"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:a})," ","fence device with the following parameters?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:(0,r.jsxs)(k.z,{children:["Update fence device"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:a})," ","parameters"]})}),null===(s=n.current.setOpen)||void 0===s||s.call(null,!0)},renderListItemCheckboxState:e=>A(e),renderListItem:(e,t)=>{let{fenceAgent:n,fenceName:s,fenceParameters:l}=t;return(0,r.jsxs)(f.Z,{row:!0,children:[(0,r.jsx)(k.Ac,{children:s}),(0,r.jsx)(k.Ac,{children:Object.entries(l).reduce((e,t)=>{let[n,s]=t,l=(0,r.jsxs)(r.Fragment,{children:[n,'="']});return l=d.JW.test(n)?(0,r.jsxs)(r.Fragment,{children:[l,(0,r.jsx)(k.PJ,{wrapper:"mono",children:s})]}):(0,r.jsxs)(r.Fragment,{children:[l,s]}),(0,r.jsxs)(r.Fragment,{children:[e," ",l,'"']})},n)})]})}}),[S,I,u,m,y,A,w,Q,W,x,G,J,i,c,C]),Y=(0,a.useMemo)(()=>g||b?(0,r.jsx)(F.Z,{}):X,[b,g,X]),ee=(0,a.useMemo)(()=>(0,r.jsx)(B.Z,{count:1,defaultMessageType:"warning",ref:s}),[]);return e&&N.Z.get("/fence/template").then(e=>{let{data:t}=e;p(t)}).catch(e=>{(0,_.Z)(e)}).finally(()=>{Z(!1)}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(v.s_,{children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(k.z,{children:"Manage fence devices"})}),Y]}),(0,r.jsx)(E.Z,{dialogProps:{PaperProps:{sx:{minWidth:{xs:"90%",md:"50em"}}}},scrollBoxProps:{padding:".3em .5em"},...o,disableProceed:P,loadingAction:M,preActionArea:ee,ref:n,scrollContent:!0,showClose:!0}),(0,r.jsx)(R.Z,{closeOnProceed:!0,scrollBoxProps:{paddingRight:"1em"},...l,ref:t,scrollContent:!0})]})},Y=n(73846),ee=n(45036),et=n(9968),en=n(82092);let er={online:"ok",offline:"off"},es={dr:"DR",node:"Subnode"};var el=e=>{var t;let{data:n}=e,{hostName:s,hostStatus:l,hostType:i,shortHostName:a}=n;return(0,r.jsxs)(f.Z,{row:!0,spacing:".5em",children:[(0,r.jsx)(et.Z,{colour:null!==(t=er[l])&&void 0!==t?t:"warning",sx:{alignSelf:"stretch",height:"auto"}}),(0,r.jsxs)(f.Z,{flexGrow:1,spacing:0,children:[(0,r.jsxs)(f.Z,{sm:"row",spacing:".5em",children:[(0,r.jsx)(k.Ac,{children:es[i]}),(0,r.jsx)(k.$_,{whiteSpace:"nowrap",children:a}),(0,r.jsx)(en.Z,{orientation:"vertical",sx:{alignSelf:"stretch",height:"auto"}}),(0,r.jsx)(k.$_,{sx:{display:{xs:"none",sm:"flex"}},whiteSpace:"nowrap",children:s})]}),(0,r.jsx)(k.Ac,{children:l})]})]})},ei=n(45328),ea=n(8506),eo=n(42050),ec=n(50385),ed=n(60318),eu=n(42815),eh=n(89621),em=n(85533),ep=n(17254),ex=n(39971),ef=e=>{let{formControlProps:t,formControlLabelProps:n,formLabelProps:s,id:l,label:i,name:o,onChange:c,radioItems:d,radioProps:{sx:u,...h}={},radioGroupProps:m,value:p}=e,x=(0,a.useMemo)(()=>"string"==typeof i?(0,r.jsx)(k.Ac,{children:i}):i,[i]),f=(0,a.useMemo)(()=>Object.entries(d).map(e=>{let[t,{label:s,value:i}]=e,a="string"==typeof s?(0,r.jsx)(k.Ac,{children:s}):s;return(0,r.jsx)(ec.Z,{control:(0,r.jsx)(ed.Z,{...h,sx:{["&.".concat(eu.Z.root)]:{color:ex.s7},...u}}),value:i,label:a,...n},"".concat(l,"-").concat(t))}),[n,l,d,u,h]);return(0,r.jsxs)(eh.Z,{...t,children:[(0,r.jsx)(em.Z,{...s,children:x}),(0,r.jsx)(ep.Z,{id:l,name:o,onChange:c,row:!0,value:p,...m,children:f})]})},ej=n(16310),eg=n(48313);let ev=ej.Ry().shape({enterpriseKey:(0,eg.uI)().optional(),name:ej.Z_().required(),redhatConfirmPassword:ej.Z_().when("redhatPassword",(e,t)=>String(e).length>0?t.required().oneOf([ej.iH("redhatPassword")]):t.optional()),redhatPassword:ej.Z_().when("redhatUsername",(e,t)=>String(e).length>0?t.required():t.optional()),redhatUsername:ej.Z_().when("redhatPassword",(e,t)=>String(e).length>0?t.required():t.optional()),target:ej.Z_().required(),type:ej.Z_().oneOf(["dr","subnode"]).required(),uuid:(0,eg.uI)().required()},[["redhatUsername","redhatPassword"]]),eZ=ej.Ry({password:ej.Z_().required(),target:ej.Z_().required()});var eb=n(12823),ew=n(22582);let ek={subnode:{label:"Subnode",value:"subnode"},dr:{label:"Disaster Recovery (DR) host",value:"dr"}};var ey=e=>{let{host:t,setResponse:n,tools:s}=e,{disabledSubmit:l,formik:i,formikErrors:o,handleChange:c}=(0,ew.Z)({initialValues:{name:t.hostName,password:t.hostPassword,target:t.target,type:"",uuid:t.hostUUID},onSubmit:(e,t)=>{let{setSubmitting:l}=t,{enterpriseKey:i,name:a,password:o,redhatPassword:c,redhatUsername:d,target:u,type:h,uuid:m}=e;s.confirm.prepare({actionProceedText:"Prepare",content:(0,r.jsx)(D.Z,{entries:e,hasPassword:!0}),onCancelAppend:()=>l(!1),onProceedAppend:()=>{s.confirm.loading(!0),N.Z.put("/host/prepare",{enterprise:{uuid:i},host:{name:a,password:o,ssh:{},type:"subnode"===h?"node":h,uuid:m},redhat:{password:c,user:d},target:u}).then(()=>{s.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Started job to prepare host at ",u,"."]})}),s.add.open(!1),setTimeout(n,500)}).catch(e=>{let t=(0,_.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare host at ",u,". ",t.children]}),s.confirm.finish("Error",t),l(!1)})},titleText:"Prepare host at ".concat(e.target," with the following?")}),s.confirm.open()},validationSchema:ev}),d=(0,a.useMemo)(()=>"enterpriseKey",[]),u=(0,a.useMemo)(()=>"name",[]),h=(0,a.useMemo)(()=>"redhatConfirmPassword",[]),m=(0,a.useMemo)(()=>"redhatPassword",[]),p=(0,a.useMemo)(()=>"redhatUsername",[]),x=(0,a.useMemo)(()=>"type",[]),f=(0,a.useMemo)(()=>t.isInetConnected&&/rhel/i.test(t.hostOS)&&!t.isOSRegistered,[t.hostOS,t.isInetConnected,t.isOSRegistered]);return(0,r.jsxs)(ea.ZP,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),i.submitForm()},spacing:"1em",children:[(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(ef,{id:x,label:"Host type",name:x,onChange:c,radioItems:ek,value:i.values.type})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{id:u,label:"Host name",name:u,onChange:c,required:!0,value:i.values.name})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{id:d,label:"Alteeve enterprise key",name:d,onChange:c,value:i.values.enterpriseKey})})}),f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:p,label:"RedHat username",name:p,onChange:c,value:i.values.redhatUsername})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:m,label:"RedHat password",name:m,onChange:c,type:"password",value:i.values.redhatPassword})})}),(0,r.jsx)(ea.ZP,{display:{xs:"none",sm:"initial"},item:!0,sm:1}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:h,label:"Confirm RedHat password",name:h,onChange:c,type:"password",value:i.values.redhatConfirmPassword})})})]}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(B.Z,{count:1,messages:o})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eo.Z,{actions:[{background:"blue",children:"Prepare host",disabled:l,type:"submit"}]})})]})},eP=n(29873),eM=n(21758),eC=e=>{let{jobs:t,progress:n}=e,s=(0,a.useMemo)(()=>Object.keys(t).filter(e=>t[e].local),[t]),{altData:l,loading:i}=(0,z.Z)("/job?broken_keys",{mod:e=>{let t=0,r=s.reduce((n,r)=>{let{[r]:s}=e;return s&&(n.push(s),t+=s.progress),n},[]);return n.setTotal(t/r.length),r},refreshInterval:2e3});return i?(0,r.jsx)(F.Z,{mt:0}):l?(0,r.jsxs)(ea.ZP,{alignItems:"center",container:!0,spacing:"0.5em",children:[...l.map(e=>{let{progress:t,uuid:n}=e;return(0,r.jsx)(ea.ZP,{item:!0,children:(0,r.jsx)(eM.Z,{slotProps:{pie:{size:"1em"}},value:t})},"".concat(n,"-progress"))}),(0,r.jsx)(ea.ZP,{item:!0,xs:!0,children:(0,r.jsx)(k.Ac,{children:100===n.total?"Finished deletion.":"Deleting..."})})]}):(0,r.jsx)(eP.Z,{type:"warning",children:"Failed to get the list of jobs."})},eS=e=>{let{setResponse:t,tools:n}=e,s=(0,a.useRef)(null),[l,i]=(0,a.useState)(),[o,c]=(0,a.useState)(0),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)([]),p=(0,a.useCallback)(e=>{var t,n;return null===(n=s.current)||void 0===n?void 0:null===(t=n.setMessage)||void 0===t?void 0:t.call(null,"api",e)},[]),{disabledSubmit:x,formik:f,formikErrors:j,handleChange:v}=(0,ew.Z)({initialValues:{password:"",target:""},onSubmit:(e,s)=>{let{setSubmitting:l}=s;p(),u(!0),m([]),t(void 0),i(void 0);let{password:a,target:o}=e;N.Z.put("/command/inquire-host",{password:a,target:o}).then(e=>{let{data:s}=e,{badSshKeys:l,isConnected:c}=s;if(l){p({children:(0,r.jsxs)(r.Fragment,{children:["Host identification at ",o," changed. If this is valid, please delete the conflicting SSH host key."]}),type:"warning"}),m([{background:"red",children:"Delete keys",onClick:()=>{n.confirm.prepare({actionProceedText:"Delete",content:(0,r.jsxs)(k.Ac,{children:["There's a different host key on ",o,", which could mean a MITM attack. But if this change is expected, you can delete the known host key(s) to resolve the conflict."]}),onProceedAppend:()=>{n.confirm.loading(!0),N.Z.delete("/ssh-key/conflict",{data:l}).then(e=>{n.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Started job to delete host key(s) for ",o,"."]})}),p(),m([]);let{data:t}=e;t&&i(t.jobs)}).catch(e=>{let t=(0,_.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to delete host key(s). ",t.children]}),n.confirm.finish("Error",t)})},proceedColour:"red",titleText:"Delete all known SSH host key(s) for ".concat(o,"?")}),n.confirm.open(!0)},type:"button"}]);return}if(!c){p({children:(0,r.jsx)(r.Fragment,{children:"Failed to connect. Please make sure the credentials are correct, and the host is reachable from this striker."}),type:"warning"});return}t({...s,hostPassword:a,target:o}),p()}).catch(e=>{let t=(0,_.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to access ",o,". ",t.children]}),p(t)}).finally(()=>{l(!1),u(!1)})},validationSchema:eZ}),Z=(0,a.useMemo)(()=>({target:"target",password:"password"}),[]),b=(0,a.useMemo)(()=>!!l&&o<100,[l,o]);return(0,r.jsxs)(ea.ZP,{component:"form",container:!0,columns:{xs:1,sm:2},onSubmit:e=>{e.preventDefault(),f.submitForm()},spacing:"1em",children:[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:Z.target,label:"IP address",name:Z.target,onChange:v,required:!0,value:f.values.target})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:Z.password,label:"Password",name:Z.password,onChange:v,required:!0,type:"password",value:f.values.password})})}),l&&(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eC,{jobs:l,progress:{total:o,setTotal:c}})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(B.Z,{count:1,messages:j,ref:s})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:d?(0,r.jsx)(F.Z,{mt:0}):(0,r.jsx)(eo.Z,{actions:[...h,{background:"blue",children:"Test access",disabled:x||b,type:"submit"}]})})]})},eI=e=>{let{onValidateHostsChange:t}=e,[n,s]=(0,a.useState)();return(0,r.jsx)(Y.Z,{formDialogProps:{common:{onClose:function(e){let{handlers:{base:t}}=e;for(var n=arguments.length,r=Array(n>1?n-1:0),l=1;l<n;l++)r[l-1]=arguments[l];null==t||t.call(null,...r),setTimeout(s,500)}}},addHeader:"Initialize host",editHeader:"",entriesUrl:"/host?type=dr&type=subnode",entryUrlPrefix:"/host",getDeleteErrorMessage:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return{...n,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete host(s). ",e]})}},getDeleteHeader:e=>"Delete the following ".concat(e," host(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted host(s)"})}),listEmpty:"No host(s) found.",listProps:{allowAddItem:!0,allowEdit:!1,allowItemButton:!0},onValidateEntriesChange:t,renderAddForm:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eS,{setResponse:s,tools:e}),n&&(0,r.jsx)(ey,{host:n,setResponse:s,tools:e})]}),renderDeleteItem:(e,t)=>{let{key:n}=t,s=null==e?void 0:e[n];return(0,r.jsx)(k.Ac,{children:null==s?void 0:s.shortHostName})},renderEditForm:(e,t)=>t&&(0,r.jsx)(ee.VZ,{children:(0,r.jsx)(D.Z,{entries:t,renderEntryValue:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];let{0:{entry:l,key:i}}=n;return"command"===i?(0,r.jsx)(ei.Z,{iconProps:{fontSize:"small"},mapPreset:"copy",onClick:()=>navigator.clipboard.writeText(String(l)),size:"small"}):e(...n)},hasPassword:!0})}),renderListItem:(e,t)=>(0,r.jsx)(el,{data:t})})},eA=n(18573),eF=()=>{let[e,t]=(0,a.useState)(!1);return(0,r.jsxs)(v.s_,{children:[(0,r.jsxs)(v.V9,{children:[(0,r.jsx)(k.z,{children:"Hosts"}),(0,r.jsx)(eA.Z,{syncing:e})]}),(0,r.jsx)(eI,{onValidateHostsChange:n=>{n!==e&&t(n)}})]})},eT=n(24811),eO=n(19166),eU=n(22143),eN=e=>{let{list:t,setValue:n,value:s}=e;return 0===t.length?(0,r.jsx)(k.Ac,{children:"No host(s) found."}):(0,r.jsx)(eU.Z,{centered:!0,onChange:(e,t)=>{n(t)},orientation:"vertical",value:s,children:t.map(e=>{let{hostConfigured:t,hostStatus:n,hostType:s,hostUUID:l,shortHostName:i}=e,a=s.replace("dr","DR").replace("node","Subnode");return(0,r.jsx)(eO.Z,{label:(0,r.jsxs)(ea.ZP,{container:!0,spacing:"1em",sx:{[".".concat(eT.Z.item,":not(:first-child)")]:{borderLeft:"thin solid ".concat(ex.d)}},children:[(0,r.jsx)(ea.ZP,{item:!0,xs:!0,children:(0,r.jsx)(k.Ac,{noWrap:!0,children:a})}),(0,r.jsx)(ea.ZP,{item:!0,xs:!0,children:(0,r.jsx)(k.$_,{noWrap:!0,children:i})}),(0,r.jsx)(ea.ZP,{item:!0,xs:!0,children:(0,r.jsxs)(k.Ac,{noWrap:!0,children:[n,t?", configured":""]})})]}),sx:{textAlign:"left"},value:l},"host-".concat(l))})})},eR=n(66859),eq=n(19306);let eE=ej.Ry({hostName:ej.Z_().required(),networkInit:eq.PC});var eD=e=>{let{values:t}=e;return(0,r.jsxs)(ea.ZP,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"Host name"})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{children:t.hostName})}),(0,r.jsx)(eq.e2,{...e})]})},e_=n(93666);let eH=e=>{let{dns:t="",gateway:n="",hostName:r="",networks:s}=e,l={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"},defaultsn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"sn"},defaultmn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"mn"}};return s&&(l=(0,e_.Z)(s)),{hostName:r,mini:!1,networkInit:{dns:t,gateway:n,networks:l}}};var eB=e=>{let{detail:t,tools:n,uuid:s}=e,l=(0,a.useRef)(null),i=(0,ew.Z)({initialValues:eH(t),onSubmit:(e,s)=>{let{setSubmitting:i}=s,a=(0,eR.Z)(e,l.current);n.confirm.prepare({actionProceedText:"Prepare network",content:l.current&&(0,r.jsx)(eD,{gatewayIface:a.gatewayInterface,ifaces:l.current,values:e}),onCancelAppend:()=>i(!1),onProceedAppend:()=>{n.confirm.loading(!0),N.Z.put("/host/".concat(t.hostUUID,"?handler=subnode-network"),a).then(()=>{n.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started network config on"," ",t.shortHostName]})})}).catch(e=>{let s=(0,_.Z)(e);s.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare network on ",t.shortHostName,"."," ",s.children]}),n.confirm.finish("Error",s),i(!1)})},titleText:"Prepare network on ".concat(t.shortHostName," with the following?")}),n.confirm.open()},validationSchema:eE}),{disabledSubmit:o,formik:c,formikErrors:d,handleChange:u}=i,h=(0,a.useMemo)(()=>t.hostType.replace("node","subnode"),[t.hostType]),{parentSequence:m,sequence:p}=(0,a.useMemo)(()=>{let[e,n]=t.shortHostName.replace(/^.*a(\d+).*(?:n|dr)(\d+)$/,"$1,$2").split(",",2);return{parentSequence:Number(e),sequence:Number(n)}},[t.shortHostName]),x=(0,a.useMemo)(()=>({hostName:"hostName",mini:"mini",networks:"networkInit.networks"}),[]);return(0,r.jsxs)(ea.ZP,{columns:{xs:1,sm:2,md:3,lg:4},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),c.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{id:x.hostName,label:"Host name",name:x.hostName,onChange:u,required:!0,value:c.values.hostName})})}),(0,r.jsx)(ea.ZP,{display:{xs:"none",md:"initial"},flexGrow:1,item:!0}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(b.Z,{id:x.mini,label:"Minimal config",name:x.mini,onChange:(e,t)=>{if(t){let{defaultbcn:e}=c.values.networkInit.networks;c.setFieldValue(x.networks,{defaultbcn:e},!0)}else c.resetForm();c.handleChange(e)},checked:c.values.mini})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eq.rQ,{formikUtils:i,host:{parentSequence:m,sequence:p,type:h,uuid:s},onFetchSuccess:e=>{l.current=e}})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(B.Z,{count:1,messages:d})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eo.Z,{actions:[{background:"blue",children:"Prepare network",disabled:o,type:"submit"}]})})]})},eV=n(40657),eL=e=>{let{uuid:t}=e,{confirmDialog:n,finishConfirm:s,setConfirmDialogLoading:l,setConfirmDialogOpen:i,setConfirmDialogProps:o}=(0,eV.Z)({initial:{scrollContent:!0,wide:!0}}),c=(0,a.useMemo)(()=>({add:{open:()=>null},confirm:{finish:s,loading:l,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return i(e)},prepare:o},edit:{open:()=>null}}),[s,l,i,o]),{data:d}=(0,z.Z)("/host/".concat(t));return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eB,{detail:d,tools:c,uuid:t}),n]}):(0,r.jsx)(F.Z,{mt:0})},ez=n(17428),e$=()=>{let[e,t]=(0,a.useState)(!1),{data:n}=(0,z.Z)("/host?type=dr&type=subnode"),s=(0,a.useMemo)(()=>n&&Object.values(n),[n]);return s?(0,r.jsxs)(v.s_,{children:[(0,r.jsx)(eN,{list:s,setValue:t,value:e}),e&&(0,r.jsx)(en.Z,{sx:{margin:"2em 0"}}),s.map(t=>(0,r.jsx)(ez.Z,{changingTabId:e,tabId:t.hostUUID,children:(0,r.jsx)(eL,{uuid:t.hostUUID})},"cell-".concat(t.hostUUID)))]}):(0,r.jsx)(v.s_,{children:(0,r.jsx)(F.Z,{})})},eW=n(28951),eG=n(91905);let eJ="an-host-input",eQ="".concat(eJ,"-cell"),eK="IPMI IP",eX={fence:(e,t)=>{let{dataset:{hostId:n="",fenceId:r="",fenceName:s=""},value:l}=t,{hostConfig:{hosts:{[n]:i}}}=e,{fences:a={}}=i;a[r]={fenceName:s,fencePort:l},i.fences=a},host:(e,t)=>{let{dataset:{hostId:n="",hostNumber:r="",hostType:s=""}}=t,l=Number.parseInt(r,10);e.hostConfig.hosts[n]={hostNumber:l,hostType:s}},ipmi:(e,t)=>{let{dataset:{hostId:n=""},value:r}=t,{hostConfig:{hosts:{[n]:s}}}=e;s.ipmiIp=r},network:(e,t)=>{let{dataset:{hostId:n="",networkId:r="",networkNumber:s="",networkType:l=""},value:i}=t,{hostConfig:{hosts:{[n]:a}}}=e,{networks:o={}}=a,c=Number.parseInt(s,10);o[r]={networkIp:i,networkNumber:c,networkType:l},a.networks=o},ups:(e,t)=>{let{checked:n,dataset:{hostId:r="",upsId:s="",upsName:l=""}}=t,{hostConfig:{hosts:{[r]:i}}}=e,{upses:a={}}=i;a[s]={isUsed:n,upsName:l},i.upses=a}},eY={xs:1,sm:2,md:3},e0=(e,t)=>"".concat(eJ,"-").concat(e,"-").concat(t,"-port"),e1=e=>"".concat(eJ,"-").concat(e,"-ipmi-ip"),e5=(e,t)=>"".concat(eJ,"-").concat(e,"-").concat(t,"-ip"),e2=(e,t)=>"".concat(eJ,"-").concat(e,"-").concat(t,"-power-host");var e8=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,buildInputUnmountFunction:s,setMessage:l},hostId:i,hostNumber:o,hostType:c,previous:{fences:d={},ipmiIp:u,networks:h={},upses:m={}}={},hostLabel:p="".concat(c.replace("node","subnode")," ").concat(o)}=e,x=(0,a.useMemo)(()=>Object.entries(d),[d]),Z=(0,a.useMemo)(()=>Object.entries(h),[h]),y=(0,a.useMemo)(()=>Object.entries(m),[m]),P=(0,a.useMemo)(()=>!!y.length,[y.length]),M=(0,a.useMemo)(()=>"".concat(eJ,"-").concat(i),[i]),C=(0,a.useMemo)(()=>e1(i),[i]),S=(0,a.useMemo)(()=>"".concat(eQ,"-").concat(i,"-ipmi-ip"),[i]),I=(0,a.useMemo)(()=>x.reduce((e,s)=>{let[a,{fenceName:o,fencePort:c}]=s,d="".concat(eQ,"-").concat(i,"-").concat(a,"-port"),u=e0(i,a),h="Plug on ".concat(o);return e[d]={children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"fence","data-host-id":i,"data-fence-id":a,"data-fence-name":o},id:u,label:h,value:c}),inputTestBatch:(0,w.Gn)("".concat(i," ").concat(h),()=>{l(u)},{onFinishBatch:t(u)},e=>{l(u,{children:e})}),onFirstRender:n(u)})},e},{}),[t,n,x,i,l]),A=(0,a.useMemo)(()=>Z.reduce((e,a)=>{let[o,{networkIp:c,networkNumber:d,networkType:u}]=a,h="".concat(eQ,"-").concat(i,"-").concat(o,"-ip"),m=e5(i,o),p="".concat(u.toUpperCase()," ").concat(d," IP");return e[h]={children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"network","data-host-id":i,"data-network-id":o,"data-network-number":d,"data-network-type":u},id:m,label:p,value:c}),inputTestBatch:(0,w._)("".concat(i," ").concat(p),()=>{l(m)},{onFinishBatch:t(m)},e=>{l(m,{children:e})}),onFirstRender:n(m),onUnmount:s(m),required:!0})},e},{}),[Z,i,t,n,s,l]),F=(0,a.useMemo)(()=>y.reduce((e,t)=>{let[n,{isUsed:s,upsName:l}]=t,a="".concat(eQ,"-").concat(i,"-").concat(n,"-power-host"),o=e2(i,n),c="Uses ".concat(l);return e[a]={children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(b.Z,{baseInputProps:{"data-handler":"ups","data-host-id":i,"data-ups-id":n,"data-ups-name":l},checked:s,id:o,label:c}),valueType:"boolean"})},e},{}),[i,y]),T=(0,a.useMemo)(()=>P&&(0,r.jsx)(eG.Z,{columns:eY,layout:F,spacing:"1em"}),[P,F]);return(0,r.jsxs)(v.Lg,{mv:0,children:[(0,r.jsx)(v.CH,{children:(0,r.jsx)(k.Ac,{children:p})}),(0,r.jsxs)(v.bc,{children:[(0,r.jsx)("input",{hidden:!0,id:M,readOnly:!0,"data-handler":"host","data-host-id":i,"data-host-number":o,"data-host-type":c}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(eG.Z,{columns:eY,layout:{"fence-message":{children:(0,r.jsx)(eP.Z,{children:"It is recommended to provide at least 1 fence device plug."}),width:"100%",xs:0},...A,[S]:{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"ipmi","data-host-id":i},id:C,label:eK,value:u}),inputTestBatch:(0,w._)("".concat(i," ").concat(eK),()=>{l(C)},{onFinishBatch:t(C)},e=>{l(C,{children:e})}),onFirstRender:n(C),onUnmount:s(C)})},...I},spacing:"1em"}),T]})]})]})};let e9="".concat("".concat("an-host-config-input","-group"),"-cell"),e3={node1:{hostNumber:1,hostType:"node"},node2:{hostNumber:2,hostType:"node"}},e7=e=>{let{anSeq:t,minIp:n,offset3:r=10,step3:s=2,subnetMask:l,subSeq:i}=e;try{let e=new eW.Netmask("".concat(n,"/").concat(l));if(16!==e.bitmask)return"".concat(e.base.replace(/\.0/g,""),".");return n.replace(/^((\d+\.){2})\d+\.\d+$/,"$1".concat((t-1)*s+r,".").concat(i))}catch(e){return""}};var e4=e=>{let{anSequence:t,formUtils:n,knownFences:s={},knownUpses:l={},networkListEntries:i,previous:{hosts:o=e3}={}}=e,c=(0,a.useMemo)(()=>Object.entries(o),[o]),d=(0,a.useMemo)(()=>Object.values(s),[s]),u=(0,a.useMemo)(()=>Object.values(l),[l]),h=(0,a.useMemo)(()=>c.reduce((e,s)=>{let[l,a]=s,{fences:o={},hostNumber:c,hostType:h,ipmiIp:m,networks:p={},upses:x={}}=a,f=m,j=d.reduce((e,t)=>{let{fenceName:n}=t,{[n]:{fencePort:r=""}={}}=o;return e[n]={fenceName:n,fencePort:r},e},{}),g=i.reduce((e,n)=>{let[r,{networkMinIp:s,networkNumber:l,networkSubnetMask:i,networkType:a}]=n,{[r]:{networkIp:o=""}={}}=p;return o||(o=e7({anSeq:t,minIp:s,subnetMask:i,subSeq:c})),f||"bcn"!==a||1!==l||(f=e7({anSeq:t,minIp:s,offset3:11,subnetMask:i,subSeq:c})),e[r]={networkIp:o,networkNumber:l,networkType:a},e},{}),v=u.reduce((e,t)=>{let{upsName:n}=t,{[n]:{isUsed:r=!0}={}}=x;return e[n]={isUsed:r,upsName:n},e},{});return e["".concat(e9,"-").concat(l)]={children:(0,r.jsx)(e8,{formUtils:n,hostId:l,hostNumber:c,hostType:h,previous:{fences:j,ipmiIp:f,networks:g,upses:v}}),md:3,sm:2},e},{}),[t,n,c,d,u,i]);return(0,r.jsx)(eG.Z,{columns:{xs:1,sm:2,md:3},layout:h,spacing:"1em"})},e6=n(23279),te=n.n(e6);let tt="an-id-input",tn="".concat(tt,"-domain"),tr="".concat(tt,"-prefix"),ts="".concat(tt,"-sequence"),tl="Domain name",ti="Prefix",ta="Sequence";var to=e=>{let{debounceWait:t=500,formUtils:{buildFinishInputTestBatchFunction:n,buildInputFirstRenderFunction:s,setMessage:l},onSequenceChange:i,previous:{domain:o,prefix:c,sequence:d}={}}=e,u=(0,a.useMemo)(()=>i&&te()(i,t),[t,i]);return(0,r.jsx)(eG.Z,{columns:{xs:1,sm:2,md:3},layout:{"an-id-input-cell-prefix":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tr,label:ti,value:c}),inputTestBatch:(0,w.Gn)(ti,()=>{l(tr)},{onFinishBatch:n(tr)},e=>{l(tr,{children:e})}),onFirstRender:s(tr),required:!0})},"an-id-input-cell-domain":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tn,label:tl,value:o}),inputTestBatch:(0,w.Gn)(tl,()=>{l(tn)},{onFinishBatch:n(tn)},e=>{l(tn,{children:e})}),onFirstRender:s(tn),required:!0})},"an-id-input-cell-sequence":{children:(0,r.jsx)(j.Z,{createInputOnChangeHandlerOptions:{postSet:u},input:(0,r.jsx)(g.Z,{id:ts,label:ta,value:d}),inputTestBatch:(0,w.qY)(ta,()=>{l(ts)},{onFinishBatch:n(ts)},e=>{l(ts,{children:e})}),onFirstRender:s(ts),required:!0,valueType:"number"})}},spacing:"1em"})},tc=n(25934),td=n(94047);let tu="an-network-input",th="".concat(tu,"-cell"),tm={gateway:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkGateway=r},minip:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkMinIp=r},network:(e,t)=>{let{dataset:{networkId:n="",networkNumber:r="",networkType:s=""}}=t,{networkConfig:{networks:l}}=e,i=Number.parseInt(r,10);l[n]={networkNumber:i,networkType:s}},subnetmask:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkSubnetMask=r}},tp=e=>"".concat(tu,"-").concat(e,"-gateway"),tx=e=>"".concat(tu,"-").concat(e,"-min-ip"),tf=e=>"".concat(tu,"-").concat(e,"-network-type"),tj=e=>"".concat(tu,"-").concat(e,"-subnet-mask");var tg=e=>{let{debounceWait:t=500,formUtils:{buildFinishInputTestBatchFunction:n,buildInputFirstRenderFunction:s,buildInputUnmountFunction:l,setMessage:i},inputGatewayLabel:o="Gateway",inputMinIpLabel:c="IP address",inputSubnetMaskLabel:d="Subnet mask",networkId:u,networkNumber:h,networkType:m,networkTypeOptions:p,onClose:x,onNetworkGatewayChange:f,onNetworkMinIpChange:b,onNetworkSubnetMaskChange:k,onNetworkTypeChange:y,previous:{gateway:P,minIp:M,subnetMask:C}={},readonlyNetworkName:S,showCloseButton:I,showGateway:A}=e,F=(0,a.useMemo)(()=>"".concat(td.Z[m]," ").concat(h),[h,m]),T=(0,a.useMemo)(()=>"".concat(th,"-").concat(u,"-gateway"),[u]),O=(0,a.useMemo)(()=>"".concat(th,"-").concat(u,"-ip"),[u]),U=(0,a.useMemo)(()=>"".concat(th,"-").concat(u,"-subnet-mask"),[u]),N=(0,a.useMemo)(()=>"".concat(tu,"-").concat(u),[u]),R=(0,a.useMemo)(()=>tp(u),[u]),q=(0,a.useMemo)(()=>tx(u),[u]),E=(0,a.useMemo)(()=>tf(u),[u]),D=(0,a.useMemo)(()=>tj(u),[u]),_=(0,a.useMemo)(()=>A?void 0:"none",[A]),H=(0,a.useMemo)(()=>f&&te()(f,t),[t,f]),B=(0,a.useMemo)(()=>b&&te()(b,t),[t,b]),V=(0,a.useMemo)(()=>k&&te()(k,t),[t,k]),L=(0,a.useMemo)(()=>I&&(0,r.jsx)(ei.Z,{mapPreset:"close",iconProps:{fontSize:"small"},onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==x||x.call(null,{networkId:u,networkType:m},...t)},sx:{padding:".2em",position:"absolute",right:"-.6rem",top:"-.2rem"}}),[I,u,m,x]),z=(0,a.useMemo)(()=>{let e;return A&&R&&(e=(0,r.jsx)(j.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==H?void 0:H.call(null,{networkId:u,networkType:m},...t)}},input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"gateway","data-network-id":u},id:R,label:o,value:P}),inputTestBatch:(0,w._)("".concat(F," ").concat(o),()=>{i(R)},{onFinishBatch:n(R)},e=>{i(R,{children:e})}),onFirstRender:s(R),onUnmount:l(R),required:A})),e},[A,R,u,o,P,F,n,s,l,H,m,i]);return(0,r.jsxs)(v.Lg,{mv:0,children:[(0,r.jsxs)(v.CH,{children:[(0,r.jsx)(j.Z,{input:(0,r.jsx)(Z.Z,{id:E,isReadOnly:S,onChange:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==y||y.call(null,{networkId:u,networkType:m},...t)},selectItems:p,selectProps:{renderValue:()=>F},value:m})}),L]}),(0,r.jsxs)(v.bc,{children:[(0,r.jsx)("input",{hidden:!0,id:N,readOnly:!0,"data-handler":"network","data-network-id":u,"data-network-number":h,"data-network-type":m}),(0,r.jsx)(eG.Z,{columns:{xs:1,sm:2,md:3},layout:{[O]:{children:(0,r.jsx)(j.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==B?void 0:B.call(null,{networkId:u,networkType:m},...t)}},input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"minip","data-network-id":u},id:q,label:c,value:M}),inputTestBatch:(0,w._)("".concat(F," ").concat(c),()=>{i(q)},{onFinishBatch:n(q)},e=>{i(q,{children:e})}),onFirstRender:s(q),onUnmount:l(q),required:!0})},[U]:{children:(0,r.jsx)(j.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==V?void 0:V.call(null,{networkId:u,networkType:m},...t)}},input:(0,r.jsx)(g.Z,{baseInputProps:{"data-handler":"subnetmask","data-network-id":u},id:D,label:d,value:C}),inputTestBatch:(0,w._)("".concat(F," ").concat(d),()=>{i(D)},{onFinishBatch:n(D)},e=>{i(D,{children:e})}),onFirstRender:s(D),onUnmount:l(D),required:!0})},[T]:{children:z,display:_}},spacing:"1em"})]})]})},tv=n(95996);let tZ="an-network-config-input",tb="".concat(tZ,"-cell"),tw="".concat(tZ,"-dns"),tk="".concat(tZ,"-ntp"),ty=Object.entries(td.Z),tP={bcn:{base:"10.201.0.0",mask:"255.255.0.0"},mn:{base:"10.199.0.0",mask:"255.255.0.0"},sn:{base:"10.101.0.0",mask:"255.255.0.0"}},tM=e=>"ifn"===e,tC=e=>"mn"===e,tS=e=>{let{entries:t,type:n}=e,r=t.filter(e=>{let[,{networkType:t}]=e;return t===n}).sort((e,t)=>{let[,{networkNumber:n}]=e,[,{networkNumber:r}]=t;return n>r?1:-1}).pop();if(!r){var s;return null!==(s=tP[n])&&void 0!==s?s:{}}let[,{networkMinIp:l,networkSubnetMask:i}]=r;try{let{base:e,mask:t}=new eW.Netmask("".concat(l,"/").concat(i)).next();return{base:e,mask:t}}catch(e){return{}}};var tI=e=>{let{formUtils:t,networkListEntries:n,previous:{dnsCsv:s="8.8.8.8,8.8.4.4",ntpCsv:l}={},setNetworkList:i}=e,{buildFinishInputTestBatchFunction:o,buildInputFirstRenderFunction:c,setMessage:d,setMessageRe:u,setValidity:h}=t,m=(0,a.useCallback)(function(e){let{input:t=n,end:r=n.length}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r-1,l=0;return t.every((t,n)=>{let[,{networkType:r}]=t;return r===e&&(l+=1),n<s}),l},[n]),p=(0,a.useMemo)(()=>ty.map(e=>{let[t,n]=e;return{displayValue:n,value:t}}),[]),x=(0,a.useCallback)(function(){let{networkMinIp:e="",networkSubnetMask:t="",networkType:r=n.some(e=>{let[,{networkType:t}]=e;return tC(t)})?"ifn":"mn",networkGateway:s=tM(r)?"":void 0,networkNumber:l=m(r)+1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{base:i=e,mask:a=t}=tS({entries:n,type:r});return{network:{networkGateway:s,networkMinIp:i,networkNumber:l,networkSubnetMask:a,networkType:r},networkId:(0,tc.Z)()}},[m,n]),f=(0,a.useCallback)((e,t)=>i((0,tv.ZP)(e,t)),[i]),v=(0,a.useCallback)((e,t,n)=>i(r=>{let s={...r},{[e]:l}=s;return l&&(l[t]=n),s}),[i]),Z=(0,a.useCallback)((e,t)=>{let{networkId:r,networkType:s}=e,{target:{value:l}}=t,a=String(l),o=!1,c=0;i(n.reduce((e,t)=>{let[l,i]=t,{networkNumber:d,networkType:h,networkMinIp:m,networkSubnetMask:p,...x}=i,f=d,j=h;l===r&&(o=!0,j=a,u(RegExp(l)));let g=j===a;if(g&&(c+=1),o){g?f=c:j===s&&(f-=1);let{base:t=m,mask:r=p}=tS({entries:n,type:j});e[l]={...x,networkMinIp:t,networkSubnetMask:r,networkNumber:f,networkType:j}}else e[l]=i;return e},{}))},[n,u,i]),b=(0,a.useCallback)(e=>{let{networkId:t,networkType:r}=e,s=!1,l=0;i(n.reduce((e,n)=>{let[i,a]=n;if(i===t)return s=!0,e;let{networkType:o}=a,c=o===r;return c&&(l+=1),e[i]=s&&c?{...a,networkNumber:l}:a,e},{}))},[n,i]),k=(0,a.useMemo)(()=>n.reduce((e,n)=>{let[s,{networkGateway:l,networkMinIp:i,networkNumber:a,networkSubnetMask:o,networkType:c}]=n,d="".concat(tb,"-").concat(s),u=1===a,h=tM(c),m=tC(c)||!u;return e[d]={children:(0,r.jsx)(tg,{formUtils:t,networkId:s,networkNumber:a,networkType:c,networkTypeOptions:p,onClose:b,onNetworkMinIpChange:(e,t)=>{let{networkId:n}=e,{target:{value:r}}=t;return v(n,"networkMinIp",r)},onNetworkSubnetMaskChange:(e,t)=>{let{networkId:n}=e,{target:{value:r}}=t;return v(n,"networkSubnetMask",r)},onNetworkTypeChange:Z,previous:{gateway:l,minIp:i,subnetMask:o},readonlyNetworkName:!m,showCloseButton:m,showGateway:h}),md:3,sm:2},e},{}),[n,t,p,b,Z,v]);return(0,r.jsx)(eG.Z,{columns:{xs:1,sm:2,md:3},layout:{...k,"an-network-config-cell-add-network":{children:(0,r.jsx)(ei.Z,{mapPreset:"add",onClick:()=>{let{network:e,networkId:t}=x();f(t,e)}}),display:"flex",justifyContent:"center",md:3,sm:2},"an-network-config-input-cell-dns":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tw,label:"DNS",value:s}),inputTestBatch:(0,w.dg)("DNS",()=>{d(tw)},{onFinishBatch:o(tw)},e=>{d(tw,{children:e})}),onFirstRender:c(tw),required:!0})},"an-network-config-input-cell-ntp":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tk,label:"NTP",value:l}),onFirstRender:()=>{h(tk,!0)}})}},spacing:"1em"})};let tA={bcn1:{networkMinIp:"10.201.0.0",networkNumber:1,networkSubnetMask:"255.255.0.0",networkType:"bcn"},sn1:{networkMinIp:"10.101.0.0",networkNumber:1,networkSubnetMask:"255.255.0.0",networkType:"sn"},ifn1:{networkMinIp:"",networkNumber:1,networkSubnetMask:"",networkType:"ifn"}};var tF=e=>{var t;let{formUtils:n,knownFences:s,knownUpses:l,previous:{hostConfig:i,networkConfig:o={},...c}={}}=e,{networks:d=tA}=o,[u,h]=(0,a.useState)(null!==(t=null==c?void 0:c.sequence)&&void 0!==t?t:0),[m,p]=(0,a.useState)(d),x=(0,a.useMemo)(()=>Object.entries(m),[m]);return(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(to,{formUtils:n,onSequenceChange:e=>{let{target:{value:t}}=e;h(Number(t))},previous:c}),(0,r.jsx)(tI,{formUtils:n,networkListEntries:x,previous:o,setNetworkList:p}),(0,r.jsx)(e4,{anSequence:u,formUtils:n,knownFences:s,knownUpses:l,networkListEntries:x,previous:i})]})},tT=e=>{let{formUtils:t,knownFences:n,knownUpses:s,previous:l}=e;return(0,r.jsx)(tF,{formUtils:t,knownFences:n,knownUpses:s,previous:l})},tO=n(50361),tU=n.n(tO),tN=n(47856),tR=n(74178);let tq=ej.Ry({name:ej.Z_().required(),uuid:(0,eg.uI)().required()}),tE=ej.Ry({anvil:ej.Vo(e=>void 0!==e?tq:ej.nK().optional()),number:ej.Rx(),type:ej.Z_(),uuid:(0,eg.uI)().required()}),tD=ej.Z_().when(["rerun"],(e,t)=>e[0]?t.optional():t.required()),t_=ej.Ry({confirmPassword:tD.oneOf([ej.iH("password")]),description:tD,hosts:ej.Vo(e=>ej.Ry((0,tR.Z)(e,tE))),password:tD,rerun:ej.O7().required(),reuseHosts:ej.O7().when(["hosts"],(e,t)=>{let n=e[0];return n&&Object.values(n).some(e=>!!e.anvil)?t.isTrue():t.isFalse()})});var tH=e=>{let{detail:t,knownFences:n,knownHosts:s,knownUpses:l,onSubmitSuccess:i,tools:o}=e,{anvil:c,domain:d,hostConfig:u,networkConfig:h}=t,{hosts:m}=u,{dnsCsv:p,networks:j,ntpCsv:v}=h,b=(0,a.useMemo)(()=>Object.entries(m),[m]),w=(0,a.useMemo)(()=>Object.entries(j),[j]),y=(0,a.useMemo)(()=>Object.entries(n),[n]),P=(0,a.useMemo)(()=>Object.entries(s),[s]),M=(0,a.useMemo)(()=>Object.entries(l),[l]),C=(0,a.useMemo)(()=>P.map(e=>{let[,{anvil:t,hostName:n,hostUUID:s}]=e;return{displayValue:(0,r.jsxs)(f.Z,{spacing:0,children:[(0,r.jsx)(k.Ac,{inverted:!0,children:n}),(0,r.jsx)(k.KI,{inverted:!0,children:t?"Used by ".concat(t.name):"Ready"})]}),value:s}}),[P]),{disabledSubmit:S,formik:I,formikErrors:A,handleChange:F}=(0,ew.Z)({initialValues:{confirmPassword:"",description:"",hosts:b.reduce((e,t)=>{let n;let[r,{hostName:l,hostNumber:i,hostType:a}]=t,o="";if(c){let{hosts:{[i]:{uuid:e}}}=c;o=e;let t=s[e];t&&(n=t.anvil)}else if(l){let e=P.find(e=>{let[,{shortHostName:t}]=e;return t===l});if(e){let[,t]=e;n=t.anvil,o=t.hostUUID}}return e[r]={anvil:n,number:i,type:a,uuid:o},e},{}),password:"",rerun:!!c,reuseHosts:!1},onSubmit:(e,n)=>{let{setSubmitting:l}=n,{confirmPassword:a,rerun:c,reuseHosts:u,hosts:h,...p}=e,x={...c?null:p,hosts:Object.values(h).reduce((e,t)=>{let{number:n,type:r,uuid:l}=t,i="".concat(r).concat(n);return e["".concat(r.replace("node","Subnode")," ").concat(n)]={useHost:s[l].hostName,renameTo:"".concat(m[i].hostName,".").concat(d)},e},{})};o.confirm.prepare({actionProceedText:"Run",content:(0,r.jsx)(D.Z,{entries:x,hasPassword:!0}),onCancelAppend:()=>l(!1),onProceedAppend:()=>{o.confirm.loading(!0),N.Z.put("/command/run-manifest/".concat(t.uuid),e).then(()=>{o.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started installing ",t.name]})}),null==i||i.call(null),o.edit.open(!1)}).catch(e=>{let t=(0,_.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to run install manifest. ",t.children]}),o.confirm.finish("Error",t),l(!1)})},titleText:"Run install manifest ".concat(t.name," with the following?")}),o.confirm.open()},validationSchema:t_}),T=(0,a.useMemo)(()=>"confirmPassword",[]),O=(0,a.useMemo)(()=>"description",[]),U=(0,a.useMemo)(()=>"hosts",[]),R=(0,a.useMemo)(()=>"password",[]),q=(0,a.useMemo)(()=>"reuseHosts",[]),E=(0,a.useMemo)(()=>b.reduce((e,t)=>{let[n,{hostNumber:l,hostType:i}]=t,a="".concat(U,".").concat(n),o="".concat(a,".uuid"),c="".concat(i.replace("node","Subnode")," ").concat(l);return e.push((0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(Z.Z,{id:o,label:c,name:o,onChange:e=>{let{target:{value:t}}=e,{[t]:{anvil:r}}=s,a=tU()(I.values.hosts),o=Object.entries(a).find(e=>{let[r,{uuid:s}]=e;return r!==n&&s===t});if(o){let[e,t]=o,{number:r,type:s}=t;a[e]={...a[n],number:r,type:s}}return a[n]={anvil:r,number:l,type:i,uuid:t},I.setFieldValue(U,a)},required:!0,selectItems:C,selectProps:{renderValue:e=>{let{[e]:{hostName:t}}=s;return t}},value:I.values.hosts[n].uuid})},"".concat(n,"-selector"))),e},[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"Use host"})},"host-selector-header")]),[I,b,C,U,s]),H=(0,a.useMemo)(()=>b.reduce((e,t)=>{let[n,{hostName:s}]=t;return e.push((0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsxs)(k.$_,{noWrap:!0,children:[s,".",d]})},"".concat(n,"-rename"))),e},[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"New hostname"})},"host-rename-header")]),[b,d]),V=(0,a.useMemo)(()=>w.reduce((e,t)=>{let[n,s]=t,{networkNumber:l,networkType:i}=s,a="".concat(i.toLocaleUpperCase()).concat(l),o=b.map(e=>{let[t,{networks:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{children:e})},"".concat(n,"-").concat(t,"-ip"))};if(!s)return l();let{[n]:i}=s;if(!i)return l();let{networkIp:a}=i;return l(a)});return e.push((0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:a})},"".concat(n,"-header")),...o),e},[]),[b,w]),L=(0,a.useMemo)(()=>y.reduce((e,t)=>{let[n,s]=t,{fenceName:l}=s,i=b.map(e=>{let[t,{fences:s}]=e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{children:e})},"".concat(n,"-").concat(t,"-port"))};if(!s)return i();let{[l]:a}=s;if(!a)return i();let{fencePort:o}=a;return i(o)});return e.push((0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsxs)(k.Ac,{children:["Plug on ",l]})},"".concat(n,"-header")),...i),e},[]),[b,y]),z=(0,a.useMemo)(()=>M.reduce((e,t)=>{let[n,s]=t,{upsName:l}=s,i=b.map(e=>{let[t,{upses:s}]=e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{children:e})},"".concat(n,"-").concat(t,"-used"))};if(!s)return i();let{[l]:a}=s;if(!a)return i();let{isUsed:o}=a;return i(o?"yes":"no")});return e.push((0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsxs)(k.Ac,{children:["Uses ",l]})},"".concat(n,"-header")),...i),e},[]),[b,M]),$=(0,a.useMemo)(()=>{let e;let t=w.find(e=>{let{1:{networkGateway:t}}=e;return!!t}),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{justifyContent:"end",children:e})},"gateway-value")};if(t){let[,{networkGateway:r}]=t;e=r&&r.length>0?n(r):n()}else e=n();return[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"Gateway"})},"gateway-header"),e]},[w]),W=(0,a.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{justifyContent:"end",children:e})},"dns-value")},t=p&&p.length>0?e(p):e();return[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"DNS"})},"dns-header"),t]},[p]),G=(0,a.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.$_,{justifyContent:"end",children:e})},"ntp-value")},t=v&&v.length>0?e(v):e();return[(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Ac,{children:"NTP"})},"ntp-header"),t]},[v]),J=(0,a.useMemo)(()=>{let e=Object.values(I.values.hosts).filter(e=>!!e.anvil);if(0===e.length)return null;let t=e.slice(1).reduce((e,t)=>"".concat(e,", ").concat(s[t.uuid].shortHostName),s[e[0].uuid].shortHostName);return(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(eP.Z,{children:[(0,r.jsx)(tN.Z,{id:q,invert:!0,name:q,onChange:I.handleChange,required:!0,sx:{marginRight:".5em"},thinPadding:!0,value:I.values.reuseHosts}),"Confirm reusing host(s): ",t,"."]})})},[I,s,q]);return(0,r.jsxs)(ea.ZP,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),I.submitForm()},spacing:"1em",children:[c?(0,r.jsxs)(ea.ZP,{item:!0,width:"100%",children:[(0,r.jsx)(k.Ac,{children:"Description"}),(0,r.jsx)(k.Ac,{children:c.description})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{id:O,label:"Description",name:O,onChange:F,required:!0,value:I.values.description})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:R,label:"Password",name:R,onChange:F,required:!0,type:x.Z.password,value:I.values.password})})}),(0,r.jsx)(ea.ZP,{item:!0,xs:1,children:(0,r.jsx)(eb.Z,{input:(0,r.jsx)(g.Z,{disableAutofill:!0,id:T,label:"Confirm password",name:T,onChange:F,required:!0,type:x.Z.password,value:I.values.confirmPassword})})})]}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(ea.ZP,{alignItems:"center",columns:b.length+1,columnSpacing:"1em",container:!0,rowSpacing:".6em",children:[...E,...H,...V,...L,...z]})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(ea.ZP,{columns:2,container:!0,spacing:".6em",children:[...$,...W,...G]})}),J,(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(B.Z,{count:1,messages:A})}),(0,r.jsx)(ea.ZP,{item:!0,width:"100%",children:(0,r.jsx)(eo.Z,{actions:[{background:"blue",children:"Run",disabled:S,type:"submit"}]})})]})};let tB=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[{target:r}]=t,{elements:s}=r,{value:l}=s.namedItem(tn),{value:i}=s.namedItem(tr),{value:a}=s.namedItem(ts),{value:o}=s.namedItem(tw),{value:c}=s.namedItem(tk),d=Number.parseInt(a,10);return Object.values(s).reduce((e,t)=>{var n,r;let{id:s}=t;if(RegExp("^".concat(eJ)).test(s)){let{dataset:{handler:r=""}}=t;null===(n=eX[r])||void 0===n||n.call(null,e,t)}else if(RegExp("^".concat(tu)).test(s)){let{dataset:{handler:n=""}}=t;null===(r=tm[n])||void 0===r||r.call(null,e,t)}return e},{domain:l,hostConfig:{hosts:{}},networkConfig:{dnsCsv:o,networks:{},ntpCsv:c},prefix:i,sequence:d})};var tV=()=>{let e=(0,a.useRef)({}),t=(0,a.useRef)({}),n=(0,a.useRef)({}),s=(0,a.useRef)(null),l=(0,a.useRef)({}),[i,o]=(0,L.Z)(),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(!0),[m,p]=(0,a.useState)(),{data:x,loading:j,mutate:g}=(0,z.Z)("/manifest",{refreshInterval:1e4}),{data:Z,loading:b,mutate:w}=(0,z.Z)("/manifest/template"),{data:y,loading:P,mutate:M}=(0,z.Z)("/host?type=subnode"),C=(0,$.Z)([tn,tr,ts,tw,tk],l),{isFormInvalid:S,isFormSubmitting:I,submitForm:A}=C,{buildDeleteDialogProps:T,checks:O,getCheck:U,hasChecks:q,resetChecks:W,setCheck:G}=(0,V.Z)({list:x}),{name:J,uuid:Q}=(0,a.useMemo)(()=>null!=m?m:{},[m]),{domain:K,fences:X,prefix:Y,sequence:et,upses:en}=(0,a.useMemo)(()=>null!=Z?Z:{},[Z]),er=(0,a.useCallback)(e=>{let{hostConfig:{hosts:t}}=e,n=Object.values(t).reduce((e,t)=>{let{fences:n,hostType:r,hostNumber:s}=t,l="".concat(r.replace(/node/,"subnode")).concat(s);return n?e[l]=Object.values(n).reduce((e,t)=>{let{fencePort:n}=t;return e+(n.length?1:0)},0):e[l]=0,e},{}),s=Object.entries(n).map(e=>{let[t,n]=e;return n?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(eP.Z,{children:["No fence device port specified for ",t,"."]},"".concat(t,"-no-fence-port-message"))});return{counts:n,messages:s}},[]),es=(0,a.useMemo)(()=>({actionProceedText:"Add",content:(0,r.jsx)(tF,{formUtils:C,knownFences:X,knownUpses:en,previous:{domain:K,prefix:Y,sequence:et}}),onSubmitAppend:function(){for(var t,n=arguments.length,s=Array(n),l=0;l<n;l++)s[l]=arguments[l];let i=tB(...s),{messages:a}=er(i);o({actionProceedText:"Add",content:(0,r.jsx)(D.Z,{entries:i,maxDepth:6}),onProceedAppend:()=>{A({body:i,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add install manifest. ",e]}),method:"post",onSuccess:()=>g(),successMsg:"Successfully added install manifest",url:"/manifest"})},preActionArea:(0,r.jsx)(f.Z,{spacing:".3em",children:a}),titleText:"Add install manifest?"}),null===(t=e.current.setOpen)||void 0===t||t.call(null,!0)},titleText:"Add an install manifest"}),[er,C,g,X,en,K,Y,et,o,A]),el=(0,a.useMemo)(()=>({actionProceedText:"Update",content:(0,r.jsx)(tT,{formUtils:C,knownFences:X,knownUpses:en,previous:m}),onSubmitAppend:function(){for(var t,n=arguments.length,s=Array(n),l=0;l<n;l++)s[l]=arguments[l];let i=tB(...s),{messages:a}=er(i);o({actionProceedText:"Update",content:(0,r.jsx)(D.Z,{entries:i,maxDepth:6}),onProceedAppend:()=>{A({body:i,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update install manifest. ",e]}),method:"put",onSuccess:()=>g(),successMsg:"Successfully updated install manifest ".concat(J),url:"/manifest/".concat(Q)})},preActionArea:(0,r.jsx)(f.Z,{spacing:".3em",children:a}),titleText:"Update install manifest ".concat(J,"?")}),null===(t=e.current.setOpen)||void 0===t||t.call(null,!0)},loading:u,titleText:"Update install manifest ".concat(J)}),[er,C,g,u,X,en,m,J,Q,o,A]),ea=(0,a.useCallback)((e,t)=>{h(!0),N.Z.get("manifest/".concat(e)).then(t=>{let{data:n}=t;n.uuid=e,p(n)}).catch(e=>{(0,_.Z)(e)}).finally(()=>{h(!1),null==t||t.call(null)})},[h,p]),eo=(0,a.useMemo)(()=>(0,r.jsx)(H.Z,{allowEdit:!0,allowItemButton:c,disableDelete:!q,edit:c,header:!0,listEmpty:"No manifest(s) registered.",listItems:x,onAdd:()=>{var e;null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var t;o(T({onProceedAppend:()=>{A({body:{uuids:O},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Delete manifest(s) failed. ",e]}),method:"delete",onSuccess:()=>{g(),W()},url:"/manifest"})},getConfirmDialogTitle:e=>"Delete ".concat(e," manifest(s)?"),renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(k.Ac,{children:null==x?void 0:x[t].manifestName})}})),null===(t=e.current.setOpen)||void 0===t||t.call(null,!0)},onEdit:()=>{d(e=>!e)},onItemCheckboxChange:(e,t,n)=>{G(e,n)},onItemClick:e=>{var t;let{manifestName:r,manifestUUID:s}=e;p({name:r,uuid:s}),null===(t=n.current.setOpen)||void 0===t||t.call(null,!0),ea(s)},renderListItemCheckboxState:e=>U(e),renderListItem:(e,t)=>{let{manifestName:n}=t;return(0,r.jsxs)(f.Z,{fullWidth:!0,row:!0,children:[(0,r.jsx)(ei.Z,{disabled:c,mapPreset:"play",onClick:()=>{var t;null===(t=s.current)||void 0===t||t.setOpen(!0),ea(e)},variant:"normal"}),(0,r.jsx)(k.Ac,{children:n})]})}}),[T,O,U,ea,g,q,c,x,W,G,o,p,A]),ec=(0,a.useMemo)(()=>P||b||j?(0,r.jsx)(F.Z,{}):eo,[P,j,b,eo]),ed=(0,a.useMemo)(()=>(0,r.jsx)(B.Z,{count:1,defaultMessageType:"warning",ref:l}),[]),{confirmDialog:eu,finishConfirm:eh,setConfirmDialogLoading:em,setConfirmDialogOpen:ep,setConfirmDialogProps:ex}=(0,eV.Z)({initial:{scrollContent:!0,wide:!0}}),ef=(0,a.useMemo)(()=>({add:{open:()=>null},confirm:{finish:eh,loading:em,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return ep(e)},prepare:ex},edit:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==s?void 0:null===(e=s.current)||void 0===e?void 0:e.setOpen(t)}}}),[eh,em,ep,ex]),ej=(0,a.useMemo)(()=>b||u||P,[P,u,b]),eg=(0,a.useMemo)(()=>m&&X&&y&&en&&(0,r.jsx)(tH,{detail:m,knownFences:X,knownHosts:y,knownUpses:en,onSubmitSuccess:()=>{w(),M()},tools:ef}),[ef,M,w,y,X,en,m]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(v.s_,{children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(k.z,{children:"Manage manifests"})}),ec]}),(0,r.jsx)(E.Z,{...es,disableProceed:S,loadingAction:I,preActionArea:ed,ref:t,scrollContent:!0,showClose:!0}),(0,r.jsx)(E.Z,{...el,disableProceed:S,loadingAction:I,preActionArea:ed,ref:n,scrollContent:!0,showClose:!0}),(0,r.jsx)(ee.Js,{header:"".concat((null==m?void 0:m.anvil)?"Rerun":"Run"," install manifest ").concat(null==m?void 0:m.name),loading:ej,ref:s,showClose:!0,wide:!0,children:eg}),(0,r.jsx)(R.Z,{closeOnProceed:!0,...i,ref:e,scrollContent:!0,wide:!0}),eu]})};let tL="common-ups-input-ip-address",tz="common-ups-input-host-name",t$="IP address",tW="Host name";var tG=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,setMessage:s},previous:{upsIPAddress:l,upsName:i}={}}=e;return(0,r.jsx)(eG.Z,{columns:{xs:1,sm:2},layout:{"common-ups-input-cell-host-name":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tz,label:tW,value:i}),inputTestBatch:(0,w.Gn)(tW,()=>{s(tz)},{onFinishBatch:t(tz)},e=>{s(tz,{children:e})}),onFirstRender:n(tz),required:!0})},"common-ups-input-cell-ip-address":{children:(0,r.jsx)(j.Z,{input:(0,r.jsx)(g.Z,{id:tL,label:t$,value:l}),inputTestBatch:(0,w._)(t$,()=>{s(tL)},{onFinishBatch:t(tL)},e=>{s(tL,{children:e})}),onFirstRender:n(tL),required:!0})}},spacing:"1em"})},tJ=n(65716);let tQ="add-ups-select-ups-type-id";var tK=e=>{let{formUtils:t,loading:n,previous:s={},upsTemplate:l}=e,{buildInputFirstRenderFunction:i,setValidity:o}=t,{upsTypeId:c=""}=s,d=(0,T.Z)(),[u,h]=(0,a.useState)(c),m=(0,a.useMemo)(()=>l?Object.entries(l).map(e=>{let t,[n,{brand:s,description:l,links:{0:i}}]=e;if(i){let{linkHref:e,linkLabel:n}=i;t=(0,r.jsx)(tJ.Z,{href:e,onClick:e=>{e.stopPropagation()},sx:{display:"inline-flex",color:ex.E5},target:"_blank",children:n})}return{displayValue:(0,r.jsxs)(f.Z,{spacing:0,children:[(0,r.jsx)(k.Ac,{inverted:!0,children:s}),(0,r.jsxs)(k.Ac,{inverted:!0,children:[l," (",t,")"]})]}),value:n}}):[],[l]),p=(0,a.useMemo)(()=>l&&(0,r.jsx)(Z.Z,{formControlProps:{sx:{marginTop:".3em"}},id:tQ,label:"UPS type",onChange:e=>{let{target:{value:t}}=e,n=String(t);o(tQ,!0),h(n)},required:!0,selectItems:m,selectProps:{onClearIndicatorClick:()=>{o(tQ,!1),h("")},renderValue:e=>{let{brand:t}=l[String(e)];return t}},value:u}),[l,m,u,o]),x=(0,a.useMemo)(()=>n?(0,r.jsx)(F.Z,{}):(0,r.jsxs)(f.Z,{children:[p,u&&(0,r.jsx)(tG,{formUtils:t,previous:s})]}),[t,u,n,p,s]);return(0,a.useEffect)(()=>{d&&i(tQ)({isValid:!!u})},[i,u,d]),x};let tX="edit-ups-input-ups-uuid";var tY=e=>{let{formUtils:t,loading:n,previous:s,upsTemplate:l,upsUUID:i}=e;return(0,a.useMemo)(()=>n?(0,r.jsx)(F.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tK,{formUtils:t,previous:s,upsTemplate:l}),(0,r.jsx)("input",{hidden:!0,id:tX,readOnly:!0,value:i})]}),[t,n,s,l,i])};let t0=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[{target:s}]=n,{elements:l}=s,{value:i}=l.namedItem(tz),{value:a}=l.namedItem(tL),o=l.namedItem(tQ),c="",d="",u="";o&&({value:u}=o,{agent:c,brand:d}=e[u]);let h=l.namedItem(tX),m="";return h&&({value:m}=h),{agent:c,brand:d,ipAddress:a,name:i,typeId:u,uuid:m}},t1=e=>{let{brand:t,ipAddress:n,name:s,uuid:l}=e;return(0,r.jsx)(H.Z,{listItems:{"ups-brand":{label:"Brand",value:t},"ups-name":{label:"Host name",value:s},"ups-ip-address":{label:"IP address",value:n}},listItemProps:{sx:{padding:0}},renderListItem:(e,t)=>{let{label:n,value:s}=t;return(0,r.jsxs)(f.Z,{fullWidth:!0,growFirst:!0,row:!0,children:[(0,r.jsx)(k.Ac,{children:n}),(0,r.jsx)(k.$_,{children:s})]},"confirm-ups-".concat(l,"-").concat(e))}})};var t5=()=>{let e=(0,T.Z)(),t=(0,a.useRef)({}),n=(0,a.useRef)({}),s=(0,a.useRef)({}),[l,i]=(0,L.Z)(),[o,c]=(0,L.Z)(),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!0),[p,x]=(0,a.useState)(),{data:j,loading:g}=(0,z.Z)("/ups",{refreshInterval:6e4}),Z=(0,$.Z)([tL,tz,tQ],s),{isFormInvalid:b,isFormSubmitting:w,submitForm:y}=Z,{buildDeleteDialogProps:P,checks:M,getCheck:C,hasChecks:S,setCheck:I}=(0,V.Z)({list:j}),A=(0,a.useCallback)(e=>{var n,s;let{upsAgent:l,upsIPAddress:a,upsName:o,upsUUID:c}=e,d=null!==(s=null===(n=Object.entries(null!=p?p:{}).find(e=>{let[,{agent:t}]=e;return l===t}))||void 0===n?void 0:n[0])&&void 0!==s?s:"";return{actionProceedText:"Update",content:(0,r.jsx)(tY,{formUtils:Z,previous:{upsIPAddress:a,upsName:o,upsTypeId:d},upsTemplate:p,upsUUID:c}),onSubmitAppend:e=>{var n;if(!p)return;let s=t0(p,e),{name:l}=s;i({actionProceedText:"Update",content:t1(s),onProceedAppend:()=>{y({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update UPS. ",e]}),method:"put",successMsg:"Successfully updated UPS ".concat(o),url:"/ups/".concat(c)})},titleText:(0,r.jsxs)(k.z,{children:["Update"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:l})," ","with the following data?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:(0,r.jsxs)(k.z,{children:["Update UPS"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:o})]})}},[Z,i,y,p]),O=(0,a.useMemo)(()=>({actionProceedText:"Add",content:(0,r.jsx)(tK,{formUtils:Z,upsTemplate:p}),onSubmitAppend:e=>{var n;if(!p)return;let s=t0(p,e),{brand:l,name:a}=s;i({actionProceedText:"Add",content:t1(s),onProceedAppend:()=>{y({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add UPS. ",e]}),method:"post",successMsg:"Successfully added UPS ".concat(a),url:"/ups"})},titleText:(0,r.jsxs)(k.z,{children:["Add a"," ",(0,r.jsx)(k.Q0,{fontSize:"inherit",children:l})," UPS with the following data?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:"Add a UPS"}),[Z,i,y,p]),U=(0,a.useMemo)(()=>(0,r.jsx)(H.Z,{allowEdit:!0,allowItemButton:d,disableDelete:!S,edit:d,header:!0,listEmpty:"No Ups(es) registered.",listItems:j,onAdd:()=>{var e;c(O),null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var e;i(P({getConfirmDialogTitle:e=>"Delete ".concat(e," UPSes?"),onProceedAppend:()=>{y({body:{uuids:M},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to delete UPS(es). ",e]}),method:"delete",url:"/ups"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(k.Ac,{children:null==j?void 0:j[t].upsName})}})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>{u(e=>!e)},onItemCheckboxChange:(e,t,n)=>{I(e,n)},onItemClick:e=>{var t;c(A(e)),null===(t=n.current.setOpen)||void 0===t||t.call(null,!0)},renderListItemCheckboxState:e=>C(e),renderListItem:(e,t)=>{let{upsAgent:n,upsIPAddress:s,upsName:l}=t;return(0,r.jsxs)(f.Z,{fullWidth:!0,row:!0,children:[(0,r.jsx)(k.Ac,{children:l}),(0,r.jsxs)(k.Ac,{children:['agent="',n,'"']}),(0,r.jsxs)(k.Ac,{children:['ip="',s,'"']})]})}}),[O,P,A,M,C,S,d,I,i,c,y,j]),q=(0,a.useMemo)(()=>h||g?(0,r.jsx)(F.Z,{}):U,[h,g,U]),D=(0,a.useMemo)(()=>(0,r.jsx)(B.Z,{count:1,defaultMessageType:"warning",ref:s}),[]);return e&&N.Z.get("/ups/template").then(e=>{let{data:t}=e;x(t)}).catch(e=>{(0,_.Z)(e)}).finally(()=>{m(!1)}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(v.s_,{children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(k.z,{children:"Manage UPSes"})}),q]}),(0,r.jsx)(E.Z,{...o,disableProceed:b,loadingAction:w,preActionArea:D,ref:n,showClose:!0}),(0,r.jsx)(R.Z,{closeOnProceed:!0,...l,ref:t})]})},t2=n(92214);let t8="prepare-host",t9="prepare-network",t3="manage-fence",t7="manage-ups",t4="manage-manifest",t6={[t8]:"Prepare Host",[t9]:"Prepare Network",[t3]:"Manage Fence Devices",[t7]:"Manage UPSes",[t4]:"Manage Manifests"},ne="Loading",nt=()=>(0,r.jsx)(t2.Z,{children:(0,r.jsx)(eF,{})}),nn=()=>(0,r.jsx)(t2.Z,{children:(0,r.jsx)(e$,{})}),nr=()=>(0,r.jsx)(t2.Z,{children:(0,r.jsx)(X,{})}),ns=()=>(0,r.jsx)(t2.Z,{children:(0,r.jsx)(t5,{})}),nl=()=>(0,r.jsx)(t2.Z,{children:(0,r.jsx)(tV,{})});var ni=()=>{let{isReady:e,push:t,query:n}=(0,i.useRouter)(),[s,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(ne);return(0,a.useEffect)(()=>{if(!e)return;let{step:r}=n,l=o(r,{fallbackValue:t8});t6[l]||(l=t8),t({query:{...n,step:l}},void 0,{shallow:!0}),u===ne&&h(t6[l]),s||d(l)},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:u})}),(0,r.jsx)(c.Z,{}),(0,r.jsx)(v.s_,{children:(0,r.jsxs)(eU.Z,{onChange:(e,r)=>{d(r),h(t6[r]),t({query:{...n,step:r}},void 0,{shallow:!0})},orientation:{xs:"vertical",sm:"horizontal"},value:s,children:[(0,r.jsx)(eO.Z,{label:"Prepare host",value:t8}),(0,r.jsx)(eO.Z,{label:"Prepare network",value:t9}),(0,r.jsx)(eO.Z,{label:"Manage fence devices",value:t3}),(0,r.jsx)(eO.Z,{label:"Manage UPSes",value:t7}),(0,r.jsx)(eO.Z,{label:"Manage manifests",value:t4})]})}),(0,r.jsx)(ez.Z,{changingTabId:s,tabId:t8,children:(0,r.jsx)(nt,{})}),(0,r.jsx)(ez.Z,{changingTabId:s,tabId:t9,children:(0,r.jsx)(nn,{})}),(0,r.jsx)(ez.Z,{changingTabId:s,tabId:t3,children:(0,r.jsx)(nr,{})}),(0,r.jsx)(ez.Z,{changingTabId:s,tabId:t7,children:(0,r.jsx)(ns,{})}),(0,r.jsx)(ez.Z,{changingTabId:s,tabId:t4,children:(0,r.jsx)(nl,{})})]})}}},function(e){e.O(0,[537,256,711,245,548,48,538,975,25,215,436,590,879,340,888,774,179],function(){return e(e.s=29582)}),_N_E=e.O()}]);