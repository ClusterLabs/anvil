(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[464],{45844:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/init",function(){return i(23175)}])},81208:function(e,n,i){"use strict";var s=i(85893),t=i(67294),r=i(99576);let l={count:0,defaultMessageType:"info",messages:void 0,onSet:void 0,usePlaceholder:!0},a=(0,t.forwardRef)((e,n)=>{let{count:i=l.count,defaultMessageType:a=l.defaultMessageType,messages:c,onSet:o,usePlaceholder:d=l.usePlaceholder}=e,[u,m]=(0,t.useState)({}),x=(0,t.useMemo)(()=>({...c,...u}),[c,u]),h=(0,t.useCallback)(e=>void 0!==x[e],[x]),j=(0,t.useCallback)((e,n)=>{let i=0;m(s=>{let{[e]:t,...r}=s;return n&&(r[e]=n),i=Object.keys(r).length,r}),null==o||o.call(null,i)},[o]),Z=(0,t.useCallback)((e,n)=>{let i=0,s=n?(e,s)=>{e[s]=n,i+=1}:void 0;m(n=>{let t={};return Object.keys(n).forEach(r=>{e.test(r)?null==s||s.call(null,t,r):(t[r]=n[r],i+=1)}),t}),null==o||o.call(null,i)},[o]),f=(0,t.useMemo)(()=>{let e=Object.entries(x),n=i>0,t=n?i:e.length,l=[];if(e.every(e=>{let[n,i]=e,{children:c,type:o=a}=i;return l.push((0,s.jsx)(r.Z,{type:o,children:c},"message-".concat(n))),l.length<t}),d&&n&&0===l.length){let e=i-l.length;for(let n=0;n<e;n+=1)l.push((0,s.jsx)(r.Z,{sx:{visibility:"hidden"},text:"Placeholder"},"message-placeholder-".concat(n)))}return l},[i,a,d,x]);return(0,t.useImperativeHandle)(n,()=>({exists:h,setMessage:j,setMessageRe:Z}),[h,j,Z]),(0,s.jsx)(s.Fragment,{children:f})});a.defaultProps=l,a.displayName="MessageGroup",n.Z=a},14879:function(e,n){"use strict";n.Z={boolean:e=>!!e,number:e=>parseInt(String(e),10)||0,string:e=>String(e)}},23175:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return E}});var s=i(85893),t=i(99514),r=e=>{let{children:n}=e;return(0,s.jsxs)(t.ZP,{columns:{md:8,xs:1},container:!0,children:[(0,s.jsx)(t.ZP,{item:!0,xs:1}),(0,s.jsx)(t.ZP,{item:!0,md:6,xs:1,children:n}),(0,s.jsx)(t.ZP,{item:!0,xs:1})]})},l=i(67294),a=i(23930),c=i(53541),o=i(37842),d=i(4845),u=i(98484),m=i(85923),x=i(97607),h=i(38993),j=i(81208),Z=i(91029),f=i(95277),g=i(16310);let p=g.Ry({adminPassword:g.Z_().required(),confirmAdminPassword:g.Z_().oneOf([g.iH("adminPassword")]).required(),domainName:g.Z_().required(),hostName:g.Z_().required(),hostNumber:g.Rx().required(),organizationName:g.Z_().required(),organizationPrefix:g.Z_().min(1).max(5).required(),networkInit:h.P});var P=i(26339),b=i(59278),w=e=>{let{gatewayIface:n,ifaces:i,values:r}=e;return(0,s.jsxs)(t.ZP,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Organization name"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.organizationName})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Organization prefix"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.organizationPrefix})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Striker number"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.hostNumber})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Domain name"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.domainName})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Host name"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.hostName})}),(0,s.jsx)(t.ZP,{item:!0,sx:{marginTop:"1.4em"},xs:2,children:(0,s.jsx)(b.Ac,{children:"Networks"})}),Object.entries(r.networkInit.networks).map(e=>{let[n,{interfaces:r,ip:l,sequence:a,subnetMask:c,type:o}]=e;return(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsxs)(t.ZP,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,s.jsx)(t.ZP,{item:!0,xs:2,children:(0,s.jsxs)(b.Ac,{children:[P.Z[o]," ",a," (",(0,s.jsx)(b.Q0,{children:"".concat(o.toUpperCase()).concat(a)}),")"]})}),r.map((e,r)=>{let l="network-confirm-".concat(n,"-interface").concat(r),a="none";if(""!==e){var c;l="".concat(l,"-").concat(e),a=null===(c=i[e])||void 0===c?void 0:c.name}return(0,s.jsxs)(t.ZP,{columns:{xs:2},container:!0,item:!0,children:[(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Link ".concat(r+1)})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:a})})]},l)}),(0,s.jsx)(t.ZP,{item:!0,xs:2,children:(0,s.jsx)(b.$_,{children:"".concat(l,"/").concat(c)})})]})},"network-confirm-".concat(n))}),(0,s.jsx)(t.ZP,{item:!0,sx:{marginBottom:"1.4em"},xs:2}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Gateway"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.networkInit.gateway})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Gateway network"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:n.toUpperCase()})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.Ac,{children:"Domain name server(s)"})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(b.$_,{children:r.networkInit.dns})})]})},v=i(60280),k=i(12387),_=i(82547);let N=e=>{let n="",i="",s="",t="",r="",l={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"}},a="",c="";if(e){({dns:t="",domain:n="",gateway:r="",hostName:i="",sequence:s="",organization:a="",prefix:c=""}=e);let{networks:o={}}=e;l=(0,v.Z)(o)}return{adminPassword:"",confirmAdminPassword:"",domainName:n,hostName:i,hostNumber:s,networkInit:{dns:t,gateway:r,networks:l},organizationName:a,organizationPrefix:c}},y=(e,n,i)=>[e,n,i].every(e=>e.length>0)?"".concat(e,"-striker").concat((0,f.Z)(n),".").concat(i):"",A=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=e.split(/\s+/).filter(e=>!/^(?:and|of)$/.test(e)).slice(0,n),s="";return i.length>1?s=i.map(e=>e.substring(0,1).toLocaleLowerCase()).join(""):1===i.length&&(s=i[0].substring(0,n).toLocaleLowerCase()),s};var C=e=>{let{detail:n,onSubmitSuccess:i,tools:r}=e,a=(0,l.useRef)(null),c=(0,_.Z)({initialValues:N(n),onSubmit:(e,n)=>{let{setSubmitting:t}=n,l=(0,m.Z)(e,a.current);r.confirm.prepare({actionProceedText:"Initialize",content:a.current&&(0,s.jsx)(w,{gatewayIface:l.gatewayInterface,ifaces:a.current,values:e}),onCancelAppend:()=>t(!1),onProceedAppend:()=>{r.confirm.loading(!0),u.Z.put("/init",l).then(e=>{null==i||i.call(null,e.data),r.confirm.finish("Success",{children:(0,s.jsx)(s.Fragment,{children:"Successfully registered striker initialization job."})})}).catch(e=>{let n=(0,x.Z)(e);n.children=(0,s.jsxs)(s.Fragment,{children:["Failed to register striker initialization job. ",n.children]}),r.confirm.finish("Error",n),t(!1)})},titleText:"Initialize ".concat(e.hostName," with the following?")}),r.confirm.open()},validationSchema:p}),{disabledSubmit:f,formik:g,formikErrors:P,getFieldChanged:b,handleChange:v}=c,C=(0,l.useMemo)(()=>"adminPassword",[]),z=(0,l.useMemo)(()=>"confirmAdminPassword",[]),q=(0,l.useMemo)(()=>"domainName",[]),S=(0,l.useMemo)(()=>"hostName",[]),M=(0,l.useMemo)(()=>"hostNumber",[]),I=(0,l.useMemo)(()=>"organizationName",[]),O=(0,l.useMemo)(()=>"organizationPrefix",[]),$=(0,l.useCallback)(e=>n=>{if(b(S))return;let{target:{value:i}}=n,{values:{domainName:s,hostNumber:t,organizationPrefix:r}}=g;switch(e){case q:s=i;break;case M:t=i;break;case O:r=i}let l=y(r,t,s);g.setFieldValue(S,l)},[q,g,b,S,M,O]);return(0,s.jsxs)(t.ZP,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),g.handleSubmit(e)},spacing:"1em",children:[(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsxs)(t.ZP,{columns:2,container:!0,spacing:"1em",children:[(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{id:I,label:"Organization Name",name:I,onBlur:e=>{if(b(O))return;let{target:{value:n}}=e,i=A(n);g.setFieldValue(O,i)},onChange:v,required:!0,value:g.values.organizationName})})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{baseInputProps:{maxLength:5},id:O,label:"Prefix",name:O,onBlur:$(O),onChange:v,required:!0,value:g.values.organizationPrefix})})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{id:M,label:"Striker #",name:M,onBlur:$(M),onChange:v,required:!0,value:g.values.hostNumber})})})]})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsxs)(t.ZP,{columns:1,container:!0,spacing:"1em",children:[(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{id:q,label:"Domain name",name:q,onBlur:$(q),onChange:v,required:!0,value:g.values.domainName})})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{disableAutofill:!0,id:S,label:"Host name",name:S,onChange:v,required:!0,value:g.values.hostName})})})]})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,sm:2,md:1,children:(0,s.jsxs)(t.ZP,{columns:{xs:1,sm:2,md:1},container:!0,spacing:"1em",children:[(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{disableAutofill:!0,id:C,label:"Admin password",name:C,onChange:v,required:!0,type:o.Z.password,value:g.values.adminPassword})})}),(0,s.jsx)(t.ZP,{item:!0,xs:1,children:(0,s.jsx)(k.Z,{input:(0,s.jsx)(Z.Z,{disableAutofill:!0,id:z,label:"Confirm admin password",name:z,onChange:v,required:!0,type:o.Z.password,value:g.values.confirmAdminPassword})})})]})}),(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsx)(h.r,{formikUtils:c,host:{parentSequence:NaN,sequence:Number(g.values.hostNumber),type:"striker",uuid:"local"},onFetchSuccess:e=>{a.current=e}})}),(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsx)(j.Z,{count:1,messages:P})}),(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsx)(d.Z,{actions:[{background:"blue",children:"Initialize",disabled:f,type:"submit"}]})})]})},z=i(40743),q=i(86549),S=i(64503),M=i(6837),I=i(77510);let O=e=>{let{children:n}=e;return(0,s.jsx)(a.s_,{sx:{marginLeft:{xs:"1em",sm:"auto"},marginRight:{xs:"1em",sm:"auto"},marginTop:"calc(50vh - 10em)",maxWidth:{xs:void 0,sm:"60%",md:"50%",lg:"40%"},minWidth:"fit-content"},children:n})};var $=e=>{let{jobUuid:n,reinit:i}=e,r=(0,l.useRef)(null),o=(0,l.useMemo)(()=>{let e="login",n="/login";return i&&(e="striker config",n="/config"),{label:e,path:n}},[i]),{data:d}=(0,I.Z)("/init/job/".concat(n),{onSuccess:e=>{let{progress:n}=e;null===r.current&&100===n&&(r.current=setTimeout(e=>{window.location.replace(e)},3e3,o.path))},refreshInterval:2e3}),u=(0,l.useMemo)(()=>{if(!(null==d?void 0:d.status))return(0,s.jsx)(S.Z,{children:"Loading..."});let{status:e}=d,n=Object.values(e).reduce((e,n)=>"".concat(e).concat(n.value,"\n\n"),"").trimEnd();return(0,s.jsx)(S.Z,{children:n})},[d]);return d?(0,s.jsx)(O,{children:(0,s.jsxs)(t.ZP,{columns:1,container:!0,rowGap:".6em",children:[(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(b.Ac,{children:["You will be auto redirected to ",o.label," after initialization completes. If not, you can manually access"," ",(0,s.jsx)(q.Z,{display:"inline-flex",href:o.path,children:o.label})," ","after completion."]})}),(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsx)(z.ko,{progressPercentage:d.progress})}),(0,s.jsx)(t.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(a.Lg,{mb:0,mt:0,children:[(0,s.jsx)(a.CH,{children:(0,s.jsx)(b.Ac,{children:"Status"})}),(0,s.jsx)(a.bc,{children:(0,s.jsx)(M.Z,{id:"status-scroll-box",height:"20vh",children:u})})]})})]})}):(0,s.jsx)(O,{children:(0,s.jsx)(c.Z,{mt:0})})},L=i(2188),T=()=>{let[e,n]=(0,l.useState)(),{confirmDialog:i,finishConfirm:t,setConfirmDialogLoading:r,setConfirmDialogOpen:o,setConfirmDialogProps:d}=(0,L.Z)({initial:{scrollContent:!0,wide:!0}}),u=(0,l.useMemo)(()=>({add:{open:()=>null},confirm:{finish:t,loading:r,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return o(e)},prepare:d},edit:{open:()=>null}}),[t,r,o,d]),{data:m,loading:x}=(0,I.Z)("/host/local");return x?(0,s.jsx)(a.s_,{children:(0,s.jsx)(c.Z,{})}):e?(0,s.jsx)($,{jobUuid:e,reinit:!!m}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.s_,{children:[(0,s.jsx)(a.V9,{children:(0,s.jsxs)(b.z,{children:[m?"Rei":"I","nitialize striker"]})}),(0,s.jsx)(C,{detail:m,onSubmitSuccess:e=>{n(e.jobUuid)},tools:u})]}),i]})},E=()=>(0,s.jsx)(r,{children:(0,s.jsx)(T,{})})}},function(e){e.O(0,[491,442,206,74,461,602,982,361,292,173,967,598,888,774,179],function(){return e(e.s=45844)}),_N_E=e.O()}]);