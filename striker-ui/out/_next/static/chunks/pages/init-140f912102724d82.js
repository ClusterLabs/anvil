(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[464],{45844:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/init",function(){return i(80449)}])},9968:function(e,n,i){"use strict";var r=i(85893),s=i(77527),t=i(90642),a=i(39971);let l="Decorator",o={ok:"".concat(l,"-ok"),warning:"".concat(l,"-warning"),error:"".concat(l,"-error"),off:"".concat(l,"-off")},c=(0,s.ZP)(t.Z)({borderRadius:a.n_,height:"100%",width:"1.4em",["&.".concat(o.ok)]:{backgroundColor:a.Ej},["&.".concat(o.warning)]:{backgroundColor:a.Wd},["&.".concat(o.error)]:{backgroundColor:a.hM},["&.".concat(o.off)]:{backgroundColor:a.s7}});n.Z=e=>{let{colour:n,...i}=e;return(0,r.jsx)(c,{...i,className:o[n]})}},65716:function(e,n,i){"use strict";var r=i(85893),s=i(77527),t=i(61769),a=i(39971);let l=(0,s.ZP)(t.Z)({color:a.lD,textDecorationColor:a.s7});n.Z=e=>{let{children:n,...i}=e;return(0,r.jsx)(l,{underline:"always",variant:"subtitle1",...i,children:n})}},92214:function(e,n,i){"use strict";var r=i(85893),s=i(8506);n.Z=e=>{let{children:n}=e;return(0,r.jsxs)(s.ZP,{columns:{lg:8,xs:1},container:!0,children:[(0,r.jsx)(s.ZP,{item:!0,xs:1}),(0,r.jsx)(s.ZP,{item:!0,lg:6,xs:1,children:n}),(0,r.jsx)(s.ZP,{item:!0,xs:1})]})}},40657:function(e,n,i){"use strict";var r=i(85893),s=i(67294),t=i(47177),a=i(29873);n.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:n="",content:i="",titleText:l="",...o}={}}=e,c=(0,s.useRef)(null),[d,u]=(0,s.useState)({actionProceedText:n,content:i,titleText:l}),m=(0,s.useCallback)(e=>u(n=>{let{loading:i,...r}=n;return{...r,loading:e}}),[]),x=(0,s.useCallback)(e=>{var n,i;return null==c?void 0:null===(i=c.current)||void 0===i?void 0:null===(n=i.setOpen)||void 0===n?void 0:n.call(null,e)},[]),h=(0,s.useCallback)((e,n)=>u({actionProceedText:"",content:(0,r.jsx)(a.Z,{...n}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,s.useMemo)(()=>(0,r.jsx)(t.Z,{...o,...d,ref:c}),[d,o]),confirmDialogRef:c,setConfirmDialogLoading:m,setConfirmDialogOpen:x,setConfirmDialogProps:u,finishConfirm:h}}},80449:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return L}});var r=i(85893),s=i(92214),t=i(67294),a=i(65375),l=i(90209),o=i(8506),c=i(46315),d=i(42050),u=i(66389),m=i(66859),x=i(11100),h=i(19306),j=i(18050),Z=i(23852),f=i(98717),g=i(16310);let p=g.Ry({adminPassword:g.Z_().required(),confirmAdminPassword:g.Z_().oneOf([g.iH("adminPassword")]).required(),domainName:g.Z_().required(),hostName:g.Z_().required(),hostNumber:g.Rx().required(),organizationName:g.Z_().required(),organizationPrefix:g.Z_().min(1).max(5).required(),networkInit:h.PC});var P=i(57882),b=e=>{let{values:n}=e;return(0,r.jsxs)(o.ZP,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.Ac,{children:"Organization name"})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.$_,{children:n.organizationName})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.Ac,{children:"Organization prefix"})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.$_,{children:n.organizationPrefix})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.Ac,{children:"Striker number"})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.$_,{children:n.hostNumber})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.Ac,{children:"Domain name"})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.$_,{children:n.domainName})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.Ac,{children:"Host name"})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(P.$_,{children:n.hostName})}),(0,r.jsx)(h.e2,{...e})]})},w=i(93666),v=i(12823),k=i(22582);let N=e=>{let n="",i="",r="",s="",t="",a={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"}},l="",o="",c="";if(e){({domain:n="",organization:o="",prefix:c=""}=e.variables),i=e.name;let{sequence:d}=e.variables;r=d?String(d):"",{dns:s="",gateway:t="",ntp:l=""}=e.netconf;let{networks:u={}}=e.netconf;a=(0,w.Z)(u)}return{adminPassword:"",confirmAdminPassword:"",domainName:n,hostName:i,hostNumber:r,networkInit:{dns:s,gateway:t,networks:a,ntp:l},organizationName:o,organizationPrefix:c}},_=(e,n,i)=>[e,n,i].every(e=>e.length>0)?"".concat(e,"-striker").concat((0,f.Z)(n),".").concat(i):"",C=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=e.split(/\s+/).filter(e=>!/^(?:and|of)$/.test(e)).slice(0,n),r="";return i.length>1?r=i.map(e=>e.substring(0,1).toLocaleLowerCase()).join(""):1===i.length&&(r=i[0].substring(0,n).toLocaleLowerCase()),r};var z=e=>{let{detail:n,onSubmitSuccess:i,tools:s}=e,a=(0,t.useRef)(null),l=(0,k.Z)({initialValues:N(n),onSubmit:(e,n)=>{let{setSubmitting:t}=n,l=(0,m.Z)(e,a.current);s.confirm.prepare({actionProceedText:"Initialize",content:a.current&&(0,r.jsx)(b,{gatewayIface:l.gatewayInterface,ifaces:a.current,values:e}),onCancelAppend:()=>t(!1),onProceedAppend:()=>{s.confirm.loading(!0),u.Z.put("/init",l).then(e=>{null==i||i.call(null,e.data),s.confirm.finish("Success",{children:(0,r.jsx)(r.Fragment,{children:"Successfully registered striker initialization job."})})}).catch(e=>{let n=(0,x.Z)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to register striker initialization job. ",n.children]}),s.confirm.finish("Error",n),t(!1)})},titleText:"Initialize ".concat(e.hostName," with the following?")}),s.confirm.open()},validationSchema:p}),{disabledSubmit:f,formik:g,formikErrors:P,getFieldChanged:w,handleChange:z}=l,A=(0,t.useMemo)(()=>"adminPassword",[]),q=(0,t.useMemo)(()=>"confirmAdminPassword",[]),S=(0,t.useMemo)(()=>"domainName",[]),y=(0,t.useMemo)(()=>"hostName",[]),M=(0,t.useMemo)(()=>"hostNumber",[]),I=(0,t.useMemo)(()=>"organizationName",[]),R=(0,t.useMemo)(()=>"organizationPrefix",[]),T=(0,t.useCallback)(e=>n=>{if(w(y))return;let{target:{value:i}}=n,{values:{domainName:r,hostNumber:s,organizationPrefix:t}}=g;switch(e){case S:r=i;break;case M:s=i;break;case R:t=i}let a=_(t,s,r);g.setFieldValue(y,a)},[S,g,w,y,M,R]);return(0,r.jsxs)(o.ZP,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),g.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsxs)(o.ZP,{columns:2,container:!0,spacing:"1em",children:[(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{id:I,label:"Organization Name",name:I,onBlur:e=>{if(w(R))return;let{target:{value:n}}=e,i=C(n);g.setFieldValue(R,i)},onChange:z,required:!0,value:g.values.organizationName})})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{baseInputProps:{maxLength:5},id:R,label:"Prefix",name:R,onBlur:T(R),onChange:z,required:!0,value:g.values.organizationPrefix})})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{id:M,label:"Striker #",name:M,onBlur:T(M),onChange:z,required:!0,value:g.values.hostNumber})})})]})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsxs)(o.ZP,{columns:1,container:!0,spacing:"1em",children:[(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{id:S,label:"Domain name",name:S,onBlur:T(S),onChange:z,required:!0,value:g.values.domainName})})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{disableAutofill:!0,id:y,label:"Host name",name:y,onChange:z,required:!0,value:g.values.hostName})})})]})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,sm:2,md:1,children:(0,r.jsxs)(o.ZP,{columns:{xs:1,sm:2,md:1},container:!0,spacing:"1em",children:[(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{disableAutofill:!0,id:A,label:"Admin password",name:A,onChange:z,required:!0,type:c.Z.password,value:g.values.adminPassword})})}),(0,r.jsx)(o.ZP,{item:!0,xs:1,children:(0,r.jsx)(v.Z,{input:(0,r.jsx)(Z.Z,{disableAutofill:!0,id:q,label:"Confirm admin password",name:q,onChange:z,required:!0,type:c.Z.password,value:g.values.confirmAdminPassword})})})]})}),(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsx)(h.rQ,{formikUtils:l,host:{parentSequence:NaN,sequence:Number(g.values.hostNumber),type:"striker",uuid:"local"},onFetchSuccess:e=>{a.current=e}})}),(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsx)(j.Z,{count:1,messages:P})}),(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsx)(d.Z,{actions:[{background:"blue",children:"Initialize",disabled:f,type:"submit"}]})})]})},A=i(64236),q=i(65716),S=i(91469),y=i(28192),M=i(5499),I=i(5048),R=i(1699);let T=e=>{let{children:n}=e;return(0,r.jsx)(a.s_,{sx:{marginLeft:{xs:"1em",sm:"auto"},marginRight:{xs:"1em",sm:"auto"},marginTop:"calc(50vh - 30vh - 6em)",width:{xs:void 0,sm:"90vw",md:"80vw",lg:"70vw",xl:"60vw"}},children:n})};var D=e=>{let{jobUuid:n,reinit:i}=e,s=(0,t.useRef)(null),c=(0,t.useMemo)(()=>{let e="login",n="/login";return i&&(e="striker config",n="/config"),{label:e,path:n}},[i]),d=(0,R.Z)({follow:!0}),{data:u}=(0,M.Z)("/init/job/".concat(n),{onSuccess:e=>{let{progress:n}=e;null===s.current&&100===n&&(s.current=setTimeout(e=>{window.location.replace(e)},3e3,c.path))},refreshInterval:2e3}),m=(0,I.Z)(null==u?void 0:u.status);return u?(0,r.jsx)(T,{children:(0,r.jsxs)(o.ZP,{columns:1,container:!0,rowGap:".6em",children:[(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(P.Ac,{children:["You will be auto redirected to ",c.label," after initialization completes. If not, you can manually access"," ",(0,r.jsx)(q.Z,{display:"inline-flex",href:c.path,children:c.label})," ","after completion."]})}),(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsx)(A.ko,{progressPercentage:u.progress})}),(0,r.jsx)(o.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(a.Lg,{mb:0,mt:0,children:[(0,r.jsx)(a.CH,{children:(0,r.jsx)(P.Ac,{children:"Status"})}),(0,r.jsx)(a.bc,{children:(0,r.jsx)(y.Z,{height:"60vh",lineHeight:"2",ref:d.callbackRef,children:(0,r.jsx)(S.Z,{children:m.string})},"status")})]})})]})}):(0,r.jsx)(T,{children:(0,r.jsx)(l.Z,{mt:0})})},E=i(40657),F=()=>{let[e,n]=(0,t.useState)(),{confirmDialog:i,finishConfirm:s,setConfirmDialogLoading:o,setConfirmDialogOpen:c,setConfirmDialogProps:d}=(0,E.Z)({initial:{scrollContent:!0,wide:!0}}),u=(0,t.useMemo)(()=>({add:{open:()=>null},confirm:{finish:s,loading:o,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return c(e)},prepare:d},edit:{open:()=>null}}),[s,o,c,d]),{data:m,loading:x}=(0,M.Z)("/host/local");return x?(0,r.jsx)(a.s_,{children:(0,r.jsx)(l.Z,{})}):e?(0,r.jsx)(D,{jobUuid:e,reinit:!!m}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.s_,{children:[(0,r.jsx)(a.V9,{children:(0,r.jsxs)(P.z,{children:[m?"Rei":"I","nitialize striker"]})}),(0,r.jsx)(z,{detail:m,onSubmitSuccess:e=>{n(e.jobUuid)},tools:u})]}),i]})},L=()=>(0,r.jsx)(s.Z,{children:(0,r.jsx)(F,{})})}},function(e){e.O(0,[662,760,14,245,145,48,771,215,590,504,888,774,179],function(){return e(e.s=45844)}),_N_E=e.O()}]);