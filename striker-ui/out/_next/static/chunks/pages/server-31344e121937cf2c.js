(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{41171:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/server",function(){return r(15160)}])},76740:function(e,t,r){"use strict";var s=r(85893),n=r(90642),i=r(19304),l=r(47407),a=r(41609),o=r.n(a),d=r(35338),c=r(44400),u=r(5387),h=r(57882);let m=e=>{let{entry:t}=e;return(0,s.jsx)(h.$_,{whiteSpace:"nowrap",children:String(t)})},x=e=>{let{entry:t,key:r}=e;return d.JW.test(r)?(0,s.jsx)(h.PJ,{wrapper:"mono",children:String(t)}):m(e)},v=e=>{let{entry:t,hasPassword:r}=e;return o()(t)?(0,s.jsx)(h.Ac,{children:"none"}):r?x(e):m(e)},j=e=>{let{depth:t,entry:r,getLabel:i,hasPassword:l,key:a,nest:o,renderValue:d}=e;return(0,s.jsxs)(u.Z,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,s.jsx)(h.Ac,{children:i({cap:c.Z,depth:t,entry:r,hasPassword:l,key:a})}),(0,s.jsx)(n.Z,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!o&&d(v,{depth:t,entry:r,hasPassword:l,key:a})})]})},p=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},g=e=>null!==e&&"object"==typeof e&&!o()(e),f=e=>{let{depth:t=0,entries:r,getEntryLabel:n,getListProps:a,getListItemProps:o,hasPassword:d,listKey:c,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:x}=e,v=[];Object.entries(r).forEach(e=>{let[r,l]=e,a=g(l),c=a?null:l,j={depth:t,entry:c,hasPassword:d,key:r};x(p,j)||v.push((0,s.jsx)(i.ZP,{sx:{paddingLeft:"".concat(t,"em")},...null==o?void 0:o.call(null,j),children:h({depth:t,entry:c,getLabel:n,hasPassword:d,key:r,nest:a,renderValue:m})},"form-summary-entry-".concat(r))),a&&t<u&&v.push(f({depth:t+1,entries:l,getEntryLabel:n,hasPassword:d,listKey:r,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:x}))});let j="form-summary-list-".concat(null!=c?c:"root");return(0,s.jsx)(l.Z,{dense:!0,disablePadding:!0,...null==a?void 0:a.call(null,{depth:t,entries:r,key:c}),children:v},j)};t.Z=e=>{let{entries:t,getEntryLabel:r=e=>{let{cap:t,key:r}=e;return t(r)},getListProps:s,getListItemProps:n,hasPassword:i=!1,maxDepth:l=3,renderEntry:a=j,renderEntryValue:o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return e(...r)},skip:d=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];return e(...r)}}=e;return f({entries:t,getEntryLabel:r,getListProps:s,getListItemProps:n,hasPassword:i,maxDepth:l,renderEntry:a,renderEntryValue:o,skip:d})}},61347:function(e,t,r){"use strict";r.d(t,{w:function(){return o}});var s=r(77527),n=r(55730),i=r(42048),l=r(73490),a=r(39971);let o={draggable:"".concat("DragDataGrid","-draggable")},d=(0,s.ZP)(i._)({color:a.s7,["& .".concat(n.Z.root)]:{color:"inherit"},["& .".concat(l._.cell)]:{"&:focus":{outline:"none"},"&:focus-within":{outline:"none"}},["& .".concat(l._.row)]:{["&.".concat(o.draggable,":hover")]:{cursor:"grab",["& .".concat(l._.cell," p")]:{cursor:"auto"}}}});t.Z=d},64046:function(e,t,r){"use strict";var s=r(85893),n=r(8506),i=r(67294),l=r(29873),a=r(21758),o=r(90209),d=r(71487),c=r(57882),u=r(5499);t.Z=e=>{let{commands:t,getLabel:r,names:h,progress:m,uuids:x}=e,v=(0,i.useMemo)(()=>{let e=new URLSearchParams;return h&&h.forEach(t=>{e.append("name",t)}),t&&t.forEach(t=>{e.append("command",t)}),e.toString()},[t,h]),{altData:j,loading:p}=(0,u.Z)("/job?".concat(v),{mod:e=>{let t;let r=(t=x?x.reduce((t,r)=>{let{[r]:s}=e;return s&&t.push(s),t},[]):Object.values(e)).reduce((e,t)=>e+t.progress,0);return m.set(r/t.length),t},refreshInterval:3e3}),g=(0,i.useMemo)(()=>(0,d.Z)(null==r?void 0:r.call(null,m.value),c.Ac),[r,m.value]);return p?(0,s.jsx)(o.Z,{mt:0}):j?j.length?(0,s.jsxs)(n.ZP,{alignItems:"center",columnSpacing:"0.5em",container:!0,children:[...j.map(e=>(0,s.jsx)(n.ZP,{item:!0,children:(0,s.jsx)(a.Z,{error:!!e.error.count,slotProps:{pie:{size:"1em"}},value:e.progress})},"".concat(e.uuid,"-progress"))),(0,s.jsx)(n.ZP,{item:!0,xs:!0,children:g})]}):null:(0,s.jsx)(l.Z,{type:"warning",children:"Failed to get jobs."})}},92214:function(e,t,r){"use strict";var s=r(85893),n=r(8506);t.Z=e=>{let{children:t}=e;return(0,s.jsxs)(n.ZP,{columns:{lg:8,xs:1},container:!0,children:[(0,s.jsx)(n.ZP,{item:!0,xs:1}),(0,s.jsx)(n.ZP,{item:!0,lg:6,xs:1,children:t}),(0,s.jsx)(n.ZP,{item:!0,xs:1})]})}},16562:function(e,t,r){"use strict";var s=r(85893),n=r(77527),i=r(50385),l=r(13539),a=r(67294),o=r(39971),d=r(57882);let c=(0,n.ZP)(i.Z)({height:"3.5em",marginLeft:0,width:"100%"});t.Z=e=>{let{baseInputProps:t,checked:r,formControlLabelProps:n,id:i,label:u,name:h,onChange:m,switchProps:x}=e,v=(0,a.useMemo)(()=>"string"==typeof u?(0,s.jsx)(d.Ac,{inheritColour:!0,color:"".concat(o.s7,"AF"),children:u}):(0,s.jsx)(s.Fragment,{children:u}),[u]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{componentsProps:{typography:{flexGrow:1}},control:(0,s.jsx)(l.Z,{checked:r,edge:"end",name:h,onChange:m,...x}),label:v,labelPlacement:"start",...n}),(0,s.jsx)("input",{checked:r,hidden:!0,id:i,readOnly:!0,...t})]})}},19166:function(e,t,r){"use strict";var s=r(85893),n=r(77527),i=r(58918),l=r(80483),a=r(67294),o=r(39971),d=r(57882);let c=(0,n.ZP)(i.Z)({borderRadius:o.n_,color:o.s7,padding:".4em .8em",textTransform:"none",["&.".concat(l.Z.selected)]:{color:o.Ej}});t.Z=e=>{let{label:t,...r}=e,n=(0,a.useMemo)(()=>"string"==typeof t?(0,s.jsx)(d.Ac,{inheritColour:!0,children:t}):t,[t]);return(0,s.jsx)(c,{label:n,...r})}},17428:function(e,t,r){"use strict";var s=r(85893),n=r(90642),i=r(67294);t.Z=e=>{let{changingTabId:t,children:r,retain:l=!1,tabId:a}=e,o=(0,i.useMemo)(()=>t===a,[t,a]),d=(0,i.useMemo)(()=>l?(0,s.jsx)(n.Z,{sx:{display:o?"initial":"none"},children:r}):o&&r,[r,o,l]);return(0,s.jsx)(s.Fragment,{children:d})}},22143:function(e,t,r){"use strict";var s=r(85893),n=r(77527),i=r(14221),l=r(93465),a=r(80483),o=r(18745),d=r(89540),c=r(67294),u=r(39971);let h="1.8em",m=(0,n.ZP)(i.Z)({minHeight:"1em",["&.".concat(l.Z.vertical)]:{minHeight:h,["& .".concat(a.Z.root)]:{alignItems:"flex-start",minHeight:h,paddingLeft:"2em"},["& .".concat(l.Z.indicator)]:{right:"initial"}},["& .".concat(a.Z.root)]:{minHeight:"1em"},["& .".concat(l.Z.indicator)]:{backgroundColor:u.Ej,borderRadius:u.n_}});t.Z=e=>{let{orientation:t,variant:r="fullWidth",...n}=e,i=(0,o.Z)(),l=(0,c.useCallback)(e=>i.breakpoints.up(e),[i]),a=(0,d.Z)(l("xs")),u=(0,d.Z)(l("sm")),h=(0,d.Z)(l("md")),x=(0,d.Z)(l("lg")),v=(0,d.Z)(l("xl")),j=(0,c.useMemo)(()=>[["xs",a],["sm",u],["md",h],["lg",x],["xl",v]],[x,h,u,v,a]),p=(0,c.useMemo)(()=>{let e;return"object"==typeof t?j.some(r=>{let[s,n]=r;return n&&t[s]&&(e=t[s]),!n}):e=t,e},[j,t]);return(0,s.jsx)(m,{orientation:p,variant:r,...n})}},82934:function(e,t,r){"use strict";var s=r(82040);t.Z=(e,t,r)=>{let n;if(!e||!t.isReady)return;let{name:i,uuid:l}=t.query;return i?n=Object.values(e).find(r((0,s.Z)(i))):l&&(n=e[(0,s.Z)(l)]),n}},82040:function(e,t){"use strict";t.Z=function(e){let{fallbackValue:t="",joinSeparator:r="",limit:s=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof Array?e.slice(0,s).join(r):null!=e?e:t}},72094:function(e,t){"use strict";t.Z=(e,t,r)=>{let s;let{query:n}=e;if(void 0===r){let{[t]:e,...r}=n;s=r}else s={...n,[t]:r};return s}},83688:function(e,t,r){"use strict";var s=r(54743),n=r(85893);t.Z=(0,s.Z)((0,n.jsx)("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}),"Fullscreen")},55751:function(e,t,r){"use strict";var s=r(54743),n=r(85893);t.Z=(0,s.Z)((0,n.jsx)("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"}),"Keyboard")},86142:function(e,t,r){"use strict";var s=r(54743),n=r(85893);t.Z=(0,s.Z)((0,n.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},10617:function(e,t,r){"use strict";var s=r(54743),n=r(85893);t.Z=(0,s.Z)((0,n.jsx)("path",{d:"M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNewOutlined")},32602:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return a},noSSR:function(){return l}});let s=r(38754);r(85893),r(67294);let n=s._(r(35491));function i(e){return{default:(null==e?void 0:e.default)||e}}function l(e,t){return delete t.webpack,delete t.modules,e(t)}function a(e,t){let r=n.default,s={loading:e=>{let{error:t,isLoading:r,pastDelay:s}=e;return null}};e instanceof Promise?s.loader=()=>e:"function"==typeof e?s.loader=e:"object"==typeof e&&(s={...s,...e});let a=(s={...s,...t}).loader;return(s.loadableGenerated&&(s={...s,...s.loadableGenerated},delete s.loadableGenerated),"boolean"!=typeof s.ssr||s.ssr)?r({...s,loader:()=>null!=a?a().then(i):Promise.resolve(i(()=>null))}):(delete s.webpack,delete s.modules,l(r,s))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return s}});let s=r(38754)._(r(67294)).default.createContext(null)},35491:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let s=r(38754)._(r(67294)),n=r(1159),i=[],l=[],a=!1;function o(e){let t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then(e=>(r.loading=!1,r.loaded=e,e)).catch(e=>{throw r.loading=!1,r.error=e,e}),r}class d{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function c(e){return function(e,t){let r=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),i=null;function o(){if(!i){let t=new d(e,r);i={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return i.promise()}if(!a){let e=r.webpack?r.webpack():r.modules;e&&l.push(t=>{for(let r of e)if(t.includes(r))return o()})}function c(e,t){!function(){o();let e=s.default.useContext(n.LoadableContext);e&&Array.isArray(r.modules)&&r.modules.forEach(t=>{e(t)})}();let l=s.default.useSyncExternalStore(i.subscribe,i.getCurrentValue,i.getCurrentValue);return s.default.useImperativeHandle(t,()=>({retry:i.retry}),[]),s.default.useMemo(()=>{var t;return l.loading||l.error?s.default.createElement(r.loading,{isLoading:l.loading,pastDelay:l.pastDelay,timedOut:l.timedOut,error:l.error,retry:i.retry}):l.loaded?s.default.createElement((t=l.loaded)&&t.default?t.default:t,e):null},[e,l])}return c.preload=()=>o(),c.displayName="LoadableComponent",s.default.forwardRef(c)}(o,e)}function u(e,t){let r=[];for(;e.length;){let s=e.pop();r.push(s(t))}return Promise.all(r).then(()=>{if(e.length)return u(e,t)})}c.preloadAll=()=>new Promise((e,t)=>{u(i).then(e,t)}),c.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let r=()=>(a=!0,t());u(l,e).then(r,r)})),window.__NEXT_PRELOADREADY=c.preloadReady;let h=c},15160:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ts}});var s=r(85893),n=r(77527),i=r(90642),l=r(9008),a=r.n(l),o=r(11163),d=r(67294),c=r(45842),u=r(82934),h=r(82040),m=r(25436),x=r(8506),v=r(82092),j=r(65375),p=r(54743),g=(0,p.Z)((0,s.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),f=(0,p.Z)((0,s.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),Z=r(48403),b=r.n(Z),y=r(5387),P=r(66389),w=r(76740),S=r(11100),_=function(e,t,r,n,i){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},{setSubmitting:a}=t,{buildRequestBody:o,buildSummary:d,onSuccess:c}=l,u=null==d?void 0:d.call(null,e);r.confirm.prepare({actionProceedText:"Save",content:(0,s.jsx)(w.Z,{entries:null!=u?u:e}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{var t;r.confirm.loading(!0);let i=null==o?void 0:o.call(null,e,u);P.Z.put(n(),null!==(t=null!=i?i:u)&&void 0!==t?t:e).then(()=>{r.confirm.finish("Success",{children:(0,s.jsx)(s.Fragment,{children:"Successfully registered server update job"})}),null==c||c.call(null),r.add.open(!1),r.edit.open(!1)}).catch(e=>{let t=(0,S.Z)(e);t.children=(0,s.jsxs)(s.Fragment,{children:["Failed to register server update job. ",t.children]}),r.confirm.finish("Error",t),a(!1)})},titleText:i()}),r.confirm.open(!0)},k=r(45328),C=r(73490),z=r(39971),M=r(61347);let A=(0,n.ZP)(M.Z)({["& .".concat(C._.row)]:{"&:hover":{cursor:"pointer"},"&.Mui-selected":{[".".concat(C._.cell,":first-child")]:{borderLeft:"thick solid ".concat(z.Ej)}},[".".concat(C._.cell,":first-child")]:{borderLeft:"thick solid ".concat(z.s7)}}});var V=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[n]=t,{children:i,formik:l,...a}=n;return(0,s.jsx)(x.ZP,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),l.handleSubmit(e)},spacing:"1em",...a,children:i})},I=r(42050),O=r(90209),F=r(5499),D=e=>{let{dangerous:t,detail:r,formDisabled:n,label:i}=e,{data:l}=(0,F.Z)("/job?name=".concat(r.uuid,"::update"),{refreshInterval:2e3}),a=(0,d.useMemo)(()=>!l||n||Object.keys(l).length>0,[n,l]),o=(0,d.useMemo)(()=>t?"red":"blue",[t]);return l?(0,s.jsx)(I.Z,{actions:[{background:o,children:i,disabled:a,type:"submit"}]}):(0,s.jsx)(O.Z,{mt:0})},R=r(57882),T=r(22582),U=e=>{let{detail:t,tools:r}=e,[n,i]=(0,d.useState)(),l=(0,d.useMemo)(()=>{let[,...e]=t.devices.diskOrderBy.boot;return e},[t.devices.diskOrderBy.boot]),{disabledSubmit:a,formik:o}=(0,T.Z)({initialValues:{order:l},onSubmit:(e,s)=>{_(e,s,r,()=>"/server/".concat(t.uuid,"/set-boot-order"),()=>"Set boot order?",{buildSummary:e=>({order:e.order.map(e=>{let{[e]:{target:{dev:r}}}=t.devices.disks;return r})})})}}),c=(0,d.useMemo)(()=>({order:"order"}),[]),u=(0,d.useMemo)(()=>void 0===n?-1:o.values.order.indexOf(n),[o.values.order,n]),h=(0,d.useMemo)(()=>u<1,[u]),m=(0,d.useMemo)(()=>{let e=o.values.order.length-1;return u<0||u>=e},[o.values.order.length,u]),v=(0,d.useMemo)(()=>o.values.order.map(e=>{let{[e]:{device:r,source:{dev:{path:s=""},file:{path:n=""}},target:{dev:i}}}=t.devices.disks;return{dev:i,index:e,name:r,source:s||n}}),[t.devices.disks,o.values.order]),j=(0,d.useMemo)(()=>[{field:"name",flex:0,headerName:"Name",renderCell:e=>{let{value:t}=e,r=t;return/cdrom/.test(t)&&(r="optical"),r=b()(r)},sortable:!1},{field:"dev",flex:0,headerName:"Device",renderCell:e=>{let{value:t}=e;return(0,s.jsx)(R.$_,{noWrap:!0,children:t})},sortable:!1},{field:"source",flex:1,headerName:"Source",renderCell:e=>{let{value:t}=e;return(0,s.jsx)(R.$_,{noWrap:!0,textOverflow:"ellipsis",children:t})},sortable:!1}],[]);return(0,s.jsxs)(V,{formik:o,children:[(0,s.jsx)(x.ZP,{item:!0,alignSelf:"center",children:(0,s.jsxs)(y.Z,{spacing:".6em",children:[(0,s.jsx)(k.Z,{disabled:h,onClick:()=>{let{order:e}=o.values;if(h)return;let t=u-1,{[t]:r,[u]:s}=e,n=[...e];n.splice(t,2,s,r),o.setFieldValue(c.order,n,!0)},children:(0,s.jsx)(g,{fontSize:"small"})}),(0,s.jsx)(k.Z,{disabled:m,onClick:()=>{let{order:e}=o.values;if(m)return;let t=u+1,{[u]:r,[t]:s}=e,n=[...e];n.splice(u,2,s,r),o.setFieldValue(c.order,n,!0)},children:(0,s.jsx)(f,{fontSize:"small"})})]})}),(0,s.jsx)(x.ZP,{item:!0,flexGrow:1,children:(0,s.jsx)(A,{autoHeight:!0,columns:j,disableColumnMenu:!0,getRowId:e=>e.index,hideFooter:!0,onSelectionModelChange:e=>{let[t]=e;i(Number(t))},rows:v})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:t,formDisabled:a,label:"Save"})})]})},W=r(18050),L=r(23852),E=r(16310),N=r(43267),q=r(48313),H=e=>E.Ry({size:E.nK().when(["storage"],(t,r)=>{let[s]=t,n=null==e?void 0:e.storageGroups[s];return n?(0,N.BQ)(n.free):r}),storage:(0,q.uI)()}),G=e=>E.Ry({bridge:E.Z_().required(),mac:(0,q.Cm)().notOneOf([...e.devices.interfaces.map(e=>e.mac.address),...Object.values(e.bridges).map(e=>e.mac)],"${path} already exists"),model:E.Z_().nullable()}),B=e=>E.Ry({name:E.Z_().required().oneOf([e.name])}),$=e=>{let{available:t}=e;return E.Ry({size:(0,N.xJ)(t)})},Q=(e,t)=>E.Ry({name:(0,N.RN)(e.uuid,t)});let J=E.Ry({file:(0,q.uI)().nullable()}),K=E.Ry({cores:E.Rx().min(1).required(),sockets:E.Rx().min(1).required()}),X=E.Ry({lvmVgUuid:E.Z_().required("Volume group is required."),protocol:E.Z_().required().oneOf(["long-throw","short-throw","sync"])}),Y=E.Ry({after:E.Z_(),delay:E.Rx().min(0)});var ee=r(12823);let et=e=>{let{cpu:t,detail:r,tools:n}=e,{topology:i}=r.cpu,{disabledSubmit:l,formik:a,formikErrors:o,handleChange:c}=(0,T.Z)({initialValues:{clusters:String(i.clusters),cores:String(i.cores),dies:String(i.dies),sockets:String(i.sockets),threads:String(i.threads)},onSubmit:(e,t)=>{_(e,t,n,()=>"/server/".concat(r.uuid,"/set-cpu"),()=>"Set CPU?",{buildSummary:e=>({cores:Number(e.cores),sockets:Number(e.sockets)})})},validationSchema:K}),u=(0,d.useMemo)(()=>({cores:"cores",sockets:"sockets"}),[]);return(0,s.jsxs)(V,{formik:a,children:[(0,s.jsxs)(x.ZP,{item:!0,width:"100%",children:[(0,s.jsxs)(R.Ac,{children:["Model: ",Object.values(t.hosts)[0].model]}),(0,s.jsxs)(R.Ac,{children:["Available cores: ",t.cores]})]}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:u.cores,label:"Cores",name:u.cores,onChange:c,required:!0,value:a.values.cores})})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:u.sockets,label:"Sockets",name:u.sockets,onChange:c,required:!0,value:a.values.sockets})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:o})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:r,formDisabled:l,label:"Save"})})]})};var er=e=>{let{detail:t}=e,{data:r}=(0,F.Z)("/anvil/".concat(t.anvil.uuid,"/cpu"),{refreshInterval:5e3});return r?(0,s.jsx)(et,{cpu:r,...e}):(0,s.jsx)(O.Z,{mt:0})},es=r(53833),en=e=>{let{detail:t,tools:r}=e,{disabledSubmit:n,formik:i,handleChange:l}=(0,T.Z)({initialValues:{name:""},onSubmit:(e,n)=>{(0,es.Z)(r,"/server/".concat(t.uuid),"Delete server ".concat(t.name,"?"),{description:(0,s.jsxs)(R.Ac,{children:["Are you sure you want to delete the server ",t.name,"? This action is not reversible!"]}),dangerous:!0,method:"delete",messages:{fail:(0,s.jsx)(s.Fragment,{children:"Failed to register server deletion job."}),proceed:"Delete",success:(0,s.jsx)(s.Fragment,{children:"Successfully registered server deletion job"})},onCancel:()=>{n.setSubmitting(!1)},onFail:()=>{n.setSubmitting(!1)},onSuccess:()=>{window.location.replace("/")}})},validationSchema:B(t)}),a=(0,d.useMemo)(()=>({name:"name"}),[]);return(0,s.jsxs)(V,{formik:i,justifyContent:"center",children:[(0,s.jsxs)(x.ZP,{item:!0,width:"100%",children:[(0,s.jsxs)(R.Ac,{children:["Deleting ",(0,s.jsx)(R.Q0,{children:t.name})," will remove all of its data, including its configurations and storage volume(s)."]}),(0,s.jsx)(R.Ac,{children:"Please type the server name to ensure the correct server gets deleted."})]}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:a.name,label:"Server name",name:a.name,onChange:l,value:i.values.name})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{dangerous:!0,detail:t,formDisabled:n,label:"Delete"})})]})},ei=(0,p.Z)((0,s.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14.5c-2.49 0-4.5-2.01-4.5-4.5S9.51 7.5 12 7.5s4.5 2.01 4.5 4.5-2.01 4.5-4.5 4.5zm0-5.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"}),"Album"),el=(0,p.Z)((0,s.jsx)("path",{d:"M4 20h16v2H4zM4 2h16v2H4zm9 7h3l-4-4-4 4h3v6H8l4 4 4-4h-3z"}),"Expand"),ea=r(45036),eo=r(18541),ed=r(29873),ec=r(53839),eu=r(54490),eh=r(4615),em=r(60665),ex=r(64236),ev=r(52257),ej=r(37628);let ep=[...eh.k,{displayValue:"%",value:"percent"}];var eg=e=>{var t;let{device:r,detail:n,tools:i}=e,l=(0,d.useMemo)(()=>n.devices.disks.find(e=>e.target.dev===r),[n.devices.disks,r]),{altData:a}=(0,F.Z)("/anvil/".concat(n.anvil.uuid,"/storage"),{mod:em.Z,refreshInterval:5e3}),{disabledSubmit:o,formik:c,formikErrors:u,handleChange:h}=(0,T.Z)({initialValues:{size:{unit:"GiB",value:"0"},storage:null!==(t=null==l?void 0:l.source.dev.sg)&&void 0!==t?t:""},onSubmit:(e,t)=>{_(e,t,i,()=>"/server/".concat(n.uuid,"/").concat(r?"grow-disk":"add-disk"),()=>"Add disk on ".concat(null==a?void 0:a.storageGroups[e.storage].name,"?"),{buildSummary:e=>{let{size:t,storage:s}=e,{unit:n,value:i}=t,l=/percent/i.test(n)?"%":n;return r?{device:r,size:"".concat(i).concat(l)}:{size:"".concat(i).concat(l),storage:null==a?void 0:a.storageGroups[s].name}},buildRequestBody:(e,t)=>((null==t?void 0:t.storage)&&(t.storage=e.storage),t)})},validationSchema:H(a)}),m=(0,d.useMemo)(()=>{let e="size";return{size:e,storage:"storage",unit:"".concat(e,".unit"),value:"".concat(e,".value")}},[]),v=(0,d.useMemo)(()=>a&&Object.values(a.storageGroups).map(e=>({displayValue:e.name,value:e.uuid})),[a]),j=(0,d.useMemo)(()=>{if(a)return a.storageGroups[c.values.storage]},[c.values,a]),p=(0,d.useMemo)(()=>{let{unit:e}=c.values.size;return"percent"===e?"GiB":e},[c.values.size]),g=(0,d.useMemo)(()=>{if(!j)return;let e={toUnit:p};return{free:(0,eu._d)(j.free,e),size:(0,eu._d)(j.size,e),used:(0,eu._d)(j.used,e)}},[p,j]),f=(0,d.useMemo)(()=>{if(!l)return;let{name:e="",size:t}=l.source.dev.lv;if(t)return{name:e,size:(0,eu._d)(t,{toUnit:p}),zero:/_0$/.test(e)}},[p,l]),Z=(0,d.useMemo)(()=>"shut off"!==n.state&&(null==f?void 0:f.zero)||o,[n.state,null==f?void 0:f.zero,o]),b=(0,d.useMemo)(()=>{if("shut off"!==n.state&&(null==f?void 0:f.zero))return(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(ed.Z,{children:"A server must be shut off in order to grow its disk 0."})})},[n.state,null==f?void 0:f.zero]),y=(0,d.useMemo)(()=>g&&a&&(0,s.jsxs)(x.ZP,{item:!0,width:"100%",children:[(0,s.jsxs)(R.Ac,{children:["Storage group: ",(0,s.jsx)(R.Q0,{noWrap:!0,children:null==j?void 0:j.name})]}),(0,s.jsx)(ex.Tj,{storages:a,target:c.values.storage}),(0,s.jsxs)(x.ZP,{container:!0,children:[(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsxs)(R.Ac,{children:["Used: ",g.used]})}),(0,s.jsx)(x.ZP,{item:!0,textAlign:"center",xs:!0,children:(0,s.jsxs)(R.Ac,{fontWeight:400,children:["Free: ",g.free]})}),(0,s.jsx)(x.ZP,{item:!0,textAlign:"right",children:(0,s.jsxs)(R.Ac,{children:["Total: ",g.size]})})]})]}),[g,c.values.storage,null==j?void 0:j.name,a]),P=(0,d.useMemo)(()=>r&&(0,s.jsx)(x.ZP,{item:!0,textAlign:"center",width:{xs:"100%",sm:"fit-content"},children:(0,s.jsx)(ec.Z,{sx:{color:z.s7}})}),[r]);return v?(0,s.jsxs)(V,{alignItems:"center",formik:c,children:[b,y,(0,s.jsx)(x.ZP,{item:!0,sm:!0,xs:1,children:r?(0,s.jsxs)(x.ZP,{alignItems:"center",container:!0,children:[(0,s.jsxs)(x.ZP,{item:!0,xs:!0,children:[(0,s.jsxs)(R.Ac,{children:["Disk: ",(0,s.jsx)(R.Q0,{noWrap:!0,children:r})]}),(0,s.jsxs)(R.Ac,{children:["(",(0,s.jsxs)(R.Q0,{children:["volume=",null==f?void 0:f.name]}),")"]})]}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(R.Ac,{fontWeight:400,noWrap:!0,children:null==f?void 0:f.size})})]}):(0,s.jsx)(ej.Z,{id:m.storage,label:"Storage group",name:m.storage,onChange:c.handleChange,selectItems:v,selectProps:{disabled:!!r},value:c.values.storage})}),P,(0,s.jsx)(x.ZP,{item:!0,sm:!0,xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(ev.Z,{id:"server-disk-input",label:"Disk size",inputWithLabelProps:{id:m.value,inputProps:{disabled:!c.values.storage},name:m.value},onChange:h,selectItems:ep,selectWithLabelProps:{id:m.unit,name:m.unit,onChange:e=>{let t=e.target.value,{unit:r,value:s}=c.values.size;if([t,r].includes("percent")){c.setFieldValue(m.size,{unit:t,value:"0"},!0);return}let n=(0,eu.Gh)(s,{fromUnit:r,precision:"B"===t?0:void 0,toUnit:t});if(!n)return;let{value:i}=n;c.setFieldValue(m.size,{unit:t,value:i},!0)},selectProps:{disabled:!c.values.storage},value:c.values.size.unit},value:c.values.size.value})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:u})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:n,formDisabled:Z,label:"Save"})})]}):(0,s.jsx)(O.Z,{mt:0})},ef=(0,p.Z)((0,s.jsx)("path",{d:"M5 17h14v2H5zm7-12L5.33 15h13.34z"}),"Eject"),eZ=r(48801);let eb=e=>{let{fileUuid:t}=e,{data:r}=(0,F.Z)("/file/".concat(t));if(!r)return(0,s.jsx)(O.Z,{mt:0});let{checksum:n,path:l,size:a}=r;return(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(R.$_,{children:l.full}),(0,s.jsx)(R.$_,{children:(0,eu._d)(a,{toUnit:"ibyte"})}),(0,s.jsxs)(R.$_,{children:["md5: ",n]})]})};var ey=e=>{var t;let{detail:r,device:n,tools:i}=e,l=(0,d.useMemo)(()=>r.devices.disks.find(e=>e.target.dev===n),[r.devices.disks,n]),{data:a}=(0,F.Z)("/file?name=".concat(r.anvil.name,"&type=iso"),{refreshInterval:5e3}),{disabledSubmit:o,formik:c,formikErrors:u}=(0,T.Z)({initialValues:{file:null!==(t=null==l?void 0:l.source.file.uuid)&&void 0!==t?t:null},onSubmit:(e,t)=>{_(e,t,i,()=>"/server/".concat(r.uuid,"/change-iso"),()=>"".concat(e.file?"Insert":"Eject"," ISO?"),{buildSummary:e=>{var t;let{file:r}=e,s=null==l?void 0:l.target.dev;return r?{device:s,iso:null==a?void 0:null===(t=a[r])||void 0===t?void 0:t.name}:{device:s}},buildRequestBody:(e,t)=>((null==t?void 0:t.iso)&&e.file&&(t.iso=e.file),t)})},validationSchema:J}),h=(0,d.useMemo)(()=>({file:"file"}),[]),m=(0,d.useMemo)(()=>a&&Object.values(a),[a]),v=(0,d.useMemo)(()=>{if(!a)return;let{file:e}=c.values;if(e)return a[e]},[c.values,a]);return m?(0,s.jsxs)(V,{formik:c,children:[(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsx)(eZ.Z,{disableClearable:!0,extendRenderInput:e=>{e.inputLabelProps={...e.inputLabelProps,shrink:!0},e.inputProps={...e.inputProps,notched:!0,placeholder:"Empty slot"}},getOptionLabel:e=>e.name,id:h.file,isOptionEqualToValue:(e,t)=>e.uuid===(null==t?void 0:t.uuid),label:"ISO (optical disk)",noOptionsText:"No matching ISO",onChange:(e,t)=>{c.setFieldValue(h.file,t?t.uuid:null,!0)},openOnFocus:!0,options:m,renderOption:(e,t)=>{let{name:r,uuid:n}=t;return(0,d.createElement)("li",{...e,key:"iso-op-".concat(n)},(0,s.jsx)(R.Ac,{inheritColour:!0,children:r}))},value:v})}),(0,s.jsx)(x.ZP,{item:!0,alignSelf:"center",children:(0,s.jsx)(k.Z,{onClick:()=>{c.setFieldValue(h.file,null,!0)},size:"small",children:(0,s.jsx)(ef,{})})}),c.values.file&&(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(eb,{fileUuid:c.values.file})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:u})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:r,formDisabled:o,label:"Save"})})]}):(0,s.jsx)(O.Z,{mt:0})},eP=e=>{let{detail:t,tools:r}=e,n=(0,d.useRef)(null),i=(0,d.useRef)(null),l=(0,d.useRef)(null),[a,o]=(0,d.useState)(),c=(0,d.useMemo)(()=>t.devices.disks.reduce((e,t)=>(e[t.target.dev]=t,e),{}),[t.devices.disks]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(x.ZP,{container:!0,spacing:"1em",children:[(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(ed.Z,{children:'Disk operations "shrink" or "delete" must be done through commands to avoid data loss.'})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(eo.Z,{allowAddItem:!0,header:!0,listEmpty:"No disk(s) found.",listItems:c,onAdd:()=>{o(void 0),r.add={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=n.current)||void 0===e?void 0:e.setOpen(t)}},r.add.open(!0)},renderListItem:(e,t)=>{let{device:n,source:{dev:{path:a=""},file:{path:d=""}},target:{dev:c}}=t,u=n;return/cd/.test(n)&&(u="optical"),(0,s.jsxs)(x.ZP,{alignItems:"center",columnGap:"1em",container:!0,children:[(0,s.jsxs)(x.ZP,{item:!0,xs:!0,children:[(0,s.jsxs)(y.Z,{columnSpacing:0,row:!0,rowSpacing:".5em",children:[(0,s.jsxs)(R.Ac,{noWrap:!0,children:[b()(u),":"]})," ",(0,s.jsx)(R.$_,{noWrap:!0,children:e})]}),(0,s.jsx)(R.$_,{noWrap:!0,children:a||d})]}),"optical"===u&&(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(k.Z,{onClick:()=>{o(c),r.edit={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=l.current)||void 0===e?void 0:e.setOpen(t)}},r.edit.open(!0)},size:"small",children:(0,s.jsx)(ei,{})})}),"disk"===u&&(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(k.Z,{onClick:()=>{o(c),r.edit={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=i.current)||void 0===e?void 0:e.setOpen(t)}},r.edit.open(!0)},size:"small",children:(0,s.jsx)(el,{sx:{rotate:"90deg"}})})})]})}})})]}),(0,s.jsx)(ea.Js,{header:"Add disk",ref:n,showClose:!0,wide:!0,children:(0,s.jsx)(eg,{...e})}),(0,s.jsx)(ea.Js,{header:"".concat(a,": grow disk"),ref:i,showClose:!0,wide:!0,children:a&&(0,s.jsx)(eg,{device:a,...e})}),(0,s.jsx)(ea.Js,{header:"".concat(a,": insert or eject ISO"),ref:l,showClose:!0,wide:!0,children:a&&(0,s.jsx)(ey,{device:a,...e})})]})},ew=r(13539);let eS={mac:"auto",model:"e1000e"};var e_=e=>{let{detail:t,tools:r}=e,{disabledSubmit:n,formik:i,formikErrors:l,handleChange:a}=(0,T.Z)({initialValues:{bridge:"",mac:"",model:eS.model},onSubmit:(e,s)=>{_(e,s,r,()=>"/server/".concat(t.uuid,"/add-interface"),()=>"Add interface?",{buildSummary:e=>{let t={...e};return t.mac||(t.mac=eS.mac),t},buildRequestBody:(e,t)=>{let r={};return(null==t?void 0:t.bridge)&&(r.bridge=t.bridge),(null==t?void 0:t.mac)&&t.mac!==eS.mac&&(r.mac=t.mac),(null==t?void 0:t.model)&&t.model!==eS.model&&(r.model=t.model),r}})},validationSchema:G(t)}),o=(0,d.useMemo)(()=>({bridge:"bridge",mac:"mac",model:"model"}),[]),c=(0,d.useMemo)(()=>Object.values(Object.values(t.bridges).reduce((e,t)=>{let{name:r}=t;return r in e||(e[r]={value:r}),e},{})),[t.bridges]);return(0,s.jsxs)(V,{formik:i,children:[(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ej.Z,{id:o.bridge,label:"Bridge",name:o.bridge,onChange:i.handleChange,required:!0,selectItems:c,value:i.values.bridge})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:o.mac,inputLabelProps:{shrink:!0},inputProps:{notched:!0,placeholder:"Auto generated"},label:"Mac address",name:o.mac,onChange:a,value:i.values.mac})})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(eZ.Z,{id:o.model,label:"Model",noOptionsText:"No matching model",onChange:(e,t)=>{i.setFieldValue(o.model,t,!0)},openOnFocus:!0,options:t.libvirt.nicModels,value:i.values.model})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:l})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:t,formDisabled:n,label:"Save"})})]})};let ek={down:"plug-in",up:"unplug"},eC={down:"unplugged",up:"plugged-in"};var ez=e=>{let{detail:t,tools:r}=e,n=(0,d.useRef)(null),i=(0,d.useMemo)(()=>t.devices.interfaces.reduce((e,t)=>(e[t.mac.address]=t,e),{}),[t.devices.interfaces]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.ZP,{container:!0,children:(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(eo.Z,{allowAddItem:!0,header:!0,listEmpty:"No server network interface(s) found.",listItems:i,onAdd:()=>{r.add={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=n.current)||void 0===e?void 0:e.setOpen(t)}},r.add.open(!0)},renderListItem:(e,n)=>{let{link:{state:i},model:{type:l},source:{bridge:a},target:{dev:o}}=n,d="up"===i;return(0,s.jsxs)(x.ZP,{alignItems:"center",columnGap:"1em",container:!0,children:[(0,s.jsxs)(x.ZP,{alignItems:"center",display:"flex",flexDirection:"column",item:!0,minWidth:"5em",children:[(0,s.jsx)(R.KI,{noWrap:!0,children:b()(eC[i])}),(0,s.jsx)(ew.Z,{checked:d,onChange:()=>{let{[i]:n}=ek;(0,es.Z)(r,"/server/".concat(t.uuid,"/set-interface-state"),"".concat(b()(n)," ").concat(o," (").concat(e,")?"),{body:{active:!d,mac:e},messages:{proceed:b()(n),fail:(0,s.jsxs)(s.Fragment,{children:["Failed to register ",n," interface job."]}),success:(0,s.jsxs)(s.Fragment,{children:["Successfully registered ",n," interface job"]})}})}})]}),(0,s.jsxs)(x.ZP,{item:!0,xs:!0,children:[(0,s.jsxs)(y.Z,{xs:"column",md:"row",columnSpacing:0,children:[(0,s.jsxs)(R.$_,{noWrap:!0,children:[o," (",l,")"]}),(0,s.jsx)(v.Z,{flexItem:!0,orientation:"vertical"}),(0,s.jsx)(R.$_,{noWrap:!0,children:e})]}),(0,s.jsx)(R.$_,{children:a})]}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(k.Z,{mapPreset:"delete",onClick:()=>{(0,es.Z)(r,"/server/".concat(t.uuid,"/delete-interface"),"Delete ".concat(o," (").concat(e,")?"),{body:{mac:e},messages:{proceed:"Delete",fail:(0,s.jsx)(s.Fragment,{children:"Failed to register delete interface job."}),success:(0,s.jsx)(s.Fragment,{children:"Successfully registered delete interface job"})}})},size:"small",variant:"redcontained"})})]})}})})}),(0,s.jsx)(ea.Js,{header:"Add interface",ref:n,showClose:!0,wide:!0,children:(0,s.jsx)(e_,{...e})})]})},eM=r(22700);let eA=e=>{var t,r;let{detail:n,memory:i,tools:l}=e,{disabledSubmit:a,formik:o,formikErrors:c,handleChange:u}=(0,T.Z)({initialValues:{size:{unit:"GiB",value:null!==(r=null===(t=(0,eu.Gh)(n.memory.size,{toUnit:"GiB"}))||void 0===t?void 0:t.value)&&void 0!==r?r:"0"}},onSubmit:(e,t)=>{_(e,t,l,()=>"/server/".concat(n.uuid,"/set-memory"),()=>"Set memory?",{buildSummary:e=>{let{unit:t,value:r}=e.size;return{size:"".concat(r).concat(t)}}})},validationSchema:$(i)}),h=(0,d.useMemo)(()=>{let e="size";return{size:e,unit:"".concat(e,".unit"),value:"".concat(e,".value")}},[]),m=(0,d.useMemo)(()=>{let e={toUnit:o.values.size.unit},t=(0,eu._d)(i.allocated,e);return{allocated:t,available:(0,eu._d)(i.available,e),reserved:(0,eu._d)(i.reserved,e),total:(0,eu._d)(i.total,e)}},[o.values.size.unit,i.allocated,i.available,i.reserved,i.total]);return(0,s.jsxs)(V,{formik:o,children:[(0,s.jsxs)(x.ZP,{item:!0,width:"100%",children:[(0,s.jsx)(ex._1,{memory:i}),(0,s.jsxs)(x.ZP,{container:!0,children:[(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsxs)(R.Ac,{children:["Allocated: ",m.allocated]})}),(0,s.jsx)(x.ZP,{item:!0,textAlign:"center",xs:!0,children:(0,s.jsxs)(R.Ac,{fontWeight:400,children:["Available: ",m.available]})}),(0,s.jsxs)(x.ZP,{item:!0,textAlign:"right",children:[(0,s.jsxs)(R.Ac,{children:["System: ",m.reserved]}),(0,s.jsxs)(R.Ac,{children:["Total: ",m.total]})]})]})]}),(0,s.jsx)(x.ZP,{item:!0,sm:"auto",xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(ev.Z,{id:"server-memory-input",label:"Memory",inputWithLabelProps:{id:h.value,name:h.value},onChange:u,selectItems:eh.k,selectWithLabelProps:{id:h.unit,name:h.unit,onChange:e=>{let t=e.target.value,{value:r,unit:s}=o.values.size,n=(0,eu.Gh)(r,{fromUnit:s,precision:"B"===t?0:void 0,toUnit:t});if(!n)return;let{value:i}=n;o.setFieldValue(h.size,{value:i,unit:t},!0)},value:o.values.size.unit},value:o.values.size.value})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:c})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:n,formDisabled:a,label:"Save"})})]})};var eV=e=>{let{detail:t}=e,{altData:r}=(0,F.Z)("/anvil/".concat(t.anvil.uuid,"/memory"),{mod:eM.Z,refreshInterval:5e3});return r?(0,s.jsx)(eA,{memory:r,...e}):(0,s.jsx)(O.Z,{mt:0})},eI=r(46194),eO=e=>{let{detail:t,tools:r}=e,{altData:n}=(0,F.Z)("/host?type=subnode",{mod:e=>Object.values(e).find(e=>{var r,s;return(null===(r=e.anvil)||void 0===r?void 0:r.uuid)===t.anvil.uuid&&e.shortHostName!==(null===(s=t.host)||void 0===s?void 0:s.short)})});return n?t.host?(0,s.jsxs)(x.ZP,{container:!0,spacing:"1em",children:[(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(R.Ac,{children:["Running on: ",t.host.short]})}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsxs)(eI.Z,{onClick:()=>{(0,es.Z)(r,"/server/".concat(t.uuid,"/migrate"),"Migrate ".concat(t.name," to ").concat(n.shortHostName,"?"),{body:{target:n.shortHostName},messages:{fail:(0,s.jsx)(s.Fragment,{children:"Failed to register migration job."}),proceed:"Migrate",success:(0,s.jsx)(s.Fragment,{children:"Successfully registered migration job"})}})},children:["Migrate to ",n.shortHostName]})})]}):(0,s.jsx)(ed.Z,{children:"Cannot migrate a shut off server."}):(0,s.jsx)(O.Z,{mt:0})},eF=r(87931),eD=e=>Object.values(e).reduce((e,t)=>{let{uuid:r}=t;return e[r]=(0,eF.Z)(t),e},{}),eR=r(64046),eT=r(16562);let eU=BigInt(0),eW=[{displayValue:(0,s.jsxs)(i.Z,{children:[(0,s.jsxs)(R.Ac,{inheritColour:!0,children:["Async (",(0,s.jsx)(R.Q0,{inheritColour:!0,noWrap:!0,children:"short-throw"}),")"]}),(0,s.jsx)(R.Ac,{selected:!1,children:"Replication writes are considered done when the data is in the active node's network transmit buffer."})]}),value:"short-throw"},{displayValue:(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(R.Ac,{inheritColour:!0,children:"Sync"}),(0,s.jsx)(R.Ac,{selected:!1,children:"Replication writes are considered done when the data is written to disk on the DR host."})]}),value:"sync"}],eL=e=>{let{detail:t,drs:r,tools:n}=e,[i,l]=(0,d.useState)(0),[a,o]=(0,d.useState)(!1),c=(0,d.useMemo)(()=>a&&i<100,[a,i]),u=(0,d.useMemo)(()=>"/server/".concat(t.uuid,"/set-protect"),[t.uuid]),h=(0,d.useMemo)(()=>Object.values(r).reduce((e,t)=>(Object.values(t.storage.volumeGroups).forEach(t=>{e[t.internalUuid]=t}),e),{}),[r]),m=(0,d.useMemo)(()=>Object.values(h).map(e=>e.internalUuid),[h]),v=(0,d.useMemo)(()=>Object.values(t.devices.disks).reduce((e,t)=>{let{lv:r}=t.source.dev;return r.uuid&&(e[r.uuid]=r),e},{}),[t.devices.disks]),j=(0,d.useMemo)(()=>Object.values(t.protect)[0],[t.protect]),p=(0,d.useMemo)(()=>Object.values(v).map(e=>{let{size:t}=e;if(!t)return eU;try{return BigInt(t)}catch(e){return eU}}).reduce((e,t)=>e+t,eU),[v]),{changeFieldValue:g,disabledSubmit:f,formik:Z,formikErrors:y}=(0,T.Z)({initialValues:{lvmVgUuid:null,protocol:"sync"},onSubmit:(e,t)=>{o(!1),_(e,t,n,()=>u,()=>"Update server protect config?",{buildSummary:e=>{let{lvmVgUuid:t,protocol:s}=e;if(!t)return{};let{[t]:n}=h,{[n.host]:i}=r;return{drHost:i.short,volumeGroup:"".concat(n.name," (").concat(n.internalUuid,")"),protocol:s}},buildRequestBody:e=>{let{lvmVgUuid:t,protocol:r}=e,s={operation:"protect"};return t&&(s.lvmVgUuid=t),r&&(s.protocol=r),s},onSuccess:()=>{o(!0)}})},validationSchema:X}),P=(0,d.useMemo)(()=>({lvmVgUuid:"lvmVgUuid",protocol:"protocol"}),[]);if(j){let{drUuid:e="",protocol:i,status:l}=j,{[e]:a}=r,o="connected"===l.connection;return(0,s.jsxs)(x.ZP,{alignItems:"center",container:!0,spacing:"1em",children:[(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(R.Ac,{children:[(0,s.jsx)(R.Q0,{edge:"start",noWrap:!0,children:t.name})," ","is configured to be protected by"," ",(0,s.jsx)(R.Q0,{noWrap:!0,children:a.short})," using protocol"," ",(0,s.jsx)(R.Q0,{noWrap:!0,children:i}),"."]})}),(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsx)(eT.Z,{checked:o,label:"Connection",onChange:(e,t)=>{let r=t?"connect":"disconnect",i=b()(r);(0,es.Z)(n,u,"".concat(i," the server on the protector DR host?"),{body:{operation:r},description:(0,s.jsx)(R.Ac,{children:"connect"===r?(0,s.jsx)(s.Fragment,{children:"This operation connects the server to its copy on the DR host and start streaming replication."}):(0,s.jsx)(s.Fragment,{children:"This operation disconnects the server from its copy on the DR host and stop streaming replication."})}),messages:{fail:(0,s.jsxs)(s.Fragment,{children:["Failed to register ",r," resource job."]}),proceed:i,success:(0,s.jsxs)(s.Fragment,{children:["Successfully registered ",r," resource job"]})}})}})}),(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsx)(eI.Z,{onClick:()=>{let e="update",t=b()(e);(0,es.Z)(n,u,"".concat(t," the server on the protector DR host?"),{body:{operation:e},description:(0,s.jsx)(R.Ac,{children:"This operation is a combination that connects, performs a sync, and disconnects."}),messages:{fail:(0,s.jsxs)(s.Fragment,{children:["Failed to register ",e," resource job."]}),proceed:t,success:(0,s.jsxs)(s.Fragment,{children:["Successfully registered ",e," resource job"]})}})},sx:{width:"100%"},children:"Update"})}),(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsx)(eI.Z,{background:"red",onClick:()=>{let e="remove",t=b()(e);(0,es.Z)(n,u,"".concat(t," protection for the server on the protector DR host?"),{body:{operation:e},description:(0,s.jsx)(R.Ac,{children:"This operation removes the server's copy on the DR host and thus removes the protection."}),dangerous:!0,messages:{fail:(0,s.jsxs)(s.Fragment,{children:["Failed to register ",e," protection job."]}),proceed:t,success:(0,s.jsxs)(s.Fragment,{children:["Successfully registered ",e," protection job"]})}})},sx:{width:"100%"},children:"Remove protection"})})]})}return(0,s.jsxs)(V,{formik:Z,children:[(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(eo.Z,{header:"Server disk(s)",listItems:v,renderListItem:(e,t)=>(0,s.jsxs)(x.ZP,{container:!0,children:[(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsxs)(R.Ac,{children:[(0,s.jsx)(R.Q0,{edge:"start",noWrap:!0,children:t.name})," ","(",(0,s.jsx)(R.Q0,{noWrap:!0,variant:"caption",children:t.uuid}),")"]})}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(R.Ac,{edge:"end",noWrap:!0,children:t.size&&(0,eu._d)(t.size,{toUnit:"ibyte"})})})]})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(R.Ac,{children:["Server total disk(s) size:"," ",(0,eu._d)(p,{toUnit:"ibyte"})]})}),(0,s.jsx)(x.ZP,{item:!0,xs:2,children:(0,s.jsx)(eZ.Z,{getOptionDisabled:e=>{let{[e]:t}=h;return t.free<p},getOptionLabel:e=>{let{[e]:t}=h,{[t.host]:s}=r;return"".concat(s.short," - ").concat(t.name)},id:P.lvmVgUuid,label:"Volume group",noOptionsText:"No matching volume group",onChange:(e,t)=>{g(P.lvmVgUuid,t,!0)},openOnFocus:!0,options:m,renderOption:(e,t)=>{let{[t]:n}=h,{[n.host]:i}=r,l=n.free>=p?(0,s.jsx)(s.Fragment,{children:"Sufficient space"}):(0,s.jsx)(s.Fragment,{children:"Insufficient space"});return(0,d.createElement)("li",{...e,key:"dr-op-".concat(t)},(0,s.jsxs)(x.ZP,{alignItems:"center",columnSpacing:"1em",container:!0,children:[(0,s.jsxs)(x.ZP,{item:!0,xs:!0,children:[(0,s.jsxs)(R.Ac,{edge:"start",inheritColour:!0,children:[(0,s.jsx)(R.Q0,{edge:"start",inheritColour:!0,noWrap:!0,children:i.short})," ","-"," ",(0,s.jsx)(R.Q0,{inheritColour:!0,noWrap:!0,children:n.name})]}),(0,s.jsxs)(R.Ac,{edge:"start",inheritColour:!0,children:[(0,s.jsx)(R.Q0,{edge:"start",inheritColour:!0,noWrap:!0,children:(0,eu._d)(n.free,{toUnit:"ibyte"})})," ","free"]})]}),(0,s.jsx)(x.ZP,{item:!0,children:(0,s.jsx)(R.Ac,{edge:"end",inheritColour:!0,noWrap:!0,children:l})})]}))},required:!0,value:Z.values.lvmVgUuid})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ej.Z,{id:P.protocol,label:"Protocol",name:P.protocol,onChange:Z.handleChange,required:!0,selectItems:eW,selectProps:{renderValue:e=>e},value:Z.values.protocol})}),a&&(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(eR.Z,{getLabel:e=>100===e?"Config changed.":"Changing config...",names:["dr::link","dr::protect","storage-group-member::add::".concat(Z.values.lvmVgUuid)],progress:{set:l,value:i}})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:y})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:t,formDisabled:f||c,label:"Save"})})]})};var eE=e=>{let{altData:t,error:r,loading:n}=(0,F.Z)("/host?detail=1&type=dr",{mod:eD});return n?(0,s.jsx)(O.Z,{mt:0}):t?(0,s.jsx)(eL,{drs:t,...e}):(0,s.jsxs)(ed.Z,{type:"warning",children:["Failed to get DR hosts. ",null==r?void 0:r.message]})},eN=e=>{let{detail:t,servers:r,tools:n}=e,{disabledSubmit:i,formik:l,formikErrors:a,handleChange:o}=(0,T.Z)({initialValues:{name:t.name},onSubmit:(e,r)=>{_(e,r,n,()=>"/server/".concat(t.uuid,"/rename"),()=>"Rename ".concat(t.name,"?"))},validationSchema:Q(t,r)}),c=(0,d.useMemo)(()=>({name:"name"}),[]),u=(0,d.useMemo)(()=>"shut off"!==t.state||i,[t.state,i]);return(0,s.jsxs)(V,{formik:l,children:["shut off"!==t.state&&(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(ed.Z,{children:"A server can only be renamed when it's shut off."})}),(0,s.jsx)(x.ZP,{item:!0,sm:"auto",xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:c.name,label:"Server name",name:c.name,onChange:o,required:!0,value:l.values.name})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:a})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:t,formDisabled:u,label:"Save"})})]})},eq=e=>{let{detail:t,servers:r,tools:n}=e,{disabledSubmit:i,formik:l,formikErrors:a,handleChange:o}=(0,T.Z)({initialValues:{active:t.start.active,after:t.start.after||"",delay:String(t.start.delay)},onSubmit:(e,s)=>{_(e,s,n,()=>"/server/".concat(t.uuid,"/set-start-dependency"),()=>"Set start dependency?",{buildSummary:e=>{var t;let{active:s,after:n,delay:i}=e;return s?{after:null===(t=r[n])||void 0===t?void 0:t.name,delay:"".concat(i," second(s)")}:{"stay-off":"yes"}},buildRequestBody:e=>{let{active:t,after:r,delay:s}=e;return t&&r?{after:r,delay:Number(s)}:{active:t}}})},validationSchema:Y}),c=(0,d.useMemo)(()=>({active:"active",after:"after",delay:"delay"}),[]),u=(0,d.useMemo)(()=>Object.values(r).filter(e=>e.uuid!==t.uuid),[t.uuid,r]),h=(0,d.useMemo)(()=>u.map(e=>{let{name:t,uuid:r}=e;return{displayValue:t,value:r}}),[u]);return(0,s.jsxs)(V,{formik:l,children:[(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ej.Z,{id:c.after,label:"Start after",name:c.after,onChange:l.handleChange,selectItems:h,selectProps:{disabled:!l.values.active,onClearIndicatorClick:()=>{l.setFieldValue(c.after,"",!0)}},value:l.values.after})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(ee.Z,{input:(0,s.jsx)(L.Z,{id:c.delay,inputProps:{disabled:!l.values.active||""===l.values.after},label:"Delay (seconds)",name:c.delay,onChange:o,value:l.values.delay})})}),(0,s.jsx)(x.ZP,{item:!0,xs:1,children:(0,s.jsx)(eT.Z,{checked:!l.values.active,id:c.active,label:"Stay off",name:c.active,onChange:(e,t)=>{l.setFieldValue(c.active,!t,!0)}})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(W.Z,{count:1,messages:a})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(D,{detail:t,formDisabled:i,label:"Save"})})]})},eH=r(19166),eG=r(17428),eB=r(22143),e$=r(40657);let eQ={label:"Boot order",value:"boot-order"},eJ={label:"CPU",value:"cpu"},eK={label:"Deletion",value:"deletion"},eX={label:"Disks",value:"disks"},eY={label:"General",value:"general"},e0={label:"Interfaces",value:"interfaces"},e1={label:"Memory",value:"memory"},e2={label:"Migration",value:"migration"},e4={label:"Name",value:"name"},e5={label:"Disaster recovery",value:"protect"},e3={label:"Start dependency",value:"start-dependency"},e8=(0,n.ZP)(c.$x)(e=>{let{theme:t}=e;return{width:"100%",[t.breakpoints.up("xs")]:{height:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";return"calc(".concat(e," * 0.6)")}("100vw")},[t.breakpoints.up("sm")]:{height:"6em"},[t.breakpoints.up("md")]:{height:"9em"}}});var e9=e=>{let{slotProps:t,serverUuid:r}=e,[n,i]=(0,d.useState)(eY.value),{data:l,mutate:a}=(0,F.Z)("/server"),{data:o}=(0,F.Z)("/server/".concat(r),{refreshInterval:3e3}),{confirmDialog:u,finishConfirm:h,setConfirmDialogLoading:m,setConfirmDialogOpen:p,setConfirmDialogProps:g}=(0,e$.Z)({initial:{scrollContent:!0,wide:!0}}),f=(0,d.useRef)({add:{open:()=>null},confirm:{finish:h,loading:m,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return p(e)},prepare:g},edit:{open:()=>null}});return o&&l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.s_,{children:(0,s.jsxs)(x.ZP,{container:!0,spacing:"1em",children:[(0,s.jsx)(x.ZP,{item:!0,width:{xs:"100%",sm:"14em",md:"20em"},children:(0,s.jsxs)(x.ZP,{columns:1,container:!0,spacing:"1em",children:[(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsx)(c.bC,{server:o,children:(0,s.jsx)(c.MB,{server:o,slots:{screenshotBox:(0,s.jsx)(e8,{})},...null==t?void 0:t.preview})})}),(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(eB.Z,{onChange:(e,t)=>{i(t),[e2.value,e3.value].includes(t)&&a()},orientation:"vertical",value:n,children:[(0,s.jsx)(eH.Z,{...eY,label:o.name}),(0,s.jsx)(eH.Z,{disabled:!0,icon:(0,s.jsx)(v.Z,{orientation:"horizontal",sx:{width:"100%"}}),label:""}),(0,s.jsx)(eH.Z,{...eQ}),(0,s.jsx)(eH.Z,{...eJ}),(0,s.jsx)(eH.Z,{...eX}),(0,s.jsx)(eH.Z,{...e0}),(0,s.jsx)(eH.Z,{...e1}),(0,s.jsx)(eH.Z,{...e2}),(0,s.jsx)(eH.Z,{...e4}),(0,s.jsx)(eH.Z,{...e5}),(0,s.jsx)(eH.Z,{...e3}),(0,s.jsx)(eH.Z,{...eK})]})})]})}),(0,s.jsx)(x.ZP,{display:{xs:"none",sm:"initial"},item:!0,children:(0,s.jsx)(v.Z,{orientation:"vertical"})}),(0,s.jsxs)(x.ZP,{item:!0,xs:!0,children:[(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:eY.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:eY.label})}),(0,s.jsx)(x.ZP,{container:!0,rowSpacing:"0.4em",children:[{header:"UUID",value:o.uuid},{header:"State",value:o.state},{header:"On node",value:"".concat(o.anvil.name,": ").concat(o.anvil.description)},{header:"On host",value:o.host?o.host.short:"None"}].map(e=>{let{header:t,value:r}=e;return(0,s.jsx)(x.ZP,{item:!0,width:"100%",children:(0,s.jsxs)(x.ZP,{columnSpacing:"1em",container:!0,children:[(0,s.jsx)(x.ZP,{item:!0,width:"10em",children:(0,s.jsx)(R.Ac,{children:t})}),(0,s.jsx)(x.ZP,{item:!0,xs:!0,children:(0,s.jsx)(R.$_,{children:r})})]})},"general-".concat(t))})})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:eQ.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:eQ.label})}),(0,s.jsx)(U,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:eJ.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:eJ.label})}),(0,s.jsx)(er,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:eK.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:eK.label})}),(0,s.jsx)(en,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:eX.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:eX.label})}),(0,s.jsx)(eP,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e0.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e0.label})}),(0,s.jsx)(ez,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e1.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e1.label})}),(0,s.jsx)(eV,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e2.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e2.label})}),(0,s.jsx)(eO,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e4.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e4.label})}),(0,s.jsx)(eN,{detail:o,tools:f.current,servers:l})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e5.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e5.label})}),(0,s.jsx)(eE,{detail:o,tools:f.current})]}),(0,s.jsxs)(eG.Z,{changingTabId:n,tabId:e3.value,children:[(0,s.jsx)(j.V9,{children:(0,s.jsx)(R.z,{children:e3.label})}),(0,s.jsx)(eq,{detail:o,servers:l,tools:f.current})]})]})]})}),u]}):(0,s.jsx)(j.s_,{children:(0,s.jsx)(O.Z,{mt:0})})},e7=r(92214),e6=r(72094);let te="Server",tt={preview:"".concat(te,"-preview"),fullView:"".concat(te,"-fullView")},tr=(0,n.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(tt.preview)]:{width:"25%",height:"100%",[t.breakpoints.down("md")]:{width:"100%"}},["& .".concat(tt.fullView)]:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"center"}}});var ts=()=>{var e;let t=(0,o.useRouter)(),{data:r,error:n,loading:l}=(0,F.Z)("/server"),x=(0,d.useMemo)(()=>(0,u.Z)(r,t,e=>t=>t.name===e),[t,r]),v=(0,d.useMemo)(()=>{if(!t.isReady)return"";let{view:e}=t.query;return(0,h.Z)(e)},[t.isReady,t.query]);if(l)return(0,s.jsxs)("div",{children:[(0,s.jsx)(a(),{children:(0,s.jsx)("title",{children:"Loading..."})}),(0,s.jsx)(m.Z,{}),(0,s.jsx)(e7.Z,{children:(0,s.jsx)(j.s_,{children:(0,s.jsx)(O.Z,{mt:0})})})]});if(!x)return(0,s.jsxs)("div",{children:[(0,s.jsx)(a(),{children:(0,s.jsx)("title",{children:"Server?"})}),(0,s.jsx)(m.Z,{}),(0,s.jsx)(e7.Z,{children:(0,s.jsx)(j.s_,{children:(0,s.jsxs)(ed.Z,{children:["Couldn't find server ",t.query.name||t.query.uuid,". ",null==n?void 0:n.message]})})})]});let p={vnc:(0,s.jsx)(i.Z,{className:tt.fullView,children:(0,s.jsx)(c.SJ,{node:x.anvil,onClickCloseButton:()=>{let e=(0,e6.Z)(t,"view");t.replace({query:e},void 0,{shallow:!0})},server:x})})};return(0,s.jsxs)(tr,{children:[(0,s.jsx)(a(),{children:(0,s.jsx)("title",{children:x.name})}),(0,s.jsx)(m.Z,{}),null!==(e=p[v])&&void 0!==e?e:(0,s.jsx)(e7.Z,{children:(0,s.jsx)(e9,{serverUuid:x.uuid,slotProps:{preview:{onClick:()=>{let e=(0,e6.Z)(t,"view","vnc");t.replace({query:e},void 0,{shallow:!0})}}}})})]})}},5152:function(e,t,r){e.exports=r(32602)}},function(e){e.O(0,[662,256,760,14,245,145,48,538,215,436,590,394,250,888,774,179],function(){return e(e.s=41171)}),_N_E=e.O()}]);