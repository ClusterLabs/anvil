(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{88668:function(e,t,n){var r=n(83369),i=n(90619),l=n(72385);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=l,e.exports=a},82908:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},90939:function(e,t,n){var r=n(2492),i=n(37005);e.exports=function e(t,n,l,a,o){return t===n||(null!=t&&null!=n&&(i(t)||i(n))?r(t,n,l,a,e,o):t!=t&&n!=n)}},2492:function(e,t,n){var r=n(46384),i=n(67114),l=n(18351),a=n(16096),o=n(64160),s=n(1469),u=n(44144),d=n(36719),c="[object Arguments]",h="[object Array]",m="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,f,v,g){var x=s(e),j=s(t),Z=x?h:o(e),b=j?h:o(t);Z=Z==c?m:Z,b=b==c?m:b;var y=Z==m,C=b==m,w=Z==b;if(w&&u(e)){if(!u(t))return!1;x=!0,y=!1}if(w&&!y)return g||(g=new r),x||d(e)?i(e,t,n,f,v,g):l(e,t,Z,n,f,v,g);if(!(1&n)){var A=y&&p.call(e,"__wrapped__"),O=C&&p.call(t,"__wrapped__");if(A||O){var P=A?e.value():e,k=O?t.value():t;return g||(g=new r),v(P,k,n,f,g)}}return!!w&&(g||(g=new r),a(e,t,n,f,v,g))}},74757:function(e){e.exports=function(e,t){return e.has(t)}},67114:function(e,t,n){var r=n(88668),i=n(82908),l=n(74757);e.exports=function(e,t,n,a,o,s){var u=1&n,d=e.length,c=t.length;if(d!=c&&!(u&&c>d))return!1;var h=s.get(e),m=s.get(t);if(h&&m)return h==t&&m==e;var p=-1,f=!0,v=2&n?new r:void 0;for(s.set(e,t),s.set(t,e);++p<d;){var g=e[p],x=t[p];if(a)var j=u?a(x,g,p,t,e,s):a(g,x,p,e,t,s);if(void 0!==j){if(j)continue;f=!1;break}if(v){if(!i(t,function(e,t){if(!l(v,t)&&(g===e||o(g,e,n,a,s)))return v.push(t)})){f=!1;break}}else if(!(g===x||o(g,x,n,a,s))){f=!1;break}}return s.delete(e),s.delete(t),f}},18351:function(e,t,n){var r=n(62705),i=n(11149),l=n(77813),a=n(67114),o=n(68776),s=n(21814),u=r?r.prototype:void 0,d=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,c,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!c(new i(e),new i(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return l(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var m=o;case"[object Set]":var p=1&r;if(m||(m=s),e.size!=t.size&&!p)break;var f=h.get(e);if(f)return f==t;r|=2,h.set(e,t);var v=a(m(e),m(t),r,u,c,h);return h.delete(e),v;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},16096:function(e,t,n){var r=n(58234),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,l,a,o){var s=1&n,u=r(e),d=u.length;if(d!=r(t).length&&!s)return!1;for(var c=d;c--;){var h=u[c];if(!(s?h in t:i.call(t,h)))return!1}var m=o.get(e),p=o.get(t);if(m&&p)return m==t&&p==e;var f=!0;o.set(e,t),o.set(t,e);for(var v=s;++c<d;){var g=e[h=u[c]],x=t[h];if(l)var j=s?l(x,g,h,t,e,o):l(g,x,h,e,t,o);if(!(void 0===j?g===x||a(g,x,n,l,o):j)){f=!1;break}v||(v="constructor"==h)}if(f&&!v){var Z=e.constructor,b=t.constructor;Z!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof Z&&Z instanceof Z&&"function"==typeof b&&b instanceof b)&&(f=!1)}return o.delete(e),o.delete(t),f}},68776:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},90619:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},72385:function(e){e.exports=function(e){return this.__data__.has(e)}},21814:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},18446:function(e,t,n){var r=n(90939);e.exports=function(e,t){return r(e,t)}},47037:function(e,t,n){var r=n(44239),i=n(1469),l=n(37005);e.exports=function(e){return"string"==typeof e||!i(e)&&l(e)&&"[object String]"==r(e)}},24084:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mail-config",function(){return n(95954)}])},48801:function(e,t,n){"use strict";var r=n(85893),i=n(21640),l=n(93454),a=n(77527),o=n(4989),s=n(1142),u=n(58219),d=n(35562),c=n(90642),h=n(96245),m=n(82492),p=n.n(m),f=n(67294),v=n(39971),g=n(17512),x=n(23852);let j=e=>(0,r.jsx)(i.Z,{in:!0,children:(0,r.jsx)(l.Z,{...e})}),Z=(0,a.ZP)("ul")({padding:0}),b=o.Z;t.Z=e=>{let{componentsProps:t,extendRenderInput:n,getGroupLabel:i,label:l,ListboxProps:a,messageBoxProps:o,renderGroup:m,renderInput:y,sx:C,...w}=e,A=(0,f.useMemo)(()=>p()({paper:{sx:{backgroundColor:v.s7,["& .".concat(s.Z.groupLabel)]:{backgroundColor:v.s7}}}},t),[t]),O=(0,f.useMemo)(()=>p()({sx:{["& .".concat(s.Z.option)]:{'&[aria-selected="true"]':{backgroundColor:v.lD,["&.".concat(s.Z.focused)]:{backgroundColor:v.lD}},["&.".concat(s.Z.focused)]:{backgroundColor:v.lD}}}},a),[a]),P=(0,f.useMemo)(()=>m||i&&(e=>(0,r.jsxs)("li",{children:[(0,r.jsx)(b,{component:"div",className:s.Z.groupLabel,children:i(e.group)}),(0,r.jsx)(Z,{className:s.Z.groupUl,children:e.children})]},e.key)),[i,m]),k=(0,f.useMemo)(()=>null!=y?y:e=>{let{fullWidth:t,InputProps:i,InputLabelProps:a,inputProps:o}=e,s={formControlProps:{fullWidth:t,ref:i.ref},inputLabelProps:a,inputProps:{className:i.className,endAdornment:i.endAdornment,inputProps:o,startAdornment:i.startAdornment},label:l};return null==n||n.call(null,s,e),(0,r.jsx)(x.Z,{...s})},[n,l,y]),_=(0,f.useMemo)(()=>p()({["& .".concat(u.Z.root," .").concat(s.Z.endAdornment)]:{right:"7px",["& .".concat(d.Z.root)]:{color:v.s7}}},C),[C]);return(0,r.jsxs)(c.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,r.jsx)(h.Z,{autoHighlight:!0,autoSelect:!0,PaperComponent:j,...w,ListboxProps:O,renderGroup:P,renderInput:k,slotProps:A,sx:_}),(0,r.jsx)(g.Z,{...o})]})}},73846:function(e,t,n){"use strict";var r=n(85893),i=n(67294),l=n(28937),a=n(45036),o=n(11100),s=n(18541),u=n(71108),d=n(81013),c=n(40657),h=n(5499);let m=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"==typeof e?e(...n):e};t.Z=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[p]=t,{addHeader:f,editHeader:v,entriesUrl:g,formDialogProps:x,getAddLoading:j,getDeleteErrorMessage:Z,getDeleteHeader:b,getDeletePromiseChain:y=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},getDeleteSuccessMessage:C,getEditLoading:w=e=>e,listEmpty:A,listProps:O,onItemClick:P=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},refreshInterval:k=5e3,renderAddForm:_,renderDeleteItem:M,renderEditForm:S,renderListItem:F,entryUrlPrefix:I=g}=p,D=(0,i.useRef)(null),V=(0,i.useRef)(null),{confirmDialog:E,finishConfirm:U,setConfirmDialogLoading:N,setConfirmDialogOpen:L,setConfirmDialogProps:q}=(0,c.Z)({initial:{scrollContent:!0}}),[R,T]=(0,i.useState)(!1),[H,W]=(0,i.useState)(),{data:z,mutate:K,loading:J}=(0,h.Z)(g,{refreshInterval:k}),{fetch:B,loading:X}=(0,u.Z)({onData:e=>W(e),url:I}),G=(0,i.useMemo)(()=>m(f),[f]),$=(0,i.useMemo)(()=>m(v,H),[H,v]),Q=(0,i.useMemo)(()=>({add:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==D?void 0:null===(e=D.current)||void 0===e?void 0:e.setOpen(t)}},confirm:{finish:U,loading:N,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return L(e)},prepare:q},edit:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==V?void 0:null===(e=V.current)||void 0===e?void 0:e.setOpen(t)}}}),[U,N,L,q]),{buildDeleteDialogProps:Y,checks:ee,getCheck:et,hasAllChecks:en,hasChecks:er,multipleItems:ei,resetChecks:el,setAllChecks:ea,setCheck:eo}=(0,d.Z)({list:z});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{allowCheckAll:ei,allowEdit:!0,allowItemButton:R,disableDelete:!er,edit:R,getListCheckboxProps:()=>({checked:en,onChange:(e,t)=>ea(t)}),getListItemCheckboxProps:e=>({checked:et(e),onChange:(t,n)=>eo(e,n)}),header:!0,listEmpty:A,listItems:z,loading:J,onAdd:()=>{var e;return null==D?void 0:null===(e=D.current)||void 0===e?void 0:e.setOpen(!0)},onDelete:()=>{q(Y({onProceedAppend:()=>{N(!0),Promise.all(y((e,t)=>e.map(e=>l.Z.delete("".concat(t,"/").concat(e))),ee,g)).then(()=>{U("Success",C()),K()}).catch(e=>{U("Error",Z((0,o.Z)(e)))}).finally(()=>{el()})},getConfirmDialogTitle:b,renderEntry:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return M(z,...t)}})),L(!0)},onEdit:()=>T(e=>!e),onItemClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return P((e,t)=>{var n;null==V||null===(n=V.current)||void 0===n||n.setOpen(!0),B("/".concat(t))},...t)},renderListItem:F,...O}),(0,r.jsx)(a.Js,{header:G,loading:null==j?void 0:j.call(null),ref:D,showClose:!0,...null==x?void 0:x.common,...null==x?void 0:x.add,children:_(Q)}),(0,r.jsx)(a.Js,{header:$,loading:w(X),ref:V,showClose:!0,...null==x?void 0:x.common,...null==x?void 0:x.edit,children:S(Q,H)}),E]})}},76740:function(e,t,n){"use strict";var r=n(85893),i=n(90642),l=n(19304),a=n(47407),o=n(35338),s=n(44400),u=n(5387),d=n(57882);let c=e=>{let{entry:t}=e;return(0,r.jsx)(d.$_,{whiteSpace:"nowrap",children:String(t)})},h=e=>{let{entry:t,key:n}=e;return o.JW.test(n)?(0,r.jsx)(d.PJ,{wrapper:"mono",children:String(t)}):c(e)},m=e=>{let{entry:t,hasPassword:n}=e;return["",null,void 0].some(e=>t===e)||Number.isNaN(t)?(0,r.jsx)(d.Ac,{children:"none"}):n?h(e):c(e)},p=e=>{let{depth:t,entry:n,getLabel:l,hasPassword:a,key:o,nest:c,renderValue:h}=e;return(0,r.jsxs)(u.Z,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,r.jsx)(d.Ac,{children:l({cap:s.Z,depth:t,entry:n,hasPassword:a,key:o})}),(0,r.jsx)(i.Z,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!c&&h(m,{depth:t,entry:n,hasPassword:a,key:o})})]})},f=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},v=e=>{let{depth:t=0,entries:n,getEntryLabel:i,getListProps:o,getListItemProps:s,hasPassword:u,listKey:d,maxDepth:c,renderEntry:h,renderEntryValue:m,skip:p}=e,g=[];Object.entries(n).forEach(e=>{let[n,a]=e,o=null!==a&&"object"==typeof a,d=o?null:a,x={depth:t,entry:d,hasPassword:u,key:n};p(f,x)||g.push((0,r.jsx)(l.ZP,{sx:{paddingLeft:"".concat(t,"em")},...null==s?void 0:s.call(null,x),children:h({depth:t,entry:d,getLabel:i,hasPassword:u,key:n,nest:o,renderValue:m})},"form-summary-entry-".concat(n))),o&&t<c&&g.push(v({depth:t+1,entries:a,getEntryLabel:i,hasPassword:u,listKey:n,maxDepth:c,renderEntry:h,renderEntryValue:m,skip:p}))});let x="form-summary-list-".concat(null!=d?d:"root");return(0,r.jsx)(a.Z,{dense:!0,disablePadding:!0,...null==o?void 0:o.call(null,{depth:t,entries:n,key:d}),children:g},x)};t.Z=e=>{let{entries:t,getEntryLabel:n=e=>{let{cap:t,key:n}=e;return t(n)},getListProps:r,getListItemProps:i,hasPassword:l=!1,maxDepth:a=3,renderEntry:o=p,renderEntryValue:s=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},skip:u=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)}}=e;return v({entries:t,getEntryLabel:n,getListProps:r,getListItemProps:i,hasPassword:l,maxDepth:a,renderEntry:o,renderEntryValue:s,skip:u})}},71108:function(e,t,n){"use strict";var r=n(67294),i=n(28937),l=n(11100);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{config:t,onError:n,onData:a,url:o=""}=e,[s,u]=(0,r.useState)(!1);return{fetch:(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,s="".concat(o).concat(e);s&&(u(!0),i.Z.get(s,{...t,...r}).then(e=>{let{data:t}=e;null==a||a.call(null,t)}).catch(e=>{let t=(0,l.Z)(e);null==n||n.call(null,t)}).finally(()=>{u(!1)}))},[o,t,a,n]),loading:s}}},81013:function(e,t,n){"use strict";var r=n(85893),i=n(67294),l=n(95996),a=n(76740);t.Z=e=>{let{list:t={}}=e,[n,o]=(0,i.useState)({}),s=(0,i.useMemo)(()=>Object.keys(t),[t]),u=(0,i.useMemo)(()=>Object.keys(n),[n]),d=(0,i.useMemo)(()=>u.length===s.length,[u.length,s.length]),c=(0,i.useMemo)(()=>u.length>0,[u.length]),h=(0,i.useMemo)(()=>s.length>1,[s.length]),m=(0,i.useCallback)(e=>{let{confirmDialogProps:t={},formSummaryProps:i={},getConfirmDialogTitle:l,onProceedAppend:o,renderEntry:s}=e;return{actionProceedText:"Delete",content:(0,r.jsx)(a.Z,{entries:n,maxDepth:0,renderEntry:s,...i}),onProceedAppend:o,proceedColour:"red",titleText:l(u.length),...t}},[n,u.length]),p=(0,i.useCallback)(e=>!!n[e],[n]);return{buildDeleteDialogProps:m,checklist:n,checks:u,getCheck:p,hasAllChecks:d,hasChecks:c,multipleItems:h,resetChecks:(0,i.useCallback)(()=>o({}),[]),setAllChecks:(0,i.useCallback)(e=>o(s.reduce((t,n)=>(e&&(t[n]=e),t),{})),[s]),setCheck:(0,i.useCallback)((e,t)=>o((0,l.ZP)(e,t||void 0)),[])}}},40657:function(e,t,n){"use strict";var r=n(85893),i=n(67294),l=n(47177),a=n(29873);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:t="",content:n="",titleText:o="",...s}={}}=e,u=(0,i.useRef)(null),[d,c]=(0,i.useState)({actionProceedText:t,content:n,titleText:o}),h=(0,i.useCallback)(e=>c(t=>{let{loading:n,...r}=t;return{...r,loading:e}}),[]),m=(0,i.useCallback)(e=>{var t,n;return null==u?void 0:null===(n=u.current)||void 0===n?void 0:null===(t=n.setOpen)||void 0===t?void 0:t.call(null,e)},[]),p=(0,i.useCallback)((e,t)=>c({actionProceedText:"",content:(0,r.jsx)(a.Z,{...t}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,i.useMemo)(()=>(0,r.jsx)(l.Z,{...s,...d,ref:u}),[d,s]),confirmDialogRef:u,setConfirmDialogLoading:h,setConfirmDialogOpen:m,setConfirmDialogProps:c,finishConfirm:p}}},2094:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(20512),i=n(18446),l=n.n(i),a=n(13218),o=n.n(a),s=n(47037),u=n.n(s),d=n(67294),c=n(23279),h=n.n(c),m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{wait:n=500,...r}=t;return h()(e,n,r)},p=n(46671);let f=(e,t,n)=>{let[r,...i]=u()(t)?t.split("."):t;if(!(r in e))return!1;let a=e[r],s=n[r];return o()(a)&&o()(s)&&i.length?f(a,i,s):!l()(a,s)};var v=e=>{let[t,n]=(0,d.useState)({}),[i,l]=(0,d.useState)(!1),a=(0,r.TA)({...e}),o=(0,d.useMemo)(()=>{let e=m(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.handleChange(...t),l(!1)});return function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];l(!0);let[o]=i;if(!u()(o)){let e=o.target?o.target:o.currentTarget;n(t=>(0,r.tP)(t,e.name,!0))}e(...i)}},[a.handleChange]),s=(0,d.useCallback)(e=>(0,r.u9)(t,e),[t]),c=(0,d.useCallback)(e=>f(a.values,e,a.initialValues),[a.initialValues,a.values]),h=(0,d.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(n=>(0,r.tP)(n,e,t))},[]),v=(0,d.useMemo)(()=>i||!a.dirty||!a.isValid||a.isValidating||a.isSubmitting,[i,a.dirty,a.isSubmitting,a.isValid,a.isValidating]),g=(0,d.useMemo)(()=>(0,p.Z)(a.errors,{skip:e=>!s(e)}),[a.errors,s]);return{disabledSubmit:v,formik:a,formikErrors:g,getFieldChanged:s,getFieldIsDiff:c,handleChange:o,setFieldChanged:h}}},39806:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=e=>e.reduce((e,t)=>{let{hostName:n,hostType:r,hostUUID:i,shortHostName:l}=t;return e[i]={name:n,short:l,type:r,uuid:i},e},{}),i=e=>e.reduce((e,t)=>{let{anvilDescription:n,anvilName:i,anvilUUID:l,hosts:a}=t;return e[l]={description:n,hosts:r(a),name:i,uuid:l},e},{})},95996:function(e,t,n){"use strict";n.d(t,{Um:function(){return i}});let r=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[,r,i,l]=t;void 0!==l&&(r[i]=l)},i=function(e,t){let{set:n=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let i={};return Object.keys(r).forEach(l=>{e.test(l)?n(r,i,l,t):i[l]=r[l]}),i}};t.ZP=function(e,t){let{guard:n=()=>!0,set:i=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{[e]:l,...a}=r,o={...a};return n(r,e,t)&&i(r,o,e,t),o}}},74178:function(e,t){"use strict";t.Z=(e,t)=>e&&Object.keys(e).reduce((e,n)=>({...e,[n]:t}),{})},95954:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Q}});var r=n(85893),i=n(8506),l=n(9008),a=n.n(l),o=n(25436),s=n(37906),u=n(67294),d=n(25934),c=n(42050),h=n(28937),m=n(5387),p=n(76740),f=n(11100),v=n(16310),g=n(74178),x=n(48313);let j=v.Rx().oneOf([0,1,2,3,4]),Z=v.Ry({delete:v.O7().optional(),level:j.required(),target:v.Ry({type:v.Z_().oneOf(["node","subnode"]).required(),uuid:(0,x.uI)().required()}),uuid:(0,x.uI)().optional()}),b=v.Vo(e=>v.Ry((0,g.Z)(e,Z))),y=v.Ry({alertOverrides:b,email:v.Z_().email().required(),language:v.Z_().oneOf(["en_CA"]).optional(),level:j.required(),name:v.Z_().required(),uuid:(0,x.uI)().optional()}),C=v.Vo(e=>v.Ry((0,g.Z)(e,y)));var w=n(48801),A=n(45328),O=n(37628),P=n(57882),k=n(12823);let _=[{displayValue:"Ignore",value:0},{displayValue:"Critical",value:1},{displayValue:"Warning",value:2},{displayValue:"Notice",value:3},{displayValue:"Info",value:4}];var M=e=>{let{alertOverrideTargetOptions:t,alertOverrideValueId:n,mailRecipientUuid:l,formikUtils:a}=e,o=(0,u.useMemo)(()=>null!=n?n:(0,d.Z)(),[n]),{formik:s}=a,{values:{[l]:c}}=s,{alertOverrides:{[o]:h}}=c,p=(0,u.useMemo)(()=>"".concat(l,".alertOverrides.").concat(o),[o,l]),f=(0,u.useMemo)(()=>"".concat(p,".remove"),[p]),v=(0,u.useMemo)(()=>"".concat(p,".target"),[p]),g=(0,u.useMemo)(()=>"".concat(p,".level"),[p]);return(0,r.jsxs)(i.ZP,{alignItems:"center",columns:{xs:1,sm:10},container:!0,justifyContent:"stretch",spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:6,children:(0,r.jsx)(w.Z,{getOptionLabel:e=>e.name,id:v,isOptionEqualToValue:(e,t)=>e.uuid===t.uuid,label:"Target",noOptionsText:"No node or subnode found.",onChange:(e,t)=>s.setFieldValue(v,t,!0),openOnFocus:!0,options:t,renderOption:(e,t)=>(0,u.createElement)("li",{...e,key:"".concat(t.node,"-").concat(t.uuid)},"node"===t.type?(0,r.jsxs)(m.Z,{spacing:0,children:[(0,r.jsx)(P.Ac,{inheritColour:!0,children:t.name}),(0,r.jsx)(P.KI,{inheritColour:!0,children:t.description})]}):(0,r.jsx)(P.Ac,{inheritColour:!0,paddingLeft:".6em",children:t.name})),value:h.target})}),(0,r.jsx)(i.ZP,{item:!0,flexGrow:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(O.Z,{id:g,label:"Alert level",name:g,onChange:s.handleChange,selectItems:_,value:h.level})})}),(0,r.jsx)(i.ZP,{item:!0,width:"min-content",children:(0,r.jsx)(A.Z,{mapPreset:"delete",onClick:()=>{h.uuids?s.setFieldValue(f,!0,!0):s.setValues(e=>{let t={...e},{[l]:n}=t,{[o]:r,...i}=n.alertOverrides;return n.alertOverrides={...i},t})},size:"small"})})]})},S=n(18541),F=e=>{let{alertOverrideTargetOptions:t,formikUtils:n,mailRecipientUuid:i}=e,{formik:l}=n,{values:{[i]:a}}=l,{alertOverrides:o}=a;return(0,r.jsx)(S.Z,{allowAddItem:!0,edit:!0,header:"Alert override rules",listEmpty:"No alert overrides(s)",listItems:o,onAdd:()=>{let e=(0,d.Z)();l.setValues(t=>{let n={...t},{[i]:r}=n;return r.alertOverrides={...r.alertOverrides,[e]:{level:2,target:null}},n})},renderListItem:(e,l)=>!l.remove&&(0,r.jsx)(M,{alertOverrideTargetOptions:t,alertOverrideValueId:e,formikUtils:n,mailRecipientUuid:i})})},I=n(18050),D=n(23852),V=n(2094);let E=[{displayValue:(0,r.jsxs)(m.Z,{spacing:0,children:[(0,r.jsx)(P.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Critical"}),(0,r.jsx)(P.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that could lead to imminent service interruption or unexpected loss of redundancy."})]}),value:1},{displayValue:(0,r.jsxs)(m.Z,{spacing:0,children:[(0,r.jsx)(P.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Warning"}),(0,r.jsx)(P.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that require attention from administrators, such as redundancy loss due to load shedding, hardware in pre-failure, input power loss, temperature anomalies, etc."})]}),value:2},{displayValue:(0,r.jsxs)(m.Z,{spacing:0,children:[(0,r.jsx)(P.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Notice"}),(0,r.jsx)(P.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that are generally safe to ignore, but might provide early warnings of developing issues or insight into system behaviour."})]}),value:3},{displayValue:(0,r.jsxs)(m.Z,{spacing:0,children:[(0,r.jsx)(P.Ac,{inheritColour:!0,fontWeight:"inherit",children:"Info"}),(0,r.jsx)(P.KI,{inheritColour:!0,whiteSpace:"normal",children:"Alerts that are almost always safe to ignore, but may be useful in testing and debugging."})]}),value:4}],U={1:"Critical",2:"Warning",3:"Notice",4:"Info"},N=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/alert-override",{uuid:r}=e;return r?Object.values(e.alertOverrides).reduce((e,t)=>{let{remove:i,level:l,target:a,uuids:o}=t;if(o&&e.push(...Object.keys(o).map(e=>({method:"delete",url:"".concat(n,"/").concat(e)}))),a&&!i){var s;let t=null!==(s=a.subnodes)&&void 0!==s?s:[a.uuid];e.push(...t.map(e=>({body:{hostUuid:e,level:l,mailRecipientUuid:r},method:"post",url:n})))}return e},[]):[]};var L=e=>{let{alertOverrideTargetOptions:t,mailRecipientUuid:n,previousFormikValues:l,tools:a}=e,o=(0,u.useMemo)(()=>null!=n?n:(0,d.Z)(),[n]),m=(0,V.Z)({initialValues:null!=l?l:{[o]:{alertOverrides:{},email:"",language:"en_CA",level:2,name:""}},onSubmit:(e,t)=>{let{setSubmitting:n}=t,{[o]:i}=e,s="Add",u=(0,r.jsx)(r.Fragment,{children:"Failed to add mail recipient."}),d="post",c=(0,r.jsx)(r.Fragment,{children:"Mail recipient added."}),m="Add mail recipient with the following?",v="/mail-recipient";l&&(s="Update",u=(0,r.jsx)(r.Fragment,{children:"Failed to update mail server."}),d="put",c=(0,r.jsx)(r.Fragment,{children:"Mail recipient updated."}),m="Update ".concat(i.name," with the following?"),v+="/".concat(o));let{alertOverrides:g,uuid:x,...j}=i;a.confirm.prepare({actionProceedText:s,content:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{entries:j}),(0,r.jsx)(p.Z,{entries:{alertOverrides:Object.entries(g).reduce((e,t)=>{let[n,r]=t;return r.remove||!r.target||(e[n]={level:r.level,name:r.target.name}),e},{})}})]}),onCancelAppend:()=>n(!1),onProceedAppend:async()=>{a.confirm.loading(!0);let e=e=>{let t=(0,f.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:[u," ",t.children]}),a.confirm.finish("Error",t),n(!1)};h.Z[d](v,j).then(t=>{let{data:n}=t,r={...i};n&&(r.uuid=n.uuid),Promise.all(N(r,l&&l[o]).map(e=>h.Z[e.method](e.url,e.body))).then(()=>{a.confirm.finish("Success",{children:c}),a["post"===d?"add":"edit"].open(!1)}).catch(e)}).catch(e)},titleText:m}),a.confirm.open(!0)},validationSchema:C}),{disabledSubmit:v,formik:g,formikErrors:x,handleChange:j}=m,Z=(0,u.useMemo)(()=>"".concat(o,".email"),[o]),b=(0,u.useMemo)(()=>"".concat(o,".level"),[o]),y=(0,u.useMemo)(()=>"".concat(o,".name"),[o]);return(0,r.jsxs)(i.ZP,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),g.submitForm()},spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{id:y,label:"Recipient name",name:y,onChange:j,required:!0,value:g.values[o].name})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{id:Z,label:"Recipient email",name:Z,onChange:j,required:!0,value:g.values[o].email})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(O.Z,{id:b,label:"Alert level",name:b,onChange:g.handleChange,required:!0,selectItems:E,selectProps:{MenuProps:{sx:{["& .".concat(s.Z.paper)]:{maxWidth:{md:"60%",lg:"40%"}}}},renderValue:e=>U[e]},value:g.values[o].level})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(F,{alertOverrideTargetOptions:t,formikUtils:m,mailRecipientUuid:o})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(I.Z,{count:1,messages:x})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(c.Z,{actions:[{background:"blue",children:l?"Update":"Add",disabled:v,type:"submit"}]})})]})},q=n(39806),R=n(73846),T=e=>(0,r.jsx)(L,{...e}),H=n(71108),W=n(5499),z=()=>{let[e,t]=(0,u.useState)(),{altData:n,loading:i}=(0,W.Z)("/anvil",{mod:q.Z}),l=(0,u.useMemo)(()=>n&&Object.values(n).sort((e,t)=>e.name.localeCompare(t.name)).reduce((e,t)=>{let n={description:t.description,name:t.name,node:t.uuid,subnodes:[],type:"node",uuid:t.uuid},r=Object.values(t.hosts).sort((e,t)=>e.name.localeCompare(t.name)).reduce((e,r)=>{var i;return"dr"===r.type||(e.push({name:r.name,node:t.uuid,type:"subnode",uuid:r.uuid}),null===(i=n.subnodes)||void 0===i||i.push(r.uuid)),e},[]);return e.push(n,...r),e},[]),[n]),{fetch:a,loading:o}=(0,H.Z)({onData:e=>t(e),url:"/alert-override"}),s=(0,u.useMemo)(()=>{if(n&&e)return Object.entries(Object.values(e).reduce((e,t)=>{let{node:{uuid:n}}=t;return e[n]?e[n].push(t):e[n]=[t],e},{})).reduce((e,t)=>{let[r,i]=t,[l,...a]=i;if(i.length>1&&a.every(e=>{let{level:t}=e;return t===l.level})){let{0:{level:t}}=i,{[r]:l}=n;e[r]={level:t,target:{description:l.description,name:l.name,node:l.uuid,subnodes:i.map(e=>{let{subnode:{uuid:t}}=e;return t}),type:"node",uuid:l.uuid},uuids:i.reduce((e,t)=>{let{subnode:n,uuid:r}=t;return e[r]=n.uuid,e},{})}}else i.forEach(t=>{let{level:n,node:r,subnode:i,uuid:l}=t;e[i.uuid]={level:n,target:{name:i.name,node:r.uuid,type:"subnode",uuid:i.uuid},uuids:{[l]:i.uuid}}});return e},{})},[e,n]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(R.Z,{addHeader:"Add mail recipient",editHeader:e=>"Update ".concat(null==e?void 0:e.name),entriesUrl:"/mail-recipient",getAddLoading:e=>e||i,getDeleteErrorMessage:e=>{let{children:t,...n}=e;return{...n,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete mail recipient(s). ",t]})}},getDeleteHeader:e=>"Delete the following ".concat(e," mail recipient(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted mail recipient(s)."})}),getEditLoading:e=>e||o,listEmpty:"No mail recipient(s) found.",onItemClick:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[,i]=n;e(...n),a(void 0,{params:{"mail-recipient":i}})},renderAddForm:e=>l&&(0,r.jsx)(L,{alertOverrideTargetOptions:l,tools:e}),renderDeleteItem:(e,t)=>{let{key:n}=t,i=null==e?void 0:e[n];return(0,r.jsx)(P.Ac,{children:null==i?void 0:i.name})},renderEditForm:(e,t)=>l&&t&&s&&(0,r.jsx)(T,{alertOverrideTargetOptions:l,mailRecipientUuid:t.uuid,previousFormikValues:{[t.uuid]:{alertOverrides:s,...t}},tools:e}),renderListItem:(e,t)=>{let{name:n}=t;return(0,r.jsx)(P.Ac,{children:n})}})})};let K=v.Ry({address:v.Z_().required(),authentication:v.Z_().oneOf(["none","plain-text","encrypted"]),confirmPassword:v.Z_().when("password",(e,t)=>String(e).length>0?t.required().oneOf([v.iH("password")]):t.optional()),heloDomain:v.Z_().required(),password:v.Z_().optional(),port:v.Rx().required(),security:v.Z_().oneOf(["none","starttls","tls-ssl"]),username:v.Z_().optional(),uuid:(0,x.uI)().required()}),J=v.Vo(e=>v.Ry((0,g.Z)(e,K)));var B=e=>{let{localhostDomain:t="",mailServerUuid:n,previousFormikValues:l,tools:a}=e,o=(0,u.useMemo)(()=>null!=n?n:(0,d.Z)(),[n]),{disabledSubmit:s,formik:m,formikErrors:v,handleChange:g}=(0,V.Z)({initialValues:null!=l?l:{[o]:{address:"",authentication:"none",heloDomain:t,port:587,security:"none",uuid:o}},onSubmit:(e,t)=>{let{setSubmitting:n}=t,{[o]:i}=e,s="Add",u=(0,r.jsx)(r.Fragment,{children:"Failed to add mail server."}),d="post",c=(0,r.jsx)(r.Fragment,{children:"Mail server added."}),m="Add mail server with the following?",v="/mail-server";l&&(s="Update",u=(0,r.jsx)(r.Fragment,{children:"Failed to update mail server."}),d="put",c=(0,r.jsx)(r.Fragment,{children:"Mail server updated."}),m="Update ".concat(i.address,":").concat(i.port," with the following?"),v+="/".concat(o));let{confirmPassword:g,uuid:x,...j}=i;a.confirm.prepare({actionProceedText:s,content:(0,r.jsx)(p.Z,{entries:j,hasPassword:!0}),onCancelAppend:()=>n(!1),onProceedAppend:()=>{a.confirm.loading(!0),h.Z[d](v,i).then(()=>{a.confirm.finish("Success",{children:c}),a["post"===d?"add":"edit"].open(!1)}).catch(e=>{let t=(0,f.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:[u," ",t.children]}),a.confirm.finish("Error",t),n(!1)})},titleText:m}),a.confirm.open(!0)},validationSchema:J}),x=(0,u.useMemo)(()=>"".concat(o,".address"),[o]),j=(0,u.useMemo)(()=>"".concat(o,".authentication"),[o]),Z=(0,u.useMemo)(()=>"".concat(o,".confirmPassword"),[o]),b=(0,u.useMemo)(()=>"".concat(o,".heloDomain"),[o]),y=(0,u.useMemo)(()=>"".concat(o,".password"),[o]),C=(0,u.useMemo)(()=>"".concat(o,".port"),[o]),w=(0,u.useMemo)(()=>"".concat(o,".security"),[o]),A=(0,u.useMemo)(()=>"".concat(o,".username"),[o]);return(0,r.jsxs)(i.ZP,{component:"form",onSubmit:e=>{e.preventDefault(),m.submitForm()},container:!0,columns:{xs:1,sm:2},spacing:"1em",children:[(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{id:x,label:"Server address",name:x,onChange:g,required:!0,value:m.values[o].address})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{id:C,label:"Server port",name:C,onChange:g,required:!0,type:"number",value:m.values[o].port})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(O.Z,{id:w,label:"Server security type",name:w,onChange:g,required:!0,selectItems:["none","starttls","tls-ssl"],value:m.values[o].security})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(O.Z,{id:j,label:"Server authentication method",name:j,onChange:g,required:!0,selectItems:["none","plain-text","encrypted"],value:m.values[o].authentication})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{id:b,label:"HELO domain",name:b,onChange:g,required:!0,value:m.values[o].heloDomain})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:A,label:"Server username",name:A,onChange:g,value:m.values[o].username})})}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:y,label:"Server password",name:y,onChange:g,type:"password",value:m.values[o].password})})}),(0,r.jsx)(i.ZP,{display:{xs:"none",sm:"initial"},item:!0,sm:1}),(0,r.jsx)(i.ZP,{item:!0,xs:1,children:(0,r.jsx)(k.Z,{input:(0,r.jsx)(D.Z,{disableAutofill:!0,id:Z,label:"Confirm password",name:Z,onChange:g,type:"password",value:m.values[o].confirmPassword})})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(I.Z,{count:1,messages:v})}),(0,r.jsx)(i.ZP,{item:!0,width:"100%",children:(0,r.jsx)(c.Z,{actions:[{background:"blue",children:l?"Update":"Add",disabled:s,type:"submit"}]})})]})},X=e=>(0,r.jsx)(B,{...e}),G=()=>{let{data:e,loading:t}=(0,W.Z)("/host/local");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(R.Z,{addHeader:"Add mail server",editHeader:e=>"Update ".concat(null==e?void 0:e.address,":").concat(null==e?void 0:e.port),entriesUrl:"/mail-server",getAddLoading:e=>e||t,getDeleteErrorMessage:e=>{let{children:t,...n}=e;return{...n,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete mail server(s). ",t]})}},getDeleteHeader:e=>"Delete the following ".concat(e," mail server(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted mail server(s)."})}),listEmpty:"No mail server(s) found",renderAddForm:t=>e&&(0,r.jsx)(B,{localhostDomain:e.domain,tools:t}),renderDeleteItem:(e,t)=>{let{key:n}=t,i=null==e?void 0:e[n];return(0,r.jsxs)(P.Ac,{children:[null==i?void 0:i.address,":",null==i?void 0:i.port]})},renderEditForm:(e,t)=>t&&(0,r.jsx)(X,{mailServerUuid:t.uuid,previousFormikValues:{[t.uuid]:t},tools:e}),renderListItem:(e,t)=>{let{address:n,port:i}=t;return(0,r.jsxs)(P.Ac,{children:[n,":",i]})}})})},$=n(65375),Q=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:"Mail Config"})}),(0,r.jsx)(o.Z,{}),(0,r.jsxs)(i.ZP,{container:!0,columns:{xs:1,md:6,lg:4},children:[(0,r.jsx)(i.ZP,{item:!0,xs:1}),(0,r.jsx)(i.ZP,{item:!0,xs:1,md:4,lg:2,children:(0,r.jsxs)($.s_,{children:[(0,r.jsx)($.V9,{children:(0,r.jsx)(P.z,{children:"Mail config"})}),(0,r.jsx)($.TZ,{expandInitially:!0,header:"Manage mail servers",children:(0,r.jsx)(G,{})}),(0,r.jsx)($.TZ,{expandInitially:!0,header:"Manage mail recipients",children:(0,r.jsx)(z,{})})]})})]})]})}},function(e){e.O(0,[447,256,940,245,84,558,436,716,888,774,179],function(){return e(e.s=24084)}),_N_E=e.O()}]);