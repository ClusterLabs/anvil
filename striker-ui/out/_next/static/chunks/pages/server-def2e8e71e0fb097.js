(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{41171:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/server",function(){return l(68317)}])},76740:function(e,t,l){"use strict";var r=l(85893),i=l(90642),s=l(19304),n=l(47407),a=l(35338),d=l(44400),o=l(5387),c=l(57882);let u=e=>{let{entry:t}=e;return(0,r.jsx)(c.$_,{whiteSpace:"nowrap",children:String(t)})},h=e=>{let{entry:t,key:l}=e;return a.JW.test(l)?(0,r.jsx)(c.PJ,{wrapper:"mono",children:String(t)}):u(e)},m=e=>{let{entry:t,hasPassword:l}=e;return["",null,void 0].some(e=>t===e)||Number.isNaN(t)?(0,r.jsx)(c.Ac,{children:"none"}):l?h(e):u(e)},v=e=>{let{depth:t,entry:l,getLabel:s,hasPassword:n,key:a,nest:u,renderValue:h}=e;return(0,r.jsxs)(o.Z,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,r.jsx)(c.Ac,{children:s({cap:d.Z,depth:t,entry:l,hasPassword:n,key:a})}),(0,r.jsx)(i.Z,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!u&&h(m,{depth:t,entry:l,hasPassword:n,key:a})})]})},x=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},j=e=>{let{depth:t=0,entries:l,getEntryLabel:i,getListProps:a,getListItemProps:d,hasPassword:o,listKey:c,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:v}=e,f=[];Object.entries(l).forEach(e=>{let[l,n]=e,a=null!==n&&"object"==typeof n,c=a?null:n,p={depth:t,entry:c,hasPassword:o,key:l};v(x,p)||f.push((0,r.jsx)(s.ZP,{sx:{paddingLeft:"".concat(t,"em")},...null==d?void 0:d.call(null,p),children:h({depth:t,entry:c,getLabel:i,hasPassword:o,key:l,nest:a,renderValue:m})},"form-summary-entry-".concat(l))),a&&t<u&&f.push(j({depth:t+1,entries:n,getEntryLabel:i,hasPassword:o,listKey:l,maxDepth:u,renderEntry:h,renderEntryValue:m,skip:v}))});let p="form-summary-list-".concat(null!=c?c:"root");return(0,r.jsx)(n.Z,{dense:!0,disablePadding:!0,...null==a?void 0:a.call(null,{depth:t,entries:l,key:c}),children:f},p)};t.Z=e=>{let{entries:t,getEntryLabel:l=e=>{let{cap:t,key:l}=e;return t(l)},getListProps:r,getListItemProps:i,hasPassword:s=!1,maxDepth:n=3,renderEntry:a=v,renderEntryValue:d=function(e){for(var t=arguments.length,l=Array(t>1?t-1:0),r=1;r<t;r++)l[r-1]=arguments[r];return e(...l)},skip:o=function(e){for(var t=arguments.length,l=Array(t>1?t-1:0),r=1;r<t;r++)l[r-1]=arguments[r];return e(...l)}}=e;return j({entries:t,getEntryLabel:l,getListProps:r,getListItemProps:i,hasPassword:s,maxDepth:n,renderEntry:a,renderEntryValue:d,skip:o})}},61347:function(e,t,l){"use strict";l.d(t,{w:function(){return d}});var r=l(77527),i=l(55730),s=l(42048),n=l(73490),a=l(39971);let d={draggable:"".concat("DragDataGrid","-draggable")},o=(0,r.ZP)(s._)({color:a.s7,["& .".concat(i.Z.root)]:{color:"inherit"},["& .".concat(n._.cell)]:{"&:focus":{outline:"none"},"&:focus-within":{outline:"none"}},["& .".concat(n._.row)]:{["&.".concat(d.draggable,":hover")]:{cursor:"grab",["& .".concat(n._.cell," p")]:{cursor:"auto"}}}});t.Z=o},92214:function(e,t,l){"use strict";var r=l(85893),i=l(8506);t.Z=e=>{let{children:t}=e;return(0,r.jsxs)(i.ZP,{columns:{lg:8,xs:1},container:!0,children:[(0,r.jsx)(i.ZP,{item:!0,xs:1}),(0,r.jsx)(i.ZP,{item:!0,lg:6,xs:1,children:t}),(0,r.jsx)(i.ZP,{item:!0,xs:1})]})}},16562:function(e,t,l){"use strict";var r=l(85893),i=l(77527),s=l(50385),n=l(13539),a=l(67294),d=l(39971),o=l(57882);let c=(0,i.ZP)(s.Z)({height:"3.5em",marginLeft:0,width:"100%"});t.Z=e=>{let{baseInputProps:t,checked:l,formControlLabelProps:i,id:s,label:u,name:h,onChange:m,switchProps:v}=e,x=(0,a.useMemo)(()=>"string"==typeof u?(0,r.jsx)(o.Ac,{inheritColour:!0,color:"".concat(d.s7,"AF"),children:u}):(0,r.jsx)(r.Fragment,{children:u}),[u]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c,{componentsProps:{typography:{flexGrow:1}},control:(0,r.jsx)(n.Z,{checked:l,edge:"end",name:h,onChange:m,...v}),label:x,labelPlacement:"start",...i}),(0,r.jsx)("input",{checked:l,hidden:!0,id:s,readOnly:!0,...t})]})}},19166:function(e,t,l){"use strict";var r=l(85893),i=l(77527),s=l(58918),n=l(80483),a=l(67294),d=l(39971),o=l(57882);let c=(0,i.ZP)(s.Z)({borderRadius:d.n_,color:d.s7,padding:".4em .8em",textTransform:"none",["&.".concat(n.Z.selected)]:{color:d.Ej}});t.Z=e=>{let{label:t,...l}=e,i=(0,a.useMemo)(()=>"string"==typeof t?(0,r.jsx)(o.Ac,{inheritColour:!0,children:t}):t,[t]);return(0,r.jsx)(c,{label:i,...l})}},17428:function(e,t,l){"use strict";var r=l(85893),i=l(90642),s=l(67294);t.Z=e=>{let{changingTabId:t,children:l,retain:n=!1,tabId:a}=e,d=(0,s.useMemo)(()=>t===a,[t,a]),o=(0,s.useMemo)(()=>n?(0,r.jsx)(i.Z,{sx:{display:d?"initial":"none"},children:l}):d&&l,[l,d,n]);return(0,r.jsx)(r.Fragment,{children:o})}},22143:function(e,t,l){"use strict";var r=l(85893),i=l(77527),s=l(14221),n=l(93465),a=l(80483),d=l(18745),o=l(89540),c=l(67294),u=l(39971);let h="1.8em",m=(0,i.ZP)(s.Z)({minHeight:"1em",["&.".concat(n.Z.vertical)]:{minHeight:h,["& .".concat(a.Z.root)]:{alignItems:"flex-start",minHeight:h,paddingLeft:"2em"},["& .".concat(n.Z.indicator)]:{right:"initial"}},["& .".concat(a.Z.root)]:{minHeight:"1em"},["& .".concat(n.Z.indicator)]:{backgroundColor:u.Ej,borderRadius:u.n_}});t.Z=e=>{let{orientation:t,variant:l="fullWidth",...i}=e,s=(0,d.Z)(),n=(0,c.useCallback)(e=>s.breakpoints.up(e),[s]),a=(0,o.Z)(n("xs")),u=(0,o.Z)(n("sm")),h=(0,o.Z)(n("md")),v=(0,o.Z)(n("lg")),x=(0,o.Z)(n("xl")),j=(0,c.useMemo)(()=>[["xs",a],["sm",u],["md",h],["lg",v],["xl",x]],[v,h,u,x,a]),f=(0,c.useMemo)(()=>{let e;return"object"==typeof t?j.some(l=>{let[r,i]=l;return i&&t[r]&&(e=t[r]),!i}):e=t,e},[j,t]);return(0,r.jsx)(m,{orientation:f,variant:l,...i})}},72094:function(e,t){"use strict";t.Z=(e,t,l)=>{let r;let{query:i}=e;if(void 0===l){let{[t]:e,...l}=i;r=l}else r={...i,[t]:l};return r}},83688:function(e,t,l){"use strict";var r=l(54743),i=l(85893);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"}),"Fullscreen")},55751:function(e,t,l){"use strict";var r=l(54743),i=l(85893);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"}),"Keyboard")},86142:function(e,t,l){"use strict";var r=l(54743),i=l(85893);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},37737:function(e,t,l){"use strict";var r=l(54743),i=l(85893);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNew")},10617:function(e,t,l){"use strict";var r=l(54743),i=l(85893);t.Z=(0,r.Z)((0,i.jsx)("path",{d:"M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"}),"PowerSettingsNewOutlined")},32602:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{default:function(){return a},noSSR:function(){return n}});let r=l(38754);l(85893),l(67294);let i=r._(l(35491));function s(e){return{default:(null==e?void 0:e.default)||e}}function n(e,t){return delete t.webpack,delete t.modules,e(t)}function a(e,t){let l=i.default,r={loading:e=>{let{error:t,isLoading:l,pastDelay:r}=e;return null}};e instanceof Promise?r.loader=()=>e:"function"==typeof e?r.loader=e:"object"==typeof e&&(r={...r,...e});let a=(r={...r,...t}).loader;return(r.loadableGenerated&&(r={...r,...r.loadableGenerated},delete r.loadableGenerated),"boolean"!=typeof r.ssr||r.ssr)?l({...r,loader:()=>null!=a?a().then(s):Promise.resolve(s(()=>null))}):(delete r.webpack,delete r.modules,n(l,r))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1159:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return r}});let r=l(38754)._(l(67294)).default.createContext(null)},35491:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let r=l(38754)._(l(67294)),i=l(1159),s=[],n=[],a=!1;function d(e){let t=e(),l={loading:!0,loaded:null,error:null};return l.promise=t.then(e=>(l.loading=!1,l.loaded=e,e)).catch(e=>{throw l.loading=!1,l.error=e,e}),l}class o{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function c(e){return function(e,t){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),s=null;function d(){if(!s){let t=new o(e,l);s={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return s.promise()}if(!a){let e=l.webpack?l.webpack():l.modules;e&&n.push(t=>{for(let l of e)if(t.includes(l))return d()})}function c(e,t){!function(){d();let e=r.default.useContext(i.LoadableContext);e&&Array.isArray(l.modules)&&l.modules.forEach(t=>{e(t)})}();let n=r.default.useSyncExternalStore(s.subscribe,s.getCurrentValue,s.getCurrentValue);return r.default.useImperativeHandle(t,()=>({retry:s.retry}),[]),r.default.useMemo(()=>{var t;return n.loading||n.error?r.default.createElement(l.loading,{isLoading:n.loading,pastDelay:n.pastDelay,timedOut:n.timedOut,error:n.error,retry:s.retry}):n.loaded?r.default.createElement((t=n.loaded)&&t.default?t.default:t,e):null},[e,n])}return c.preload=()=>d(),c.displayName="LoadableComponent",r.default.forwardRef(c)}(d,e)}function u(e,t){let l=[];for(;e.length;){let r=e.pop();l.push(r(t))}return Promise.all(l).then(()=>{if(e.length)return u(e,t)})}c.preloadAll=()=>new Promise((e,t)=>{u(s).then(e,t)}),c.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let l=()=>(a=!0,t());u(n,e).then(l,l)})),window.__NEXT_PRELOADREADY=c.preloadReady;let h=c},68317:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eY}});var r=l(85893),i=l(77527),s=l(90642),n=l(9008),a=l.n(n),d=l(11163),o=l(67294),c=l(45842),u=l(25436),h=l(8506),m=l(82092),v=l(65375),x=l(54743),j=(0,x.Z)((0,r.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),f=(0,x.Z)((0,r.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),p=l(48403),g=l.n(p),b=l(5387),Z=l(66389),y=l(76740),P=l(11100),w=function(e,t,l,i,s){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},{setSubmitting:a}=t,{buildRequestBody:d,buildSummary:o,onSuccess:c}=n,u=null==o?void 0:o.call(null,e);l.confirm.prepare({actionProceedText:"Save",content:(0,r.jsx)(y.Z,{entries:null!=u?u:e}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{var t;l.confirm.loading(!0);let s=null==d?void 0:d.call(null,e,u);Z.Z.put(i(),null!==(t=null!=s?s:u)&&void 0!==t?t:e).then(()=>{l.confirm.finish("Success",{children:(0,r.jsx)(r.Fragment,{children:"Successfully registered server update job"})}),null==c||c.call(null),l.add.open(!1),l.edit.open(!1)}).catch(e=>{let t=(0,P.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to register server update job. ",t.children]}),l.confirm.finish("Error",t),a(!1)})},titleText:s()}),l.confirm.open(!0)},_=l(45328),k=l(73490),S=l(39971),z=l(61347);let C=(0,i.ZP)(z.Z)({["& .".concat(k._.row)]:{"&:hover":{cursor:"pointer"},"&.Mui-selected":{[".".concat(k._.cell,":first-child")]:{borderLeft:"thick solid ".concat(S.Ej)}},[".".concat(k._.cell,":first-child")]:{borderLeft:"thick solid ".concat(S.s7)}}});var M=function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];let[i]=t,{children:s,formik:n,...a}=i;return(0,r.jsx)(h.ZP,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),n.handleSubmit(e)},spacing:"1em",...a,children:s})},I=l(42050),V=l(90209),A=l(5499),O=e=>{let{detail:t,formDisabled:l,label:i}=e,{data:s}=(0,A.Z)("/job?name=".concat(t.uuid,"::update"),{refreshInterval:2e3}),n=(0,o.useMemo)(()=>!s||l||Object.keys(s).length>0,[l,s]);return s?(0,r.jsx)(I.Z,{actions:[{background:"blue",children:i,disabled:n,type:"submit"}]}):(0,r.jsx)(V.Z,{mt:0})},F=l(57882),R=l(2094),D=e=>{let{detail:t,tools:l}=e,[i,s]=(0,o.useState)(),n=(0,o.useMemo)(()=>{let[,...e]=t.devices.diskOrderBy.boot;return e},[t.devices.diskOrderBy.boot]),{disabledSubmit:a,formik:d}=(0,R.Z)({initialValues:{order:n},onSubmit:(e,r)=>{w(e,r,l,()=>"/server/".concat(t.uuid,"/set-boot-order"),()=>"Set boot order?",{buildSummary:e=>({order:e.order.map(e=>{let{[e]:{target:{dev:l}}}=t.devices.disks;return l})})})}}),c=(0,o.useMemo)(()=>({order:"order"}),[]),u=(0,o.useMemo)(()=>void 0===i?-1:d.values.order.indexOf(i),[d.values.order,i]),m=(0,o.useMemo)(()=>u<1,[u]),v=(0,o.useMemo)(()=>{let e=d.values.order.length-1;return u<0||u>=e},[d.values.order.length,u]),x=(0,o.useMemo)(()=>d.values.order.map(e=>{let{[e]:{device:l,source:{dev:{path:r=""},file:{path:i=""}},target:{dev:s}}}=t.devices.disks;return{dev:s,index:e,name:l,source:r||i}}),[t.devices.disks,d.values.order]),p=(0,o.useMemo)(()=>[{field:"name",flex:0,headerName:"Name",renderCell:e=>{let{value:t}=e,l=t;return/cdrom/.test(t)&&(l="optical"),l=g()(l)},sortable:!1},{field:"dev",flex:0,headerName:"Device",renderCell:e=>{let{value:t}=e;return(0,r.jsx)(F.$_,{noWrap:!0,children:t})},sortable:!1},{field:"source",flex:1,headerName:"Source",renderCell:e=>{let{value:t}=e;return(0,r.jsx)(F.$_,{noWrap:!0,textOverflow:"ellipsis",children:t})},sortable:!1}],[]);return(0,r.jsxs)(M,{formik:d,children:[(0,r.jsx)(h.ZP,{item:!0,alignSelf:"center",children:(0,r.jsxs)(b.Z,{spacing:".6em",children:[(0,r.jsx)(_.Z,{disabled:m,onClick:()=>{let{order:e}=d.values;if(m)return;let t=u-1,{[t]:l,[u]:r}=e,i=[...e];i.splice(t,2,r,l),d.setFieldValue(c.order,i,!0)},children:(0,r.jsx)(j,{fontSize:"small"})}),(0,r.jsx)(_.Z,{disabled:v,onClick:()=>{let{order:e}=d.values;if(v)return;let t=u+1,{[u]:l,[t]:r}=e,i=[...e];i.splice(u,2,r,l),d.setFieldValue(c.order,i,!0)},children:(0,r.jsx)(f,{fontSize:"small"})})]})}),(0,r.jsx)(h.ZP,{item:!0,flexGrow:1,children:(0,r.jsx)(C,{autoHeight:!0,columns:p,disableColumnMenu:!0,getRowId:e=>e.index,hideFooter:!0,onSelectionModelChange:e=>{let[t]=e;s(Number(t))},rows:x})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:t,formDisabled:a,label:"Save"})})]})},N=l(18050),T=l(23852),L=l(16310),E=l(43267),W=l(48313),H=e=>L.Ry({size:L.nK().when(["storage"],(t,l)=>{let[r]=t,i=null==e?void 0:e.storageGroups[r];return i?(0,E.BQ)(i.free):l}),storage:(0,W.uI)()}),G=e=>L.Ry({bridge:L.Z_().required(),mac:(0,W.Cm)().notOneOf([...e.devices.interfaces.map(e=>e.mac.address),...Object.values(e.bridges).map(e=>e.mac)],"${path} already exists"),model:L.Z_().nullable()}),q=e=>{let{available:t}=e;return L.Ry({size:(0,E.xJ)(t)})},B=(e,t)=>L.Ry({name:(0,E.RN)(e.uuid,t)});let U=L.Ry({file:(0,W.uI)().nullable()}),$=L.Ry({cores:L.Rx().min(1).required(),sockets:L.Rx().min(1).required()}),J=L.Ry({after:L.Z_(),delay:L.Rx().min(0)});var K=l(12823);let Q=e=>{let{cpu:t,detail:l,tools:i}=e,{topology:s}=l.cpu,{disabledSubmit:n,formik:a,formikErrors:d,handleChange:c}=(0,R.Z)({initialValues:{clusters:String(s.clusters),cores:String(s.cores),dies:String(s.dies),sockets:String(s.sockets),threads:String(s.threads)},onSubmit:(e,t)=>{w(e,t,i,()=>"/server/".concat(l.uuid,"/set-cpu"),()=>"Set CPU?",{buildSummary:e=>({cores:Number(e.cores),sockets:Number(e.sockets)})})},validationSchema:$}),u=(0,o.useMemo)(()=>({cores:"cores",sockets:"sockets"}),[]);return(0,r.jsxs)(M,{formik:a,children:[(0,r.jsxs)(h.ZP,{item:!0,width:"100%",children:[(0,r.jsxs)(F.Ac,{children:["Model: ",Object.values(t.hosts)[0].model]}),(0,r.jsxs)(F.Ac,{children:["Available cores: ",t.cores]})]}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(T.Z,{id:u.cores,label:"Cores",name:u.cores,onChange:c,required:!0,value:a.values.cores})})}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(T.Z,{id:u.sockets,label:"Sockets",name:u.sockets,onChange:c,required:!0,value:a.values.sockets})})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:d})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:l,formDisabled:n,label:"Save"})})]})};var X=e=>{let{detail:t}=e,{data:l}=(0,A.Z)("/anvil/".concat(t.anvil.uuid,"/cpu"),{refreshInterval:5e3});return l?(0,r.jsx)(Q,{cpu:l,...e}):(0,r.jsx)(V.Z,{mt:0})},Y=(0,x.Z)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14.5c-2.49 0-4.5-2.01-4.5-4.5S9.51 7.5 12 7.5s4.5 2.01 4.5 4.5-2.01 4.5-4.5 4.5zm0-5.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"}),"Album"),ee=(0,x.Z)((0,r.jsx)("path",{d:"M4 20h16v2H4zM4 2h16v2H4zm9 7h3l-4-4-4 4h3v6H8l4 4 4-4h-3z"}),"Expand"),et=l(45036),el=l(18541),er=l(29873),ei=l(53839),es=l(54490),en=l(4615),ea=l(60665),ed=l(41373),eo=l(52257),ec=l(37628);let eu=[...en.k,{displayValue:"%",value:"percent"}];var eh=e=>{var t;let{device:l,detail:i,tools:s}=e,n=(0,o.useMemo)(()=>i.devices.disks.find(e=>e.target.dev===l),[i.devices.disks,l]),{altData:a}=(0,A.Z)("/anvil/".concat(i.anvil.uuid,"/store"),{mod:ea.Z,refreshInterval:5e3}),{disabledSubmit:d,formik:c,formikErrors:u,handleChange:m}=(0,R.Z)({initialValues:{size:{unit:"GiB",value:"0"},storage:null!==(t=null==n?void 0:n.source.dev.sg)&&void 0!==t?t:""},onSubmit:(e,t)=>{w(e,t,s,()=>"/server/".concat(i.uuid,"/").concat(l?"grow-disk":"add-disk"),()=>"Add disk on ".concat(null==a?void 0:a.storageGroups[e.storage].name,"?"),{buildSummary:e=>{let{size:t,storage:r}=e,{unit:i,value:s}=t,n=/percent/i.test(i)?"%":i;return l?{device:l,size:"".concat(s).concat(n)}:{size:"".concat(s).concat(n),storage:null==a?void 0:a.storageGroups[r].name}},buildRequestBody:(e,t)=>((null==t?void 0:t.storage)&&(t.storage=e.storage),t)})},validationSchema:H(a)}),v=(0,o.useMemo)(()=>{let e="size";return{size:e,storage:"storage",unit:"".concat(e,".unit"),value:"".concat(e,".value")}},[]),x=(0,o.useMemo)(()=>a&&Object.values(a.storageGroups).map(e=>({displayValue:e.name,value:e.uuid})),[a]),j=(0,o.useMemo)(()=>{if(a)return a.storageGroups[c.values.storage]},[c.values,a]),f=(0,o.useMemo)(()=>{let{unit:e}=c.values.size;return"percent"===e?"GiB":e},[c.values.size]),p=(0,o.useMemo)(()=>{if(!j)return;let e={toUnit:f};return{free:(0,es._d)(j.free,e),size:(0,es._d)(j.size,e),used:(0,es._d)(j.used,e)}},[f,j]),g=(0,o.useMemo)(()=>{if(!n)return;let{name:e="",size:t}=n.source.dev.lv;if(t)return{name:e,size:(0,es._d)(t,{toUnit:f}),zero:/_0$/.test(e)}},[f,n]),b=(0,o.useMemo)(()=>"shut off"!==i.state&&(null==g?void 0:g.zero)||d,[i.state,null==g?void 0:g.zero,d]),Z=(0,o.useMemo)(()=>{if("shut off"!==i.state&&(null==g?void 0:g.zero))return(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(er.Z,{children:"A server must be shut off in order to grow its disk 0."})})},[i.state,null==g?void 0:g.zero]),y=(0,o.useMemo)(()=>p&&a&&(0,r.jsxs)(h.ZP,{item:!0,width:"100%",children:[(0,r.jsxs)(F.Ac,{children:["Storage group: ",(0,r.jsx)(F.Q0,{noWrap:!0,children:null==j?void 0:j.name})]}),(0,r.jsx)(ed.Tj,{storages:a,target:c.values.storage}),(0,r.jsxs)(h.ZP,{container:!0,children:[(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsxs)(F.Ac,{children:["Used: ",p.used]})}),(0,r.jsx)(h.ZP,{item:!0,textAlign:"center",xs:!0,children:(0,r.jsxs)(F.Ac,{fontWeight:400,children:["Free: ",p.free]})}),(0,r.jsx)(h.ZP,{item:!0,textAlign:"right",children:(0,r.jsxs)(F.Ac,{children:["Total: ",p.size]})})]})]}),[p,c.values.storage,null==j?void 0:j.name,a]),P=(0,o.useMemo)(()=>l&&(0,r.jsx)(h.ZP,{item:!0,textAlign:"center",width:{xs:"100%",sm:"fit-content"},children:(0,r.jsx)(ei.Z,{sx:{color:S.s7}})}),[l]);return x?(0,r.jsxs)(M,{alignItems:"center",formik:c,children:[Z,y,(0,r.jsx)(h.ZP,{item:!0,sm:!0,xs:1,children:l?(0,r.jsxs)(h.ZP,{alignItems:"center",container:!0,children:[(0,r.jsxs)(h.ZP,{item:!0,xs:!0,children:[(0,r.jsxs)(F.Ac,{children:["Disk: ",(0,r.jsx)(F.Q0,{noWrap:!0,children:l})]}),(0,r.jsxs)(F.Ac,{children:["(",(0,r.jsxs)(F.Q0,{children:["volume=",null==g?void 0:g.name]}),")"]})]}),(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsx)(F.Ac,{fontWeight:400,noWrap:!0,children:null==g?void 0:g.size})})]}):(0,r.jsx)(ec.Z,{id:v.storage,label:"Storage group",name:v.storage,onChange:c.handleChange,selectItems:x,selectProps:{disabled:!!l},value:c.values.storage})}),P,(0,r.jsx)(h.ZP,{item:!0,sm:!0,xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(eo.Z,{id:"server-disk-input",label:"Disk size",inputWithLabelProps:{id:v.value,inputProps:{disabled:!c.values.storage},name:v.value},onChange:m,selectItems:eu,selectWithLabelProps:{id:v.unit,name:v.unit,onChange:e=>{let t=e.target.value,{unit:l,value:r}=c.values.size;if([t,l].includes("percent")){c.setFieldValue(v.size,{unit:t,value:"0"},!0);return}let i=(0,es.Gh)(r,{fromUnit:l,precision:"B"===t?0:void 0,toUnit:t});if(!i)return;let{value:s}=i;c.setFieldValue(v.size,{unit:t,value:s},!0)},selectProps:{disabled:!c.values.storage},value:c.values.size.unit},value:c.values.size.value})})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:u})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:i,formDisabled:b,label:"Save"})})]}):(0,r.jsx)(V.Z,{mt:0})},em=(0,x.Z)((0,r.jsx)("path",{d:"M5 17h14v2H5zm7-12L5.33 15h13.34z"}),"Eject"),ev=l(48801);let ex=e=>{let{fileUuid:t}=e,{data:l}=(0,A.Z)("/file/".concat(t));if(!l)return(0,r.jsx)(V.Z,{mt:0});let{checksum:i,path:n,size:a}=l;return(0,r.jsxs)(s.Z,{children:[(0,r.jsx)(F.$_,{children:n.full}),(0,r.jsx)(F.$_,{children:(0,es._d)(a,{toUnit:"ibyte"})}),(0,r.jsxs)(F.$_,{children:["md5: ",i]})]})};var ej=e=>{var t;let{detail:l,device:i,tools:s}=e,n=(0,o.useMemo)(()=>l.devices.disks.find(e=>e.target.dev===i),[l.devices.disks,i]),{data:a}=(0,A.Z)("/file?name=".concat(l.anvil.name,"&type=iso"),{refreshInterval:5e3}),{disabledSubmit:d,formik:c,formikErrors:u}=(0,R.Z)({initialValues:{file:null!==(t=null==n?void 0:n.source.file.uuid)&&void 0!==t?t:null},onSubmit:(e,t)=>{w(e,t,s,()=>"/server/".concat(l.uuid,"/change-iso"),()=>"".concat(e.file?"Insert":"Eject"," ISO?"),{buildSummary:e=>{var t;let{file:l}=e,r=null==n?void 0:n.target.dev;return l?{device:r,iso:null==a?void 0:null===(t=a[l])||void 0===t?void 0:t.name}:{device:r}},buildRequestBody:(e,t)=>((null==t?void 0:t.iso)&&e.file&&(t.iso=e.file),t)})},validationSchema:U}),m=(0,o.useMemo)(()=>({file:"file"}),[]),v=(0,o.useMemo)(()=>a&&Object.values(a),[a]),x=(0,o.useMemo)(()=>{if(!a)return;let{file:e}=c.values;if(e)return a[e]},[c.values,a]);return v?(0,r.jsxs)(M,{formik:c,children:[(0,r.jsx)(h.ZP,{item:!0,xs:!0,children:(0,r.jsx)(ev.Z,{disableClearable:!0,extendRenderInput:e=>{e.inputLabelProps={...e.inputLabelProps,shrink:!0},e.inputProps={...e.inputProps,notched:!0,placeholder:"Empty slot"}},getOptionLabel:e=>e.name,id:m.file,isOptionEqualToValue:(e,t)=>e.uuid===(null==t?void 0:t.uuid),label:"ISO (optical disk)",noOptionsText:"No matching ISO",onChange:(e,t)=>{c.setFieldValue(m.file,t?t.uuid:null,!0)},openOnFocus:!0,options:v,renderOption:(e,t)=>{let{name:l,uuid:i}=t;return(0,o.createElement)("li",{...e,key:"iso-op-".concat(i)},(0,r.jsx)(F.Ac,{inheritColour:!0,children:l}))},value:x})}),(0,r.jsx)(h.ZP,{item:!0,alignSelf:"center",children:(0,r.jsx)(_.Z,{onClick:()=>{c.setFieldValue(m.file,null,!0)},size:"small",children:(0,r.jsx)(em,{})})}),c.values.file&&(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(ex,{fileUuid:c.values.file})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:u})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:l,formDisabled:d,label:"Save"})})]}):(0,r.jsx)(V.Z,{mt:0})},ef=e=>{let{detail:t,tools:l}=e,i=(0,o.useRef)(null),s=(0,o.useRef)(null),n=(0,o.useRef)(null),[a,d]=(0,o.useState)(),c=(0,o.useMemo)(()=>t.devices.disks.reduce((e,t)=>(e[t.target.dev]=t,e),{}),[t.devices.disks]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(h.ZP,{container:!0,spacing:"1em",children:[(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(er.Z,{children:'Disk operations "shrink" or "delete" must be done through commands to avoid data loss.'})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(el.Z,{allowAddItem:!0,header:!0,listEmpty:"No disk(s) found.",listItems:c,onAdd:()=>{d(void 0),l.add={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=i.current)||void 0===e?void 0:e.setOpen(t)}},l.add.open(!0)},renderListItem:(e,t)=>{let{device:i,source:{dev:{path:a=""},file:{path:o=""}},target:{dev:c}}=t,u=i;return/cd/.test(i)&&(u="optical"),(0,r.jsxs)(h.ZP,{alignItems:"center",columnGap:"1em",container:!0,children:[(0,r.jsxs)(h.ZP,{item:!0,xs:!0,children:[(0,r.jsxs)(b.Z,{columnSpacing:0,row:!0,rowSpacing:".5em",children:[(0,r.jsxs)(F.Ac,{noWrap:!0,children:[g()(u),":"]})," ",(0,r.jsx)(F.$_,{noWrap:!0,children:e})]}),(0,r.jsx)(F.$_,{noWrap:!0,children:a||o})]}),"optical"===u&&(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsx)(_.Z,{onClick:()=>{d(c),l.edit={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=n.current)||void 0===e?void 0:e.setOpen(t)}},l.edit.open(!0)},size:"small",children:(0,r.jsx)(Y,{})})}),"disk"===u&&(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsx)(_.Z,{onClick:()=>{d(c),l.edit={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=s.current)||void 0===e?void 0:e.setOpen(t)}},l.edit.open(!0)},size:"small",children:(0,r.jsx)(ee,{sx:{rotate:"90deg"}})})})]})}})})]}),(0,r.jsx)(et.Js,{header:"Add disk",ref:i,showClose:!0,wide:!0,children:(0,r.jsx)(eh,{...e})}),(0,r.jsx)(et.Js,{header:"".concat(a,": grow disk"),ref:s,showClose:!0,wide:!0,children:a&&(0,r.jsx)(eh,{device:a,...e})}),(0,r.jsx)(et.Js,{header:"".concat(a,": insert or eject ISO"),ref:n,showClose:!0,wide:!0,children:a&&(0,r.jsx)(ej,{device:a,...e})})]})},ep=l(13539),eg=(e,t,l,i)=>{var s,n;let{body:a,messages:d,method:o="put",onFail:c,onSuccess:u,dangerous:h=/delete/i.test(null!==(s=null==d?void 0:d.proceed)&&void 0!==s?s:"")}=i;e.confirm.prepare({actionProceedText:null!==(n=null==d?void 0:d.proceed)&&void 0!==n?n:"Confirm",onProceedAppend:()=>{e.confirm.loading(!0),Z.Z.request({data:a,method:o,url:t}).then(()=>{e.confirm.finish("Success",{children:null==d?void 0:d.success}),null==u||u.call(null)}).catch(t=>{let l=(0,P.Z)(t);l.children=(0,r.jsxs)(r.Fragment,{children:[null==d?void 0:d.fail," ",l.children]}),e.confirm.finish("Error",l),null==c||c.call(null)})},proceedColour:h?"red":void 0,titleText:l}),e.confirm.open(!0)};let eb={mac:"auto",model:"e1000e"};var eZ=e=>{let{detail:t,tools:l}=e,{disabledSubmit:i,formik:s,formikErrors:n,handleChange:a}=(0,R.Z)({initialValues:{bridge:"",mac:"",model:eb.model},onSubmit:(e,r)=>{w(e,r,l,()=>"/server/".concat(t.uuid,"/add-interface"),()=>"Add interface?",{buildSummary:e=>{let t={...e};return t.mac||(t.mac=eb.mac),t},buildRequestBody:(e,t)=>{let l={};return(null==t?void 0:t.bridge)&&(l.bridge=t.bridge),(null==t?void 0:t.mac)&&t.mac!==eb.mac&&(l.mac=t.mac),(null==t?void 0:t.model)&&t.model!==eb.model&&(l.model=t.model),l}})},validationSchema:G(t)}),d=(0,o.useMemo)(()=>({bridge:"bridge",mac:"mac",model:"model"}),[]),c=(0,o.useMemo)(()=>Object.values(Object.values(t.bridges).reduce((e,t)=>{let{name:l}=t;return l in e||(e[l]={value:l}),e},{})),[t.bridges]);return(0,r.jsxs)(M,{formik:s,children:[(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(ec.Z,{id:d.bridge,label:"Bridge",name:d.bridge,onChange:s.handleChange,required:!0,selectItems:c,value:s.values.bridge})}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(T.Z,{id:d.mac,inputLabelProps:{shrink:!0},inputProps:{notched:!0,placeholder:"Auto generated"},label:"Mac address",name:d.mac,onChange:a,value:s.values.mac})})}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(ev.Z,{id:d.model,label:"Model",noOptionsText:"No matching model",onChange:(e,t)=>{s.setFieldValue(d.model,t,!0)},openOnFocus:!0,options:t.libvirt.nicModels,value:s.values.model})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:n})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:t,formDisabled:i,label:"Save"})})]})};let ey={down:"plug-in",up:"unplug"},eP={down:"unplugged",up:"plugged-in"};var ew=e=>{let{detail:t,tools:l}=e,i=(0,o.useRef)(null),s=(0,o.useMemo)(()=>t.devices.interfaces.reduce((e,t)=>(e[t.mac.address]=t,e),{}),[t.devices.interfaces]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.ZP,{container:!0,children:(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(el.Z,{allowAddItem:!0,header:!0,listEmpty:"No server network interface(s) found.",listItems:s,onAdd:()=>{l.add={open:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null===(e=i.current)||void 0===e?void 0:e.setOpen(t)}},l.add.open(!0)},renderListItem:(e,i)=>{let{link:{state:s},model:{type:n},source:{bridge:a},target:{dev:d}}=i,o="up"===s;return(0,r.jsxs)(h.ZP,{alignItems:"center",columnGap:"1em",container:!0,children:[(0,r.jsxs)(h.ZP,{alignItems:"center",display:"flex",flexDirection:"column",item:!0,minWidth:"5em",children:[(0,r.jsx)(F.KI,{noWrap:!0,children:g()(eP[s])}),(0,r.jsx)(ep.Z,{checked:o,onChange:()=>{let{[s]:i}=ey;eg(l,"/server/".concat(t.uuid,"/set-interface-state"),"".concat(g()(i)," ").concat(d," (").concat(e,")?"),{body:{active:!o,mac:e},messages:{proceed:g()(i),fail:(0,r.jsxs)(r.Fragment,{children:["Failed to register ",i," interface job."]}),success:(0,r.jsxs)(r.Fragment,{children:["Successfully registered ",i," interface job"]})}})}})]}),(0,r.jsxs)(h.ZP,{item:!0,xs:!0,children:[(0,r.jsxs)(b.Z,{xs:"column",md:"row",columnSpacing:0,children:[(0,r.jsxs)(F.$_,{noWrap:!0,children:[d," (",n,")"]}),(0,r.jsx)(m.Z,{flexItem:!0,orientation:"vertical"}),(0,r.jsx)(F.$_,{noWrap:!0,children:e})]}),(0,r.jsx)(F.$_,{children:a})]}),(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsx)(_.Z,{mapPreset:"delete",onClick:()=>{eg(l,"/server/".concat(t.uuid,"/delete-interface"),"Delete ".concat(d," (").concat(e,")?"),{body:{mac:e},messages:{proceed:"Delete",fail:(0,r.jsx)(r.Fragment,{children:"Failed to register delete interface job."}),success:(0,r.jsx)(r.Fragment,{children:"Successfully registered delete interface job"})}})},size:"small",variant:"redcontained"})})]})}})})}),(0,r.jsx)(et.Js,{header:"Add interface",ref:i,showClose:!0,wide:!0,children:(0,r.jsx)(eZ,{...e})})]})},e_=l(22700);let ek=e=>{var t,l;let{detail:i,memory:s,tools:n}=e,{disabledSubmit:a,formik:d,formikErrors:c,handleChange:u}=(0,R.Z)({initialValues:{size:{unit:"GiB",value:null!==(l=null===(t=(0,es.Gh)(i.memory.size,{toUnit:"GiB"}))||void 0===t?void 0:t.value)&&void 0!==l?l:"0"}},onSubmit:(e,t)=>{w(e,t,n,()=>"/server/".concat(i.uuid,"/set-memory"),()=>"Set memory?",{buildSummary:e=>{let{unit:t,value:l}=e.size;return{size:"".concat(l).concat(t)}}})},validationSchema:q(s)}),m=(0,o.useMemo)(()=>{let e="size";return{size:e,unit:"".concat(e,".unit"),value:"".concat(e,".value")}},[]),v=(0,o.useMemo)(()=>{let e={toUnit:d.values.size.unit},t=(0,es._d)(s.allocated,e);return{allocated:t,available:(0,es._d)(s.available,e),reserved:(0,es._d)(s.reserved,e),total:(0,es._d)(s.total,e)}},[d.values.size.unit,s.allocated,s.available,s.reserved,s.total]);return(0,r.jsxs)(M,{formik:d,children:[(0,r.jsxs)(h.ZP,{item:!0,width:"100%",children:[(0,r.jsx)(ed._1,{memory:s}),(0,r.jsxs)(h.ZP,{container:!0,children:[(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsxs)(F.Ac,{children:["Allocated: ",v.allocated]})}),(0,r.jsx)(h.ZP,{item:!0,textAlign:"center",xs:!0,children:(0,r.jsxs)(F.Ac,{fontWeight:400,children:["Available: ",v.available]})}),(0,r.jsxs)(h.ZP,{item:!0,textAlign:"right",children:[(0,r.jsxs)(F.Ac,{children:["System: ",v.reserved]}),(0,r.jsxs)(F.Ac,{children:["Total: ",v.total]})]})]})]}),(0,r.jsx)(h.ZP,{item:!0,sm:"auto",xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(eo.Z,{id:"server-memory-input",label:"Memory",inputWithLabelProps:{id:m.value,name:m.value},onChange:u,selectItems:en.k,selectWithLabelProps:{id:m.unit,name:m.unit,onChange:e=>{let t=e.target.value,{value:l,unit:r}=d.values.size,i=(0,es.Gh)(l,{fromUnit:r,precision:"B"===t?0:void 0,toUnit:t});if(!i)return;let{value:s}=i;d.setFieldValue(m.size,{value:s,unit:t},!0)},value:d.values.size.unit},value:d.values.size.value})})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:c})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:i,formDisabled:a,label:"Save"})})]})};var eS=e=>{let{detail:t}=e,{altData:l}=(0,A.Z)("/anvil/".concat(t.anvil.uuid,"/memory"),{mod:e_.Z,refreshInterval:5e3});return l?(0,r.jsx)(ek,{memory:l,...e}):(0,r.jsx)(V.Z,{mt:0})},ez=l(46194),eC=e=>{let{detail:t,tools:l}=e,{altData:i}=(0,A.Z)("/host?types=node",{mod:e=>Object.values(e).find(e=>{var l,r;return(null===(l=e.anvil)||void 0===l?void 0:l.uuid)===t.anvil.uuid&&e.shortHostName!==(null===(r=t.host)||void 0===r?void 0:r.short)})});return i?t.host?(0,r.jsxs)(h.ZP,{container:!0,spacing:"1em",children:[(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(F.Ac,{children:["Running on: ",t.host.short]})}),(0,r.jsx)(h.ZP,{item:!0,children:(0,r.jsxs)(ez.Z,{onClick:()=>{eg(l,"/server/".concat(t.uuid,"/migrate"),"Migrate ".concat(t.name," to ").concat(i.shortHostName,"?"),{body:{target:i.shortHostName},messages:{fail:(0,r.jsx)(r.Fragment,{children:"Failed to register migration job."}),proceed:"Migrate",success:(0,r.jsx)(r.Fragment,{children:"Successfully register migration job"})}})},children:["Migrate to ",i.shortHostName]})})]}):(0,r.jsx)(er.Z,{children:"Cannot migrate a shut off server."}):(0,r.jsx)(V.Z,{mt:0})},eM=e=>{let{detail:t,servers:l,tools:i}=e,{disabledSubmit:s,formik:n,formikErrors:a,handleChange:d}=(0,R.Z)({initialValues:{name:t.name},onSubmit:(e,l)=>{w(e,l,i,()=>"/server/".concat(t.uuid,"/rename"),()=>"Rename ".concat(t.name,"?"))},validationSchema:B(t,l)}),c=(0,o.useMemo)(()=>({name:"name"}),[]),u=(0,o.useMemo)(()=>"shut off"!==t.state||s,[t.state,s]);return(0,r.jsxs)(M,{formik:n,children:["shut off"!==t.state&&(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(er.Z,{children:"A server can only be renamed when it's shut off."})}),(0,r.jsx)(h.ZP,{item:!0,sm:"auto",xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(T.Z,{id:c.name,label:"Server name",name:c.name,onChange:d,required:!0,value:n.values.name})})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:a})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:t,formDisabled:u,label:"Save"})})]})},eI=l(16562),eV=e=>{let{detail:t,servers:l,tools:i}=e,{disabledSubmit:s,formik:n,formikErrors:a,handleChange:d}=(0,R.Z)({initialValues:{active:t.start.active,after:t.start.after||"",delay:String(t.start.delay)},onSubmit:(e,r)=>{w(e,r,i,()=>"/server/".concat(t.uuid,"/set-start-dependency"),()=>"Set start dependency?",{buildSummary:e=>{var t;let{active:r,after:i,delay:s}=e;return r?{after:null===(t=l[i])||void 0===t?void 0:t.name,delay:"".concat(s," second(s)")}:{"stay-off":"yes"}},buildRequestBody:e=>{let{active:t,after:l,delay:r}=e;return t&&l?{after:l,delay:Number(r)}:{active:t}}})},validationSchema:J}),c=(0,o.useMemo)(()=>({active:"active",after:"after",delay:"delay"}),[]),u=(0,o.useMemo)(()=>Object.values(l).filter(e=>e.anvil.uuid===t.anvil.uuid&&e.uuid!==t.uuid),[t.anvil.uuid,t.uuid,l]),m=(0,o.useMemo)(()=>u.map(e=>{let{name:t,uuid:l}=e;return{displayValue:t,value:l}}),[u]);return(0,r.jsxs)(M,{formik:n,children:[(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(ec.Z,{id:c.after,label:"Start after",name:c.after,onChange:n.handleChange,selectItems:m,selectProps:{disabled:!n.values.active,onClearIndicatorClick:()=>{n.setFieldValue(c.after,"",!0)}},value:n.values.after})}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(K.Z,{input:(0,r.jsx)(T.Z,{id:c.delay,inputProps:{disabled:!n.values.active||""===n.values.after},label:"Delay (seconds)",name:c.delay,onChange:d,value:n.values.delay})})}),(0,r.jsx)(h.ZP,{item:!0,xs:1,children:(0,r.jsx)(eI.Z,{checked:!n.values.active,id:c.active,label:"Stay off",name:c.active,onChange:(e,t)=>{n.setFieldValue(c.active,!t,!0)}})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(N.Z,{count:1,messages:a})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(O,{detail:t,formDisabled:s,label:"Save"})})]})},eA=l(19166),eO=l(17428),eF=l(22143),eR=l(40657);let eD={label:"Boot order",value:"boot-order"},eN={label:"CPU",value:"cpu"},eT={label:"Disks",value:"disks"},eL={label:"General",value:"general"},eE={label:"Interfaces",value:"interfaces"},eW={label:"Memory",value:"memory"},eH={label:"Migration",value:"migration"},eG={label:"Name",value:"name"},eq={label:"Start dependency",value:"start-dependency"},eB=(0,i.ZP)(c.$x)(e=>{let{theme:t}=e;return{width:"100%",[t.breakpoints.up("xs")]:{height:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";return"calc(".concat(e," * 0.6)")}("100vw")},[t.breakpoints.up("sm")]:{height:"6em"},[t.breakpoints.up("md")]:{height:"9em"}}});var eU=e=>{let{slotProps:t,serverUuid:l}=e,[i,s]=(0,o.useState)(eL.value),{data:n,mutate:a}=(0,A.Z)("/server"),{data:d}=(0,A.Z)("/server/".concat(l),{refreshInterval:2e3}),{confirmDialog:u,finishConfirm:x,setConfirmDialogLoading:j,setConfirmDialogOpen:f,setConfirmDialogProps:p}=(0,eR.Z)({initial:{scrollContent:!0,wide:!0}}),g=(0,o.useRef)({add:{open:()=>null},confirm:{finish:x,loading:j,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return f(e)},prepare:p},edit:{open:()=>null}});return d&&n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.s_,{children:(0,r.jsxs)(h.ZP,{container:!0,spacing:"1em",children:[(0,r.jsx)(h.ZP,{item:!0,width:{xs:"100%",sm:"14em",md:"20em"},children:(0,r.jsxs)(h.ZP,{columns:1,container:!0,spacing:"1em",children:[(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsx)(c.bC,{server:d,children:(0,r.jsx)(c.MB,{server:d,slots:{screenshotBox:(0,r.jsx)(eB,{})},...null==t?void 0:t.preview})})}),(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(eF.Z,{onChange:(e,t)=>{s(t),[eH.value,eq.value].includes(t)&&a()},orientation:"vertical",value:i,children:[(0,r.jsx)(eA.Z,{label:eL.label,value:eL.value}),(0,r.jsx)(eA.Z,{disabled:!0,icon:(0,r.jsx)(m.Z,{orientation:"horizontal",sx:{width:"100%"}}),label:""}),(0,r.jsx)(eA.Z,{label:eD.label,value:eD.value}),(0,r.jsx)(eA.Z,{label:eN.label,value:eN.value}),(0,r.jsx)(eA.Z,{label:eT.label,value:eT.value}),(0,r.jsx)(eA.Z,{label:eE.label,value:eE.value}),(0,r.jsx)(eA.Z,{label:eW.label,value:eW.value}),(0,r.jsx)(eA.Z,{label:eH.label,value:eH.value}),(0,r.jsx)(eA.Z,{label:eG.label,value:eG.value}),(0,r.jsx)(eA.Z,{label:eq.label,value:eq.value})]})})]})}),(0,r.jsx)(h.ZP,{display:{xs:"none",sm:"initial"},item:!0,children:(0,r.jsx)(m.Z,{orientation:"vertical"})}),(0,r.jsxs)(h.ZP,{item:!0,xs:!0,children:[(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eL.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eL.label})}),(0,r.jsx)(h.ZP,{container:!0,rowSpacing:"0.4em",children:[{header:"UUID",value:d.uuid},{header:"State",value:d.state},{header:"On node",value:"".concat(d.anvil.name,": ").concat(d.anvil.description)},{header:"On host",value:d.host?d.host.short:"None"}].map(e=>{let{header:t,value:l}=e;return(0,r.jsx)(h.ZP,{item:!0,width:"100%",children:(0,r.jsxs)(h.ZP,{columnSpacing:"1em",container:!0,children:[(0,r.jsx)(h.ZP,{item:!0,width:"10em",children:(0,r.jsx)(F.Ac,{children:t})}),(0,r.jsx)(h.ZP,{item:!0,xs:!0,children:(0,r.jsx)(F.$_,{children:l})})]})},"general-".concat(t))})})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eD.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eD.label})}),(0,r.jsx)(D,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eN.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eN.label})}),(0,r.jsx)(X,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eT.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eT.label})}),(0,r.jsx)(ef,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eE.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eE.label})}),(0,r.jsx)(ew,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eW.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eW.label})}),(0,r.jsx)(eS,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eH.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eH.label})}),(0,r.jsx)(eC,{detail:d,tools:g.current})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eG.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eG.label})}),(0,r.jsx)(eM,{detail:d,tools:g.current,servers:n})]}),(0,r.jsxs)(eO.Z,{changingTabId:i,tabId:eq.value,children:[(0,r.jsx)(v.V9,{children:(0,r.jsx)(F.z,{children:eq.label})}),(0,r.jsx)(eV,{detail:d,servers:n,tools:g.current})]})]})]})}),u]}):(0,r.jsx)(v.s_,{children:(0,r.jsx)(V.Z,{mt:0})})},e$=l(92214),eJ=l(72094);let eK="Server",eQ={preview:"".concat(eK,"-preview"),fullView:"".concat(eK,"-fullView")},eX=(0,i.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(eQ.preview)]:{width:"25%",height:"100%",[t.breakpoints.down("md")]:{width:"100%"}},["& .".concat(eQ.fullView)]:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"center"}}});var eY=()=>{var e;let t=(0,d.useRouter)(),{data:l,error:i,loading:n}=(0,A.Z)("/server"),h=(0,o.useMemo)(()=>{let e;if(!l||!t.isReady)return;let{name:r,uuid:i}=t.query;return r?e=Object.values(l).find(e=>e.name===r):i&&(e=l["string"==typeof i?i:i[0]]),e},[t.isReady,t.query,l]),m=(0,o.useMemo)(()=>{if(!t.isReady)return"";let{view:e}=t.query;return e?"string"==typeof e?e:e[0]:""},[t.isReady,t.query]);if(n)return(0,r.jsxs)("div",{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:"Loading..."})}),(0,r.jsx)(u.Z,{}),(0,r.jsx)(e$.Z,{children:(0,r.jsx)(v.s_,{children:(0,r.jsx)(V.Z,{mt:0})})})]});if(!h)return(0,r.jsxs)("div",{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:"Server?"})}),(0,r.jsx)(u.Z,{}),(0,r.jsx)(e$.Z,{children:(0,r.jsx)(v.s_,{children:(0,r.jsxs)(er.Z,{children:["Couldn't find server ",t.query.name||t.query.uuid,". ",null==i?void 0:i.message]})})})]});let x={vnc:(0,r.jsx)(s.Z,{className:eQ.fullView,children:(0,r.jsx)(c.SJ,{onClickCloseButton:()=>{let e=(0,eJ.Z)(t,"view");t.replace({query:e},void 0,{shallow:!0})},serverUuid:h.uuid,serverName:h.name})})};return(0,r.jsxs)(eX,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:h.name})}),(0,r.jsx)(u.Z,{}),null!==(e=x[m])&&void 0!==e?e:(0,r.jsx)(e$.Z,{children:(0,r.jsx)(eU,{serverUuid:h.uuid,slotProps:{preview:{onClick:()=>{let e=(0,eJ.Z)(t,"view","vnc");t.replace({query:e},void 0,{shallow:!0})}}}})})]})}},5152:function(e,t,l){e.exports=l(32602)}},function(e){e.O(0,[995,256,202,391,548,937,731,126,436,622,259,352,888,774,179],function(){return e(e.s=41171)}),_N_E=e.O()}]);