(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{14453:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config",function(){return n(51688)}])},47177:function(e,t,n){"use strict";var l=n(85893),r=n(90642),s=n(67294),o=n(45036),c=n(5387),i=n(71487),a=n(57882);let d=(0,s.forwardRef)((e,t)=>{let{actionCancelText:n="Cancel",actionProceedText:d,children:u,closeOnProceed:h=!1,contentContainerProps:p,dialogProps:x,disableProceed:m,loading:g,loadingAction:f=!1,onActionAppend:j,onCancelAppend:Z,onProceedAppend:v,openInitially:P,preActionArea:w,proceedButtonProps:b,proceedColour:y="blue",scrollContent:k=!1,scrollBoxProps:A,showActionArea:C=!0,showCancel:S,showClose:T,titleText:M,wide:I,content:O=u}=e,E=(0,s.useRef)(null),F=(0,s.useMemo)(()=>(0,i.Z)(O,a.Ac),[O]),R=(0,s.useMemo)(()=>(0,s.createElement)(k?o.VZ:r.Z,A,F),[F,A,k]),N=(0,s.useMemo)(()=>C&&(0,l.jsx)(o.ux,{cancelProps:{children:n,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==j||j.call(null,...t),null==Z||Z.call(null,...t)}},closeOnProceed:h,loading:f,proceedProps:{background:y,children:d,disabled:m,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==j||j.call(null,...t),null==v||v.call(null,...t)},...b},showCancel:S}),[n,d,h,m,f,j,Z,v,b,y,C,S]);return(0,s.useImperativeHandle)(t,()=>({setOpen:e=>{var t;return null===(t=E.current)||void 0===t?void 0:t.setOpen(e)}}),[]),(0,l.jsx)(o.Js,{dialogProps:x,header:M,loading:g,openInitially:P,ref:E,showClose:T,wide:I,children:(0,l.jsxs)(c.Z,{...p,children:[R,w,N]})})});d.displayName="ConfirmDialog",t.Z=d},18950:function(e,t,n){"use strict";var l=n(85893),r=n(67294),s=n(47177);let o=(0,r.forwardRef)((e,t)=>{let{children:n,contentContainerProps:o,dialogProps:c,onSubmitAppend:i,proceedButtonProps:a,scrollBoxProps:d,scrollContent:u,...h}=e,p=(0,r.useMemo)(()=>({...o,component:"form",onSubmit:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l]=t;l.preventDefault(),null==i||i.call(null,...t)}}),[o,i]),x=(0,r.useMemo)(()=>({...d,sx:u?{overflowX:"hidden",paddingTop:".6em",...null==d?void 0:d.sx}:null==d?void 0:d.sx}),[d,u]);return(0,l.jsx)(s.Z,{dialogProps:c,contentContainerProps:p,proceedButtonProps:{...a,type:"submit"},scrollContent:u,scrollBoxProps:x,wide:!0,...h,ref:t,children:n})});o.displayName="FormDialog",t.Z=o},76740:function(e,t,n){"use strict";var l=n(85893),r=n(90642),s=n(19304),o=n(47407),c=n(35338),i=n(44400),a=n(5387),d=n(57882);let u=e=>{let{entry:t}=e;return(0,l.jsx)(d.$_,{whiteSpace:"nowrap",children:String(t)})},h=e=>{let{entry:t,key:n}=e;return c.JW.test(n)?(0,l.jsx)(d.PJ,{wrapper:"mono",children:String(t)}):u(e)},p=e=>{let{entry:t,hasPassword:n}=e;return["",null,void 0].some(e=>t===e)||Number.isNaN(t)?(0,l.jsx)(d.Ac,{children:"none"}):n?h(e):u(e)},x=e=>{let{depth:t,entry:n,getLabel:s,hasPassword:o,key:c,nest:u,renderValue:h}=e;return(0,l.jsxs)(a.Z,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,l.jsx)(d.Ac,{children:s({cap:i.Z,depth:t,entry:n,hasPassword:o,key:c})}),(0,l.jsx)(r.Z,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!u&&h(p,{depth:t,entry:n,hasPassword:o,key:c})})]})},m=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},g=e=>{let{depth:t=0,entries:n,getEntryLabel:r,getListProps:c,getListItemProps:i,hasPassword:a,listKey:d,maxDepth:u,renderEntry:h,renderEntryValue:p,skip:x}=e,f=[];Object.entries(n).forEach(e=>{let[n,o]=e,c=null!==o&&"object"==typeof o,d=c?null:o,j={depth:t,entry:d,hasPassword:a,key:n};x(m,j)||f.push((0,l.jsx)(s.ZP,{sx:{paddingLeft:"".concat(t,"em")},...null==i?void 0:i.call(null,j),children:h({depth:t,entry:d,getLabel:r,hasPassword:a,key:n,nest:c,renderValue:p})},"form-summary-entry-".concat(n))),c&&t<u&&f.push(g({depth:t+1,entries:o,getEntryLabel:r,hasPassword:a,listKey:n,maxDepth:u,renderEntry:h,renderEntryValue:p,skip:x}))});let j="form-summary-list-".concat(null!=d?d:"root");return(0,l.jsx)(o.Z,{dense:!0,disablePadding:!0,...null==c?void 0:c.call(null,{depth:t,entries:n,key:d}),children:f},j)};t.Z=e=>{let{entries:t,getEntryLabel:n=e=>{let{cap:t,key:n}=e;return t(n)},getListProps:l,getListItemProps:r,hasPassword:s=!1,maxDepth:o=3,renderEntry:c=x,renderEntryValue:i=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),l=1;l<t;l++)n[l-1]=arguments[l];return e(...n)},skip:a=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),l=1;l<t;l++)n[l-1]=arguments[l];return e(...n)}}=e;return g({entries:t,getEntryLabel:n,getListProps:l,getListItemProps:r,hasPassword:s,maxDepth:o,renderEntry:c,renderEntryValue:i,skip:a})}},65716:function(e,t,n){"use strict";var l=n(85893),r=n(11825),s=n(61769),o=n(39971),c=n(5387);t.Z=e=>{let{children:t,sx:n,...i}=e;return(0,l.jsx)(s.Z,{underline:"hover",variant:"subtitle1",...i,sx:{color:o.lD,textDecorationColor:o.s7,...n},children:(0,l.jsxs)(c.Z,{row:!0,children:[t,(0,l.jsx)(r.Z,{sx:{marginLeft:".3em"}})]})})}},18050:function(e,t,n){"use strict";var l=n(85893),r=n(67294),s=n(29873);let o={count:0,defaultMessageType:"info",messages:void 0,onSet:void 0,usePlaceholder:!0},c=(0,r.forwardRef)((e,t)=>{let{count:n=o.count,defaultMessageType:c=o.defaultMessageType,messages:i,onSet:a,usePlaceholder:d=o.usePlaceholder}=e,[u,h]=(0,r.useState)({}),p=(0,r.useMemo)(()=>({...i,...u}),[i,u]),x=(0,r.useCallback)(e=>void 0!==p[e],[p]),m=(0,r.useCallback)((e,t)=>{let n=0;h(l=>{let{[e]:r,...s}=l;return t&&(s[e]=t),n=Object.keys(s).length,s}),null==a||a.call(null,n)},[a]),g=(0,r.useCallback)((e,t)=>{let n=0,l=t?(e,l)=>{e[l]=t,n+=1}:void 0;h(t=>{let r={};return Object.keys(t).forEach(s=>{e.test(s)?null==l||l.call(null,r,s):(r[s]=t[s],n+=1)}),r}),null==a||a.call(null,n)},[a]),f=(0,r.useMemo)(()=>{let e=Object.entries(p),t=n>0,r=t?n:e.length,o=[];if(e.every(e=>{let[t,n]=e,{children:i,type:a=c}=n;return o.push((0,l.jsx)(s.Z,{type:a,children:i},"message-".concat(t))),o.length<r}),d&&t&&0===o.length){let e=n-o.length;for(let t=0;t<e;t+=1)o.push((0,l.jsx)(s.Z,{sx:{visibility:"hidden"},text:"Placeholder"},"message-placeholder-".concat(t)))}return o},[n,c,d,p]);return(0,r.useImperativeHandle)(t,()=>({exists:x,setMessage:m,setMessageRe:g}),[x,m,g]),(0,l.jsx)(l.Fragment,{children:f})});c.defaultProps=o,c.displayName="MessageGroup",t.Z=c},81013:function(e,t,n){"use strict";var l=n(85893),r=n(67294),s=n(95996),o=n(76740);t.Z=e=>{let{list:t={}}=e,[n,c]=(0,r.useState)({}),i=(0,r.useMemo)(()=>Object.keys(t),[t]),a=(0,r.useMemo)(()=>Object.keys(n),[n]),d=(0,r.useMemo)(()=>a.length===i.length,[a.length,i.length]),u=(0,r.useMemo)(()=>a.length>0,[a.length]),h=(0,r.useMemo)(()=>i.length>1,[i.length]),p=(0,r.useCallback)(e=>{let{confirmDialogProps:t={},formSummaryProps:r={},getConfirmDialogTitle:s,onProceedAppend:c,renderEntry:i}=e;return{actionProceedText:"Delete",content:(0,l.jsx)(o.Z,{entries:n,maxDepth:0,renderEntry:i,...r}),onProceedAppend:c,proceedColour:"red",titleText:s(a.length),...t}},[n,a.length]),x=(0,r.useCallback)(e=>!!n[e],[n]);return{buildDeleteDialogProps:p,checklist:n,checks:a,getCheck:x,hasAllChecks:d,hasChecks:u,multipleItems:h,resetChecks:(0,r.useCallback)(()=>c({}),[]),setAllChecks:(0,r.useCallback)(e=>c(i.reduce((t,n)=>(e&&(t[n]=e),t),{})),[i]),setCheck:(0,r.useCallback)((e,t)=>c((0,s.ZP)(e,t||void 0)),[])}}},84337:function(e,t,n){"use strict";var l=n(67294);t.Z=function(){let{actionProceedText:e="",content:t="",titleText:n="",...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.useState)({actionProceedText:e,content:t,titleText:n,...r})}},56351:function(e,t){"use strict";t.Z={boolean:e=>!!e,number:e=>parseInt(String(e),10)||0,string:e=>String(e)}},94047:function(e,t){"use strict";t.Z={bcn:"Back-Channel Network",ifn:"Internet-Facing Network",mn:"Migration Network",sn:"Storage Network"}},44400:function(e,t,n){"use strict";var l=n(48403),r=n.n(l);t.Z=e=>{let t=e.replace(/([a-z\d])([A-Z])/g,"$1 $2");return r()(t)}},51688:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eh}});var l=n(85893),r=n(8506),s=n(9008),o=n.n(s),c=n(67294),i=n(53165),a=n(47177),d=n(25436),u=n(14631),h=n(94047),p=n(46315),x=n(28937);let m=function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=n=>{var l;null===(l=t.current.setMessage)||void 0===l||l.call(null,e,n)};return n&&(n[l]=r),r};var g=(e,t)=>{let n={};return e instanceof Array?e.reduce((e,n)=>(m(n,t,e),e),n):Object.entries(e).reduce((e,n)=>{let[l,r]=n;return m(r,t,e,l),e},n)},f=n(95996),j=n(50385),Z=n(47856),v=n(57882),P=e=>{let{checkboxProps:t,checked:n,formControlLabelProps:r,label:s,onChange:o}=e,i=(0,c.useMemo)(()=>"string"==typeof s?(0,l.jsx)(v.Ac,{children:s}):s,[s]);return(0,l.jsx)(j.Z,{...r,control:(0,l.jsx)(Z.Z,{...t,checked:n,onChange:o}),label:i})},w=n(5387),b=n(91905),y=n(11100),k=n(45328),A=n(2911),C=n(18050),S=n(23852),T=n(72414);let M={dbPort:"dbPort",ipAddress:"ipAddress",password:"password",sshPort:"sshPort",user:"user"},I="IP address",O="Password",E=(0,c.forwardRef)((e,t)=>{let{formGridColumns:n=2}=e,r=(0,c.useRef)({}),s=(0,c.useRef)({}),o=(0,c.useRef)({}),i=(0,c.useRef)({}),d=(0,c.useRef)({}),u=(0,c.useRef)({}),[h,m]=(0,c.useState)({}),[j,Z]=(0,c.useState)(!0),[E,F]=(0,c.useState)(!1),R=(0,c.useCallback)(e=>t=>{let{isValid:n}=t;m((0,f.ZP)(e,n))},[]),N=(0,c.useCallback)(e=>t=>{m((0,f.ZP)(e,t))},[]),D=(0,c.useCallback)(e=>{var t;null===(t=u.current.setMessage)||void 0===t||t.call(null,"api",e)},[]),_=(0,c.useMemo)(()=>Object.values(h).some(e=>!e),[h]),B=(0,c.useMemo)(()=>g(M,u),[]);return(0,l.jsx)(a.Z,{actionProceedText:"Add",content:(0,l.jsx)(b.Z,{columns:{xs:1,sm:n},layout:{"add-peer-ip-address":{children:(0,l.jsx)(w.Z,{row:!0,spacing:".3em",children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:"add-peer-ip-address-input",inputProps:{readOnly:!0,onFocus:e=>{e.target.readOnly=!1}},label:I}),inputTestBatch:(0,T._)(I,()=>{B.ipAddress()},{onFinishBatch:N(M.ipAddress)},e=>{B.ipAddress({children:e})}),onFirstRender:R(M.ipAddress),ref:s,required:!0})})},"add-peer-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:"add-peer-password-input",label:O,type:p.Z.password}),inputTestBatch:(0,T.Gn)(O,()=>{B.password()},{onFinishBatch:N(M.password)},e=>{B.password({children:e})}),onFirstRender:R(M.password),ref:o,required:!0})},"add-peer-is-ping":{children:(0,l.jsx)(P,{checked:j,label:"Ping",onChange:(e,t)=>{Z(t)}}),sx:{display:"flex"}},"add-peer-message-group":{children:(0,l.jsx)(C.Z,{count:1,defaultMessageType:"warning",ref:u}),sm:n}},spacing:"1em"}),dialogProps:{PaperProps:{sx:{minWidth:"16em"}}},loadingAction:E,onActionAppend:()=>{D()},onProceedAppend:()=>{var e,t,n,l,c;F(!0),x.Z.post("/host/connection",{ipAddress:null===(e=s.current.getValue)||void 0===e?void 0:e.call(null),isPing:j,password:null===(t=o.current.getValue)||void 0===t?void 0:t.call(null),port:null===(n=r.current.getValue)||void 0===n?void 0:n.call(null),sshPort:null===(l=i.current.getValue)||void 0===l?void 0:l.call(null),user:null===(c=d.current.getValue)||void 0===c?void 0:c.call(null)}).then(()=>{D({children:"Successfully initiated the peer addition. You can continue to edit the field(s) to add another peer.",type:"info"})}).catch(e=>{let t=(0,y.Z)(e);t.children="Failed to add the given peer. ".concat(t.children),D(t)}).finally(()=>{F(!1)})},proceedButtonProps:{disabled:_},ref:t,titleText:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(v.z,{children:"Add a peer"}),(0,l.jsx)(k.Z,{mapPreset:"close",onClick:()=>{if(t&&"current"in t){var e;null===(e=t.current.setOpen)||void 0===e||e.call(null,!1)}},variant:"redcontained"})]})})});E.displayName="AddPeerDialog";var F=n(18541),R=n(29873),N=n(65375),D=n(38444),_=n(53819),B=n(39971);let U={small:v.KI,medium:v.Ac},L={size:"small",stateMap:new Map([[!1,(0,l.jsx)(D.Z,{sx:{color:B.Wd}},"state-false")],[!0,(0,l.jsx)(_.Z,{sx:{color:B.Ej}},"state-true")]])},H=e=>{let{label:t,size:n=L.size,state:r,stateMap:s=L.stateMap}=e,o=s.get(r);return(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",children:[o&&(0,c.cloneElement)(o,{fontSize:n}),(0,c.createElement)(U[n],{},t)]})};H.defaultProps=L;var V=e=>{let{refreshInterval:t=6e4}=e,n=(0,c.useRef)({}),s=(0,c.useRef)({}),[o,d]=(0,c.useState)(void 0),[p,m]=(0,c.useState)({actionProceedText:"",content:"",titleText:""}),[g,f]=(0,c.useState)({}),[j,Z]=(0,c.useState)(!1),[P,b]=(0,c.useState)({}),k=(0,c.useMemo)(()=>o&&(0,l.jsx)(r.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(R.Z,{...o})}),[o]),{isLoading:A}=(0,u.Z)("".concat(i.Z,"/host/connection"),{refreshInterval:t,onError:e=>{d({children:"Failed to get connection data. Error: ".concat(e),type:"error"})},onSuccess:e=>{let{local:{inbound:{ipAddress:t,port:n,user:l},peer:r}}=e;f(e=>Object.entries(t).reduce((t,r)=>{let[s,{ifaceId:o,networkLinkNumber:c,networkNumber:i,networkType:a}]=r;return t[s]={...e[s],dbPort:n,dbUser:l,ifaceId:o,ipAddress:s,networkLinkNumber:c,networkNumber:i,networkType:a},t},{})),b(e=>Object.entries(r).reduce((t,n)=>{let[l,{hostUUID:r,isPing:s,port:o,user:c}]=n,i="".concat(c,"@").concat(l,":").concat(o);return t[i]={...e[i],dbPort:o,dbUser:c,hostUUID:r,ipAddress:l,isPingTest:s},t},{}))}});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N.TZ,{header:"Configure striker peers",loading:A,children:(0,l.jsxs)(r.ZP,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(r.ZP,{item:!0,xs:1,children:(0,l.jsx)(F.Z,{header:"Inbound connections",listEmpty:(0,l.jsx)(v.Ac,{align:"center",children:"No inbound connections found."}),listItemKeyPrefix:"config-peers-inbound-connection",listItems:g,renderListItem:(e,t)=>{let{dbPort:n,dbUser:r,ifaceId:s,networkNumber:o,networkType:c}=t,i=h.Z[c]&&o?"".concat(h.Z[c]," ").concat(o):"Unknown network; interface: ".concat(s);return(0,l.jsxs)(w.Z,{spacing:0,sx:{width:"100%"},children:[(0,l.jsx)(v.$_,{children:"".concat(r,"@").concat(e,":").concat(n)}),(0,l.jsx)(v.KI,{children:i})]})}})}),(0,l.jsx)(r.ZP,{item:!0,xs:1,children:(0,l.jsx)(F.Z,{header:"Peer connections",allowEdit:!0,edit:j,listEmpty:(0,l.jsx)(v.Ac,{align:"center",children:"No peer connections found."}),listItemKeyPrefix:"config-peers-peer-connection",listItems:P,onAdd:()=>{var e;null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{let e=Object.entries(P).reduce((e,t)=>{let[,{hostUUID:n,isChecked:l}]=t;return l&&e.local.push(n),e},{local:[]}),t=e.local.length;if(t>0){var n;m({actionProceedText:"Delete",content:"The peer relationship between this striker and the selected ".concat(t," host(s) will terminate. The removed peer(s) can be re-added later."),onProceedAppend:()=>{x.Z.delete("/host/connection",{data:e}).catch(e=>{let t=(0,y.Z)(e);t.children="Failed to delete peer connection(s). ".concat(t.children),d(t)})},proceedColour:"red",titleText:"Delete ".concat(t," peer(s) from this striker?")}),null===(n=s.current.setOpen)||void 0===n||n.call(null,!0)}},onEdit:()=>{Z(e=>!e)},onItemCheckboxChange:(e,t,n)=>{P[e].isChecked=n,b(e=>({...e}))},renderListItem:(e,t)=>{let{isPingTest:n=!1}=t;return(0,l.jsx)(w.Z,{row:!0,spacing:0,children:(0,l.jsxs)(w.Z,{spacing:0,children:[(0,l.jsx)(v.$_,{children:e}),(0,l.jsx)(H,{label:"Ping",state:n})]})})}})}),k]})}),(0,l.jsx)(E,{ref:n}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...p,ref:s})]})},W=n(82092),G=n(65716),q=n(81013),z=e=>{let{mitmExternalHref:t="https://en.wikipedia.org/wiki/Man-in-the-middle_attack",refreshInterval:n=6e4}=e,r=(0,c.useRef)({}),[s,o]=(0,c.useState)(),[d,h]=(0,c.useState)({}),[p,m]=(0,c.useState)({actionProceedText:"",content:"",titleText:""}),{checks:g,getCheck:f,hasAllChecks:j,hasChecks:Z,setAllChecks:P,setCheck:b}=(0,q.Z)({list:d}),k=(0,c.useMemo)(()=>s&&(0,l.jsx)(R.Z,{...s}),[s]),A=(0,c.useMemo)(()=>Object.keys(d).length>1,[d]),{isLoading:C}=(0,u.Z)("".concat(i.Z,"/ssh-key/conflict"),{onError:e=>{o({children:"Failed to fetch SSH key conflicts. Error: ".concat(e),type:"error"})},onSuccess:e=>{h(t=>Object.values(e).reduce((e,n)=>(Object.values(n).forEach(n=>{let{hostName:l,hostUUID:r,ipAddress:s,stateUUID:o}=n;e[o]={...t[o],hostName:l,hostUUID:r,ipAddress:s}}),e),{}))},refreshInterval:n});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(N.TZ,{header:"Manage changed SSH keys",loading:C,children:[(0,l.jsxs)(w.Z,{spacing:".2em",children:[(0,l.jsx)(v.Ac,{children:"The identity of the following targets have unexpectedly changed."}),(0,l.jsxs)(R.Z,{type:"warning",isAllowClose:!0,children:["If you haven't rebuilt the listed targets, then you could be experiencing a"," ",(0,l.jsx)(G.Z,{href:t,sx:{display:"inline-flex"},target:"_blank",children:'"Man In The Middle"'})," ","attack. Please verify the targets have changed for a known reason before proceeding to remove the broken keys."]}),(0,l.jsx)(F.Z,{header:(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{width:"100%","& > :not(:last-child)":{display:{xs:"none",sm:"flex"}},"& > :last-child":{display:{xs:"initial",sm:"none"},marginLeft:0}},children:[(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{flexBasis:"calc(50% + 1em)"},children:[(0,l.jsx)(v.Ac,{children:"Host name"}),(0,l.jsx)(W.Z,{sx:{flexGrow:1}})]}),(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{flexGrow:1},children:[(0,l.jsx)(v.Ac,{children:"IP address"}),(0,l.jsx)(W.Z,{sx:{flexGrow:1}})]}),(0,l.jsx)(W.Z,{sx:{flexGrow:1}})]}),allowCheckAll:A,allowCheckItem:!0,allowDelete:!0,allowEdit:!1,disableDelete:!Z,edit:!0,getListCheckboxProps:()=>({checked:j}),listEmpty:(0,l.jsx)(v.Ac,{align:"center",children:"No conflicting keys found."}),listItems:d,onAllCheckboxChange:(e,t)=>{P(t)},onDelete:()=>{var e;let t=g.reduce((e,t)=>{if(!f(t))return e;let{hostUUID:n}=d[t];return e[n]||(e[n]=[]),e[n].push(t),e},{});m({actionProceedText:"Delete",content:"Resolve ".concat(g.length," SSH key conflicts. Please make sure the identity change(s) are expected to avoid MITM attacks."),onProceedAppend:()=>{x.Z.delete("/ssh-key/conflict",{data:t}).catch(e=>{let t=(0,y.Z)(e);t.children="Failed to delete selected SSH key conflicts. ".concat(t.children),o(t)})},proceedColour:"red",titleText:"Delete ".concat(g.length," conflicting SSH keys?")}),null===(e=r.current.setOpen)||void 0===e||e.call(null,!0)},onItemCheckboxChange:(e,t,n)=>{b(e,n)},renderListItem:(e,t)=>{let{hostName:n,ipAddress:r}=t;return(0,l.jsxs)(w.Z,{spacing:0,sm:"row",sx:{width:"100%","& > *":{flexBasis:"50%"}},xs:"column",children:[(0,l.jsx)(v.Ac,{children:n}),(0,l.jsx)(v.Ac,{children:r})]})},renderListItemCheckboxState:e=>f(e)})]}),k]}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...p,ref:r})]})};let K="common-user-input-confirm-password",$="common-user-input-name",J="common-user-input-password",X="Username",Y="Password";var Q=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,setMessage:r,setValidity:s},previous:{name:o}={},readOnlyUserName:i,requirePassword:a=!1,showPasswordField:d}=e,u=(0,c.useRef)({}),h=(0,c.useRef)({}),[x,m]=(0,c.useState)(a),g=(0,c.useMemo)(()=>d?{"common-user-input-cell-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:J,label:Y,type:p.Z.password}),inputTestBatch:(0,T.Gn)(Y,()=>{r(J)},{onFinishBatch:t(J)},e=>{r(J,{children:e})}),onBlurAppend:e=>{var t;let{target:{value:n}}=e;m(n.length>0),s(K,n===(null===(t=h.current.getValue)||void 0===t?void 0:t.call(null)))},onFirstRender:n(J),ref:u,required:a})},"common-user-input-cell-confirm-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:K,inputProps:{readOnly:!x},label:"Confirm password",type:p.Z.password}),inputTestBatch:{defaults:{onSuccess:()=>{r(K)}},onFinishBatch:t(K),tests:[{test:T.HJ},{onFailure:()=>{r(K,{children:"The passwords do not match."})},test:e=>{var t;let{value:n}=e;return n===(null===(t=u.current.getValue)||void 0===t?void 0:t.call(null))}}]},onFirstRender:n(K),ref:h,required:x})}}:void 0,[t,n,x,a,r,s,d]);return(0,l.jsx)(b.Z,{columns:{xs:1,sm:2,md:3},layout:{"common-user-input-cell-name":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:$,inputProps:{readOnly:i},label:X,value:o}),inputTestBatch:(0,T.Gn)(X,()=>{r($)},{onFinishBatch:t($)},e=>{r($,{children:e})}),onFirstRender:n($),required:!0}),md:1,sm:2},...g},spacing:"1em"})},ee=n(18950),et=n(76740),en=n(84337),el=n(95275);let er=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[{target:l}]=t,{elements:r}=l,{value:s}=r.namedItem($),o=r.namedItem(J),c="";return o&&({value:c}=o),{password:c,userName:s}};var es=()=>{let e=(0,c.useRef)({}),t=(0,c.useRef)({}),n=(0,c.useRef)({}),r=(0,c.useRef)({}),[s,o]=(0,en.Z)(),[d,h]=(0,c.useState)(!1),[p,x]=(0,c.useState)({children:"No users found."}),[m,g]=(0,c.useState)(),{data:f,isLoading:j}=(0,u.Z)("".concat(i.Z,"/user"),{onError:e=>{x((0,y.Z)(e))}}),Z=(0,el.Z)([K,$,J],r),{isFormInvalid:P,isFormSubmitting:w,submitForm:b}=Z,{buildDeleteDialogProps:k,checks:A,getCheck:S,hasChecks:T,setCheck:M}=(0,q.Z)({list:f}),{userName:I,userUUID:O}=(0,c.useMemo)(()=>null!=m?m:{},[m]),E=(0,c.useMemo)(()=>({actionProceedText:"Add",content:(0,l.jsx)(Q,{formUtils:Z,requirePassword:!0,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];let c=er(...r);o({actionProceedText:"Add",content:(0,l.jsx)(et.Z,{entries:c,hasPassword:!0}),onProceedAppend:()=>{b({body:c,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Add user failed. ",e]}),method:"post",successMsg:"Created user ".concat(c.userName,"."),url:"/user"})},titleText:"Add the following new user?"}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Add a web interface user"}),[Z,o,b]),D=(0,c.useMemo)(()=>({actionProceedText:"Edit",content:(0,l.jsx)(Q,{formUtils:Z,previous:{name:I},readOnlyUserName:"admin"===I,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];let c=er(...r);o({actionProceedText:"Update",content:(0,l.jsx)(et.Z,{entries:c,hasPassword:!0}),onProceedAppend:()=>{b({body:c,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Update user failed. ",e]}),method:"put",successMsg:"Updated user ".concat(I),url:"/user/".concat(O)})},titleText:"Update user ".concat(I," with the following?")}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Edit user ".concat(I)}),[Z,o,b,I,O]),_=(0,c.useMemo)(()=>(0,l.jsx)(C.Z,{count:1,defaultMessageType:"warning",ref:r}),[]),B=(0,c.useMemo)(()=>{var e;return(null==f?void 0:null===(e=f.current)||void 0===e?void 0:e.userName)==="admin"},[f]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(N.TZ,{header:"Manage users",loading:j,children:(0,l.jsx)(F.Z,{allowAddItem:B,allowDelete:B,allowEdit:!0,allowItemButton:d,disableDelete:!T,edit:d,getListItemCheckboxProps:(e,t)=>{let{userName:n}=t;return{disabled:"admin"===n}},header:!0,listEmpty:(0,l.jsx)(R.Z,{...p}),listItems:f,onAdd:()=>{var t;null===(t=e.current.setOpen)||void 0===t||t.call(null,!0)},onDelete:()=>{var e;o(k({confirmDialogProps:{onProceedAppend:()=>{b({body:{uuids:A},getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Delete user(s) failed. ",e]}),method:"delete",url:"/user"})}},formSummaryProps:{renderEntry:e=>{let{key:t}=e;return(0,l.jsx)(v.Ac,{children:null==f?void 0:f[t].userName})}},getConfirmDialogTitle:e=>"Delete the following ".concat(e," users?")})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>h(e=>!e),onItemCheckboxChange:(e,t,n)=>M(e,n),onItemClick:e=>{if(d){var t;g(e),null===(t=n.current.setOpen)||void 0===t||t.call(null,!0)}},renderListItemCheckboxState:e=>S(e),renderListItem:(e,t)=>{let{userName:n}=t;return(0,l.jsx)(v.Ac,{children:n})}})}),(0,l.jsx)(ee.Z,{...E,disableProceed:P,loadingAction:w,preActionArea:_,ref:e}),(0,l.jsx)(ee.Z,{...D,disableProceed:P,loadingAction:w,preActionArea:_,ref:n}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...s,ref:t})]})},eo=()=>(0,l.jsxs)(N.s_,{children:[(0,l.jsx)(V,{}),(0,l.jsx)(z,{}),(0,l.jsx)(es,{})]}),ec=n(13539),ei=n(46194),ea=n(90209);let ed=e=>(0,l.jsx)(ei.Z,{...e,sx:{width:"100%"}});var eu=e=>{let{installTarget:t="disabled",onSubmit:n,title:s}=e,[o,i]=(0,c.useState)(),a=(0,c.useMemo)(()=>s?(0,l.jsx)(v.z,{sx:{textAlign:"center"},children:s}):(0,l.jsx)(ea.Z,{mt:0}),[s]),d=(0,c.useMemo)(()=>o&&(0,l.jsx)(r.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(R.Z,{...o,onClose:()=>{i(void 0)}})}),[o,i]);return(0,l.jsxs)(N.s_,{children:[(0,l.jsx)(N.V9,{children:a}),(0,l.jsxs)(r.ZP,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(r.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsxs)(w.Z,{row:!0,children:[(0,l.jsx)(v.Ac,{sx:{flexGrow:1},children:"Install target"}),(0,l.jsx)(ec.Z,{checked:"enabled"===t,edge:"end",onChange:(e,t)=>{let r="disable",o="Disable";t&&(r="enable",o="Enable"),null==n||n.call(null,{actionProceedText:o,content:(0,l.jsxs)(v.Ac,{children:["Would you like to ",r,' "Install target" on this striker? It\'ll take a few moments to complete.']}),onProceedAppend:()=>{x.Z.put("/host/local",{isEnableInstallTarget:t},{params:{handler:"install-target"}}).catch(e=>{let t=(0,y.Z)(e);t.children="Failed to ".concat(r,' "Install target". ').concat(t.children),i(t)})},titleText:"".concat(o,' "Install target" on ').concat(s,"?")})}})]})}),(0,l.jsx)(r.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Update",content:(0,l.jsx)(v.Ac,{children:"Would you like to update the operating system on this striker? It'll be placed into maintenance mode until the update completes."}),onProceedAppend:()=>{x.Z.put("/command/update-system").catch(e=>{let t=(0,y.Z)(e);t.children="Failed to initiate system update. ".concat(t.children),i(t)})},titleText:"Update operating system on ".concat(s,"?")})},children:"Update system"})}),(0,l.jsx)(r.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{href:"/init?re=1",children:"Reconfigure striker"})}),(0,l.jsx)(r.ZP,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Reboot",content:(0,l.jsx)(v.Ac,{children:"Would you like to reboot this striker?"}),onProceedAppend:()=>{x.Z.put("/command/reboot-host").catch(e=>{let t=(0,y.Z)(e);t.children="Failed to initiate system reboot. ".concat(t.children),i(t)})},titleText:"Reboot ".concat(s,"?")})},children:"Reboot"})}),(0,l.jsx)(r.ZP,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Shutdown",content:(0,l.jsx)(v.Ac,{children:"Would you like to shutdown this striker?"}),onProceedAppend:()=>{x.Z.put("/command/poweroff-host").catch(e=>{let t=(0,y.Z)(e);t.children="Failed to initiate system shutdown. ".concat(t.children),i(t)})},titleText:"Shutdown ".concat(s,"?")})},children:"Shutdown"})}),d]})]})},eh=e=>{let{refreshInterval:t=6e4}=e,[n,s]=(0,c.useState)(!1),[h,p]=(0,c.useState)({actionProceedText:"",closeOnProceed:!0,content:"",dialogProps:{open:n},onCancelAppend:()=>{s(!1)},onProceedAppend:()=>{s(!1)},titleText:""}),[x,m]=(0,c.useState)(),[g,f]=(0,c.useState)(""),{data:j,isLoading:Z}=(0,u.Z)("".concat(i.Z,"/host/local"),{onError:()=>{f("Unknown")},onSuccess:e=>{let{installTarget:t,shortHostName:n}=e;m(t),f(n)},refreshInterval:t});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o(),{children:(0,l.jsx)("title",{children:Z?"Loading...":"".concat(null==j?void 0:j.shortHostName," Config")})}),(0,l.jsx)(d.Z,{}),(0,l.jsxs)(r.ZP,{container:!0,columns:{xs:1,md:3,lg:4},children:[(0,l.jsx)(r.ZP,{item:!0,xs:1,children:(0,l.jsx)(eu,{installTarget:x,onSubmit:e=>{let{onProceedAppend:t,...n}=e;p(e=>({...e,...n,onProceedAppend:function(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];null==t||t.call(null,...n),s(!1)}})),s(!0)},title:g})}),(0,l.jsx)(r.ZP,{item:!0,md:2,xs:1,children:(0,l.jsx)(eo,{})})]}),(0,l.jsx)(a.Z,{...h,dialogProps:{open:n}})]})}}},function(e){e.O(0,[447,256,548,918,558,436,879,888,774,179],function(){return e(e.s=14453)}),_N_E=e.O()}]);