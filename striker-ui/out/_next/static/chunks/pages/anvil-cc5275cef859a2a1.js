(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{72315:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/anvil",function(){return n(77035)}])},84337:function(e,t,n){"use strict";var s=n(67294);t.Z=function(){let{actionProceedText:e="",content:t="",titleText:n="",...o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.useState)({actionProceedText:e,content:t,titleText:n,...o})}},86142:function(e,t,n){"use strict";var s=n(54743),o=n(85893);t.Z=(0,s.Z)((0,o.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert")},62549:function(e,t,n){"use strict";var s=n(54743),o=n(85893);t.Z=(0,s.Z)((0,o.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"Sync")},13539:function(e,t,n){"use strict";var s=n(63366),o=n(87462),a=n(67294),r=n(8780),c=n(94780),i=n(41796),l=n(66643),d=n(87486),h=n(29567),u=n(77527),x=n(71230),m=n(85893);let p=["className","color","edge","size","sx"],g=e=>{let{classes:t,edge:n,size:s,color:a,checked:r,disabled:i}=e,d={root:["root",n&&"edge".concat((0,l.Z)(n)),"size".concat((0,l.Z)(s))],switchBase:["switchBase","color".concat((0,l.Z)(a)),r&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},h=(0,c.Z)(d,x.H,t);return(0,o.Z)({},t,h)},v=(0,u.ZP)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.edge&&t["edge".concat((0,l.Z)(n.edge))],t["size".concat((0,l.Z)(n.size))]]}})(e=>{let{ownerState:t}=e;return(0,o.Z)({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},"start"===t.edge&&{marginLeft:-8},"end"===t.edge&&{marginRight:-8},"small"===t.size&&{width:40,height:24,padding:7,["& .".concat(x.Z.thumb)]:{width:16,height:16},["& .".concat(x.Z.switchBase)]:{padding:4,["&.".concat(x.Z.checked)]:{transform:"translateX(16px)"}}})}),j=(0,u.ZP)(d.Z,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.switchBase,{["& .".concat(x.Z.input)]:t.input},"default"!==n.color&&t["color".concat((0,l.Z)(n.color))]]}})(e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:"".concat("light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]),transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),["&.".concat(x.Z.checked)]:{transform:"translateX(20px)"},["&.".concat(x.Z.disabled)]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:"".concat("light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600])},["&.".concat(x.Z.checked," + .").concat(x.Z.track)]:{opacity:.5},["&.".concat(x.Z.disabled," + .").concat(x.Z.track)]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:"".concat("light"===t.palette.mode?.12:.2)},["& .".concat(x.Z.input)]:{left:"-100%",width:"300%"}}},e=>{let{theme:t,ownerState:n}=e;return(0,o.Z)({"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,i.Fq)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==n.color&&{["&.".concat(x.Z.checked)]:{color:(t.vars||t).palette[n.color].main,"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n.color].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,i.Fq)(t.palette[n.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(x.Z.disabled)]:{color:t.vars?t.vars.palette.Switch["".concat(n.color,"DisabledColor")]:"".concat("light"===t.palette.mode?(0,i.$n)(t.palette[n.color].main,.62):(0,i._j)(t.palette[n.color].main,.55))}},["&.".concat(x.Z.checked," + .").concat(x.Z.track)]:{backgroundColor:(t.vars||t).palette[n.color].main}})}),f=(0,u.ZP)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:"".concat("light"===t.palette.mode?t.palette.common.black:t.palette.common.white),opacity:t.vars?t.vars.opacity.switchTrack:"".concat("light"===t.palette.mode?.38:.3)}}),Z=(0,u.ZP)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}}),b=a.forwardRef(function(e,t){let n=(0,h.Z)({props:e,name:"MuiSwitch"}),{className:a,color:c="primary",edge:i=!1,size:l="medium",sx:d}=n,u=(0,s.Z)(n,p),x=(0,o.Z)({},n,{color:c,edge:i,size:l}),b=g(x),w=(0,m.jsx)(Z,{className:b.thumb,ownerState:x});return(0,m.jsxs)(v,{className:(0,r.Z)(b.root,a),sx:d,ownerState:x,children:[(0,m.jsx)(j,(0,o.Z)({type:"checkbox",icon:w,checkedIcon:w,ref:t,ownerState:x},u,{classes:(0,o.Z)({},b,{root:b.switchBase})})),(0,m.jsx)(f,{className:b.track,ownerState:x})]})});t.Z=b},77035:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eE}});var s=n(85893),o=n(77527),a=n(90642),r=n(9008),c=n.n(r),i=n(11163),l=n(67294),d=n(53165),h=n(39971);let u=(0,l.createContext)({uuid:"",setAnvilUuid:()=>null});var x=e=>{let{children:t}=e,[n,o]=(0,l.useState)("");return(0,s.jsx)(u.Provider,{value:{uuid:n,setAnvilUuid:e=>{o(e)}},children:t})},m=n(65375),p=n(14631),g=n(13539),v=n(48403),j=n.n(v);let f=new Map([["degraded","Degraded"],["optimal","Optimal"],["offline","Offline"]]);var Z=n(28937),b=n(9968),w=n(11100),_=n(57882),k=n(40657);let y={anvilName:"".concat("SelectedAnvil","-anvilName")},N=(0,o.ZP)(a.Z)(()=>({display:"flex",flexDirection:"row",width:"100%",["& .".concat(y.anvilName)]:{paddingLeft:0}})),C=e=>{switch(e){case"optimal":return"ok";case"degraded":return"warning";default:return"off"}},S=e=>-1!==e.hosts.findIndex(e=>{let{state:t}=e;return"offline"!==t});var A=e=>{var t;let{list:n}=e,{uuid:o}=(0,l.useContext)(u),r=n.findIndex(e=>e.anvil_uuid===o),{confirmDialog:c,finishConfirm:i,setConfirmDialogLoading:d,setConfirmDialogOpen:h,setConfirmDialogProps:x}=(0,k.Z)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N,{children:""!==o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{p:1,children:(0,s.jsx)(b.Z,{colour:C(n[r].anvilStatus.system)})}),(0,s.jsxs)(a.Z,{p:1,flexGrow:1,className:y.anvilName,children:[(0,s.jsx)(_.z,{text:n[r].anvil_name}),(0,s.jsx)(_.z,{text:null!==(t=f.get(n[r].anvilStatus.system))&&void 0!==t?t:"State unavailable"})]}),(0,s.jsx)(a.Z,{p:1,children:(0,s.jsx)(g.Z,{checked:S(n[r]),onChange:()=>{let e;let{[r]:t}=n,{anvil_name:o,anvil_uuid:a}=t,c="start",l="blue";S(t)&&(c="stop",e="Servers hosted on this node will be shut down!",l="red");let u="".concat(c,"-an"),m=j()(c);x({actionProceedText:m,content:e,onProceedAppend:()=>{d(!0),Z.Z.put("/command/".concat(u,"/").concat(a)).then(()=>{i("Success",{children:(0,s.jsx)(s.Fragment,{children:"Successfully registered power job."})})}).catch(e=>{let t=(0,w.Z)(e);t.children=(0,s.jsxs)(s.Fragment,{children:["Failed to register power job. ",t.children]}),i("Error",t)})},proceedColour:l,titleText:"".concat(m," ").concat(o,"?")}),h(!0)}})})]})}),c]})},P=n(47407),T=n(56912),B=n(52311),M=e=>{var t;let{anvil:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.Ac,{text:n.anvil_name}),(0,s.jsx)(_.Ac,{text:null!==(t=f.get(n.anvilStatus.system))&&void 0!==t?t:"State unavailable"})]})},F=e=>{let t=[],n=[];return e.forEach(e=>{"optimal"===e.anvilStatus.system?t.push(e):n.push(e)}),[...n,...t]};let z="AnvilList",L={root:"".concat(z,"-root"),divider:"".concat(z,"-divider"),button:"".concat(z,"-button"),anvil:"".concat(z,"-anvil")},R=(0,o.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(L.root)]:{width:"100%",overflow:"auto",height:"30vh",paddingRight:".3em",[t.breakpoints.down(h.li)]:{height:"100%",overflow:"hidden"}},["& .".concat(L.divider)]:{backgroundColor:h.d},["& .".concat(L.button)]:{"&:hover":{backgroundColor:h.$T},paddingLeft:0},["& .".concat(L.anvil)]:{paddingLeft:0}}}),D=e=>{switch(e){case"optimal":return"ok";case"degraded":return"warning";default:return"off"}};var E=e=>{let{list:t}=e,{uuid:n,setAnvilUuid:o}=(0,l.useContext)(u);return(0,l.useEffect)(()=>{""===n&&o(F(t)[0].anvil_uuid)},[n,t,o]),(0,s.jsx)(R,{children:(0,s.jsx)(P.Z,{component:"nav",className:L.root,"aria-label":"mailbox folders",children:F(t).map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.Z,{className:L.divider}),(0,s.jsx)(B.Z,{className:L.button,onClick:()=>o(e.anvil_uuid),children:(0,s.jsxs)(a.Z,{display:"flex",flexDirection:"row",width:"100%",children:[(0,s.jsx)(a.Z,{p:1,children:(0,s.jsx)(b.Z,{colour:D(e.anvilStatus.system)})}),(0,s.jsx)(a.Z,{p:1,flexGrow:1,className:L.anvil,children:(0,s.jsx)(M,{anvil:e})})]})},e.anvil_uuid)]}))})})},I=e=>{let{list:t}=e,n=[];return null==t||t.anvils.forEach(e=>{let{anvil_uuid:t}=e,{data:s}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(t));n.push({...e,...s})}),(0,s.jsxs)(m.s_,{children:[(0,s.jsx)(A,{list:n}),(0,s.jsx)(E,{list:F(n)})]})},U=n(5387),O=n(90209),G=()=>{let{uuid:e}=(0,l.useContext)(u),{data:{allocated:t=0,cores:n=0,threads:o=0}={},isLoading:a}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(e,"/cpu")),r=(0,l.useMemo)(()=>a?(0,s.jsx)(O.Z,{}):(0,s.jsxs)(U.Z,{spacing:0,children:[(0,s.jsx)(_.Ac,{text:"Total Cores: ".concat(n)}),(0,s.jsx)(_.Ac,{text:"Total Threads: ".concat(o)}),(0,s.jsx)(_.Ac,{text:"Allocated Cores: ".concat(t)})]}),[t,n,a,o]);return(0,s.jsxs)(m.s_,{children:[(0,s.jsx)(m.V9,{children:(0,s.jsx)(_.z,{text:"CPU"})}),r]})},V=n(25436);let H=new Map([["message_0222","The subnode is in an unknown state."],["message_0223","The subnode is a full cluster member."],["message_0224","The subnode is coming online; the cluster resource manager is running (step 2/3)."],["message_0225","The subnode is coming online; the subnode is a consensus cluster member (step 1/3)."],["message_0226","The subnode has booted, but it is not (yet) joining the cluster."]]);var q=n(41373);let X="AnvilHost",W={state:"".concat(X,"-state"),bar:"".concat(X,"-bar"),label:"".concat(X,"-label"),decoratorBox:"".concat(X,"-decoratorBox")},$=(0,o.ZP)(a.Z)(e=>{let{theme:t}=e;return{overflow:"auto",height:"28vh",paddingLeft:".3em",paddingRight:".3em",[t.breakpoints.down(h.li)]:{height:"100%",overflow:"hidden"},["& .".concat(W.state)]:{paddingLeft:".7em",paddingRight:".7em"},["& .".concat(W.bar)]:{paddingLeft:".7em",paddingRight:".7em"},["& .".concat(W.label)]:{paddingTop:".3em"},["& .".concat(W.decoratorBox)]:{alignSelf:"stretch"}}}),Y=(e,t)=>{let n=e.exec(t);return n?H.get(n[0])||"Error code not recognized":"Error code not found"},J=e=>{switch(e){case"online":return"ok";case"offline":return"off";default:return"warning"}};var K=e=>{let{hosts:t}=e,n=/^[a-zA-Z]/,o=/^(message_[0-9]+)/,{confirmDialog:r,finishConfirm:c,setConfirmDialogLoading:i,setConfirmDialogOpen:l,setConfirmDialogProps:d}=(0,k.Z)();return t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($,{children:t.map(e=>{var t;if(!e)return;let r="online"===e.state,h="offline"===e.state,u=!h;return(0,s.jsxs)(m.Lg,{children:[(0,s.jsxs)(m.CH,{children:[(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(_.Ac,{text:e.host_name})}),(0,s.jsx)(a.Z,{className:W.decoratorBox,children:(0,s.jsx)(b.Z,{colour:J(e.state)})}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(_.Ac,{text:(null==e?void 0:null===(t=e.state)||void 0===t?void 0:t.replace(n,e=>e.toUpperCase()))||"Not Available"})})]}),(0,s.jsxs)(a.Z,{display:"flex",className:W.state,children:[(0,s.jsx)(a.Z,{className:W.label,children:(0,s.jsx)(_.Ac,{text:"Power: "})}),(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(g.Z,{checked:u,onChange:()=>{let t=u?"stop":"start",n="".concat(t,"-subnode"),o=j()(t);d({actionProceedText:o,content:"start"===t?(0,s.jsx)(_.Ac,{children:"The subnode will be powered on with IPMI commands."}):(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(_.Ac,{children:"The subnode will be powered off."}),(0,s.jsx)(_.Ac,{children:e.server_count?(0,s.jsxs)(s.Fragment,{children:["All ",e.server_count," servers on this subnode will be migrated to the peer subnode if possible. Otherwise, the servers will be shut down."]}):(0,s.jsx)(s.Fragment,{children:"No servers are on this subnode."})})]}),onProceedAppend:()=>{i(!0),Z.Z.put("/command/".concat(n,"/").concat(e.host_uuid)).then(()=>{c("Success",{children:(0,s.jsx)(s.Fragment,{children:"Successfully registered power job."})})}).catch(e=>{let t=(0,w.Z)(e);t.children=(0,s.jsxs)(s.Fragment,{children:["Failed to register power job. ",t.children]}),c("Error",t)})},titleText:"".concat(o," ").concat(e.host_name,"?")}),l(!0)}})}),(0,s.jsx)(a.Z,{className:W.label,children:(0,s.jsx)(_.Ac,{text:"Member: "})}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(g.Z,{checked:r,disabled:h,onChange:()=>{let t=r?"leave":"join",n="".concat(t,"-an"),o=j()(t);d({actionProceedText:o,content:"leave"===t?(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(_.Ac,{children:"The subnode will be withdrawn from its cluster and servers will be migrated as necessary."}),(0,s.jsx)(_.Ac,{children:"The operation is reversible. You can tell it to join the cluster again later."})]}):(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(_.Ac,{children:"The subnode will join the cluster it belongs to."}),(0,s.jsx)(_.Ac,{children:"The operation is reversible. You can tell it to withdraw from the cluster again later."})]}),onProceedAppend:()=>{i(!0),Z.Z.put("/command/".concat(n,"/").concat(e.host_uuid)).then(()=>{c("Success",{children:(0,s.jsx)(s.Fragment,{children:"Successfully registered cluster membership job."})})}).catch(e=>{let t=(0,w.Z)(e);t.children=(0,s.jsxs)(s.Fragment,{children:["Failed to register cluster memebership job."," ",t.children]}),c("Error",t)})},titleText:"".concat(o," cluster on ").concat(e.host_name,"?")}),l(!0)}})})]}),!r&&u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{display:"flex",width:"100%",className:W.state,children:(0,s.jsx)(a.Z,{children:(0,s.jsx)(_.Ac,{text:Y(o,e.state_message)})})}),(0,s.jsx)(a.Z,{display:"flex",width:"100%",className:W.bar,children:(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(q.ko,{progressPercentage:e.state_percent})})})]})]},e.host_uuid)})}),r]}):(0,s.jsx)($,{})},Q=e=>null==e?void 0:e.filter(e=>e.host_uuid),ee=e=>{let{anvil:t}=e,{uuid:n}=(0,l.useContext)(u),{data:o,isLoading:a}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(n)),r=t.findIndex(e=>e.anvil_uuid===n);return(0,s.jsxs)(m.s_,{children:[(0,s.jsx)(_.z,{text:"Subnodes"}),a?(0,s.jsx)(O.Z,{}):(0,s.jsx)(s.Fragment,{children:-1!==r&&o&&(0,s.jsx)(K,{hosts:Q(t[r].hosts).reduce((e,t,n)=>{let s=o.hosts[n];return s&&e.push(s),e},[])})})]})},et=n(46283),en=()=>{let{uuid:e}=(0,l.useContext)(u),{data:{allocated:t="0",reserved:n="0",total:o="0"}={},isLoading:r}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(e,"/memory")),c=(0,l.useMemo)(()=>BigInt(t),[t]),i=(0,l.useMemo)(()=>BigInt(n),[n]),h=(0,l.useMemo)(()=>BigInt(o),[o]);return(0,s.jsxs)(m.s_,{children:[(0,s.jsx)(m.V9,{children:(0,s.jsx)(_.z,{text:"Memory"})}),r?(0,s.jsx)(O.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.Z,{display:"flex",width:"100%",children:[(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(_.Ac,{text:"Allocated: ".concat((0,et.MU)(c))})}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(_.Ac,{text:"Free: ".concat((0,et.MU)(h-(i+c)))})})]}),(0,s.jsx)(a.Z,{display:"flex",width:"100%",children:(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(q.CD,{allocated:Number((i+c)*BigInt(100)/h)})})}),(0,s.jsx)(a.Z,{display:"flex",justifyContent:"center",width:"100%",children:(0,s.jsx)(_.Ac,{text:"Total: ".concat((0,et.MU)(h)," | Reserved: ").concat((0,et.MU)(i))})})]})]})},es=e=>{let t=[],n={bonds:[]};return e.hosts.forEach(e=>{e.bonds.forEach(s=>{let o=t.findIndex(e=>e===s.bond_name);-1===o?(t.push(s.bond_name),n.bonds.push({bond_name:s.bond_name,bond_uuid:s.bond_uuid,bond_speed:0,bond_state:"degraded",hosts:[{host_name:e.host_name,host_uuid:e.host_uuid,link:s.links[0].is_active?s.links[0]:s.links[1]}]})):n.bonds[o].hosts.push({host_name:e.host_name,host_uuid:e.host_uuid,link:s.links[0].is_active?s.links[0]:s.links[1]})})}),n.bonds.forEach(e=>{let t=e.hosts[0].link.link_speed>e.hosts[1].link.link_speed?1:0;e.bond_speed=e.hosts[t].link.link_speed,e.bond_state=e.hosts[t].link.link_state}),n};let eo="Network",ea={container:"".concat(eo,"-container"),root:"".concat(eo,"-root"),noPaddingLeft:"".concat(eo,"-noPaddingLeft"),divider:"".concat(eo,"-divider"),verticalDivider:"".concat(eo,"-verticalDivider")},er=(0,o.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(ea.container)]:{width:"100%",overflow:"auto",height:"32vh",paddingRight:".3em",[t.breakpoints.down(h.li)]:{height:"100%",overflow:"hidden"}},["& .".concat(ea.root)]:{paddingTop:".7em",paddingBottom:".7em"},["& .".concat(ea.noPaddingLeft)]:{paddingLeft:0},["& .".concat(ea.divider)]:{backgroundColor:h.d},["& .".concat(ea.verticalDivider)]:{height:"3.5em"}}}),ec=e=>{switch(e){case"optimal":return"ok";case"degraded":default:return"warning";case"down":return"error"}};var ei=()=>{let{uuid:e}=(0,l.useContext)(u),[t,n]=(0,l.useState)(),{isLoading:o}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(e,"/network"),{onSuccess:e=>{n(es(e))}});return(0,s.jsx)(m.s_,{children:(0,s.jsxs)(er,{children:[(0,s.jsx)(_.z,{text:"Network"}),o?(0,s.jsx)(O.Z,{}):(0,s.jsx)(a.Z,{className:ea.container,children:t&&t.bonds.map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.Z,{className:ea.root,display:"flex",flexDirection:"row",width:"100%",children:[(0,s.jsx)(a.Z,{p:1,className:ea.noPaddingLeft,children:(0,s.jsx)(b.Z,{colour:ec(e.bond_state)})}),(0,s.jsxs)(a.Z,{p:1,flexGrow:1,className:ea.noPaddingLeft,children:[(0,s.jsx)(_.Ac,{text:e.bond_name}),(0,s.jsx)(_.Ac,{text:"".concat(e.bond_speed,"Mbps")})]}),(0,s.jsx)(a.Z,{display:"flex",style:{paddingTop:".5em"},children:e.hosts.map((t,n)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{p:1,style:{paddingTop:0,paddingBottom:0},children:(0,s.jsxs)(a.Z,{children:[(0,s.jsx)(_.Ac,{text:t.host_name,selected:!1}),(0,s.jsx)(_.Ac,{text:t.link.link_name})]})},t.host_name),n!==e.hosts.length-1&&(0,s.jsx)(T.Z,{className:"".concat(ea.divider," ").concat(ea.verticalDivider),orientation:"vertical",flexItem:!0})]}))})]}),(0,s.jsx)(T.Z,{className:ea.divider})]}))})]})})},el=n(86142),ed=n(96788),eh=n(73939),eu=n(19304);let ex=new Map([["running","Running"],["idle","Idle"],["paused","Paused"],["in shutdown","Shutting Down"],["shut off","Off"],["crashed","Crashed"],["pmsuspended","PM Suspended"],["migrating","Migrating"],["provisioning","Provisioning"]]);var em=n(47177),ep=n(46194),eg=n(45328),ev=n(37600),ej=n(18766),ef=n(64860),eZ=(e,t)=>fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),eb=n(84337);let ew="Servers",e_={root:"".concat(ew,"-root"),divider:"".concat(ew,"-divider"),verticalDivider:"".concat(ew,"-verticalDivider"),button:"".concat(ew,"-button"),headerPadding:"".concat(ew,"-headerPadding"),hostsBox:"".concat(ew,"-hostsBox"),hostBox:"".concat(ew,"-hostBox"),checkbox:"".concat(ew,"-checkbox"),editButtonBox:"".concat(ew,"-editButtonBox"),dropdown:"".concat(ew,"-dropdown"),on:"".concat(ew,"-on"),off:"".concat(ew,"-off"),all:"".concat(ew,"-all")},ek=(0,o.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(e_.root)]:{width:"100%",overflow:"auto",height:"78vh",paddingRight:".3em",[t.breakpoints.down(h.li)]:{height:"100%",overflow:"hidden"}},["& .".concat(e_.divider)]:{backgroundColor:h.d},["& .".concat(e_.verticalDivider)]:{height:"75%",paddingTop:"1em"},["& .".concat(e_.button)]:{"&:hover":{backgroundColor:h.$T},paddingLeft:0},["& .".concat(e_.headerPadding)]:{paddingLeft:".3em"},["& .".concat(e_.hostsBox)]:{padding:"1em",paddingRight:0},["& .".concat(e_.hostBox)]:{paddingTop:0},["& .".concat(e_.checkbox)]:{paddingTop:".8em"},["& .".concat(e_.editButtonBox)]:{paddingTop:".3em"},["& .".concat(e_.dropdown)]:{paddingTop:".8em",paddingBottom:".8em"},["& .".concat(e_.all)]:{paddingTop:".5em",paddingLeft:".3em"}}}),ey=e=>{switch(e){case"running":return"ok";case"shut off":return"off";case"crashed":return"error";default:return"warning"}},eN=(0,o.ZP)(ed.Z)({["&.".concat(e_.on)]:{color:h.Ej},["&.".concat(e_.off)]:{color:h.hM}});var eC=e=>{var t;let{anvil:n}=e,[o,r]=(0,l.useState)(null),[c,i]=(0,l.useState)(!1),[x,g]=(0,l.useState)(!1),[v,j]=(0,l.useState)([]),[f,k]=(0,l.useState)(!1),y=(0,l.useRef)({}),[N,C]=(0,eb.Z)(),{uuid:S}=(0,l.useContext)(u),A=(0,l.useRef)([]),{data:B}=(0,p.Z)("".concat(d.Z,"/server?anvilUUIDs=").concat(S)),M=(0,l.useMemo)(()=>B&&Object.values(B),[B]),F=e=>{A.current=[],e.filter(e=>"running"===e.state).length&&A.current.push("off"),e.filter(e=>"shut off"===e.state).length&&A.current.push("on")},z=e=>{r(null),v.length&&v.forEach(t=>{eZ("".concat(d.Z,"/command/").concat("on"===e?"start-server":"stop-server","/").concat(t),{})})},L=e=>{if(!M)return;let t=v.indexOf(e);-1===t?v.push(e):v.splice(t,1),F(M.filter(e=>-1!==v.indexOf(e.uuid))),j([...v])},R=n.findIndex(e=>e.anvil_uuid===S),D=Q(null===(t=n[R])||void 0===t?void 0:t.hosts),E=(0,l.useMemo)(()=>!v.length,[v.length]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.s_,{children:(0,s.jsxs)(ek,{children:[(0,s.jsxs)(m.V9,{className:e_.headerPadding,sx:{marginBottom:0},children:[(0,s.jsx)(_.z,{text:"Servers"}),c&&(0,s.jsx)(eg.Z,{disabled:E,mapPreset:"delete",onClick:()=>{var e;C({actionProceedText:"Delete",content:"Are you sure you want to delete the selected server(s)? This action is not revertable.",onProceedAppend:()=>{Z.Z.request({data:{serverUuids:v},method:"delete",url:"/server"}).catch(e=>{(0,w.Z)(e)})},proceedColour:"red",titleText:"Delete ".concat(v.length," server(s)?")}),null===(e=y.current.setOpen)||void 0===e||e.call(null,!0)},variant:"redcontained"}),(0,s.jsx)(eg.Z,{mapPreset:"edit",onClick:()=>i(!c),state:String(c)}),(0,s.jsx)(eg.Z,{mapPreset:"add",onClick:()=>k(!0)})]}),c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{className:e_.headerPadding,display:"flex",children:(0,s.jsxs)(a.Z,{flexGrow:1,className:e_.dropdown,children:[(0,s.jsx)(ep.Z,{disabled:E,onClick:e=>{r(e.currentTarget)},startIcon:(0,s.jsx)(el.Z,{}),children:"Power"}),(0,s.jsx)(ev.Z,{muiMenuProps:{anchorEl:o,keepMounted:!0,onClose:()=>r(null)},open:!!o,children:A.current.map(e=>(0,s.jsx)(ej.Z,{onClick:()=>z(e),children:(0,s.jsx)(eN,{className:e_[e],variant:"subtitle1",children:e.replace(/^[a-z]/,e=>e.toUpperCase())})},e))})]})}),(0,s.jsxs)(a.Z,{display:"flex",children:[(0,s.jsx)(a.Z,{children:(0,s.jsx)(eh.Z,{style:{color:h.lD},color:"secondary",checked:x,onChange:()=>{M&&(x?(F([]),j([])):(F(M),j(M.map(e=>e.uuid))),g(!x))}})}),(0,s.jsx)(a.Z,{className:e_.all,children:(0,s.jsx)(_.Ac,{text:"All"})})]})]}),M?(0,s.jsx)(a.Z,{className:e_.root,children:(0,s.jsx)(P.Z,{component:"nav",children:M.map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eu.ZP,{button:!0,className:e_.button,component:c?"div":"a",href:"/server?uuid=".concat(e.uuid,"&server_name=").concat(e.name,"&server_state=").concat(e.state),onClick:()=>L(e.uuid),children:(0,s.jsxs)(a.Z,{display:"flex",flexDirection:"row",width:"100%",children:[c&&(0,s.jsx)(a.Z,{className:e_.checkbox,children:(0,s.jsx)(eh.Z,{style:{color:h.lD},color:"secondary",checked:void 0!==v.find(t=>t===e.uuid)})}),(0,s.jsx)(a.Z,{p:1,children:(0,s.jsx)(b.Z,{colour:ey(e.state)})}),(0,s.jsxs)(a.Z,{p:1,flexGrow:1,children:[(0,s.jsx)(_.Ac,{text:e.name}),(0,s.jsx)(_.Ac,{text:ex.get(e.state)||"Not Available"})]}),(0,s.jsx)(a.Z,{display:"flex",className:e_.hostsBox,children:"shut off"!==e.state&&"crashed"!==e.state&&D.map((t,n)=>{var o;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{p:1,className:e_.hostBox,children:(0,s.jsx)(_.Ac,{text:t.host_name,selected:(null===(o=e.host)||void 0===o?void 0:o.uuid)===t.host_uuid})},t.host_uuid),n!==D.length-1&&(0,s.jsx)(T.Z,{className:"".concat(e_.divider," ").concat(e_.verticalDivider),orientation:"vertical"})]})})})]})},e.uuid),(0,s.jsx)(T.Z,{className:e_.divider})]}))})}):(0,s.jsx)(O.Z,{})]})}),(0,s.jsx)(ef.Z,{dialogProps:{open:f},onClose:()=>{k(!1)}}),(0,s.jsx)(em.Z,{closeOnProceed:!0,...N,ref:y})]})};let eS="SharedStorageHost",eA={fs:"".concat(eS,"-fs"),bar:"".concat(eS,"-bar"),decoratorBox:"".concat(eS,"-decoratorBox")},eP=(0,o.ZP)("div")(()=>({["& .".concat(eA.fs)]:{paddingLeft:".7em",paddingRight:".7em"},["& .".concat(eA.bar)]:{paddingLeft:".7em",paddingRight:".7em"},["& .".concat(eA.decoratorBox)]:{paddingRight:".3em"}}));var eT=e=>{let{group:t}=e,{storage_group_free:n,storage_group_total:o}=t,r=(0,l.useMemo)(()=>BigInt(n),[n]),c=(0,l.useMemo)(()=>BigInt(o),[o]),i=(0,l.useMemo)(()=>c-r,[r,c]),d=(0,l.useMemo)(()=>Number(i*BigInt(100)/c),[i,c]);return(0,s.jsxs)(eP,{children:[(0,s.jsxs)(a.Z,{display:"flex",width:"100%",className:eA.fs,children:[(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(_.Ac,{text:"Used: ".concat((0,et.MU)(c-r))})}),(0,s.jsx)(a.Z,{children:(0,s.jsx)(_.Ac,{text:"Free: ".concat((0,et.MU)(r))})})]}),(0,s.jsx)(a.Z,{display:"flex",width:"100%",className:eA.bar,children:(0,s.jsx)(a.Z,{flexGrow:1,children:(0,s.jsx)(q.CD,{allocated:d})})}),(0,s.jsx)(a.Z,{display:"flex",justifyContent:"center",width:"100%",children:(0,s.jsx)(_.Ac,{text:"Total Storage: ".concat((0,et.MU)(c))})})]})};let eB={root:"".concat("SharedStorage","-root")},eM=(0,o.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(eB.root)]:{overflow:"auto",height:"78vh",paddingLeft:".3em",paddingRight:".3em",[t.breakpoints.down(h.li)]:{height:"100%"}}}});var eF=()=>{let{uuid:e}=(0,l.useContext)(u),{data:t,isLoading:n}=(0,p.Z)("".concat(d.Z,"/anvil/").concat(e,"/store"));return(0,s.jsx)(m.s_,{children:(0,s.jsxs)(eM,{children:[(0,s.jsx)(_.z,{text:"Shared Storage"}),n?(0,s.jsx)(O.Z,{}):(0,s.jsx)(a.Z,{className:eB.root,children:(null==t?void 0:t.storage_groups)&&t.storage_groups.map(e=>(0,s.jsxs)(m.Lg,{children:[(0,s.jsx)(m.CH,{children:(0,s.jsx)(_.Ac,{text:e.storage_group_name})}),(0,s.jsx)(eT,{group:e},e.storage_group_uuid)]},e.storage_group_uuid))})]})})},ez=()=>{let[e,t]=(0,l.useState)(void 0);return(0,l.useEffect)(()=>{let e=()=>{t(window.innerWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e};let eL="Anvil",eR={child:"".concat(eL,"-child"),server:"".concat(eL,"-server"),container:"".concat(eL,"-container")},eD=(0,o.ZP)("div")(e=>{let{theme:t}=e;return{["& .".concat(eR.child)]:{width:"22%",height:"100%",[t.breakpoints.down(h.li)]:{width:"50%"},[t.breakpoints.down("md")]:{width:"100%"}},["& .".concat(eR.server)]:{width:"35%",height:"100%",[t.breakpoints.down("md")]:{width:"100%"}},["& .".concat(eR.container)]:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",[t.breakpoints.down("md")]:{display:"block"}}}});var eE=()=>{let e=(0,i.useRouter)(),t=ez(),{anvil_uuid:n}=e.query,{uuid:o,setAnvilUuid:r}=(0,l.useContext)(u),{data:g,isLoading:v}=(0,p.Z)("".concat(d.Z,"/anvil/summary")),j=(0,l.useMemo)(()=>{let e;return g&&t&&(e=t>h.li?(0,s.jsxs)(a.Z,{className:eR.container,children:[(0,s.jsxs)(a.Z,{className:eR.child,children:[(0,s.jsx)(I,{list:g}),(0,s.jsx)(ee,{anvil:g.anvils})]}),(0,s.jsx)(a.Z,{className:eR.server,children:(0,s.jsx)(eC,{anvil:g.anvils})}),(0,s.jsx)(a.Z,{className:eR.child,children:(0,s.jsx)(eF,{})}),(0,s.jsxs)(a.Z,{className:eR.child,children:[(0,s.jsx)(ei,{}),(0,s.jsx)(G,{}),(0,s.jsx)(en,{})]})]}):(0,s.jsxs)(a.Z,{className:eR.container,children:[(0,s.jsxs)(a.Z,{className:eR.child,children:[(0,s.jsx)(eC,{anvil:g.anvils}),(0,s.jsx)(I,{list:g}),(0,s.jsx)(ee,{anvil:g.anvils})]}),(0,s.jsxs)(a.Z,{className:eR.child,children:[(0,s.jsx)(ei,{}),(0,s.jsx)(eF,{}),(0,s.jsx)(G,{}),(0,s.jsx)(en,{})]})]})),e},[g,t]),f=(0,l.useMemo)(()=>v?(0,s.jsx)(m.s_,{sx:{marginLeft:{xs:"1em",sm:"auto"},marginRight:{xs:"1em",sm:"auto"},marginTop:"calc(50vh - 10em)",maxWidth:{xs:void 0,sm:"60%",md:"50%",lg:"40%"},minWidth:"fit-content"},children:(0,s.jsx)(O.Z,{sx:{margin:"2em 2.4em"}})}):j,[j,v]);return(0,l.useEffect)(()=>{""===o&&r((null==n?void 0:n.toString())||"")},[o,n,r]),(0,s.jsxs)(eD,{children:[(0,s.jsx)(c(),{children:(0,s.jsx)("title",{children:"Anvil"})}),(0,s.jsxs)(x,{children:[(0,s.jsx)(V.Z,{}),f]})]})}},11163:function(e,t,n){e.exports=n(43079)}},function(e){e.O(0,[447,256,940,245,558,436,215,888,774,179],function(){return e(e.s=72315)}),_N_E=e.O()}]);