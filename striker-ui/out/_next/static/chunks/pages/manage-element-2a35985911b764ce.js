(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{40663:(e,n,t)=>{"use strict";t.d(n,{A:()=>h});var r=t(37876),s=t(35656),a=t(57212),l=t(54773),i=t(14232),o=t(90890),c=t(46316),d=t(51677);let u=(0,l.Ay)(s.A)({height:"3.5em",marginLeft:0,width:"100%"}),h=e=>{let{baseInputProps:n,checked:t,formControlLabelProps:s,id:l,label:h,name:m,onChange:p,switchProps:x}=e,f=(0,i.useMemo)(()=>(0,c.A)(h,d.a3,{color:"".concat(o.Qu,"AF"),inheritColour:!0}),[h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{control:(0,r.jsx)(a.A,{checked:t,edge:"end",name:m,onChange:p,...x}),label:f,labelPlacement:"start",slotProps:{typography:{flexGrow:1}},...s}),(0,r.jsx)("input",{checked:t,hidden:!0,id:l,readOnly:!0,type:"checkbox",...n})]})}},44193:(e,n,t)=>{"use strict";t.d(n,{A:()=>o});var r=t(14232),s=t(23934),a=t(12698),l=t(5806);let i=(e,n)=>{let{key:t,re:r,replace:s,value:l}=n;return t?e[t]===l?e:(0,a.Ay)(t,l)(e):r?(0,a.WT)(r,l)(e):s||e},o=(e,n)=>{var t;let[a,o]=(0,r.useState)(!1),[c,d]=(0,r.useReducer)(i,{}),u=(0,r.useCallback)(e=>{var t,r;return null==n||null==(r=n.current)||null==(t=r.setMessage)?void 0:t.call(null,"api",e)},[n]),h=(0,r.useCallback)((e,t)=>{var r,s;null==n||null==(s=n.current)||null==(r=s.setMessage)||r.call(null,String(e),t)},[n]),m=(0,r.useCallback)((e,t)=>{var r,s;null==n||null==(s=n.current)||null==(r=s.setMessageRe)||r.call(null,e,t)},[n]),p=(0,r.useCallback)(e=>{d({replace:e})},[]),x=(0,r.useCallback)((e,n)=>{d({key:e,value:n})},[]),f=(0,r.useCallback)((e,n)=>{d({re:e,value:n})},[]),j=(0,r.useCallback)(e=>{h(e),x(e)},[h,x]),g=(0,r.useCallback)(e=>{m(e),f(e)},[m,f]),A=(0,r.useCallback)(e=>n=>{x(e,n)},[x]),v=(0,r.useCallback)(e=>n=>{let{isValid:t}=n;x(e,t)},[x]),w=(0,r.useCallback)(e=>()=>{j(e)},[j]),b=(0,r.useCallback)(e=>{let{body:r,getErrorMsg:a,msgKey:i="api",method:c,onError:d,onSuccess:u,setMsg:h=null==n||null==(t=n.current)?void 0:t.setMessage,successMsg:m,url:p}=e;o(!0),s.A.request({data:r,method:c,url:p}).then(()=>{null==h||h.call(null,i,{children:m,type:"info"}),null==u||u.call(null)}).catch(e=>{let n=(0,l.A)(e);n.children=a(n.children),null==h||h.call(null,i,n),null==d||d.call(null)}).finally(()=>{o(!1)})},[n,o]),k=(0,r.useMemo)(()=>Object.values(c).some(e=>!e),[c]);return{buildFinishInputTestBatchFunction:A,buildInputFirstRenderFunction:v,buildInputUnmountFunction:w,formValidity:c,isFormInvalid:k,isFormSubmitting:a,setApiMessage:u,setFormValidity:p,setMessage:h,setMessageRe:m,setValidity:x,setValidityRe:f,submitForm:b,unsetKey:j,unsetKeyRe:g}}},45997:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>nN});var r=t(37876),s=t(77328),a=t.n(s),l=t(89099),i=t(14232),o=t(99955),c=t(86732),d=t(64410),u=t(96043),h=t(19603),m=t(12981),p=t(52076),x=t.n(p),f=t(63190),j=t(23934),g=t(57763),A=t(22430),v=t(48171),w=t(69267),b=t(65873),k=t(40663),y=t(51677),C=t(4064);let S=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,id:l,parameter:o,required:c}=s,{content_type:d,default:h,description:p,options:x=[]}=o,{changeFieldValue:f,formik:j,handleChange:g}=a,S="parameters.".concat(l,".value"),I=(0,i.useMemo)(()=>{let e;if("boolean"===d){let e=!!j.values.parameters[l].value;return(0,r.jsx)(k.A,{checked:e,id:S,label:l,name:S,onChange:(e,n)=>{f(S,n,!0)}})}let n=String(j.values.parameters[l].value);return"select"===d?(0,r.jsx)(b.A,{id:S,label:l,name:S,onChange:j.handleChange,required:c,selectItems:x,selectProps:{onClearIndicatorClick:()=>{f(S,"",!0)}},value:n}):(u.sX.test(l)?e=v.A.password:"string"!==d&&(e=v.A.number),(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:S,inputProps:{placeholder:h},label:l,name:S,onChange:g,required:c,type:e,value:n})}))},[S,f,j,g,l,x,h,d,c]);return(0,i.useMemo)(()=>(0,r.jsx)(A.A,{disableInteractive:!0,placement:"top-start",slotProps:{tooltip:{sx:{maxWidth:{md:"63em"}}}},title:(0,r.jsx)(y.a3,{children:p}),children:(0,r.jsx)(m.A,{children:I})},"".concat(l,"-tooltip")),[p,l,I])};var I=t(52627);let M=(e,n)=>{let t=!1;return[/plug|port/i.test(e),Number(n.deprecated),n.replacement].some(e=>!!e)?t=!1:1===Number(n.required)&&(t=!0),t};var O=t(5806),N=t(71401),P=t(23437),U=t(91408);let q=["integer","second"];var D=t(2062);let F=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(n);return U.Ik({agent:U.Yj().required().oneOf(r),name:((e,n)=>{let t=Object.values(n);e&&(t=t.filter(n=>n.fenceUUID!==e));let r=t.map(e=>e.fenceName);return U.Yj().min(1).max(32).notOneOf(r,"${path} already exists")})(t,e).required(),parameters:U.RZ((e,t)=>{var r;let{context:s}=t,a=null!=(r=null==s?void 0:s.agent)?r:"",l=(0,D.A)(e,e=>{let{[a]:t}=n;if(!t)return U.Ik({value:U.gl()});let{[e]:r}=t.parameters,s=((e,n)=>{let t,{content_type:r,options:s}=n;return t="boolean"===r?U.zM():q.includes(r)?U.ai():U.Yj(),M(e,n)&&(t=t.required()),s&&(t=t.oneOf(s)),t})(e,r);return U.Ik({value:s})});return U.Ik(l)})})};var E=t(71986);let R=(e,n)=>Object.entries(e.parameters).reduce((e,t)=>{var r,s;let a,[l,i]=t,{content_type:o}=i,c=null!=(s=null!=(r=null==n?void 0:n.fenceParameters[l])?r:i.default)?s:"";return a="boolean"===o?["1","on"].some(e=>e===c):String(c),e[l]={value:a},e},{}),T=(e,n,t)=>Object.entries(n).reduce((n,s)=>{let[a,l]=s,{deprecated:i,replacement:o}=l;return Number(i)||o||n.push((0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(S,{formikUtils:e,id:a,parameter:l,required:t})},"".concat(a,"-parameter-input"))),n},[]),z=e=>{let{fence:n,fences:t,template:s,tools:a}=e,l=void 0!==n,o=(0,i.useMemo)(()=>{let e,t,r;return l?(e="put",t="/fence/".concat(n.fenceUUID),r="update"):(e="post",t="/fence",r="add"),{capped:x()(r),method:e,url:t,value:r}},[l,null==n?void 0:n.fenceUUID]),c=(0,i.useMemo)(()=>Object.keys(s).sort((e,n)=>e.localeCompare(n)),[s]),u=(0,i.useMemo)(()=>((e,n)=>{let t={agent:null,name:"",parameters:{},uuid:""};if(n){let{fenceAgent:r,fenceName:s,fenceUUID:a}=n;t.agent=r,t.name=s,t.parameters=R(e[r],n),t.uuid=a}return t})(s,n),[n,s]),h=(0,E.A)({initialValues:u,onSubmit:(e,n)=>{let{setSubmitting:t}=n,{name:i,parameters:c}=e,d=String(e.agent),u={agent:d,name:i,parameters:Object.entries(c).reduce((e,n)=>{let[t,{value:r}]=n,{[d]:a}=s;if(!a)return e;let{[t]:i}=a.parameters,o=((e,n)=>"boolean"===n?e?"1":"":String(e))(r,i.content_type);return(l||o)&&o!==i.default&&(e[t]=o),e},{})};a.confirm.prepare({actionProceedText:o.capped,content:(0,r.jsx)(I.A,{entries:u,hasPassword:!0,getEntryLabel:e=>{let{cap:n,depth:t,key:r}=e;return t?r:n(r)}}),onCancelAppend:()=>t(!1),onProceedAppend:()=>{a.confirm.loading(!0),j.A.request({data:u,method:o.method,url:o.url}).then(()=>{a.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:[o.capped,"ed fence device ",i]})}),a.add.open(!1)}).catch(e=>{let n=(0,O.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to ",o.value," fence device. ",n.children]}),a.confirm.finish("Error",n),t(!1)})},titleText:"".concat(o.capped," fence device with the following?")}),a.confirm.open()},validationSchema:F(t,s,null==n?void 0:n.fenceUUID)}),{disabledSubmit:p,formik:A,formikErrors:v,handleChange:b}=h,k=(0,i.useMemo)(()=>({agent:"agent",name:"name",parameters:"parameters"}),[]),S=(0,i.useMemo)(()=>{let e;return A.values.agent&&({[A.values.agent]:e}=s),(e=>{let n={optional:{},required:{}};if(!e)return n;let{parameters:t}=e;return Object.entries(t).sort((e,n)=>{let[t]=e,[r]=n;return t.localeCompare(r)}).reduce((e,n)=>{let[t,r]=n;return e[M(t,r)?"required":"optional"][t]=r,e},n)})(e)},[A.values.agent,s]),U=(0,i.useMemo)(()=>T(h,S.optional),[h,S.optional]),q=(0,i.useMemo)(()=>T(h,S.required,!0),[h,S.required]);return(0,r.jsxs)(d.Ay,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),A.submitForm()},rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{container:!0,maxHeight:"50vh",overflow:"scroll",rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(g.A,{disabled:l,id:k.agent,label:"Fence device type",noOptionsText:"No matching fence device type",onChange:(e,t)=>{let r={...A.values,agent:t};if(t){let{[t]:e}=s;r.parameters=R(e,n)}A.setValues(r,!0)},openOnFocus:!0,options:c,renderOption:(e,n)=>{let{[n]:t}=s,a="string"==typeof t.description?t.description:"None";return(0,i.createElement)("li",{...e,key:"fence-agent-".concat(n)},(0,r.jsxs)(m.A,{children:[(0,r.jsx)(y.a3,{inheritColour:!0,children:n}),(0,r.jsx)(y.a3,{selected:!1,children:a})]}))},required:!0,value:A.values.agent})}),A.values.agent&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(P.l8,{expandInitially:!0,header:"Required parameters",panelProps:{mv:0},children:(0,r.jsxs)(d.Ay,{container:!0,rowSpacing:"0.6em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:k.name,label:"Fence device name",name:k.name,onChange:b,required:!0,value:A.values.name})})}),q]})})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(P.l8,{header:"Optional parameters",panelProps:{mv:0},children:(0,r.jsx)(d.Ay,{container:!0,rowSpacing:"0.6em",children:U})})})]})]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:v})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:o.capped,disabled:p,type:"submit"}]})})]})};var H=t(59664);let V=()=>{let{data:e,loading:n}=(0,H.A)("/fence/template");return(0,r.jsx)(h.A,{addHeader:"Add a fence device",editHeader:e=>(0,r.jsxs)(y.HM,{children:["Update fence device"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:null==e?void 0:e.fenceName})," ","parameters"]}),entriesUrl:"/fence",formDialogProps:{common:{wide:!0}},getAddLoading:e=>e||n,getEditLoading:e=>e||n,getDeleteErrorMessage:function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];return{...t,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete fence device(s). ",e]})}},getDeleteHeader:e=>"Delete ".concat(e," fence device(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted fence device(s)"})}),listEmpty:"No fence device(s) found.",onItemClick:(e,n)=>{let{args:t,entry:r,tools:s}=n,[a]=t;r.set(a),s.edit.open(!0)},renderAddForm:(n,t)=>t&&e&&(0,r.jsx)(z,{fences:t,template:e,tools:n}),renderDeleteItem:(e,n)=>{let{key:t}=n,s=null==e?void 0:e[t];return(0,r.jsx)(y.a3,{children:null==s?void 0:s.fenceName})},renderEditForm:(n,t,s)=>s&&e&&(0,r.jsx)(z,{fence:t,fences:s,template:e,tools:n}),renderListItem:(e,n)=>{let{fenceAgent:t,fenceName:s,fenceParameters:a}=n;return(0,r.jsxs)(d.Ay,{columnSpacing:"1em",container:!0,children:[(0,r.jsx)(d.Ay,{item:!0,children:(0,r.jsx)(y.a3,{children:s})}),(0,r.jsx)(d.Ay,{item:!0,xs:!0,children:(0,r.jsx)(y.a3,{noWrap:!0,children:Object.entries(a).sort((e,n)=>{let[t]=e,[r]=n;return t.localeCompare(r)}).reduce((e,n)=>{let[t,s]=n,a=(0,r.jsxs)(r.Fragment,{children:[t,'="']});return a=u.sX.test(t)?(0,r.jsxs)(r.Fragment,{children:[a,(0,r.jsx)(y.EN,{wrapper:"mono",wrapperProps:{noWrap:!0},children:s})]}):(0,r.jsxs)(r.Fragment,{children:[a,s]}),(0,r.jsxs)(r.Fragment,{children:[e," ",a,'"']})},t)})})]})}})},_=()=>(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage fence devices"})}),(0,r.jsx)(V,{})]});var B=t(58085),W=t(30198),Y=t(88824),Z=t(2126),L=t(90890),$=t(65832),X=t(98927);let G=e=>{let{list:n,setValue:t,value:s}=e;return 0===n.length?(0,r.jsx)(y.a3,{children:"No host(s) found."}):(0,r.jsx)(X.A,{centered:!0,onChange:(e,n)=>{t(n)},orientation:"vertical",value:s,children:n.map(e=>{let{hostConfigured:n,hostStatus:t,hostType:s,hostUUID:a,shortHostName:l}=e,i=s.replace("dr","DR").replace("node","Subnode");return(0,r.jsx)($.A,{label:(0,r.jsxs)(Y.A,{columnSpacing:"1em",container:!0,sx:{width:"100%",["& > .".concat(Z.A.root,":not(:first-child)")]:{borderLeft:"thin solid ".concat(L.eT),paddingLeft:"1em"}},children:[(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsx)(y.a3,{noWrap:!0,children:i})}),(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsx)(y.NA,{noWrap:!0,children:l})}),(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsxs)(y.a3,{noWrap:!0,children:[t,n?", configured":""]})})]}),sx:{textAlign:"left"},value:a},"host-".concat(a))})})};var K=t(40123),J=t.n(K),Q=t(86149),ee=t(89275);let en=U.Ik({hostName:U.Yj().required(),networkInit:ee.hJ}),et=e=>{let{values:n}=e;return(0,r.jsxs)(d.Ay,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Host name"})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.hostName})}),(0,r.jsx)(ee.Sf,{...e})]})};var er=t(588);let es=e=>{let{detail:n,tools:t,uuid:s}=e,a=(0,i.useRef)(null),l=(0,E.A)({initialValues:(e=>{let{dns:n="",gateway:t="",networks:r,ntp:s=""}=e.netconf,a={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"},defaultsn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"sn"},defaultmn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"mn"}};J()(r)||(a=(0,er.A)(r));let{name:l}=e;return{hostName:l,mini:!1,networkInit:{dns:n,gateway:t,networks:a,ntp:s}}})(n),onSubmit:(e,s)=>{let{setSubmitting:l}=s,i=(0,Q.A)(e,a.current);t.confirm.prepare({actionProceedText:"Prepare network",content:a.current&&(0,r.jsx)(et,{gatewayIface:i.gatewayInterface,ifaces:a.current,values:e}),onCancelAppend:()=>l(!1),onProceedAppend:()=>{t.confirm.loading(!0),j.A.put("/host/".concat(n.uuid,"?handler=subnode-network"),i).then(()=>{t.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started network config on ",n.short]})})}).catch(e=>{let s=(0,O.A)(e);s.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare network on ",n.short,". ",s.children]}),t.confirm.finish("Error",s),l(!1)})},titleText:"Prepare network on ".concat(n.short," with the following?")}),t.confirm.open()},validationSchema:en}),{disabledSubmit:o,formik:c,formikErrors:u,handleChange:h}=l,m=(0,i.useMemo)(()=>n.type.replace("node","subnode"),[n.type]),{parentSequence:p,sequence:x}=(0,i.useMemo)(()=>{let[e,t]=n.short.replace(/^.*a(\d+).*(?:n|dr)(\d+)$/,"$1,$2").split(",",2);return{parentSequence:Number(e),sequence:Number(t)}},[n.short]),g=(0,i.useMemo)(()=>({hostName:"hostName",mini:"mini",networks:"networkInit.networks"}),[]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2,md:3,lg:4},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),c.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:g.hostName,label:"Host name",name:g.hostName,onChange:h,required:!0,value:c.values.hostName})})}),(0,r.jsx)(d.Ay,{display:{xs:"none",md:"initial"},flexGrow:1,item:!0}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(k.A,{id:g.mini,label:"Minimal config",name:g.mini,onChange:(e,n)=>{if(n){let{defaultbcn:e}=c.values.networkInit.networks;c.setFieldValue(g.networks,{defaultbcn:e},!0)}else c.resetForm();c.handleChange(e)},checked:c.values.mini})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(ee.VT,{formikUtils:l,host:{parentSequence:p,sequence:x,type:m,uuid:s},onFetchSuccess:e=>{a.current=e}})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:u})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Prepare network",disabled:o,type:"submit"}]})})]})};var ea=t(79982),el=t(30764);let ei=e=>{let{uuid:n}=e,{confirmDialog:t,finishConfirm:s,setConfirmDialogLoading:a,setConfirmDialogOpen:l,setConfirmDialogProps:o}=(0,el.A)({initial:{scrollContent:!0,wide:!0}}),c=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:s,loading:a,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return l(e)},prepare:o},edit:{open:()=>null}}),[s,a,l,o]),{data:d}=(0,H.A)("/host/".concat(n));return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{detail:d,tools:c,uuid:n}),t]}):(0,r.jsx)(ea.A,{mt:0})};var eo=t(19383);let ec=()=>{let[e,n]=(0,i.useState)(!1),{data:t}=(0,H.A)("/host?type=dr&type=subnode"),s=(0,i.useMemo)(()=>t&&Object.values(t),[t]);return s?(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(G,{list:s,setValue:n,value:e}),e&&(0,r.jsx)(W.A,{sx:{margin:"2em 0"}}),s.map(n=>(0,r.jsx)(eo.A,{changingTabId:e,tabId:n.hostUUID,children:(0,r.jsx)(ei,{uuid:n.hostUUID})},"cell-".concat(n.hostUUID)))]}):(0,r.jsx)(P.Zk,{children:(0,r.jsx)(ea.A,{})})};var ed=t(57547),eu=t(31465),eh=t(54773);let em=(0,eh.Ay)("div")({["& > .".concat(Z.A.container,":first-child")]:{maxHeight:"60vh",overflowX:"hidden",overflowY:"scroll",paddingRight:".4em",paddingTop:".6em"}});var ep=t(91686),ex=t(22481),ef=t(10110),ej=t(67281);let{Form:eg,FormContext:eA,useFormContext:ev}=(0,ej.A)(),ew=(0,i.createContext)(null);var eb=t(5755);let ek="an-id-input-domain",ey="an-id-input-prefix",eC="an-id-input-sequence",eS="an-network-config-input-dns",eI="an-network-config-input-ntp",eM="gateway",eO="min-ip",eN="network-type",eP="network-number",eU="subnet-mask",eq="port",eD="ipmi-ip",eF="power-host",eE=e=>{let{hostSequence:n}=e,t=ev(eA),s=(0,i.useContext)(ew),a=(0,i.useMemo)(()=>{let e="hosts.".concat(n);return{[eD]:"".concat(e,".").concat(eD),fences:"".concat(e,".fences"),networks:"".concat(e,".networks"),upses:"".concat(e,".upses")}},[n]);if(!t||!s)return null;let{changeFieldValue:l,formik:o,handleChange:c}=t.formikUtils,{fences:d,upses:u}=s.template,h=Object.entries(o.values.hosts[n].fences),m=Object.entries(o.values.hosts[n].networks),p=Object.entries(o.values.hosts[n].upses);return(0,r.jsxs)(P.t$,{mv:0,children:[(0,r.jsx)(P.WJ,{children:(0,r.jsxs)(y.a3,{children:["Subnode ",n]})}),(0,r.jsx)(P.BF,{children:(0,r.jsxs)(Y.A,{container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eb.A,{children:"It is recommended to provide at least 1 fence device plug."})}),m.map(e=>{let[t,s]=e,{ip:l}=s,i="".concat(a.networks,".").concat(t,".").concat("ip"),{[eP]:d,[eN]:u=""}=o.values.netconf.networks[t],h="".concat(u.toUpperCase()," ").concat(d," IP");return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:i,label:h,name:i,onChange:c,required:!0,value:l})})},"host-".concat(n,"-network-").concat(t))}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:a[eD],label:"IPMI IP",name:a[eD],onChange:c,value:o.values.hosts[n][eD]})})}),h.map(e=>{let[t,s]=e,{[eq]:l}=s,i="".concat(a.fences,".").concat(t,".").concat(eq),{[t]:o}=d,u="Plug on ".concat(o.fenceName);return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:i,label:u,name:i,onChange:c,value:l})})},"host-".concat(n,"-fence-").concat(t))})]})}),p.length>0&&(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:p.map(e=>{let[t,s]=e,{[eF]:i}=s,o="".concat(a.upses,".").concat(t,".").concat(eF),{[t]:c}=u,d="Uses ".concat(c.upsName);return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(k.A,{checked:i,id:o,label:d,name:o,onChange:(e,n)=>{l(o,n,!0)}})},"host-".concat(n,"-ups-").concat(t))})})})]})})]})},eR=e=>{let{slotProps:n}=e,t=ev(eA);if(!t)return null;let{formik:s}=t.formikUtils;return(0,r.jsx)(Y.A,{container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:Object.keys(s.values.hosts).map(e=>(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eE,{hostSequence:e})},"host-".concat(e)))})};var eT=t(61057),ez=t(40143);let eH=e=>{let{getFieldChanged:n,hosts:t,values:r}=e,{[ek]:s,[ey]:a,[eC]:l}=r,i={...r},o=Object.entries(r.netconf.networks);return o.forEach(e=>{let[t,r]=e,{[eP]:s=0,[eN]:a}=r,l={...i.netconf.networks[t]};if(!(null==n?void 0:n("".concat("netconf.networks.".concat(t),".").concat(eO)))){let e,n=0;switch(a){case"bcn":n=200+Number(s),e="10.".concat(n,".0.0");break;case"mn":n=199,e="10.".concat(n,".0.0");break;case"sn":n=100+Number(s),e="10.".concat(n,".0.0");break;default:e=""}l[eO]=e}i.netconf.networks[t]=l}),Object.values(t).filter(e=>{let{name:n}=e;return new RegExp("^".concat(a,"-a").concat(String(l).padStart(2,"0"),"n\\d{2}\\.").concat(s,"$")).test(n)}).forEach(e=>{let t=Number(e.short.replace(/^.*n(\d+)$/,"$1")),{[t]:r}=i.hosts;r&&(i.hosts[t]={...i.hosts[t],[eD]:e.ipmi.ip},o.forEach(r=>{let[s,a]=r,{[eP]:l,[eN]:o}=a,c="".concat(o).concat(l),{[c]:d}=e.netconf.networks;if(!d)return;let{ip:u,subnetMask:h}=d,m={...i.netconf.networks[s]},p="netconf.networks.".concat(s);if(!(null==n?void 0:n("".concat(p,".").concat(eO)))){let e;try{e=new ez.Netmask("".concat(u,"/").concat(h))}catch(e){return}m[eO]=e.base}(null==n?void 0:n("".concat(p,".").concat(eU)))||(m[eU]=h),c!==e.netconf.gatewayInterface||(null==n?void 0:n("".concat(p,".").concat(eM)))||(m[eM]=e.netconf.gateway),i.netconf.networks[s]=m;let x={...i.hosts[t].networks[s]},f="hosts.".concat(t,".networks.").concat(s);(null==n?void 0:n("".concat(f,".").concat("ip")))||(x.ip=u),i.hosts[t].networks[s]=x}))}),i},eV=["bcn","ifn","mn","sn"].map(e=>{var n;return{displayValue:null!=(n=eT.A[e])?n:"Unknown network",value:e}}),e_=e=>{let{networkId:n,showGateway:t}=e,s=ev(eA),a=(0,i.useContext)(ew),l=(0,i.useMemo)(()=>{let e="".concat("netconf.networks",".").concat(n);return{[eM]:"".concat(e,".").concat(eM),[eO]:"".concat(e,".").concat(eO),[eP]:"".concat(e,".").concat(eP),[eN]:"".concat(e,".").concat(eN),[eU]:"".concat(e,".").concat(eU)}},[n]);if(!s||!a)return null;let{changeFieldValue:o,formik:c,getFieldChanged:d,handleChange:u,setValuesKai:h}=s.formikUtils,{hosts:m}=a;return(0,r.jsxs)(P.t$,{mv:0,children:[(0,r.jsxs)(P.WJ,{children:[(0,r.jsxs)(Y.A,{container:!0,spacing:"0.1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:{xs:"100%",sm:"calc(100% - ".concat("4em",")")},children:(0,r.jsx)(b.A,{id:l[eN],name:l[eN],onChange:e=>{let{value:t}=e.target;h({event:e,values:e=>{let r={...e};return r.netconf.networks[n]={...r.netconf.networks[n],[eN]:t},eH({getFieldChanged:d,hosts:m,values:r})}}),o(l[eN],t,!0)},required:!0,selectItems:eV,selectProps:{renderValue:e=>"".concat(eT.A[e])},value:c.values.netconf.networks[n][eN]})}),(0,r.jsx)(Y.A,{size:"grow",width:{xs:"100%",sm:"4em"},children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eP],label:"#",name:l[eP],onChange:e=>{let{value:t}=e.target;h({debounce:!0,event:e,values:e=>{let r={...e};return r.netconf.networks[n]={...r.netconf.networks[n],[eP]:Number(t)},eH({getFieldChanged:d,hosts:m,values:r})}})},required:!0,value:c.values.netconf.networks[n][eP]})})})]}),(0,r.jsx)(ex.A,{mapPreset:"delete",onClick:()=>{c.setValues(((e,n)=>{let t={...e},{[n]:r,...s}=t.netconf.networks;return t.netconf.networks=s,Object.keys(t.hosts).forEach(e=>{let{[e]:r}=t.hosts,{[n]:s,...a}=r.networks;r.networks=a}),t})(c.values,n),!0)},sx:{padding:".2em",position:"absolute",right:"-.5em",top:"-.2em"}})]}),(0,r.jsx)(P.BF,{children:(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eO],label:"IP address",name:l[eO],onChange:u,required:!0,value:c.values.netconf.networks[n][eO]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eU],label:"Subnet mask",name:l[eU],onChange:u,required:!0,value:c.values.netconf.networks[n][eU]})})}),t&&(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eM],label:"Gateway",name:l[eM],onChange:u,value:c.values.netconf.networks[n][eM]})})})]})})]})};var eB=t(91423);let eW=e=>{let{slotProps:n}=e,t=ev(eA),s=(0,i.useMemo)(()=>{let e="netconf";return{[eS]:"".concat(e,".").concat(eS),[eI]:"".concat(e,".").concat(eI),netconf:e,networks:"".concat(e,".networks")}},[]);if(!t)return null;let{formik:a,handleChange:l}=t.formikUtils,o=Object.entries(a.values.netconf.networks);return(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:[o.map(e=>{let[n,t]=e;return(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(e_,{networkId:n,showGateway:"ifn"===t[eN]})},"netconf-network-".concat(n))}),(0,r.jsx)(Y.A,{display:"flex",justifyContent:"center",width:"100%",children:(0,r.jsx)(ex.A,{mapPreset:"add",onClick:()=>{a.setValues((e=>{let n,t=Object.values(e.netconf.networks);if(t.some(e=>"mn"===e[eN])){let e=t.reduce((e,n)=>{let{[eP]:t=0,[eN]:r}=n;return"ifn"===r?Math.max(e,t):e},0);n={[eM]:"",[eO]:"",[eP]:e+1,[eN]:"ifn",[eU]:""}}else n={[eM]:"",[eO]:"10.199.0.0",[eP]:1,[eN]:"mn",[eU]:"255.255.0.0"};let r={ip:""},s=(0,eB.A)(),a={...e};return a.netconf.networks={...a.netconf.networks,[s]:n},Object.keys(a.hosts).forEach(e=>{let{[e]:n}=a.hosts;n.networks={...n.networks,[s]:r}}),a})(a.values),!0)}})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:s[eS],label:"DNS",name:s[eS],onChange:l,value:a.values.netconf[eS]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:s[eI],label:"NTP",name:s[eI],onChange:l,value:a.values.netconf[eI]})})})]})},eY=e=>{let{slotProps:n}=e,t=ev(eA),s=(0,i.useContext)(ew);if(!t||!s)return null;let{formik:a,getFieldChanged:l,setValuesKai:o}=t.formikUtils,{hosts:c}=s;return(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",...null==n?void 0:n.container,children:[(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:ey,label:"Prefix",name:ey,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[ey]=n,eH({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[ey]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:ek,label:"Domain name",name:ek,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[ek]=n,eH({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[ek]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:eC,label:"Sequence",name:eC,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[eC]=Number(n),eH({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[eC]})})})]})},eZ=e=>{let{slotProps:n}=e;return ev(eA)?(0,r.jsxs)(Y.A,{container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eY,{})}),(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eW,{})}),(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eR,{})})]}):(0,r.jsx)(eb.A,{children:"Missing form context."})};var eL=t(72649),e$=t.n(eL),eX=t(79232),eG=t(45566);let eK=U.Ik({name:U.Yj().required(),uuid:(0,eG.ZC)().required()}),eJ=U.Ik({anvil:U.RZ(e=>void 0!==e?eK:U.gl().optional()),number:U.ai(),type:U.Yj(),uuid:(0,eG.ZC)().required()}),eQ=U.Yj().when(["rerun"],(e,n)=>e[0]?n.optional():n.required()),e0=U.Ik({confirmPassword:eQ.oneOf([U.KR("password")]),description:eQ,hosts:U.RZ(e=>U.Ik((0,D.A)(e,eJ))),password:eQ,rerun:U.zM().required(),reuseHosts:U.zM().when(["hosts"],(e,n)=>{let t=e[0];return t&&Object.values(t).some(e=>!!e.anvil)?n.isTrue():n.isFalse()})}),e1=e=>{let{detail:n,knownFences:t,knownHosts:s,knownUpses:a,onSubmitSuccess:l,tools:o}=e,{anvil:c,domain:u,hostConfig:h,networkConfig:m}=n,{hosts:p}=h,{dnsCsv:x,networks:g,ntpCsv:A}=m,k=(0,i.useMemo)(()=>Object.entries(p),[p]),S=(0,i.useMemo)(()=>Object.entries(g),[g]),M=(0,i.useMemo)(()=>Object.entries(t),[t]),P=(0,i.useMemo)(()=>Object.entries(s),[s]),U=(0,i.useMemo)(()=>Object.entries(a),[a]),q=(0,i.useMemo)(()=>P.map(e=>{let[,{anvil:n,name:t,uuid:s}]=e;return{displayValue:(0,r.jsxs)(eu.A,{spacing:0,children:[(0,r.jsx)(y.a3,{inverted:!0,children:t}),(0,r.jsx)(y.xF,{inverted:!0,children:n?"Used by ".concat(n.name):"Ready"})]}),value:s}}),[P]),{disabledSubmit:D,formik:F,formikErrors:R,handleChange:T}=(0,E.A)({initialValues:{confirmPassword:"",description:"",hosts:k.reduce((e,n)=>{let t,[r,{hostName:a,hostNumber:l,hostType:i}]=n,o="";if(c){let{hosts:{[l]:{uuid:e}}}=c;o=e;let n=s[e];n&&(t=n.anvil)}else if(a){let e=P.find(e=>{let[,{short:n}]=e;return n===a});if(e){let[,n]=e;t=n.anvil,o=n.uuid}}return e[r]={anvil:t,number:l,type:i,uuid:o},e},{}),password:"",rerun:!!c,reuseHosts:!1},onSubmit:(e,t)=>{let{setSubmitting:a}=t,{confirmPassword:i,rerun:c,reuseHosts:d,hosts:h,...m}=e,x={...c?null:m,hosts:Object.values(h).reduce((e,n)=>{let{number:t,type:r,uuid:a}=n,l="".concat(r).concat(t);return e["".concat(r.replace("node","Subnode")," ").concat(t)]={useHost:s[a].name,renameTo:"".concat(p[l].hostName,".").concat(u)},e},{})};o.confirm.prepare({actionProceedText:"Run",content:(0,r.jsx)(I.A,{entries:x,hasPassword:!0}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{o.confirm.loading(!0),j.A.put("/command/run-manifest/".concat(n.uuid),e).then(()=>{o.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started installing ",n.name]})}),null==l||l.call(null),o.edit.open(!1)}).catch(e=>{let n=(0,O.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to run install manifest. ",n.children]}),o.confirm.finish("Error",n),a(!1)})},titleText:"Run install manifest ".concat(n.name," with the following?")}),o.confirm.open()},validationSchema:e0}),z=(0,i.useMemo)(()=>"confirmPassword",[]),H=(0,i.useMemo)(()=>"description",[]),V=(0,i.useMemo)(()=>"hosts",[]),_=(0,i.useMemo)(()=>"password",[]),B=(0,i.useMemo)(()=>"reuseHosts",[]),W=(0,i.useMemo)(()=>k.reduce((e,n)=>{let[t,{hostNumber:a,hostType:l}]=n,i="".concat(V,".").concat(t),o="".concat(i,".uuid"),c="".concat(l.replace("node","Subnode")," ").concat(a);return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(b.A,{id:o,label:c,name:o,onChange:e=>{let{target:{value:n}}=e,{[n]:{anvil:r}}=s,i=e$()(F.values.hosts),o=Object.entries(i).find(e=>{let[r,{uuid:s}]=e;return r!==t&&s===n});if(o){let[e,n]=o,{number:r,type:s}=n;i[e]={...i[t],number:r,type:s}}return i[t]={anvil:r,number:a,type:l,uuid:n},F.setFieldValue(V,i)},required:!0,selectItems:q,selectProps:{renderValue:e=>{let{[e]:{name:n}}=s;return n}},value:F.values.hosts[t].uuid})},"".concat(t,"-selector"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Use host"})},"host-selector-header")]),[F,k,q,V,s]),Y=(0,i.useMemo)(()=>k.reduce((e,n)=>{let[t,{hostName:s}]=n;return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.NA,{noWrap:!0,children:[s,".",u]})},"".concat(t,"-rename"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"New hostname"})},"host-rename-header")]),[k,u]),Z=(0,i.useMemo)(()=>S.reduce((e,n)=>{let[t,s]=n,{networkNumber:a,networkType:l}=s,i="".concat(l.toLocaleUpperCase()).concat(a),o=k.map(e=>{let[n,{networks:s}]=e,a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(t,"-").concat(n,"-ip"))};if(!s)return a();let{[t]:l}=s;if(!l)return a();let{networkIp:i}=l;return a(i)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:i})},"".concat(t,"-header")),...o),e},[]),[k,S]),L=(0,i.useMemo)(()=>M.reduce((e,n)=>{let[t,s]=n,{fenceName:a}=s,l=k.map(e=>{let[n,{fences:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(t,"-").concat(n,"-port"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{fencePort:o}=i;return l(o)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.a3,{children:["Plug on ",a]})},"".concat(t,"-header")),...l),e},[]),[k,M]),$=(0,i.useMemo)(()=>U.reduce((e,n)=>{let[t,s]=n,{upsName:a}=s,l=k.map(e=>{let[n,{upses:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(t,"-").concat(n,"-used"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{isUsed:o}=i;return l(o?"yes":"no")});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.a3,{children:["Uses ",a]})},"".concat(t,"-header")),...l),e},[]),[k,U]),X=(0,i.useMemo)(()=>{let e,n=S.find(e=>{let{1:{networkGateway:n}}=e;return!!n}),t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"gateway-value")};if(n){let[,{networkGateway:r}]=n;e=r&&r.length>0?t(r):t()}else e=t();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Gateway"})},"gateway-header"),e]},[S]),G=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"dns-value")},n=x&&x.length>0?e(x):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"DNS"})},"dns-header"),n]},[x]),K=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"ntp-value")},n=A&&A.length>0?e(A):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"NTP"})},"ntp-header"),n]},[A]),J=(0,i.useMemo)(()=>{let e=Object.values(F.values.hosts).filter(e=>!!e.anvil);if(0===e.length)return null;let n=e.slice(1).reduce((e,n)=>"".concat(e,", ").concat(s[n.uuid].short),s[e[0].uuid].short);return(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(eb.A,{children:[(0,r.jsx)(eX.A,{id:B,invert:!0,name:B,onChange:F.handleChange,required:!0,sx:{marginRight:".5em"},thinPadding:!0,value:F.values.reuseHosts}),"Confirm reusing host(s): ",n,"."]})})},[F,s,B]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),F.submitForm()},spacing:"1em",children:[c?(0,r.jsxs)(d.Ay,{item:!0,width:"100%",children:[(0,r.jsx)(y.a3,{children:"Description"}),(0,r.jsx)(y.a3,{children:c.description})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:H,label:"Description",name:H,onChange:T,required:!0,value:F.values.description})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:_,label:"Password",name:_,onChange:T,required:!0,type:v.A.password,value:F.values.password})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:z,label:"Confirm password",name:z,onChange:T,required:!0,type:v.A.password,value:F.values.confirmPassword})})})]}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{alignItems:"center",columns:k.length+1,columnSpacing:"1em",container:!0,rowSpacing:".6em",children:[...W,...Y,...Z,...L,...$]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{columns:2,container:!0,spacing:".6em",children:[...X,...G,...K]})}),J,(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:R})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Run",disabled:D,type:"submit"}]})})]})},e2=e=>{let{hostConfig:{hosts:n}}=e,t=Object.values(n).reduce((e,n)=>{let{fences:t,hostType:r,hostNumber:s}=n,a="".concat(r.replace(/node/,"subnode")).concat(s);return t?e[a]=Object.values(t).reduce((e,n)=>{let{fencePort:t}=n;return e+ +!!t.length},0):e[a]=0,e},{}),r=Object.entries(t).map(e=>{let[n,t]=e;return t?null:(0,i.createElement)(eb.A,{key:"".concat(n,"-no-fence-port-message")},"No fence device port specified for ".concat(n,"."))});return{counts:t,messages:r}},e3=function(e,n,t){var r,s;let a,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{[eP]:i=0,[eN]:o}=t,c="".concat(o).concat(i),d=10+2*(e-1),u=0;switch(o){case"bcn":u=200+Number(i),a="10.".concat(u,".").concat(d,".").concat(n);break;case"mn":u=199,a="10.".concat(u,".").concat(d,".").concat(n);break;case"sn":u=100+Number(i),a="10.".concat(u,".").concat(d,".").concat(n);break;default:a=""}return null!=(s=null==(r=l[c])?void 0:r.networkIp)?s:a},e6=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,t)=>{var r,s;let{fenceName:a,fenceUUID:l}=t;return e[l]={[eq]:null!=(s=null==(r=n[a])?void 0:r.fencePort)?s:""},e},t)},e5=function(e,n,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t.reduce((t,s)=>{let[a,l]=s;return t[a]={ip:e3(e,n,l,r)},t},s)},e4=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,t)=>{var r,s;let{upsName:a,upsUUID:l}=t;return e[l]={[eF]:null!=(s=null==(r=n[a])?void 0:r.isUsed)&&s},e},t)},e8=(e,n,t)=>{let r={[ek]:"",[ey]:"",[eC]:1,netconf:{[eS]:"",[eI]:"",networks:{}},hosts:{}},s=Object.values(e.fences),a=Object.values(e.upses);if(t){r[ek]=t.domain,r[ey]=t.prefix,r[eC]=t.sequence;let{hostConfig:e,networkConfig:n}=t;r.netconf[eS]=n.dnsCsv,r.netconf[eI]=n.ntpCsv,Object.values(n.networks).forEach(e=>{let{networkGateway:n,networkMinIp:t,networkNumber:s,networkSubnetMask:a,networkType:l}=e,i=(0,eB.A)();r.netconf.networks[i]={[eM]:n,[eO]:t,[eP]:s,[eN]:l,[eU]:a}}),Object.values(e.hosts).forEach(e=>{let{hostNumber:n,ipmiIp:l=""}=e;r.hosts[n]={[eD]:l,fences:e6(s,e.fences),networks:e5(t.sequence,n,Object.entries(r.netconf.networks),e.networks),upses:e4(a,e.upses)}})}else r[ek]=e.domain,r[ey]=e.prefix,r[eC]=e.sequence,r.netconf.networks={defaultbcn:{[eM]:"",[eO]:"10.201.0.0",[eP]:1,[eN]:"bcn",[eU]:"255.255.0.0"},defaultifn:{[eM]:"",[eO]:"",[eP]:1,[eN]:"ifn",[eU]:""},defaultmn:{[eM]:"",[eO]:"10.199.0.0",[eP]:1,[eN]:"mn",[eU]:"255.255.0.0"},defaultsn:{[eM]:"",[eO]:"10.101.0.0",[eP]:1,[eN]:"sn",[eU]:"255.255.0.0"}},r.netconf[eS]="8.8.8.8,8.8.4.4",[1,2].forEach(n=>{r.hosts[n]={[eD]:"",fences:e6(s),networks:e5(e.sequence,n,Object.entries(r.netconf.networks)),upses:e4(a)}}),r=eH({hosts:n,values:r});return r},e9=(e,n)=>{let{[ek]:t,[ey]:r,[eC]:s,netconf:a}=n,{[eS]:l="",[eI]:i="",networks:o}=a;return{domain:t,hostConfig:{hosts:((e,n)=>Object.entries(n.hosts).reduce((t,r)=>{let s,a,l,[i,o]=r,{[eD]:c,fences:d,networks:u,upses:h}=o,m="node";return t["".concat(m).concat(i)]={fences:(s=e.fences,Object.entries(d).reduce((e,n)=>{let[t,r]=n,{[eq]:a=""}=r,{[t]:l}=s;return e[t]={fenceName:l.fenceName,fencePort:a},e},{})),hostNumber:Number(i),hostType:m,ipmiIp:c,networks:(a=n.netconf.networks,Object.entries(u).reduce((e,n)=>{let[t,r]=n,{ip:s}=r,{[t]:l}=a,{[eP]:i=0,[eN]:o=""}=l;return e["".concat(o).concat(i)]={networkIp:s,networkNumber:i,networkType:o},e},{})),upses:(l=e.upses,Object.entries(h).reduce((e,n)=>{let[t,r]=n,{[eF]:s=!1}=r,{[t]:a}=l;return e[t]={isUsed:s,upsName:a.upsName},e},{}))},t},{}))(e,n)},networkConfig:{dnsCsv:l,networks:Object.values(o).reduce((e,n)=>{let{[eM]:t,[eO]:r="",[eP]:s=0,[eN]:a="",[eU]:l=""}=n;return e["".concat(a).concat(s)]={networkGateway:t,networkMinIp:r,networkNumber:s,networkSubnetMask:l,networkType:a},e},{}),ntpCsv:i},prefix:r,sequence:s}};var e7=t(23192),ne=t(57656),nn=t(44193);let nt=e=>({exclusive:!0,message:"${path} already exists",name:"duplicate-name",test:(n,t)=>{let{createError:r,parent:s}=t,{[ey]:a,[eC]:l}=s,i=String(l).padStart(2,"0"),o="".concat(a,"-anvil-").concat(i);return!e.includes(o)||r({message:"".concat(o," already exists")})}}),nr=function(e){let n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t&&(n=e=>e.manifestName!==t);let r=(0,eG.fD)(e,e=>e.manifestName,{filterBy:n});return U.Ik({[ek]:U.Yj().required(),[ey]:U.Yj().min(1).max(5).required().test(nt(r)),[eC]:U.ai().min(1).required().test(nt(r)),netconf:U.Ik({[eS]:U.Yj(),[eI]:U.Yj(),networks:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eM]:(0,eG.W5)(),[eO]:(0,eG.W5)(),[eN]:U.Yj().oneOf(["bcn","ifn","mn","sn"]),[eP]:U.ai().min(1),[eU]:(0,eG.W5)()}))))}),hosts:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eD]:(0,eG.W5)(),fences:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eq]:U.Yj()})))),networks:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({ip:(0,eG.W5)().required()})))),upses:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eF]:U.zM()}))))}))))})},ns=()=>{let e=(0,i.useRef)(null),n=(0,i.useRef)(null),t=(0,i.useRef)(null),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(),{data:c,loading:d,mutate:u}=(0,H.A)("/manifest",{refreshInterval:6e4}),{data:h,loading:m,mutate:p}=(0,H.A)("/manifest/template"),{data:x,loading:f,mutate:j}=(0,H.A)("/host?detail=1&type=subnode"),{fetch:g,loading:A}=(0,e7.A)({onData:e=>o(e),url:"/manifest"}),v=(0,nn.A)([]),{buildDeleteDialogProps:w,checks:b,getCheck:k,hasChecks:C,resetChecks:S,setCheck:I}=(0,ne.A)({list:c}),M=(0,el.A)({initial:{scrollContent:!0,wide:!0}}),{confirmDialog:O,finishConfirm:N,setConfirmDialogLoading:U,setConfirmDialogOpen:q,setConfirmDialogProps:D}=M,F=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:N,loading:U,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return q(e)},prepare:D},edit:{open:function(){var e;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==t||null==(e=t.current)?void 0:e.setOpen(n)}}}),[N,U,q,D]),E=d||m||f,R=E||A,T=(0,i.useMemo)(()=>h&&x&&l&&(0,r.jsx)(e1,{detail:l,knownFences:h.fences,knownHosts:x,knownUpses:h.upses,onSubmitSuccess:()=>{p(),j()},tools:F}),[F,j,p,x,l,h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage manifests"})}),(0,r.jsx)(ef.A,{allowEdit:!0,allowItemButton:s,disableDelete:!C,edit:s,header:!0,listEmpty:"No manifest(s) registered.",listItems:c,loading:E,onAdd:()=>{var n;null==(n=e.current)||n.setOpen(!0)},onDelete:()=>{M.setConfirmDialogProps(w({getConfirmDialogTitle:e=>"Delete ".concat(e," manifest(s)?"),onProceedAppend:()=>{v.submitForm({body:{uuids:b},getErrorMsg:e=>(M.finishConfirm("Error",{children:"Delete manifest(s) failed. ".concat(e)}),null),method:"delete",onSuccess:()=>{S(),u(),M.setConfirmDialogOpen(!1)},url:"/manifest"})},renderEntry:e=>{let{key:n}=e;return(0,r.jsx)(y.a3,{children:null==c?void 0:c[n].manifestName})}})),M.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,n,t)=>{I(e,t)},onItemClick:e=>{var t;let{manifestUUID:r}=e;null==(t=n.current)||t.setOpen(!0),g("/".concat(r))},renderListItemCheckboxState:e=>k(e),renderListItem:(e,n)=>{let{manifestName:a}=n;return(0,r.jsxs)(eu.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(ex.A,{disabled:s,mapPreset:"play",onClick:()=>{var n;null==(n=t.current)||n.setOpen(!0),g("/".concat(e))},variant:"normal"}),(0,r.jsx)(y.a3,{children:a})]})}})]}),(0,r.jsx)(ed.K_,{header:"Add an install manifest",loading:E,ref:e,showClose:!0,wide:!0,children:c&&h&&x&&(0,r.jsx)(eg,{config:{initialValues:e8(h,x),onSubmit:(n,t)=>{let s=e9(h,n);(0,ep.A)({confirm:M,getRequestBody:(e,n)=>n,getSummary:()=>s,header:"Add install manifest with the following?",helpers:t,onError:()=>"Failed to add install manifest.",onSuccess:()=>{var n;return u(),null==(n=e.current)||n.setOpen(!1),"Successfully added install manifest"},operation:"add",slotProps:{confirm:{preActionArea:(0,r.jsx)(eu.A,{spacing:".3em",children:e2(s).messages})},summary:{maxDepth:6}},url:"/manifest",values:n})},validationSchema:nr(c)},operation:"add",children:(0,r.jsx)(ew,{value:{hosts:x,template:h},children:(0,r.jsx)(em,{children:(0,r.jsx)(eZ,{})})})})}),(0,r.jsx)(ed.K_,{header:"Update install manifest ".concat(null==l?void 0:l.name),loading:R,ref:n,showClose:!0,wide:!0,children:c&&h&&x&&l&&(0,r.jsx)(eg,{config:{initialValues:e8(h,x,l),onSubmit:(e,t)=>{let s=e9(h,e);(0,ep.A)({confirm:M,getRequestBody:(e,n)=>n,getSummary:()=>s,header:"Update install manifest ".concat(l.name," with the following?"),helpers:t,onError:()=>"Failed to update install manifest.",onSuccess:()=>{var e;return u(),null==(e=n.current)||e.setOpen(!1),"Successfully updated install manifest ".concat(l.name)},operation:"edit",slotProps:{confirm:{preActionArea:(0,r.jsx)(eu.A,{spacing:".3em",children:e2(s).messages})},summary:{maxDepth:6}},url:"/manifest/".concat(l.uuid),values:e})},validationSchema:nr(c,l.name)},operation:"edit",children:(0,r.jsx)(ew,{value:{hosts:x,template:h},children:(0,r.jsx)(em,{children:(0,r.jsx)(eZ,{})})})})}),(0,r.jsx)(ed.K_,{header:"".concat((null==l?void 0:l.anvil)?"Rerun":"Run"," install manifest ").concat(null==l?void 0:l.name),loading:R,ref:t,showClose:!0,wide:!0,children:T}),O]})},{Form:na,FormContext:nl,useFormContext:ni}=(0,ej.A)();var no=t(19659);let nc="common-ups-input-ip-address",nd="common-ups-input-host-name",nu="add-ups-select-ups-type-id",nh=(0,eh.Ay)(no.A)({color:L.Uv,display:"inline-flex",textDecorationColor:L.Uv}),nm=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{loading:a,upsTemplate:l}=s,o=ni(nl),c=(0,i.useMemo)(()=>Object.entries(l).map(e=>{let n,[t,{brand:s,description:a,links:{0:l}}]=e;if(l){let{linkHref:e,linkLabel:t}=l;n=(0,r.jsx)(nh,{href:e,onClick:e=>{e.stopPropagation()},target:"_blank",children:t})}return{displayValue:(0,r.jsxs)(eu.A,{spacing:0,children:[(0,r.jsx)(y.a3,{inverted:!0,children:s}),(0,r.jsxs)(y.a3,{inverted:!0,children:[a," (",n,")"]})]}),value:t}}),[l]);if(!o)return(0,r.jsx)(eb.A,{type:"error",children:"Missing form context."});let{changeFieldValue:d,formik:u,handleChange:h}=o.formikUtils;return a?(0,r.jsx)(ea.A,{}):(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(b.A,{id:nu,label:"UPS type",name:nu,onChange:e=>{let{value:n}=e.target;d(nu,n,!0)},required:!0,selectItems:c,selectProps:{onClearIndicatorClick:()=>{d(nu,"",!0)},renderValue:e=>{let{brand:n}=l[String(e)];return n}},value:u.values[nu]})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:nd,label:"Host name",name:nd,onChange:h,required:!0,value:u.values[nd]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:nc,label:"IP address",name:nc,onChange:h,required:!0,value:u.values[nc]})})})]})},np=(e,n)=>{var t,r,s;let a=null!=(t=Object.keys(e).find(t=>{let{[t]:r}=e;return(null==n?void 0:n.upsAgent)===r.agent}))?t:"";return{[nc]:null!=(r=null==n?void 0:n.upsIPAddress)?r:"",[nd]:null!=(s=null==n?void 0:n.upsName)?s:"",[nu]:a}},nx=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(n);return U.Ik({[nc]:(0,eG.W5)().required(),[nd]:((e,n)=>{let t;e&&(t=n=>n.upsUUID!==e);let r=(0,eG.fD)(n,e=>e.upsName,{filterBy:t});return U.Yj().notOneOf(r,"${path} already exists")})(t,e).required(),[nu]:U.Yj().required().oneOf(r)})},nf=()=>{let e=(0,i.useRef)(null),n=(0,i.useRef)(null),t=(0,el.A)(),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(""),{data:c,loading:d}=(0,H.A)("/ups/template"),{data:u,loading:h,mutate:m}=(0,H.A)("/ups",{refreshInterval:6e4}),p=null==u?void 0:u[l],{buildDeleteDialogProps:x,checks:f,getCheck:j,hasChecks:g,resetChecks:A,setCheck:v}=(0,ne.A)({list:u}),w=(0,nn.A)([]),b=h||d;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage UPSes"})}),(0,r.jsx)(ef.A,{allowEdit:!0,allowItemButton:s,disableDelete:!g,edit:s,header:!0,listEmpty:"No Ups(es) registered.",listItems:u,loading:h,onAdd:()=>{var n;null==(n=e.current)||n.setOpen(!0)},onDelete:()=>{t.setConfirmDialogProps(x({getConfirmDialogTitle:e=>"Delete ".concat(e," UPSes?"),onProceedAppend:()=>{w.submitForm({body:{uuids:f},getErrorMsg:e=>(t.finishConfirm("Error",{children:"Failed to delete UPS(es). ".concat(e)}),null),method:"delete",onSuccess:()=>{A(),m(),t.setConfirmDialogOpen(!1)},url:"/ups"})},renderEntry:e=>{let{key:n}=e;return(0,r.jsx)(y.a3,{children:null==u?void 0:u[n].upsName})}})),t.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,n,t)=>{v(e,t)},onItemClick:e=>{var t;o(e.upsUUID),null==(t=n.current)||t.setOpen(!0)},renderListItemCheckboxState:e=>j(e),renderListItem:(e,n)=>{let{upsAgent:t,upsIPAddress:s,upsName:a}=n;return(0,r.jsxs)(eu.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(y.a3,{children:a}),(0,r.jsxs)(y.a3,{children:['agent="',t,'"']}),(0,r.jsxs)(y.a3,{children:['ip="',s,'"']})]})}})]}),(0,r.jsx)(ed.K_,{header:"Add a UPS",loading:b,ref:e,showClose:!0,wide:!0,children:u&&c&&(0,r.jsx)(na,{config:{initialValues:np(c),onSubmit:(n,s)=>{let{[nc]:a,[nd]:l,[nu]:i}=n,{agent:o,brand:d}=c[i];(0,ep.A)({confirm:t,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:""}),getSummary:()=>({brand:d,name:l,ipAddress:a}),header:(0,r.jsx)(y.HM,{children:"Add a UPS with the following data?"}),helpers:s,onError:()=>"Failed to add UPS.",onSuccess:()=>{var n;return m(),null==(n=e.current)||n.setOpen(!1),"Successfully added UPS ".concat(l)},operation:"add",url:"/ups",values:n})},validationSchema:nx(u,c)},operation:"add",children:(0,r.jsx)(nm,{upsTemplate:c})})}),(0,r.jsx)(ed.K_,{header:p&&(0,r.jsxs)(y.HM,{children:["Update UPS"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:p.upsName})]}),loading:b,ref:n,showClose:!0,wide:!0,children:u&&c&&p&&(0,r.jsx)(na,{config:{initialValues:np(c,p),onSubmit:(e,s)=>{let{[nc]:a,[nd]:l,[nu]:i}=e,{agent:o,brand:d}=c[i];(0,ep.A)({confirm:t,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:p.upsUUID}),getSummary:()=>({brand:d,name:l,ipAddress:a,uuid:p.upsUUID}),header:(0,r.jsxs)(y.HM,{children:["Update"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:l})," ","with the following data?"]}),helpers:s,onError:()=>"Failed to update UPS.",onSuccess:()=>{var e;return m(),null==(e=n.current)||e.setOpen(!1),"Successfully updated UPS ".concat(p.upsName)},operation:"edit",url:"/ups/".concat(p.upsUUID),values:e})},validationSchema:nx(u,c,p.upsUUID)},operation:"edit",children:(0,r.jsx)(nm,{upsTemplate:c})})}),t.confirmDialog]})};var nj=t(87986);let ng="prepare-host",nA="prepare-network",nv="manage-fence",nw="manage-ups",nb="manage-manifest",nk={[ng]:"Prepare Host",[nA]:"Prepare Network",[nv]:"Manage Fence Devices",[nw]:"Manage UPSes",[nb]:"Manage Manifests"},ny="Loading",nC=()=>(0,r.jsx)(nj.A,{children:(0,r.jsx)(B.g,{})}),nS=()=>(0,r.jsx)(nj.A,{children:(0,r.jsx)(ec,{})}),nI=()=>(0,r.jsx)(nj.A,{children:(0,r.jsx)(_,{})}),nM=()=>(0,r.jsx)(nj.A,{children:(0,r.jsx)(nf,{})}),nO=()=>(0,r.jsx)(nj.A,{children:(0,r.jsx)(ns,{})}),nN=()=>{let{isReady:e,push:n,query:t}=(0,l.useRouter)(),[s,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(ny);return(0,i.useEffect)(()=>{if(!e)return;let{step:r}=t,a=(0,o.A)(r,{fallbackValue:ng});nk[a]||(a=ng),n({query:{...t,step:a}},void 0,{shallow:!0}),u===ny&&h(nk[a]),s||d(a)},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:u})}),(0,r.jsx)(c.A,{}),(0,r.jsx)(P.Zk,{children:(0,r.jsxs)(X.A,{onChange:(e,r)=>{d(r),h(nk[r]),n({query:{...t,step:r}},void 0,{shallow:!0})},orientation:{xs:"vertical",sm:"horizontal"},value:s,children:[(0,r.jsx)($.A,{label:"Prepare host",value:ng}),(0,r.jsx)($.A,{label:"Prepare network",value:nA}),(0,r.jsx)($.A,{label:"Manage fence devices",value:nv}),(0,r.jsx)($.A,{label:"Manage UPSes",value:nw}),(0,r.jsx)($.A,{label:"Manage manifests",value:nb})]})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:ng,children:(0,r.jsx)(nC,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:nA,children:(0,r.jsx)(nS,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:nv,children:(0,r.jsx)(nI,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:nw,children:(0,r.jsx)(nM,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:nb,children:(0,r.jsx)(nO,{})})]})}},57212:(e,n,t)=>{"use strict";t.d(n,{A:()=>v});var r=t(14232),s=t(69241),a=t(4697),l=t(40393),i=t(80027),o=t(78457),c=t(26872),d=t(54773),u=t(29548),h=t(52196),m=t(48452),p=t(67360),x=t(37876);let f=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.root,t.edge&&n["edge".concat((0,i.A)(t.edge))],n["size".concat((0,i.A)(t.size))]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,["& .".concat(m.A.thumb)]:{width:16,height:16},["& .".concat(m.A.switchBase)]:{padding:4,["&.".concat(m.A.checked)]:{transform:"translateX(16px)"}}}}]}),j=(0,d.Ay)(c.A,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.switchBase,{["& .".concat(m.A.input)]:n.input},"default"!==t.color&&n["color".concat((0,i.A)(t.color))]]}})((0,u.A)(e=>{let{theme:n}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:"".concat("light"===n.palette.mode?n.palette.common.white:n.palette.grey[300]),transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),["&.".concat(m.A.checked)]:{transform:"translateX(20px)"},["&.".concat(m.A.disabled)]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:"".concat("light"===n.palette.mode?n.palette.grey[100]:n.palette.grey[600])},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{opacity:.5},["&.".concat(m.A.disabled," + .").concat(m.A.track)]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:"".concat("light"===n.palette.mode?.12:.2)},["& .".concat(m.A.input)]:{left:"-100%",width:"300%"}}}),(0,u.A)(e=>{let{theme:n}=e;return{"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.action.activeChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,l.X4)(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(n.palette).filter((0,o.A)(["light"])).map(e=>{let[t]=e;return{props:{color:t},style:{["&.".concat(m.A.checked)]:{color:(n.vars||n).palette[t].main,"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette[t].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,l.X4)(n.palette[t].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(m.A.disabled)]:{color:n.vars?n.vars.palette.Switch["".concat(t,"DisabledColor")]:"".concat("light"===n.palette.mode?(0,l.a)(n.palette[t].main,.62):(0,l.e$)(n.palette[t].main,.55))}},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{backgroundColor:(n.vars||n).palette[t].main}}}})]}})),g=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,n)=>n.track})((0,u.A)(e=>{let{theme:n}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:"".concat("light"===n.palette.mode?n.palette.common.black:n.palette.common.white),opacity:n.vars?n.vars.opacity.switchTrack:"".concat("light"===n.palette.mode?.38:.3)}})),A=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,n)=>n.thumb})((0,u.A)(e=>{let{theme:n}=e;return{boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),v=r.forwardRef(function(e,n){let t=(0,h.b)({props:e,name:"MuiSwitch"}),{className:r,color:l="primary",edge:o=!1,size:c="medium",sx:d,slots:u={},slotProps:v={},...w}=t,b={...t,color:l,edge:o,size:c},k=(e=>{let{classes:n,edge:t,size:r,color:s,checked:l,disabled:o}=e,c={root:["root",t&&"edge".concat((0,i.A)(t)),"size".concat((0,i.A)(r))],switchBase:["switchBase","color".concat((0,i.A)(s)),l&&"checked",o&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},d=(0,a.A)(c,m.n,n);return{...n,...d}})(b),y={slots:u,slotProps:v},[C,S]=(0,p.A)("root",{className:(0,s.A)(k.root,r),elementType:f,externalForwardedProps:y,ownerState:b,additionalProps:{sx:d}}),[I,M]=(0,p.A)("thumb",{className:k.thumb,elementType:A,externalForwardedProps:y,ownerState:b}),O=(0,x.jsx)(I,{...M}),[N,P]=(0,p.A)("track",{className:k.track,elementType:g,externalForwardedProps:y,ownerState:b});return(0,x.jsxs)(C,{...S,children:[(0,x.jsx)(j,{type:"checkbox",icon:O,checkedIcon:O,ref:n,ownerState:b,...w,classes:{...k,root:k.switchBase},slots:{...u.switchBase&&{root:u.switchBase},...u.input&&{input:u.input}},slotProps:{...v.switchBase&&{root:"function"==typeof v.switchBase?v.switchBase(b):v.switchBase},...v.input&&{input:"function"==typeof v.input?v.input(b):v.input}}}),(0,x.jsx)(N,{...P})]})})},67281:(e,n,t)=>{"use strict";t.d(n,{A:()=>h});var r=t(37876),s=t(88824),a=t(14232),l=t(63190);let i=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,operation:i,slotProps:o}=s,c={background:"blue",disabled:a.disabledSubmit,type:"submit",...null==o?void 0:o.submit};switch(i){case"add":c.children="Add";break;case"delete":c.background="red",c.children="Delete";break;default:c.children="Save"}return(0,r.jsx)(l.A,{actions:[c],...null==o?void 0:o.group})},o=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[a]=n,{children:l,formikUtils:i,slotProps:o}=a;return(0,r.jsx)(s.A,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),i.formik.handleSubmit(e)},spacing:"1em",width:"100%",...null==o?void 0:o.grid,children:l})};var c=t(71401);let d=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,slotProps:l}=s;return(0,r.jsx)(c.A,{count:1,messages:a.formikErrors,...null==l?void 0:l.messageGroup})};var u=t(71986);let h=e=>{var n,t;let l=(0,a.createContext)(null!=(t=null==e||null==(n=e.context)?void 0:n.defaultValue)?t:null);return{Form:e=>{let{children:n,config:t,operation:c,slotProps:h}=e,m=(0,u.A)(t),p=(0,a.useMemo)(()=>({formikUtils:m}),[m]);return(0,r.jsxs)(o,{formikUtils:m,...null==h?void 0:h.grid,children:[(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(l,{value:p,children:n})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(d,{formikUtils:m,...null==h?void 0:h.messages})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(i,{formikUtils:m,operation:c,...null==h?void 0:h.actions})})]})},FormContext:l,useFormContext:a.useContext}}},88851:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-element",function(){return t(45997)}])},91686:(e,n,t)=>{"use strict";t.d(n,{A:()=>i});var r=t(14232),s=t(52627),a=t(23934),l=t(5806);let i=e=>{let{description:n,getRequestBody:t,getSummary:i,header:o,helpers:c,onError:d,onSuccess:u,operation:h,slotProps:m,tools:p,url:x,values:f,method:j=(e=>{switch(e){case"add":return"post";case"delete":return"delete";default:return"put"}})(h)}=e,g=e.confirm?(e=>({finish:e.finishConfirm,loading:e.setConfirmDialogLoading,open:function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.setConfirmDialogOpen(n)},prepare:e.setConfirmDialogProps}))(e.confirm):null==p?void 0:p.confirm,A=null==i?void 0:i(f),v={actionProceedText:(e=>{switch(e){case"add":return"Add";case"delete":return"Delete";default:return"Save"}})(h),content:null!=n?n:(0,r.createElement)(s.A,{entries:null!=A?A:f,...null==m?void 0:m.summary}),onCancelAppend:()=>c.setSubmitting(!1),onProceedAppend:()=>{null==g||g.loading(!0);let e=null==t?void 0:t(f,A);a.A.request({data:e,method:j,url:x}).then(()=>{null==g||g.finish("Success",{children:null==u?void 0:u()}),null==p||p.add.open(!1),null==p||p.edit.open(!1)}).catch(e=>{let n=(0,l.A)(e);n.children=(0,r.createElement)(r.Fragment,null,null==d?void 0:d(e)," ",n.children),null==g||g.finish("Error",n)})},proceedColour:"delete"===h?"red":"blue",titleText:o,...null==m?void 0:m.confirm};null==g||g.prepare(v),null==g||g.open(!0)}}},e=>{e.O(0,[325,208,3,925,623,261,296,82,923,901,133,732,223,603,437,679,636,593,792],()=>e(e.s=88851)),_N_E=e.O()}]);