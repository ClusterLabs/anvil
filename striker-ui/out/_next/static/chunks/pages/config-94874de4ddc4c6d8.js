(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{19659:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var l=n(37876),r=n(54773),s=n(94760),o=n(90890);let a=(0,r.Ay)(s.A)({color:o.a$,textDecorationColor:o.Qu}),i=e=>{let{children:t,...n}=e;return(0,l.jsx)(a,{underline:"always",variant:"subtitle1",...n,children:t})}},30764:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var l=n(37876),r=n(14232),s=n(75925),o=n(5755);let a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:t="",content:n="",titleText:a="",...i}={}}=e,c=(0,r.useRef)(null),[d,u]=(0,r.useState)({actionProceedText:t,content:n,titleText:a}),h=(0,r.useCallback)(e=>u(t=>{let{loading:n,...l}=t;return{...l,loading:e}}),[]),p=(0,r.useCallback)(e=>{var t,n;return null==c||null==(n=c.current)||null==(t=n.setOpen)?void 0:t.call(null,e)},[]),x=(0,r.useCallback)((e,t)=>u({actionProceedText:"",content:(0,l.jsx)(o.A,{...t}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,r.useMemo)(()=>(0,l.jsx)(s.A,{...i,...d,ref:c}),[d,i]),confirmDialogRef:c,setConfirmDialogLoading:h,setConfirmDialogOpen:p,setConfirmDialogProps:u,finishConfirm:x}}},42116:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var l=n(14232);let r=function(){let{actionProceedText:e="",content:t="",titleText:n="",...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.useState)({actionProceedText:e,content:t,titleText:n,...r})}},48440:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var l=n(52076),r=n.n(l);let s=e=>{let t=e.replace(/([a-z\d])([A-Z])/g,"$1 $2");return r()(t)}},52627:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var l=n(37876),r=n(12981),s=n(12572),o=n(63009),a=n(40123),i=n.n(a),c=n(96043),d=n(48440),u=n(31465),h=n(51677);let p=e=>{let{entry:t}=e;return(0,l.jsx)(h.NA,{whiteSpace:"nowrap",children:String(t)})},x=e=>{let{entry:t,key:n}=e;return c.sX.test(n)?(0,l.jsx)(h.EN,{wrapper:"mono",children:String(t)}):p(e)},m=e=>{let{entry:t,hasPassword:n}=e;return i()(t)?(0,l.jsx)(h.a3,{children:"none"}):n?x(e):p(e)},A=e=>{let{depth:t,entry:n,getLabel:s,hasPassword:o,key:a,nest:i,renderValue:c}=e;return(0,l.jsxs)(u.A,{fullWidth:!0,growFirst:!0,row:!0,maxWidth:"100%",children:[(0,l.jsx)(h.a3,{children:s({cap:d.A,depth:t,entry:n,hasPassword:o,key:a})}),(0,l.jsx)(r.A,{sx:{maxWidth:"100%",overflowX:"scroll"},children:!i&&c(m,{depth:t,entry:n,hasPassword:o,key:a})})]})},g=e=>{let{key:t}=e;return/confirm|uuid/i.test(t)},f=e=>null!==e&&"object"==typeof e&&!i()(e),j=e=>{let{depth:t=0,entries:n,getEntryLabel:r,getListProps:a,getListItemProps:i,hasPassword:c,listKey:d,maxDepth:u,renderEntry:h,renderEntryValue:p,skip:x}=e,m=[];Object.entries(n).forEach(e=>{let[n,o]=e,a="form-summary-entry-".concat(n),d=f(o),A=d?null:o,y={depth:t,entry:A,hasPassword:c,key:n};x(g,y)||m.push((0,l.jsx)(s.Ay,{sx:{paddingLeft:"".concat(t,"em")},...null==i?void 0:i.call(null,y),children:h({depth:t,entry:A,getLabel:r,hasPassword:c,key:n,nest:d,renderValue:p})},a)),d&&t<u&&m.push(j({depth:t+1,entries:o,getEntryLabel:r,hasPassword:c,listKey:n,maxDepth:u,renderEntry:h,renderEntryValue:p,skip:x}))});let A="form-summary-list-".concat(null!=d?d:"root");return(0,l.jsx)(o.A,{dense:!0,disablePadding:!0,...null==a?void 0:a.call(null,{depth:t,entries:n,key:d}),children:m},A)},y=e=>{let{entries:t,getEntryLabel:n=e=>{let{cap:t,key:n}=e;return t(n)},getListProps:l,getListItemProps:r,hasPassword:s=!1,maxDepth:o=3,renderEntry:a=A,renderEntryValue:i=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),l=1;l<t;l++)n[l-1]=arguments[l];return e(...n)},skip:c=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),l=1;l<t;l++)n[l-1]=arguments[l];return e(...n)}}=e;return j({entries:t,getEntryLabel:n,getListProps:l,getListItemProps:r,hasPassword:s,maxDepth:o,renderEntry:a,renderEntryValue:i,skip:c})}},57656:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var l=n(37876),r=n(14232),s=n(12698),o=n(52627);let a=e=>{let{list:t={}}=e,[n,a]=(0,r.useState)({}),i=(0,r.useMemo)(()=>Object.keys(t),[t]),c=(0,r.useMemo)(()=>Object.keys(n),[n]),d=(0,r.useMemo)(()=>c.length===i.length,[c.length,i.length]),u=(0,r.useMemo)(()=>c.length>0,[c.length]),h=(0,r.useMemo)(()=>i.length>1,[i.length]),p=(0,r.useCallback)(e=>{let{confirmDialogProps:t={},formSummaryProps:r={},getConfirmDialogTitle:s,onProceedAppend:a,renderEntry:i}=e;return{actionProceedText:"Delete",content:(0,l.jsx)(o.A,{entries:n,maxDepth:0,renderEntry:i,...r}),onProceedAppend:a,proceedColour:"red",titleText:s(c.length),...t}},[n,c.length]),x=(0,r.useCallback)(e=>!!n[e],[n]),m=(0,r.useCallback)(()=>a({}),[]);return{buildDeleteDialogProps:p,checklist:n,checks:c,getCheck:x,hasAllChecks:d,hasChecks:u,multipleItems:h,resetChecks:m,setAllChecks:(0,r.useCallback)(e=>a(i.reduce((t,n)=>(e&&(t[n]=e),t),{})),[i]),setCheck:(0,r.useCallback)((e,t)=>a((0,s.Ay)(e,t||void 0)),[])}}},60801:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var l=n(37876),r=n(14232),s=n(75925);let o=(0,r.forwardRef)((e,t)=>{let{children:n,contentContainerProps:o,dialogProps:a,onSubmitAppend:i,proceedButtonProps:c,scrollBoxProps:d,scrollContent:u,...h}=e,p=(0,r.useMemo)(()=>({...o,component:"form",onSubmit:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l]=t;l.preventDefault(),null==i||i.call(null,...t)}}),[o,i]),x=(0,r.useMemo)(()=>({...d,sx:u?{overflowX:"hidden",paddingTop:".6em",...null==d?void 0:d.sx}:null==d?void 0:d.sx}),[d,u]);return(0,l.jsx)(s.A,{dialogProps:a,contentContainerProps:p,proceedButtonProps:{...c,type:"submit"},scrollContent:u,scrollBoxProps:x,wide:!0,...h,ref:t,children:n})});o.displayName="FormDialog";let a=o},61057:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});let l={bcn:"Back-Channel Network",ifn:"Internet-Facing Network",mn:"Migration Network",sn:"Storage Network"}},70942:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>eh});var l=n(37876),r=n(64410),s=n(77328),o=n.n(s),a=n(14232),i=n(75925),c=n(86732),d=n(61057),u=n(48171),h=n(23934);let p=function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=n=>{var l;null==(l=t.current.setMessage)||l.call(null,e,n)};return n&&(n[l]=r),r},x=(e,t)=>{let n={};return e instanceof Array?e.reduce((e,n)=>(p(n,t,e),e),n):Object.entries(e).reduce((e,n)=>{let[l,r]=n;return p(r,t,e,l),e},n)};var m=n(12698),A=n(35656),g=n(79232),f=n(46316),j=n(51677);let y=e=>{let{checkboxProps:t,checked:n,formControlLabelProps:r,label:s,onChange:o}=e,i=(0,a.useMemo)(()=>(0,f.A)(s,j.a3),[s]);return(0,l.jsx)(A.A,{...r,control:(0,l.jsx)(g.A,{...t,checked:n,onChange:o}),label:i})};var w=n(31465),b=n(667),k=n(5806),v=n(22481),P=n(94091),C=n(71401),S=n(69267),T=n(33852);let M={dbPort:"dbPort",ipAddress:"ipAddress",password:"password",sshPort:"sshPort",user:"user"},F={ipAddress:"IP address",password:"Password",ping:"Ping"},I=(0,a.forwardRef)((e,t)=>{let{formGridColumns:n=2}=e,r=(0,a.useRef)({}),s=(0,a.useRef)({}),o=(0,a.useRef)({}),c=(0,a.useRef)({}),d=(0,a.useRef)({}),p=(0,a.useRef)({}),[A,g]=(0,a.useState)({}),[f,I]=(0,a.useState)(!0),[E,O]=(0,a.useState)(!1),R=(0,a.useCallback)(e=>t=>{let{isValid:n}=t;g((0,m.Ay)(e,n))},[]),D=(0,a.useCallback)(e=>t=>{g((0,m.Ay)(e,t))},[]),N=(0,a.useCallback)(e=>{var t;null==(t=p.current.setMessage)||t.call(null,"api",e)},[]),U=(0,a.useMemo)(()=>Object.values(A).some(e=>!e),[A]),B=(0,a.useMemo)(()=>x(M,p),[]);return(0,l.jsx)(i.A,{actionProceedText:"Add",content:(0,l.jsx)(b.A,{columns:{xs:1,sm:n},layout:{"add-peer-ip-address":{children:(0,l.jsx)(w.A,{row:!0,spacing:".3em",children:(0,l.jsx)(P.A,{input:(0,l.jsx)(S.A,{id:"add-peer-ip-address-input",inputProps:{readOnly:!0,onFocus:e=>{e.target.readOnly=!1}},label:F.ipAddress}),inputTestBatch:(0,T._P)(F.ipAddress,()=>{B.ipAddress()},{onFinishBatch:D(M.ipAddress)},e=>{B.ipAddress({children:e})}),onFirstRender:R(M.ipAddress),ref:s,required:!0})})},"add-peer-password":{children:(0,l.jsx)(P.A,{input:(0,l.jsx)(S.A,{id:"add-peer-password-input",label:F.password,type:u.A.password}),inputTestBatch:(0,T.rn)(F.password,()=>{B.password()},{onFinishBatch:D(M.password)},e=>{B.password({children:e})}),onFirstRender:R(M.password),ref:o,required:!0})},"add-peer-is-ping":{children:(0,l.jsx)(y,{checked:f,label:F.ping,onChange:(e,t)=>{I(t)}}),sx:{display:"flex"}},"add-peer-message-group":{children:(0,l.jsx)(C.A,{count:1,defaultMessageType:"warning",ref:p}),sm:n}},spacing:"1em"}),dialogProps:{PaperProps:{sx:{minWidth:"16em"}}},loadingAction:E,onActionAppend:()=>{N()},onProceedAppend:()=>{var e,t,n,l,a;O(!0),h.A.post("/host/connection",{ipAddress:null==(e=s.current.getValue)?void 0:e.call(null),isPing:f,password:null==(t=o.current.getValue)?void 0:t.call(null),port:null==(n=r.current.getValue)?void 0:n.call(null),sshPort:null==(l=c.current.getValue)?void 0:l.call(null),user:null==(a=d.current.getValue)?void 0:a.call(null)}).then(()=>{N({children:"Successfully initiated the peer addition. You can continue to edit the field(s) to add another peer.",type:"info"})}).catch(e=>{let t=(0,k.A)(e);t.children="Failed to add the given peer. ".concat(t.children),N(t)}).finally(()=>{O(!1)})},proceedButtonProps:{disabled:U},ref:t,titleText:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.HM,{children:"Add a peer"}),(0,l.jsx)(v.A,{mapPreset:"close",onClick:()=>{if(t&&"current"in t){var e;null==(e=t.current.setOpen)||e.call(null,!1)}},variant:"redcontained"})]})})});I.displayName="AddPeerDialog";var E=n(74799),O=n(5755),R=n(23437),D=n(48504),N=n(15692),U=n(90890);let B={small:j.xF,medium:j.a3},_={size:"small",stateMap:new Map([[!1,(0,l.jsx)(D.A,{sx:{color:U.hr}},"state-false")],[!0,(0,l.jsx)(N.A,{sx:{color:U.ft}},"state-true")]])},L=e=>{let{label:t,size:n=_.size,state:r,stateMap:s=_.stateMap}=e,o=s.get(r);return(0,l.jsxs)(w.A,{row:!0,spacing:".3em",children:[o&&(0,a.cloneElement)(o,{fontSize:n}),(0,a.createElement)(B[n],{},t)]})};L.defaultProps=_;var W=n(59664);let V=e=>{let{refreshInterval:t=6e4}=e,n=(0,a.useRef)({}),s=(0,a.useRef)({}),[o,c]=(0,a.useState)(),[u,p]=(0,a.useState)({actionProceedText:"",content:"",titleText:""}),[x,m]=(0,a.useState)({}),[A,g]=(0,a.useState)(!1),[f,y]=(0,a.useState)({}),b=(0,a.useMemo)(()=>o&&(0,l.jsx)(r.Ay,{item:!0,sm:2,xs:1,children:(0,l.jsx)(O.A,{...o})}),[o]),{loading:v}=(0,W.A)("/host/connection",{refreshInterval:t,onError:e=>{let t=(0,k.A)(e);t.children=(0,l.jsxs)(l.Fragment,{children:["Failed to get connection data. ",t.children]}),c(t)},onSuccess:e=>{let{local:{inbound:{ipAddress:t,port:n,user:l},peer:r}}=e;c(void 0),m(e=>Object.entries(t).reduce((t,r)=>{let[s,{ifaceId:o,networkLinkNumber:a,networkNumber:i,networkType:c}]=r;return t[s]={...e[s],dbPort:n,dbUser:l,ifaceId:o,ipAddress:s,networkLinkNumber:a,networkNumber:i,networkType:c},t},{})),y(e=>Object.entries(r).reduce((t,n)=>{let[l,{hostUUID:r,isPing:s,port:o,user:a}]=n,i="".concat(a,"@").concat(l,":").concat(o);return t[i]={...e[i],dbPort:o,dbUser:a,hostUUID:r,ipAddress:l,isPingTest:s},t},{}))}});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.l8,{header:"Configure striker peers",loading:v,children:(0,l.jsxs)(r.Ay,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(r.Ay,{item:!0,xs:1,children:(0,l.jsx)(E.A,{header:"Inbound connections",listEmpty:(0,l.jsx)(j.a3,{align:"center",children:"No inbound connections found."}),listItemKeyPrefix:"config-peers-inbound-connection",listItems:x,renderListItem:(e,t)=>{let{dbPort:n,dbUser:r,ifaceId:s,networkNumber:o,networkType:a}=t,i=d.A[a]&&o?"".concat(d.A[a]," ").concat(o):"Unknown network; interface: ".concat(s);return(0,l.jsxs)(w.A,{spacing:0,sx:{width:"100%"},children:[(0,l.jsx)(j.NA,{children:"".concat(r,"@").concat(e,":").concat(n)}),(0,l.jsx)(j.xF,{children:i})]})}})}),(0,l.jsx)(r.Ay,{item:!0,xs:1,children:(0,l.jsx)(E.A,{header:"Peer connections",allowEdit:!0,edit:A,listEmpty:(0,l.jsx)(j.a3,{align:"center",children:"No peer connections found."}),listItemKeyPrefix:"config-peers-peer-connection",listItems:f,onAdd:()=>{var e;null==(e=n.current.setOpen)||e.call(null,!0)},onDelete:()=>{let e=Object.entries(f).reduce((e,t)=>{let[,{hostUUID:n,isChecked:l}]=t;return l&&e.local.push(n),e},{local:[]}),t=e.local.length;if(t>0){var n;p({actionProceedText:"Delete",content:"The peer relationship between this striker and the selected ".concat(t," host(s) will terminate. The removed peer(s) can be re-added later."),onProceedAppend:()=>{h.A.delete("/host/connection",{data:e}).catch(e=>{let t=(0,k.A)(e);t.children="Failed to delete peer connection(s). ".concat(t.children),c(t)})},proceedColour:"red",titleText:"Delete ".concat(t," peer(s) from this striker?")}),null==(n=s.current.setOpen)||n.call(null,!0)}},onEdit:()=>{g(e=>!e)},onItemCheckboxChange:(e,t,n)=>{f[e].isChecked=n,y(e=>({...e}))},renderListItem:(e,t)=>{let{isPingTest:n=!1}=t;return(0,l.jsx)(w.A,{row:!0,spacing:0,children:(0,l.jsxs)(w.A,{spacing:0,children:[(0,l.jsx)(j.NA,{children:e}),(0,l.jsx)(L,{label:"Ping",state:n})]})})}})}),b]})}),(0,l.jsx)(I,{ref:n}),(0,l.jsx)(i.A,{closeOnProceed:!0,...u,ref:s})]})};var H=n(12981),q=n(19659),K=n(57656),X=n(30764);let z=e=>{let{mitmExternalHref:t="https://en.wikipedia.org/wiki/Man-in-the-middle_attack",refreshInterval:n=1e4}=e,[r,s]=(0,a.useState)(),{confirmDialog:o,finishConfirm:i,setConfirmDialogLoading:c,setConfirmDialogOpen:d,setConfirmDialogProps:u}=(0,X.A)(),p=(0,a.useMemo)(()=>r&&(0,l.jsx)(O.A,{...r}),[r]),{data:x,loading:m}=(0,W.A)("/ssh-key/conflict",{onError:e=>{let t=(0,k.A)(e);t.children=(0,l.jsxs)(l.Fragment,{children:["Failed to fetch SSH key conflicts. ",t.children]}),s(t)},onSuccess:()=>{s(void 0)},refreshInterval:n}),{checks:A,getCheck:g,hasAllChecks:f,hasChecks:y,setAllChecks:b,setCheck:v}=(0,K.A)({list:x}),P=(0,a.useMemo)(()=>x&&Object.keys(x).length>1,[x]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(R.l8,{header:"Manage changed SSH keys",loading:m,children:[(0,l.jsxs)(w.A,{spacing:".2em",children:[(0,l.jsx)(j.a3,{children:"The identity of the following targets have unexpectedly changed."}),(0,l.jsxs)(O.A,{type:"warning",isAllowClose:!0,children:["If you haven't rebuilt the listed targets, then you could be experiencing a"," ",(0,l.jsx)(q.A,{href:t,sx:{display:"inline-flex"},target:"_blank",children:'"Man In The Middle"'})," ","attack. Please verify the targets have changed for a known reason before proceeding to remove the broken keys."]}),(0,l.jsx)(E.A,{header:!0,allowCheckAll:P,allowCheckItem:!0,allowDelete:!0,allowEdit:!1,disableDelete:!y,edit:!0,getListCheckboxProps:()=>({checked:f}),listEmpty:(0,l.jsx)(j.a3,{align:"center",children:"No conflicting keys found."}),listItems:x,onAllCheckboxChange:(e,t)=>{b(t)},onDelete:()=>{if(!x)return;let e={badKeys:A};u({actionProceedText:"Delete",content:"Resolves ".concat(A.length," SSH key conflicts. Please make sure the identity change(s) are expected to avoid MITM attacks."),onProceedAppend:()=>{c(!0),h.A.delete("/ssh-key/conflict",{data:e}).then(()=>{i("Success",{children:(0,l.jsx)(l.Fragment,{children:"Started job to delete the selected keys."})})}).catch(e=>{let t=(0,k.A)(e);t.children=(0,l.jsxs)(l.Fragment,{children:["Failed to delete the selected keys. ",t.children]}),i("Error",t)})},proceedColour:"red",titleText:"Delete ".concat(A.length," conflicting SSH keys?")}),d(!0)},onItemCheckboxChange:(e,t,n)=>{v(e,n)},renderListItem:(e,t)=>{let{ip:n,name:r,short:s}=t.target;return(0,l.jsxs)(H.A,{width:"calc(100% - 4em)",children:[(0,l.jsx)(j.a3,{noWrap:!0,children:s||r||n}),(0,l.jsx)(j.xF,{monospaced:!0,noWrap:!0,children:e})]})},renderListItemCheckboxState:e=>g(e)})]}),p]}),o]})},Z="common-user-input-confirm-password",$="common-user-input-name",G="common-user-input-password",J="Username",Q="Password",Y=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r]=t,{formUtils:{buildFinishInputTestBatchFunction:s,buildInputFirstRenderFunction:o,setMessage:i,setValidity:c},previous:{name:d}={},readOnlyUserName:h,requirePassword:p=!1,showPasswordField:x}=r,m=(0,a.useRef)({}),A=(0,a.useRef)({}),[g,f]=(0,a.useState)(p),j=(0,a.useMemo)(()=>x?{"common-user-input-cell-password":{children:(0,l.jsx)(P.A,{input:(0,l.jsx)(S.A,{id:G,label:Q,type:u.A.password}),inputTestBatch:(0,T.rn)(Q,()=>{i(G)},{onFinishBatch:s(G)},e=>{i(G,{children:e})}),onBlurAppend:e=>{var t;let{target:{value:n}}=e;f(n.length>0),c(Z,n===(null==(t=A.current.getValue)?void 0:t.call(null)))},onFirstRender:o(G),ref:m,required:p})},"common-user-input-cell-confirm-password":{children:(0,l.jsx)(P.A,{input:(0,l.jsx)(S.A,{id:Z,inputProps:{readOnly:!g},label:"Confirm password",type:u.A.password}),inputTestBatch:{defaults:{onSuccess:()=>{i(Z)}},onFinishBatch:s(Z),tests:[{test:T.G4},{onFailure:()=>{i(Z,{children:"The passwords do not match."})},test:e=>{var t;let{value:n}=e;return n===(null==(t=m.current.getValue)?void 0:t.call(null))}}]},onFirstRender:o(Z),ref:A,required:g})}}:void 0,[s,o,g,p,i,c,x]);return(0,l.jsx)(b.A,{columns:{xs:1,sm:2,md:3},layout:{"common-user-input-cell-name":{children:(0,l.jsx)(P.A,{input:(0,l.jsx)(S.A,{id:$,inputProps:{readOnly:h},label:J,value:d}),inputTestBatch:(0,T.rn)(J,()=>{i($)},{onFinishBatch:s($)},e=>{i($,{children:e})}),onFirstRender:o($),required:!0}),md:1,sm:2},...j},spacing:"1em"})};var ee=n(60801),et=n(52627),en=n(42116),el=n(44193);let er=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[{target:l}]=t,{elements:r}=l,{value:s}=r.namedItem($),o=r.namedItem(G),a="";return o&&({value:a}=o),{password:a,userName:s}},es=()=>{let e=(0,a.useRef)({}),t=(0,a.useRef)({}),n=(0,a.useRef)({}),r=(0,a.useRef)({}),[s,o]=(0,en.A)(),[c,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)({children:"No users found."}),[p,x]=(0,a.useState)(),{data:m,loading:A}=(0,W.A)("/user",{onError:e=>{h((0,k.A)(e))},periodic:!0}),g=(0,el.A)([Z,$,G],r),{isFormInvalid:f,isFormSubmitting:y,submitForm:w}=g,{buildDeleteDialogProps:b,checks:v,getCheck:P,hasChecks:S,setCheck:T}=(0,K.A)({list:m}),{userName:M,userUUID:F}=(0,a.useMemo)(()=>null!=p?p:{},[p]),I=(0,a.useMemo)(()=>({actionProceedText:"Add",content:(0,l.jsx)(Y,{formUtils:g,requirePassword:!0,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];let a=er(...r);o({actionProceedText:"Add",content:(0,l.jsx)(et.A,{entries:a,hasPassword:!0}),onProceedAppend:()=>{w({body:a,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Add user failed. ",e]}),method:"post",successMsg:"Created user ".concat(a.userName,"."),url:"/user"})},titleText:"Add the following new user?"}),null==(e=t.current.setOpen)||e.call(null,!0)},titleText:"Add a web interface user"}),[g,o,w]),D=(0,a.useMemo)(()=>({actionProceedText:"Update",content:(0,l.jsx)(Y,{formUtils:g,previous:{name:M},readOnlyUserName:"admin"===M,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];let a=er(...r);o({actionProceedText:"Update",content:(0,l.jsx)(et.A,{entries:a,hasPassword:!0}),onProceedAppend:()=>{w({body:a,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Update user failed. ",e]}),method:"put",successMsg:"Updated user ".concat(M),url:"/user/".concat(F)})},titleText:"Update user ".concat(M," with the following?")}),null==(e=t.current.setOpen)||e.call(null,!0)},titleText:"Edit user ".concat(M)}),[g,o,w,M,F]),N=(0,a.useMemo)(()=>(0,l.jsx)(C.A,{count:1,defaultMessageType:"warning",ref:r}),[]),U=(0,a.useMemo)(()=>{var e;return(null==m||null==(e=m.current)?void 0:e.userName)==="admin"},[m]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.l8,{header:"Manage users",loading:A,children:(0,l.jsx)(E.A,{allowAddItem:U,allowDelete:U,allowEdit:!0,allowItemButton:c,disableDelete:!S,edit:c,getListItemCheckboxProps:(e,t)=>{let{userName:n}=t;return{disabled:"admin"===n}},header:!0,listEmpty:(0,l.jsx)(O.A,{...u}),listItems:m,onAdd:()=>{var t;null==(t=e.current.setOpen)||t.call(null,!0)},onDelete:()=>{var e;o(b({confirmDialogProps:{onProceedAppend:()=>{w({body:{uuids:v},getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Delete user(s) failed. ",e]}),method:"delete",url:"/user"})}},formSummaryProps:{renderEntry:e=>{let{key:t}=e;return(0,l.jsx)(j.a3,{children:null==m?void 0:m[t].userName})}},getConfirmDialogTitle:e=>"Delete the following ".concat(e," users?")})),null==(e=t.current.setOpen)||e.call(null,!0)},onEdit:()=>d(e=>!e),onItemCheckboxChange:(e,t,n)=>T(e,n),onItemClick:e=>{if(c){var t;x(e),null==(t=n.current.setOpen)||t.call(null,!0)}},renderListItemCheckboxState:e=>P(e),renderListItem:(e,t)=>{let{userName:n}=t;return(0,l.jsx)(j.a3,{children:n})}})}),(0,l.jsx)(ee.A,{...I,disableProceed:f,loadingAction:y,preActionArea:N,ref:e}),(0,l.jsx)(ee.A,{...D,disableProceed:f,loadingAction:y,preActionArea:N,ref:n}),(0,l.jsx)(i.A,{closeOnProceed:!0,...s,ref:t})]})},eo=()=>(0,l.jsxs)(R.Zk,{children:[(0,l.jsx)(V,{}),(0,l.jsx)(z,{}),(0,l.jsx)(es,{})]});var ea=n(57212),ei=n(53198),ec=n(79982);let ed=e=>(0,l.jsx)(ei.A,{...e,sx:{width:"100%"}}),eu=e=>{let{installTarget:t="disabled",onSubmit:n,title:s}=e,[o,i]=(0,a.useState)(),c=(0,a.useMemo)(()=>s?(0,l.jsx)(j.HM,{sx:{textAlign:"center"},children:s}):(0,l.jsx)(ec.A,{mt:0}),[s]),d=(0,a.useMemo)(()=>o&&(0,l.jsx)(r.Ay,{item:!0,sm:2,xs:1,children:(0,l.jsx)(O.A,{...o,onClose:()=>{i(void 0)}})}),[o,i]);return(0,l.jsxs)(R.Zk,{children:[(0,l.jsx)(R.aO,{children:c}),(0,l.jsxs)(r.Ay,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(r.Ay,{display:"none",item:!0,sm:2,xs:1,children:(0,l.jsxs)(w.A,{row:!0,children:[(0,l.jsx)(j.a3,{sx:{flexGrow:1},children:"Install target"}),(0,l.jsx)(ea.A,{checked:"enabled"===t,edge:"end",onChange:(e,t)=>{let r="disable",o="Disable";t&&(r="enable",o="Enable"),null==n||n.call(null,{actionProceedText:o,content:(0,l.jsxs)(j.a3,{children:["Would you like to ",r,' "Install target" on this striker? It\'ll take a few moments to complete.']}),onProceedAppend:()=>{h.A.put("/host/local",{isEnableInstallTarget:t},{params:{handler:"install-target"}}).catch(e=>{let t=(0,k.A)(e);t.children="Failed to ".concat(r,' "Install target". ').concat(t.children),i(t)})},titleText:"".concat(o,' "Install target" on ').concat(s,"?")})}})]})}),(0,l.jsx)(r.Ay,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Update",content:(0,l.jsx)(j.a3,{children:"Would you like to update the operating system on this striker? It'll be placed into maintenance mode until the update completes."}),onProceedAppend:()=>{h.A.put("/command/update-system").catch(e=>{let t=(0,k.A)(e);t.children="Failed to initiate system update. ".concat(t.children),i(t)})},titleText:"Update operating system on ".concat(s,"?")})},children:"Update system"})}),(0,l.jsx)(r.Ay,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{href:"/init?re=1",children:"Reconfigure striker"})}),(0,l.jsx)(r.Ay,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Reboot",content:(0,l.jsx)(j.a3,{children:"Would you like to reboot this striker?"}),onProceedAppend:()=>{h.A.put("/command/reboot-host").catch(e=>{let t=(0,k.A)(e);t.children="Failed to initiate system reboot. ".concat(t.children),i(t)})},titleText:"Reboot ".concat(s,"?")})},children:"Reboot"})}),(0,l.jsx)(r.Ay,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Shutdown",content:(0,l.jsx)(j.a3,{children:"Would you like to shutdown this striker?"}),onProceedAppend:()=>{h.A.put("/command/poweroff-host").catch(e=>{let t=(0,k.A)(e);t.children="Failed to initiate system shutdown. ".concat(t.children),i(t)})},titleText:"Shutdown ".concat(s,"?")})},children:"Shutdown"})}),d]})]})},eh=e=>{let{refreshInterval:t=6e4}=e,[n,s]=(0,a.useState)(!1),[d,u]=(0,a.useState)({actionProceedText:"",closeOnProceed:!0,content:"",dialogProps:{open:n},onCancelAppend:()=>{s(!1)},onProceedAppend:()=>{s(!1)},titleText:""}),[h,p]=(0,a.useState)(),[x,m]=(0,a.useState)(""),{data:A,loading:g}=(0,W.A)("/host/local",{onError:()=>{m("Unknown")},onSuccess:e=>{let{short:t,variables:n}=e;p(n.installTarget),m(t)},refreshInterval:t});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o(),{children:(0,l.jsx)("title",{children:g?"Loading...":"".concat(null==A?void 0:A.short," Config")})}),(0,l.jsx)(c.A,{}),(0,l.jsxs)(r.Ay,{container:!0,columns:{xs:1,md:3,lg:4},children:[(0,l.jsx)(r.Ay,{item:!0,xs:1,children:(0,l.jsx)(eu,{installTarget:h,onSubmit:e=>{let{onProceedAppend:t,...n}=e;u(e=>({...e,...n,onProceedAppend:function(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];null==t||t.call(null,...n),s(!1)}})),s(!0)},title:x})}),(0,l.jsx)(r.Ay,{item:!0,md:2,xs:1,children:(0,l.jsx)(eo,{})})]}),(0,l.jsx)(i.A,{...d,dialogProps:{open:n}})]})}},75925:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var l=n(37876),r=n(12981),s=n(14232),o=n(57547),a=n(31465),i=n(46316),c=n(51677);let d=(0,s.forwardRef)((e,t)=>{let{actionCancelText:n="Cancel",actionProceedText:d,children:u,closeOnProceed:h=!1,contentContainerProps:p,dialogProps:x,disableProceed:m,loading:A,loadingAction:g=!1,onActionAppend:f,onCancelAppend:j,onProceedAppend:y,openInitially:w,preActionArea:b,proceedButtonProps:k,proceedColour:v="blue",scrollContent:P=!1,scrollBoxProps:C,showActionArea:S=!0,showCancel:T,showClose:M,titleText:F,wide:I,content:E=u}=e,O=(0,s.useRef)(null),R=(0,s.useMemo)(()=>(0,i.A)(E,c.a3),[E]),D=(0,s.useMemo)(()=>(0,s.createElement)(P?o.Ji:r.A,C,R),[R,C,P]),N=(0,s.useMemo)(()=>S&&(0,l.jsx)(o.aZ,{cancelProps:{children:n,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==f||f.call(null,...t),null==j||j.call(null,...t)}},closeOnProceed:h,loading:g,proceedProps:{background:v,children:d,disabled:m,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==f||f.call(null,...t),null==y||y.call(null,...t)},...k},showCancel:T}),[n,d,h,m,g,f,j,y,k,v,S,T]);return(0,s.useImperativeHandle)(t,()=>({setOpen:e=>{var t;return null==(t=O.current)?void 0:t.setOpen(e)}}),[]),(0,l.jsx)(o.K_,{dialogProps:x,header:F,loading:A,openInitially:w,ref:O,showClose:M,wide:I,children:(0,l.jsxs)(a.A,{...p,children:[D,b,N]})})});d.displayName="ConfirmDialog";let u=d},95623:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/config",function(){return n(70942)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[559,3,44,133,732,821,636,593,792],()=>t(95623)),_N_E=e.O()}]);