(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{2240:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(37876),s=n(71918),a=n(51553),l=n(35268),i=n(14232),o=n(10595),c=n(64345),d=n(20795);let u=(0,l.Ay)(s.A)({height:"3.5em",marginLeft:0,width:"100%"}),h=e=>{let{baseInputProps:t,checked:n,formControlLabelProps:s,id:l,label:h,name:m,onChange:p,switchProps:x}=e,f=(0,i.useMemo)(()=>(0,c.A)(h,d.a3,{color:"".concat(o.Qu,"AF"),inheritColour:!0}),[h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{control:(0,r.jsx)(a.A,{checked:n,edge:"end",name:m,onChange:p,...x}),label:f,labelPlacement:"start",slotProps:{typography:{flexGrow:1}},...s}),(0,r.jsx)("input",{checked:n,hidden:!0,id:l,readOnly:!0,type:"checkbox",...t})]})}},20863:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(14232),s=n(13920),a=n(28850),l=n(74235);let i=e=>{let{description:t,getRequestBody:n,getSummary:i,header:o,helpers:c,onError:d,onSuccess:u,operation:h,slotProps:m,tools:p,url:x,values:f,method:j=(e=>{switch(e){case"add":return"post";case"delete":return"delete";default:return"put"}})(h)}=e,g=e.confirm?(e=>({finish:e.finishConfirm,loading:e.setConfirmDialogLoading,open:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.setConfirmDialogOpen(t)},prepare:e.setConfirmDialogProps}))(e.confirm):null==p?void 0:p.confirm,v=null==i?void 0:i(f),A={actionProceedText:(e=>{switch(e){case"add":return"Add";case"delete":return"Delete";default:return"Save"}})(h),content:null!=t?t:(0,r.createElement)(s.A,{entries:null!=v?v:f,...null==m?void 0:m.summary}),onCancelAppend:()=>c.setSubmitting(!1),onProceedAppend:()=>{null==g||g.loading(!0);let e=null==n?void 0:n(f,v);a.A.request({data:e,method:j,url:x}).then(()=>{null==g||g.finish("Success",{children:null==u?void 0:u()}),null==p||p.add.open(!1),null==p||p.edit.open(!1)}).catch(e=>{let t=(0,l.A)(e);t.children=(0,r.createElement)(r.Fragment,null,null==d?void 0:d(e)," ",t.children),null==g||g.finish("Error",t)})},proceedColour:"delete"===h?"red":"blue",titleText:o,...null==m?void 0:m.confirm};null==g||g.prepare(A),null==g||g.open(!0)}},27532:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(14232),s=n(28850),a=n(21635),l=n(74235);let i=(e,t)=>{let{key:n,re:r,replace:s,value:l}=t;return n?e[n]===l?e:(0,a.Ay)(n,l)(e):r?(0,a.WT)(r,l)(e):s||e},o=(e,t)=>{var n;let[a,o]=(0,r.useState)(!1),[c,d]=(0,r.useReducer)(i,{}),u=(0,r.useCallback)(e=>{var n,r;return null==t||null==(r=t.current)||null==(n=r.setMessage)?void 0:n.call(null,"api",e)},[t]),h=(0,r.useCallback)((e,n)=>{var r,s;null==t||null==(s=t.current)||null==(r=s.setMessage)||r.call(null,String(e),n)},[t]),m=(0,r.useCallback)((e,n)=>{var r,s;null==t||null==(s=t.current)||null==(r=s.setMessageRe)||r.call(null,e,n)},[t]),p=(0,r.useCallback)(e=>{d({replace:e})},[]),x=(0,r.useCallback)((e,t)=>{d({key:e,value:t})},[]),f=(0,r.useCallback)((e,t)=>{d({re:e,value:t})},[]),j=(0,r.useCallback)(e=>{h(e),x(e)},[h,x]),g=(0,r.useCallback)(e=>{m(e),f(e)},[m,f]),v=(0,r.useCallback)(e=>t=>{x(e,t)},[x]),A=(0,r.useCallback)(e=>t=>{let{isValid:n}=t;x(e,n)},[x]),w=(0,r.useCallback)(e=>()=>{j(e)},[j]),b=(0,r.useCallback)(e=>{let{body:r,getErrorMsg:a,msgKey:i="api",method:c,onError:d,onSuccess:u,setMsg:h=null==t||null==(n=t.current)?void 0:n.setMessage,successMsg:m,url:p}=e;o(!0),s.A.request({data:r,method:c,url:p}).then(()=>{null==h||h.call(null,i,{children:m,type:"info"}),null==u||u.call(null)}).catch(e=>{let t=(0,l.A)(e);t.children=a(t.children),null==h||h.call(null,i,t),null==d||d.call(null)}).finally(()=>{o(!1)})},[t,o]),k=(0,r.useMemo)(()=>Object.values(c).some(e=>!e),[c]);return{buildFinishInputTestBatchFunction:v,buildInputFirstRenderFunction:A,buildInputUnmountFunction:w,formValidity:c,isFormInvalid:k,isFormSubmitting:a,setApiMessage:u,setFormValidity:p,setMessage:h,setMessageRe:m,setValidity:x,setValidityRe:f,submitForm:b,unsetKey:j,unsetKeyRe:g}}},36134:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tU});var r=n(37876),s=n(77328),a=n.n(s),l=n(89099),i=n(14232),o=n(51588),c=n(49508),d=n(41316),u=n(65532),h=n(96446),m=n(7254),p=n(52076),x=n.n(p),f=n(48937),j=n(28850),g=n(43010),v=n(15852),A=n(11910),w=n(69146),b=n(43620),k=n(2240),y=n(20795),C=n(88259);let S=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s]=t,{formikUtils:a,id:l,parameter:o,required:c}=s,{content_type:d,default:h,description:p,options:x=[]}=o,{changeFieldValue:f,formik:j,handleChange:g}=a,S="parameters.".concat(l,".value"),I=(0,i.useMemo)(()=>{let e;if("boolean"===d){let e=!!j.values.parameters[l].value;return(0,r.jsx)(k.A,{checked:e,id:S,label:l,name:S,onChange:(e,t)=>{f(S,t,!0)}})}let t=String(j.values.parameters[l].value);return"select"===d?(0,r.jsx)(b.A,{id:S,label:l,name:S,onChange:j.handleChange,required:c,selectItems:x,selectProps:{onClearIndicatorClick:()=>{f(S,"",!0)}},value:t}):(u.sX.test(l)?e=A.A.password:"string"!==d&&(e=A.A.number),(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:S,inputProps:{placeholder:h},label:l,name:S,onChange:g,required:c,type:e,value:t})}))},[S,f,j,g,l,x,h,d,c]);return(0,i.useMemo)(()=>(0,r.jsx)(v.A,{disableInteractive:!0,placement:"top-start",slotProps:{tooltip:{sx:{maxWidth:{md:"63em"}}}},title:(0,r.jsx)(y.a3,{children:p}),children:(0,r.jsx)(m.A,{children:I})},"".concat(l,"-tooltip")),[p,l,I])};var I=n(13920);let M=(e,t)=>{let n=!1;return[/plug|port/i.test(e),Number(t.deprecated),t.replacement].some(e=>!!e)?n=!1:1===Number(t.required)&&(n=!0),n};var O=n(74235),N=n(67820),P=n(35755),U=n(91408);let q=["integer","second"];var D=n(69397);let F=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(t);return U.Ik({agent:U.Yj().required().oneOf(r),name:((e,t)=>{let n=Object.values(t);e&&(n=n.filter(t=>t.fenceUUID!==e));let r=n.map(e=>e.fenceName);return U.Yj().min(1).max(32).notOneOf(r,"${path} already exists")})(n,e).required(),parameters:U.RZ((e,n)=>{var r;let{context:s}=n,a=null!=(r=null==s?void 0:s.agent)?r:"",l=(0,D.A)(e,e=>{let{[a]:n}=t;if(!n)return U.Ik({value:U.gl()});let{[e]:r}=n.parameters,s=((e,t)=>{let n,{content_type:r,options:s}=t;return n="boolean"===r?U.zM():q.includes(r)?U.ai():U.Yj(),M(e,t)&&(n=n.required()),s&&(n=n.oneOf(s)),n})(e,r);return U.Ik({value:s})});return U.Ik(l)})})};var E=n(93647);let R=(e,t)=>Object.entries(e.parameters).reduce((e,n)=>{var r,s;let a,[l,i]=n,{content_type:o}=i,c=null!=(s=null!=(r=null==t?void 0:t.fenceParameters[l])?r:i.default)?s:"";return a="boolean"===o?["1","on"].some(e=>e===c):String(c),e[l]={value:a},e},{}),T=(e,t,n)=>Object.entries(t).reduce((t,s)=>{let[a,l]=s,{deprecated:i,replacement:o}=l;return Number(i)||o||t.push((0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(S,{formikUtils:e,id:a,parameter:l,required:n})},"".concat(a,"-parameter-input"))),t},[]),z=e=>{let{fence:t,fences:n,template:s,tools:a}=e,l=void 0!==t,o=(0,i.useMemo)(()=>{let e,n,r;return l?(e="put",n="/fence/".concat(t.fenceUUID),r="update"):(e="post",n="/fence",r="add"),{capped:x()(r),method:e,url:n,value:r}},[l,null==t?void 0:t.fenceUUID]),c=(0,i.useMemo)(()=>Object.keys(s).sort((e,t)=>e.localeCompare(t)),[s]),u=(0,i.useMemo)(()=>((e,t)=>{let n={agent:null,name:"",parameters:{},uuid:""};if(t){let{fenceAgent:r,fenceName:s,fenceUUID:a}=t;n.agent=r,n.name=s,n.parameters=R(e[r],t),n.uuid=a}return n})(s,t),[t,s]),h=(0,E.A)({initialValues:u,onSubmit:(e,t)=>{let{setSubmitting:n}=t,{name:i,parameters:c}=e,d=String(e.agent),u={agent:d,name:i,parameters:Object.entries(c).reduce((e,t)=>{let[n,{value:r}]=t,{[d]:a}=s;if(!a)return e;let{[n]:i}=a.parameters,o=((e,t)=>"boolean"===t?e?"1":"":String(e))(r,i.content_type);return(l||o)&&o!==i.default&&(e[n]=o),e},{})};a.confirm.prepare({actionProceedText:o.capped,content:(0,r.jsx)(I.A,{entries:u,hasPassword:!0,getEntryLabel:e=>{let{cap:t,depth:n,key:r}=e;return n?r:t(r)}}),onCancelAppend:()=>n(!1),onProceedAppend:()=>{a.confirm.loading(!0),j.A.request({data:u,method:o.method,url:o.url}).then(()=>{a.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:[o.capped,"ed fence device ",i]})}),a.add.open(!1)}).catch(e=>{let t=(0,O.A)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to ",o.value," fence device. ",t.children]}),a.confirm.finish("Error",t),n(!1)})},titleText:"".concat(o.capped," fence device with the following?")}),a.confirm.open()},validationSchema:F(n,s,null==t?void 0:t.fenceUUID)}),{disabledSubmit:p,formik:v,formikErrors:A,handleChange:b}=h,k=(0,i.useMemo)(()=>({agent:"agent",name:"name",parameters:"parameters"}),[]),S=(0,i.useMemo)(()=>{let e;return v.values.agent&&({[v.values.agent]:e}=s),(e=>{let t={optional:{},required:{}};if(!e)return t;let{parameters:n}=e;return Object.entries(n).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).reduce((e,t)=>{let[n,r]=t;return e[M(n,r)?"required":"optional"][n]=r,e},t)})(e)},[v.values.agent,s]),U=(0,i.useMemo)(()=>T(h,S.optional),[h,S.optional]),q=(0,i.useMemo)(()=>T(h,S.required,!0),[h,S.required]);return(0,r.jsxs)(d.Ay,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),v.submitForm()},rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{container:!0,maxHeight:"50vh",overflow:"scroll",rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(g.A,{disabled:l,id:k.agent,label:"Fence device type",noOptionsText:"No matching fence device type",onChange:(e,n)=>{let r={...v.values,agent:n};if(n){let{[n]:e}=s;r.parameters=R(e,t)}v.setValues(r,!0)},openOnFocus:!0,options:c,renderOption:(e,t)=>{let{[t]:n}=s,a="string"==typeof n.description?n.description:"None";return(0,i.createElement)("li",{...e,key:"fence-agent-".concat(t)},(0,r.jsxs)(m.A,{children:[(0,r.jsx)(y.a3,{inheritColour:!0,children:t}),(0,r.jsx)(y.a3,{selected:!1,children:a})]}))},required:!0,value:v.values.agent})}),v.values.agent&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(P.l8,{expandInitially:!0,header:"Required parameters",panelProps:{mv:0},children:(0,r.jsxs)(d.Ay,{container:!0,rowSpacing:"0.6em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:k.name,label:"Fence device name",name:k.name,onChange:b,required:!0,value:v.values.name})})}),q]})})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(P.l8,{header:"Optional parameters",panelProps:{mv:0},children:(0,r.jsx)(d.Ay,{container:!0,rowSpacing:"0.6em",children:U})})})]})]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:A})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:o.capped,disabled:p,type:"submit"}]})})]})};var H=n(30827);let V=()=>{let{data:e,loading:t}=(0,H.A)("/fence/template");return(0,r.jsx)(h.A,{addHeader:"Add a fence device",editHeader:e=>(0,r.jsxs)(y.HM,{children:["Update fence device"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:null==e?void 0:e.fenceName})," ","parameters"]}),entriesUrl:"/fence",formDialogProps:{common:{wide:!0}},getAddLoading:e=>e||t,getEditLoading:e=>e||t,getDeleteErrorMessage:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return{...n,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete fence device(s). ",e]})}},getDeleteHeader:e=>"Delete ".concat(e," fence device(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted fence device(s)"})}),listEmpty:"No fence device(s) found.",onItemClick:(e,t)=>{let{args:n,entry:r,tools:s}=t,[a]=n;r.set(a),s.edit.open(!0)},renderAddForm:(t,n)=>n&&e&&(0,r.jsx)(z,{fences:n,template:e,tools:t}),renderDeleteItem:(e,t)=>{let{key:n}=t,s=null==e?void 0:e[n];return(0,r.jsx)(y.a3,{children:null==s?void 0:s.fenceName})},renderEditForm:(t,n,s)=>s&&e&&(0,r.jsx)(z,{fence:n,fences:s,template:e,tools:t}),renderListItem:(e,t)=>{let{fenceAgent:n,fenceName:s,fenceParameters:a}=t;return(0,r.jsxs)(d.Ay,{columnSpacing:"1em",container:!0,children:[(0,r.jsx)(d.Ay,{item:!0,children:(0,r.jsx)(y.a3,{children:s})}),(0,r.jsx)(d.Ay,{item:!0,xs:!0,children:(0,r.jsx)(y.a3,{noWrap:!0,children:Object.entries(a).sort((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}).reduce((e,t)=>{let[n,s]=t,a=(0,r.jsxs)(r.Fragment,{children:[n,'="']});return a=u.sX.test(n)?(0,r.jsxs)(r.Fragment,{children:[a,(0,r.jsx)(y.EN,{wrapper:"mono",wrapperProps:{noWrap:!0},children:s})]}):(0,r.jsxs)(r.Fragment,{children:[a,s]}),(0,r.jsxs)(r.Fragment,{children:[e," ",a,'"']})},n)})})]})}})},_=()=>(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage fence devices"})}),(0,r.jsx)(V,{})]});var B=n(75791),W=n(28957),Y=n(66998),Z=n(38317),L=n(10595),$=n(82707),X=n(93282);let G=e=>{let{list:t,setValue:n,value:s}=e;return 0===t.length?(0,r.jsx)(y.a3,{children:"No host(s) found."}):(0,r.jsx)(X.A,{centered:!0,onChange:(e,t)=>{n(t)},orientation:"vertical",value:s,children:t.map(e=>{let{hostConfigured:t,hostStatus:n,hostType:s,hostUUID:a,shortHostName:l}=e,i=s.replace("dr","DR").replace("node","Subnode");return(0,r.jsx)($.A,{label:(0,r.jsxs)(Y.A,{columnSpacing:"1em",container:!0,sx:{width:"100%",["& > .".concat(Z.A.root,":not(:first-child)")]:{borderLeft:"thin solid ".concat(L.eT),paddingLeft:"1em"}},children:[(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsx)(y.a3,{noWrap:!0,children:i})}),(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsx)(y.NA,{noWrap:!0,children:l})}),(0,r.jsx)(Y.A,{size:"grow",children:(0,r.jsxs)(y.a3,{noWrap:!0,children:[n,t?", configured":""]})})]}),sx:{textAlign:"left"},value:a},"host-".concat(a))})})};var K=n(40123),J=n.n(K),Q=n(68872),ee=n(99308);let et=U.Ik({hostName:U.Yj().required(),networkInit:ee.hJ}),en=e=>{let{values:t}=e;return(0,r.jsxs)(d.Ay,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Host name"})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:t.hostName})}),(0,r.jsx)(ee.Sf,{...e})]})};var er=n(6759);let es=e=>{let{detail:t,tools:n,uuid:s}=e,a=(0,i.useRef)(null),l=(0,E.A)({initialValues:(e=>{let{dns:t="",gateway:n="",networks:r,ntp:s=""}=e.netconf,a={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"},defaultsn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"sn"},defaultmn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"mn"}};J()(r)||(a=(0,er.A)(r));let{name:l}=e;return{hostName:l,mini:!1,networkInit:{dns:t,gateway:n,networks:a,ntp:s}}})(t),onSubmit:(e,s)=>{let{setSubmitting:l}=s,i=(0,Q.A)(e,a.current);n.confirm.prepare({actionProceedText:"Prepare network",content:a.current&&(0,r.jsx)(en,{gatewayIface:i.gatewayInterface,ifaces:a.current,values:e}),onCancelAppend:()=>l(!1),onProceedAppend:()=>{n.confirm.loading(!0),j.A.put("/host/".concat(t.uuid,"?handler=subnode-network"),i).then(()=>{n.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started network config on ",t.short]})})}).catch(e=>{let s=(0,O.A)(e);s.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare network on ",t.short,". ",s.children]}),n.confirm.finish("Error",s),l(!1)})},titleText:"Prepare network on ".concat(t.short," with the following?")}),n.confirm.open()},validationSchema:et},{allowClean:!0}),{disabledSubmit:o,formik:c,formikErrors:u,handleChange:h}=l,m=(0,i.useMemo)(()=>t.type.replace("node","subnode"),[t.type]),{parentSequence:p,sequence:x}=(0,i.useMemo)(()=>{let[e,n]=t.short.replace(/^.*a(\d+).*(?:n|dr)(\d+)$/,"$1,$2").split(",",2);return{parentSequence:Number(e),sequence:Number(n)}},[t.short]),g=(0,i.useMemo)(()=>({hostName:"hostName",mini:"mini",networks:"networkInit.networks"}),[]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2,md:3,lg:4},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),c.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:g.hostName,label:"Host name",name:g.hostName,onChange:h,required:!0,value:c.values.hostName})})}),(0,r.jsx)(d.Ay,{display:{xs:"none",md:"initial"},flexGrow:1,item:!0}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(k.A,{id:g.mini,label:"Minimal config",name:g.mini,onChange:(e,t)=>{if(t){let{defaultbcn:e}=c.values.networkInit.networks;c.setFieldValue(g.networks,{defaultbcn:e},!0)}else c.resetForm();c.handleChange(e)},checked:c.values.mini})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(ee.VT,{formikUtils:l,host:{parentSequence:p,sequence:x,type:m,uuid:s},onFetchSuccess:e=>{a.current=e}})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:u})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Prepare network",disabled:o,type:"submit"}]})})]})};var ea=n(11457),el=n(61931);let ei=e=>{let{uuid:t}=e,{confirmDialog:n,finishConfirm:s,setConfirmDialogLoading:a,setConfirmDialogOpen:l,setConfirmDialogProps:o}=(0,el.A)({initial:{scrollContent:!0,wide:!0}}),c=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:s,loading:a,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return l(e)},prepare:o},edit:{open:()=>null}}),[s,a,l,o]),{data:d}=(0,H.A)("/host/".concat(t));return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(es,{detail:d,tools:c,uuid:t}),n]}):(0,r.jsx)(ea.A,{mt:0})};var eo=n(10342);let ec=()=>{let[e,t]=(0,i.useState)(!1),{data:n}=(0,H.A)("/host?type=dr&type=subnode"),s=(0,i.useMemo)(()=>n&&Object.values(n),[n]);return s?(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(G,{list:s,setValue:t,value:e}),e&&(0,r.jsx)(W.A,{sx:{margin:"2em 0"}}),s.map(t=>(0,r.jsx)(eo.A,{changingTabId:e,tabId:t.hostUUID,children:(0,r.jsx)(ei,{uuid:t.hostUUID})},"cell-".concat(t.hostUUID)))]}):(0,r.jsx)(P.Zk,{children:(0,r.jsx)(ea.A,{})})};var ed=n(31254),eu=n(34318),eh=n(35268);let em=(0,eh.Ay)("div")({["& > .".concat(Z.A.container,":first-child")]:{maxHeight:"60vh",overflowX:"hidden",overflowY:"scroll",paddingRight:".4em",paddingTop:".6em"}});var ep=n(20863),ex=n(92144),ef=n(45944),ej=n(36150);let{Form:eg,FormContext:ev,useFormContext:eA}=(0,ej.A)(),ew=(0,i.createContext)(null);var eb=n(40038);let ek="an-id-input-domain",ey="an-id-input-prefix",eC="an-id-input-sequence",eS="an-network-config-input-dns",eI="an-network-config-input-ntp",eM="gateway",eO="min-ip",eN="network-type",eP="network-number",eU="subnet-mask",eq="port",eD="ipmi-ip",eF="power-host",eE=e=>{let{hostSequence:t}=e,n=eA(ev),s=(0,i.useContext)(ew),a=(0,i.useMemo)(()=>{let e="hosts.".concat(t);return{[eD]:"".concat(e,".").concat(eD),fences:"".concat(e,".fences"),networks:"".concat(e,".networks"),upses:"".concat(e,".upses")}},[t]);if(!n||!s)return null;let{changeFieldValue:l,formik:o,handleChange:c}=n.formikUtils,{fences:d,upses:u}=s.template,h=Object.entries(o.values.hosts[t].fences),m=Object.entries(o.values.hosts[t].networks),p=Object.entries(o.values.hosts[t].upses);return(0,r.jsxs)(P.t$,{mv:0,children:[(0,r.jsx)(P.WJ,{children:(0,r.jsxs)(y.a3,{children:["Subnode ",t]})}),(0,r.jsx)(P.BF,{children:(0,r.jsxs)(Y.A,{container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eb.A,{children:"It is recommended to provide at least 1 fence device plug."})}),m.map(e=>{let[n,s]=e,{ip:l}=s,i="".concat(a.networks,".").concat(n,".").concat("ip"),{[eP]:d,[eN]:u=""}=o.values.netconf.networks[n],h="".concat(u.toUpperCase()," ").concat(d," IP");return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:i,label:h,name:i,onChange:c,required:!0,value:l})})},"host-".concat(t,"-network-").concat(n))}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:a[eD],label:"IPMI IP",name:a[eD],onChange:c,value:o.values.hosts[t][eD]})})}),h.map(e=>{let[n,s]=e,{[eq]:l}=s,i="".concat(a.fences,".").concat(n,".").concat(eq),{[n]:o}=d,u="Plug on ".concat(o.fenceName);return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:i,label:u,name:i,onChange:c,value:l})})},"host-".concat(t,"-fence-").concat(n))})]})}),p.length>0&&(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:p.map(e=>{let[n,s]=e,{[eF]:i}=s,o="".concat(a.upses,".").concat(n,".").concat(eF),{[n]:c}=u,d="Uses ".concat(c.upsName);return(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(k.A,{checked:i,id:o,label:d,name:o,onChange:(e,t)=>{l(o,t,!0)}})},"host-".concat(t,"-ups-").concat(n))})})})]})})]})},eR=e=>{let{slotProps:t}=e,n=eA(ev);if(!n)return null;let{formik:s}=n.formikUtils;return(0,r.jsx)(Y.A,{container:!0,spacing:"1em",width:"100%",...null==t?void 0:t.container,children:Object.keys(s.values.hosts).map(e=>(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eE,{hostSequence:e})},"host-".concat(e)))})};var eT=n(87356),ez=n(40143);let eH=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t||e.split(".").map((e,t)=>{let n=Number(e);return 2===t&&(n+=1),n}).join(".")},eV=function(e,t,n){var r;let s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{[eP]:l=0,[eN]:i}=n,o="".concat(i).concat(l),c=10+2*(e-1),d=0;switch(i){case"bcn":d=200+Number(l),s="10.".concat(d,".").concat(c,".").concat(t);break;case"mn":d=199,s="10.".concat(d,".").concat(c,".").concat(t);break;case"sn":d=100+Number(l),s="10.".concat(d,".").concat(c,".").concat(t);break;default:s=""}return(null==(r=a[o])?void 0:r.networkIp)||s},e_=e=>{let{getFieldChanged:t,hosts:n,values:r}=e,{[ek]:s,[ey]:a,[eC]:l}=r,i={...r},o=Object.entries(r.netconf.networks);return o.forEach(e=>{let[n,r]=e,{[eP]:s=0,[eN]:a}=r,l={...i.netconf.networks[n]};if(!(null==t?void 0:t("".concat("netconf.networks.".concat(n),".").concat(eO)))){let e,t=0;switch(a){case"bcn":t=200+Number(s),e="10.".concat(t,".0.0");break;case"mn":t=199,e="10.".concat(t,".0.0");break;case"sn":t=100+Number(s),e="10.".concat(t,".0.0");break;default:e=""}l[eO]=e}i.netconf.networks[n]=l}),Object.entries(r.hosts).forEach(e=>{let[n]=e;o.forEach(e=>{let[r,s]=e,{[eN]:a}=s,o={...i.hosts[n].networks[r]},c="hosts.".concat(n),d="".concat(c,".networks.").concat(r);if((null==t?void 0:t("".concat(d,".").concat("ip")))||(o.ip=eV(l,Number(n),s)),i.hosts[n].networks[r]=o,"bcn"===a&&!(null==t?void 0:t("".concat(c,".").concat(eD)))){let e=eH(o.ip);i.hosts[n][eD]=e}})}),Object.values(n).filter(e=>{let{name:t}=e;return new RegExp("^".concat(a,"-a").concat(String(l).padStart(2,"0"),"n\\d{2}\\.").concat(s,"$")).test(t)}).forEach(e=>{let n=Number(e.short.replace(/^.*n(\d+)$/,"$1")),{[n]:r}=i.hosts;r&&(i.hosts[n]={...i.hosts[n],[eD]:e.ipmi.ip},o.forEach(r=>{let[s,a]=r,{[eP]:l,[eN]:o}=a,c="".concat(o).concat(l),{[c]:d}=e.netconf.networks;if(!d)return;let{ip:u,subnetMask:h}=d,m={...i.netconf.networks[s]},p="netconf.networks.".concat(s);if(!(null==t?void 0:t("".concat(p,".").concat(eO)))){let e;try{e=new ez.Netmask("".concat(u,"/").concat(h))}catch(e){return}m[eO]=e.base}(null==t?void 0:t("".concat(p,".").concat(eU)))||(m[eU]=h),c!==e.netconf.gatewayInterface||(null==t?void 0:t("".concat(p,".").concat(eM)))||(m[eM]=e.netconf.gateway),i.netconf.networks[s]=m;let x={...i.hosts[n].networks[s]},f="hosts.".concat(n,".networks.").concat(s);(null==t?void 0:t("".concat(f,".").concat("ip")))||(x.ip=u),i.hosts[n].networks[s]=x}))}),i},eB=["bcn","ifn","mn","sn"].map(e=>{var t;return{displayValue:null!=(t=eT.A[e])?t:"Unknown network",value:e}}),eW=e=>{let{networkId:t,showGateway:n}=e,s=eA(ev),a=(0,i.useContext)(ew),l=(0,i.useMemo)(()=>{let e="".concat("netconf.networks",".").concat(t);return{[eM]:"".concat(e,".").concat(eM),[eO]:"".concat(e,".").concat(eO),[eP]:"".concat(e,".").concat(eP),[eN]:"".concat(e,".").concat(eN),[eU]:"".concat(e,".").concat(eU)}},[t]);if(!s||!a)return null;let{changeFieldValue:o,formik:c,getFieldChanged:d,handleChange:u,setValuesKai:h}=s.formikUtils,{hosts:m}=a;return(0,r.jsxs)(P.t$,{mv:0,children:[(0,r.jsxs)(P.WJ,{children:[(0,r.jsxs)(Y.A,{container:!0,spacing:"0.1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:{xs:"100%",sm:"calc(100% - ".concat("4em",")")},children:(0,r.jsx)(b.A,{id:l[eN],name:l[eN],onChange:e=>{let{value:n}=e.target;h({event:e,values:e=>{let r={...e};return r.netconf.networks[t]={...r.netconf.networks[t],[eN]:n},e_({getFieldChanged:d,hosts:m,values:r})}}),o(l[eN],n,!0)},required:!0,selectItems:eB,selectProps:{renderValue:e=>"".concat(eT.A[e])},value:c.values.netconf.networks[t][eN]})}),(0,r.jsx)(Y.A,{size:"grow",width:{xs:"100%",sm:"4em"},children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eP],label:"#",name:l[eP],onChange:e=>{let{value:n}=e.target;h({debounce:!0,event:e,values:e=>{let r={...e};return r.netconf.networks[t]={...r.netconf.networks[t],[eP]:Number(n)},e_({getFieldChanged:d,hosts:m,values:r})}})},required:!0,value:c.values.netconf.networks[t][eP]})})})]}),(0,r.jsx)(ex.A,{mapPreset:"delete",onClick:()=>{c.setValues(((e,t)=>{let n={...e},{[t]:r,...s}=n.netconf.networks;return n.netconf.networks=s,Object.keys(n.hosts).forEach(e=>{let{[e]:r}=n.hosts,{[t]:s,...a}=r.networks;r.networks=a}),n})(c.values,t),!0)},sx:{padding:".2em",position:"absolute",right:"-.5em",top:"-.2em"}})]}),(0,r.jsx)(P.BF,{children:(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eO],label:"IP address",name:l[eO],onChange:u,required:!0,value:c.values.netconf.networks[t][eO]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eU],label:"Subnet mask",name:l[eU],onChange:u,required:!0,value:c.values.netconf.networks[t][eU]})})}),n&&(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:l[eM],label:"Gateway",name:l[eM],onChange:u,value:c.values.netconf.networks[t][eM]})})})]})})]})};var eY=n(91423);let eZ=e=>{let{slotProps:t}=e,n=eA(ev),s=(0,i.useMemo)(()=>{let e="netconf";return{[eS]:"".concat(e,".").concat(eS),[eI]:"".concat(e,".").concat(eI),netconf:e,networks:"".concat(e,".networks")}},[]);if(!n)return null;let{formik:a,handleChange:l}=n.formikUtils,o=Object.entries(a.values.netconf.networks);return(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",...null==t?void 0:t.container,children:[o.map(e=>{let[t,n]=e;return(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eW,{networkId:t,showGateway:"ifn"===n[eN]})},"netconf-network-".concat(t))}),(0,r.jsx)(Y.A,{display:"flex",justifyContent:"center",width:"100%",children:(0,r.jsx)(ex.A,{mapPreset:"add",onClick:()=>{a.setValues((e=>{let t,n=Object.values(e.netconf.networks);if(n.some(e=>"mn"===e[eN])){let e=n.reduce((e,t)=>{let{[eP]:n=0,[eN]:r}=t;return"ifn"===r?Math.max(e,n):e},0);t={[eM]:"",[eO]:"",[eP]:e+1,[eN]:"ifn",[eU]:""}}else t={[eM]:"",[eO]:"10.199.0.0",[eP]:1,[eN]:"mn",[eU]:"255.255.0.0"};let r={ip:""},s=(0,eY.A)(),a={...e};return a.netconf.networks={...a.netconf.networks,[s]:t},Object.keys(a.hosts).forEach(e=>{let{[e]:t}=a.hosts;t.networks={...t.networks,[s]:r}}),a})(a.values),!0)}})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:s[eS],label:"DNS",name:s[eS],onChange:l,value:a.values.netconf[eS]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:s[eI],label:"NTP",name:s[eI],onChange:l,value:a.values.netconf[eI]})})})]})},eL=e=>{let{slotProps:t}=e,n=eA(ev),s=(0,i.useContext)(ew);if(!n||!s)return null;let{formik:a,getFieldChanged:l,setValuesKai:o}=n.formikUtils,{hosts:c}=s;return(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",...null==t?void 0:t.container,children:[(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:ey,label:"Prefix",name:ey,onChange:e=>{let{value:t}=e.target;o({debounce:!0,event:e,values:e=>{let n={...e};return n[ey]=t,e_({getFieldChanged:l,hosts:c,values:n})}})},required:!0,value:a.values[ey]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:ek,label:"Domain name",name:ek,onChange:e=>{let{value:t}=e.target;o({debounce:!0,event:e,values:e=>{let n={...e};return n[ek]=t,e_({getFieldChanged:l,hosts:c,values:n})}})},required:!0,value:a.values[ek]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:eC,label:"Sequence",name:eC,onChange:e=>{let{value:t}=e.target;o({debounce:!0,event:e,values:e=>{let n={...e};return n[eC]=Number(t),e_({getFieldChanged:l,hosts:c,values:n})}})},required:!0,value:a.values[eC]})})})]})},e$=e=>{let{slotProps:t}=e;return eA(ev)?(0,r.jsxs)(Y.A,{container:!0,spacing:"1em",width:"100%",...null==t?void 0:t.container,children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eL,{})}),(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eZ,{})}),(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(eR,{})})]}):(0,r.jsx)(eb.A,{children:"Missing form context."})};var eX=n(72649),eG=n.n(eX),eK=n(60189),eJ=n(27743);let eQ=U.Ik({name:U.Yj().required(),uuid:(0,eJ.ZC)().required()}),e0=U.Ik({anvil:U.RZ(e=>void 0!==e?eQ:U.gl().optional()),number:U.ai(),type:U.Yj(),uuid:(0,eJ.ZC)().required()}),e1=U.Yj().when(["rerun"],(e,t)=>e[0]?t.optional():t.required()),e2=U.Ik({confirmPassword:e1.oneOf([U.KR("password")]),description:e1,hosts:U.RZ(e=>U.Ik((0,D.A)(e,e0))),password:e1,rerun:U.zM().required(),reuseHosts:U.zM().when(["hosts"],(e,t)=>{let n=e[0];return n&&Object.values(n).some(e=>!!e.anvil)?t.isTrue():t.isFalse()})}),e3=e=>{let{detail:t,knownFences:n,knownHosts:s,knownUpses:a,onSubmitSuccess:l,tools:o}=e,{anvil:c,domain:u,hostConfig:h,networkConfig:m}=t,{hosts:p}=h,{dnsCsv:x,networks:g,ntpCsv:v}=m,k=(0,i.useMemo)(()=>Object.entries(p),[p]),S=(0,i.useMemo)(()=>Object.entries(g),[g]),M=(0,i.useMemo)(()=>Object.entries(n),[n]),P=(0,i.useMemo)(()=>Object.entries(s),[s]),U=(0,i.useMemo)(()=>Object.entries(a),[a]),q=(0,i.useMemo)(()=>P.map(e=>{let[,{anvil:t,name:n,uuid:s}]=e;return{displayValue:(0,r.jsxs)(eu.A,{spacing:0,children:[(0,r.jsx)(y.a3,{inverted:!0,children:n}),(0,r.jsx)(y.xF,{inverted:!0,children:t?"Used by ".concat(t.name):"Ready"})]}),value:s}}),[P]),{disabledSubmit:D,formik:F,formikErrors:R,handleChange:T}=(0,E.A)({initialValues:{confirmPassword:"",description:"",hosts:k.reduce((e,t)=>{let n,[r,{hostName:a,hostNumber:l,hostType:i}]=t,o="";if(c){let{hosts:{[l]:{uuid:e}}}=c;o=e;let t=s[e];t&&(n=t.anvil)}else if(a){let e=P.find(e=>{let[,{short:t}]=e;return t===a});if(e){let[,t]=e;n=t.anvil,o=t.uuid}}return e[r]={anvil:n,number:l,type:i,uuid:o},e},{}),password:"",rerun:!!c,reuseHosts:!1},onSubmit:(e,n)=>{let{setSubmitting:a}=n,{confirmPassword:i,rerun:c,reuseHosts:d,hosts:h,...m}=e,x={...c?null:m,hosts:Object.values(h).reduce((e,t)=>{let{number:n,type:r,uuid:a}=t,l="".concat(r).concat(n);return e["".concat(r.replace("node","Subnode")," ").concat(n)]={useHost:s[a].name,renameTo:"".concat(p[l].hostName,".").concat(u)},e},{})};o.confirm.prepare({actionProceedText:"Run",content:(0,r.jsx)(I.A,{entries:x,hasPassword:!0}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{o.confirm.loading(!0),j.A.put("/command/run-manifest/".concat(t.uuid),e).then(()=>{o.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started installing ",t.name]})}),null==l||l.call(null),o.edit.open(!1)}).catch(e=>{let t=(0,O.A)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to run install manifest. ",t.children]}),o.confirm.finish("Error",t),a(!1)})},titleText:"Run install manifest ".concat(t.name," with the following?")}),o.confirm.open()},validationSchema:e2}),z=(0,i.useMemo)(()=>"confirmPassword",[]),H=(0,i.useMemo)(()=>"description",[]),V=(0,i.useMemo)(()=>"hosts",[]),_=(0,i.useMemo)(()=>"password",[]),B=(0,i.useMemo)(()=>"reuseHosts",[]),W=(0,i.useMemo)(()=>k.reduce((e,t)=>{let[n,{hostNumber:a,hostType:l}]=t,i="".concat(V,".").concat(n),o="".concat(i,".uuid"),c="".concat(l.replace("node","Subnode")," ").concat(a);return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(b.A,{id:o,label:c,name:o,onChange:e=>{let{target:{value:t}}=e,{[t]:{anvil:r}}=s,i=eG()(F.values.hosts),o=Object.entries(i).find(e=>{let[r,{uuid:s}]=e;return r!==n&&s===t});if(o){let[e,t]=o,{number:r,type:s}=t;i[e]={...i[n],number:r,type:s}}return i[n]={anvil:r,number:a,type:l,uuid:t},F.setFieldValue(V,i)},required:!0,selectItems:q,selectProps:{renderValue:e=>{let{[e]:{name:t}}=s;return t}},value:F.values.hosts[n].uuid})},"".concat(n,"-selector"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Use host"})},"host-selector-header")]),[F,k,q,V,s]),Y=(0,i.useMemo)(()=>k.reduce((e,t)=>{let[n,{hostName:s}]=t;return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.NA,{noWrap:!0,children:[s,".",u]})},"".concat(n,"-rename"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"New hostname"})},"host-rename-header")]),[k,u]),Z=(0,i.useMemo)(()=>S.reduce((e,t)=>{let[n,s]=t,{networkNumber:a,networkType:l}=s,i="".concat(l.toLocaleUpperCase()).concat(a),o=k.map(e=>{let[t,{networks:s}]=e,a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(n,"-").concat(t,"-ip"))};if(!s)return a();let{[n]:l}=s;if(!l)return a();let{networkIp:i}=l;return a(i)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:i})},"".concat(n,"-header")),...o),e},[]),[k,S]),L=(0,i.useMemo)(()=>M.reduce((e,t)=>{let[n,s]=t,{fenceName:a}=s,l=k.map(e=>{let[t,{fences:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(n,"-").concat(t,"-port"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{fencePort:o}=i;return l(o)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.a3,{children:["Plug on ",a]})},"".concat(n,"-header")),...l),e},[]),[k,M]),$=(0,i.useMemo)(()=>U.reduce((e,t)=>{let[n,s]=t,{upsName:a}=s,l=k.map(e=>{let[t,{upses:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:e})},"".concat(n,"-").concat(t,"-used"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{isUsed:o}=i;return l(o?"yes":"no")});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(y.a3,{children:["Uses ",a]})},"".concat(n,"-header")),...l),e},[]),[k,U]),X=(0,i.useMemo)(()=>{let e,t=S.find(e=>{let{1:{networkGateway:t}}=e;return!!t}),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"gateway-value")};if(t){let[,{networkGateway:r}]=t;e=r&&r.length>0?n(r):n()}else e=n();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Gateway"})},"gateway-header"),e]},[S]),G=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"dns-value")},t=x&&x.length>0?e(x):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"DNS"})},"dns-header"),t]},[x]),K=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{justifyContent:"end",children:e})},"ntp-value")},t=v&&v.length>0?e(v):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"NTP"})},"ntp-header"),t]},[v]),J=(0,i.useMemo)(()=>{let e=Object.values(F.values.hosts).filter(e=>!!e.anvil);if(0===e.length)return null;let t=e.slice(1).reduce((e,t)=>"".concat(e,", ").concat(s[t.uuid].short),s[e[0].uuid].short);return(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(eb.A,{children:[(0,r.jsx)(eK.A,{id:B,invert:!0,name:B,onChange:F.handleChange,required:!0,sx:{marginRight:".5em"},thinPadding:!0,value:F.values.reuseHosts}),"Confirm reusing host(s): ",t,"."]})})},[F,s,B]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),F.submitForm()},spacing:"1em",children:[c?(0,r.jsxs)(d.Ay,{item:!0,width:"100%",children:[(0,r.jsx)(y.a3,{children:"Description"}),(0,r.jsx)(y.a3,{children:c.description})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:H,label:"Description",name:H,onChange:T,required:!0,value:F.values.description})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:_,label:"Password",name:_,onChange:T,required:!0,type:A.A.password,value:F.values.password})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{disableAutofill:!0,id:z,label:"Confirm password",name:z,onChange:T,required:!0,type:A.A.password,value:F.values.confirmPassword})})})]}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{alignItems:"center",columns:k.length+1,columnSpacing:"1em",container:!0,rowSpacing:".6em",children:[...W,...Y,...Z,...L,...$]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{columns:2,container:!0,spacing:".6em",children:[...X,...G,...K]})}),J,(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(N.A,{count:1,messages:R})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Run",disabled:D,type:"submit"}]})})]})},e5=e=>{let{hostConfig:{hosts:t}}=e,n=Object.values(t).reduce((e,t)=>{let{fences:n,hostType:r,hostNumber:s}=t,a="".concat(r.replace(/node/,"subnode")).concat(s);return n?e[a]=Object.values(n).reduce((e,t)=>{let{fencePort:n}=t;return e+ +!!n.length},0):e[a]=0,e},{}),r=Object.entries(n).map(e=>{let[t,n]=e;return n?null:(0,i.createElement)(eb.A,{key:"".concat(t,"-no-fence-port-message")},"No fence device port specified for ".concat(t,"."))});return{counts:n,messages:r}},e4=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,n)=>{var r,s;let{fenceName:a,fenceUUID:l}=n;return e[l]={[eq]:null!=(s=null==(r=t[a])?void 0:r.fencePort)?s:""},e},n)},e8=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e.find(e=>{let[,t]=e,{[eN]:n}=t;return"bcn"===n});if(!s)return"";let[a]=s;return eH(null==(n=t[a])?void 0:n.ip,r)},e6=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return n.reduce((n,s)=>{let[a,l]=s;return n[a]={ip:eV(e,t,l,r)},n},s)},e7=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,n)=>{var r,s;let{upsName:a,upsUUID:l}=n;return e[l]={[eF]:null!=(s=null==(r=t[a])?void 0:r.isUsed)&&s},e},n)},e9=(e,t,n)=>{let r={[ek]:"",[ey]:"",[eC]:1,netconf:{[eS]:"",[eI]:"",networks:{}},hosts:{}},s=Object.values(e.fences),a=Object.values(e.upses);if(n){r[ek]=n.domain,r[ey]=n.prefix,r[eC]=n.sequence;let{hostConfig:e,networkConfig:t}=n;r.netconf[eS]=t.dnsCsv,r.netconf[eI]=t.ntpCsv,Object.values(t.networks).forEach(e=>{let{networkGateway:t,networkMinIp:n,networkNumber:s,networkSubnetMask:a,networkType:l}=e,i=(0,eY.A)();r.netconf.networks[i]={[eM]:t,[eO]:n,[eP]:s,[eN]:l,[eU]:a}}),Object.values(e.hosts).forEach(e=>{let{hostNumber:t,ipmiIp:l=""}=e,i=Object.entries(r.netconf.networks);r.hosts[t]={[eD]:l,fences:e4(s,e.fences),networks:e6(n.sequence,t,i,e.networks),upses:e7(a,e.upses)},r.hosts[t][eD]=e8(i,r.hosts[t].networks,l)})}else r[ek]=e.domain,r[ey]=e.prefix,r[eC]=e.sequence,r.netconf.networks={defaultbcn:{[eM]:"",[eO]:"10.201.0.0",[eP]:1,[eN]:"bcn",[eU]:"255.255.0.0"},defaultifn:{[eM]:"",[eO]:"",[eP]:1,[eN]:"ifn",[eU]:""},defaultmn:{[eM]:"",[eO]:"10.199.0.0",[eP]:1,[eN]:"mn",[eU]:"255.255.0.0"},defaultsn:{[eM]:"",[eO]:"10.101.0.0",[eP]:1,[eN]:"sn",[eU]:"255.255.0.0"}},r.netconf[eS]="8.8.8.8,8.8.4.4",[1,2].forEach(t=>{let n=Object.entries(r.netconf.networks);r.hosts[t]={[eD]:"",fences:e4(s),networks:e6(e.sequence,t,n),upses:e7(a)},r.hosts[t][eD]=e8(n,r.hosts[t].networks)}),r=e_({hosts:t,values:r});return r},te=(e,t)=>{let{[ek]:n,[ey]:r,[eC]:s,netconf:a}=t,{[eS]:l="",[eI]:i="",networks:o}=a;return{domain:n,hostConfig:{hosts:((e,t)=>Object.entries(t.hosts).reduce((n,r)=>{let s,a,l,[i,o]=r,{[eD]:c,fences:d,networks:u,upses:h}=o,m="node";return n["".concat(m).concat(i)]={fences:(s=e.fences,Object.entries(d).reduce((e,t)=>{let[n,r]=t,{[eq]:a=""}=r,{[n]:l}=s;return e[n]={fenceName:l.fenceName,fencePort:a},e},{})),hostNumber:Number(i),hostType:m,ipmiIp:c,networks:(a=t.netconf.networks,Object.entries(u).reduce((e,t)=>{let[n,r]=t,{ip:s}=r,{[n]:l}=a,{[eP]:i=0,[eN]:o=""}=l;return e["".concat(o).concat(i)]={networkIp:s,networkNumber:i,networkType:o},e},{})),upses:(l=e.upses,Object.entries(h).reduce((e,t)=>{let[n,r]=t,{[eF]:s=!1}=r,{[n]:a}=l;return e[n]={isUsed:s,upsName:a.upsName},e},{}))},n},{}))(e,t)},networkConfig:{dnsCsv:l,networks:Object.values(o).reduce((e,t)=>{let{[eM]:n,[eO]:r="",[eP]:s=0,[eN]:a="",[eU]:l=""}=t;return e["".concat(a).concat(s)]={networkGateway:n,networkMinIp:r,networkNumber:s,networkSubnetMask:l,networkType:a},e},{}),ntpCsv:i},prefix:r,sequence:s}};var tt=n(90065),tn=n(25351),tr=n(27532);let ts=e=>({exclusive:!0,message:"${path} already exists",name:"duplicate-name",test:(t,n)=>{let{createError:r,parent:s}=n,{[ey]:a,[eC]:l}=s,i=String(l).padStart(2,"0"),o="".concat(a,"-anvil-").concat(i);return!e.includes(o)||r({message:"".concat(o," already exists")})}}),ta=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n&&(t=e=>e.manifestName!==n);let r=(0,eJ.fD)(e,e=>e.manifestName,{filterBy:t});return U.Ik({[ek]:U.Yj().required(),[ey]:U.Yj().min(1).max(5).required().test(ts(r)),[eC]:U.ai().min(1).required().test(ts(r)),netconf:U.Ik({[eS]:U.Yj(),[eI]:U.Yj(),networks:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eM]:(0,eJ.W5)(),[eO]:(0,eJ.W5)(),[eN]:U.Yj().oneOf(["bcn","ifn","mn","sn"]),[eP]:U.ai().min(1),[eU]:(0,eJ.W5)()}))))}),hosts:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eD]:(0,eJ.W5)(),fences:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eq]:U.Yj()})))),networks:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({ip:(0,eJ.W5)().required()})))),upses:U.RZ(e=>U.Ik((0,D.A)(e,U.Ik({[eF]:U.zM()}))))}))))})},tl=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),n=(0,i.useRef)(null),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(),{data:c,loading:d,mutate:u}=(0,H.A)("/manifest",{refreshInterval:6e4}),{data:h,loading:m,mutate:p}=(0,H.A)("/manifest/template"),{data:x,loading:f,mutate:j}=(0,H.A)("/host?detail=1&type=subnode"),{fetch:g,loading:v}=(0,tt.A)({onData:e=>o(e),url:"/manifest"}),A=(0,tr.A)([]),{buildDeleteDialogProps:w,checks:b,getCheck:k,hasChecks:C,resetChecks:S,setCheck:I}=(0,tn.A)({list:c}),M=(0,el.A)({initial:{scrollContent:!0,wide:!0}}),{confirmDialog:O,finishConfirm:N,setConfirmDialogLoading:U,setConfirmDialogOpen:q,setConfirmDialogProps:D}=M,F=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:N,loading:U,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return q(e)},prepare:D},edit:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==n||null==(e=n.current)?void 0:e.setOpen(t)}}}),[N,U,q,D]),E=d||m||f,R=E||v,T=(0,i.useMemo)(()=>h&&x&&l&&(0,r.jsx)(e3,{detail:l,knownFences:h.fences,knownHosts:x,knownUpses:h.upses,tools:F}),[F,x,l,h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage manifests"})}),(0,r.jsx)(ef.A,{allowEdit:!0,allowItemButton:s,disableDelete:!C,edit:s,header:!0,listEmpty:"No manifest(s) registered.",listItems:c,loading:E,onAdd:()=>{var t;p(),j(),null==(t=e.current)||t.setOpen(!0)},onDelete:()=>{M.setConfirmDialogProps(w({getConfirmDialogTitle:e=>"Delete ".concat(e," manifest(s)?"),onProceedAppend:()=>{A.submitForm({body:{uuids:b},getErrorMsg:e=>(M.finishConfirm("Error",{children:"Delete manifest(s) failed. ".concat(e)}),null),method:"delete",onSuccess:()=>{S(),u(),M.setConfirmDialogOpen(!1)},url:"/manifest"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(y.a3,{children:null==c?void 0:c[t].manifestName})}})),M.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,t,n)=>{I(e,n)},onItemClick:e=>{var n;let{manifestUUID:r}=e;p(),j(),null==(n=t.current)||n.setOpen(!0),g("/".concat(r))},renderListItemCheckboxState:e=>k(e),renderListItem:(e,t)=>{let{manifestName:a}=t;return(0,r.jsxs)(eu.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(ex.A,{disabled:s,mapPreset:"play",onClick:()=>{var t;p(),j(),null==(t=n.current)||t.setOpen(!0),g("/".concat(e))},variant:"normal"}),(0,r.jsx)(y.a3,{children:a})]})}})]}),(0,r.jsx)(ed.K_,{header:"Add an install manifest",loading:E,ref:e,showClose:!0,wide:!0,children:c&&h&&x&&(0,r.jsx)(eg,{config:{initialValues:e9(h,x),onSubmit:(t,n)=>{let s=te(h,t);(0,ep.A)({confirm:M,getRequestBody:(e,t)=>t,getSummary:()=>s,header:"Add install manifest with the following?",helpers:n,onError:()=>"Failed to add install manifest.",onSuccess:()=>{var t;return u(),null==(t=e.current)||t.setOpen(!1),"Successfully added install manifest"},operation:"add",slotProps:{confirm:{preActionArea:(0,r.jsx)(eu.A,{spacing:".3em",children:e5(s).messages})},summary:{maxDepth:6}},url:"/manifest",values:t})},validationSchema:ta(c)},operation:"add",children:(0,r.jsx)(ew,{value:{hosts:x,template:h},children:(0,r.jsx)(em,{children:(0,r.jsx)(e$,{})})})})}),(0,r.jsx)(ed.K_,{header:"Update install manifest ".concat(null==l?void 0:l.name),loading:R,ref:t,showClose:!0,wide:!0,children:c&&h&&x&&l&&(0,r.jsx)(eg,{config:{initialValues:e9(h,x,l),onSubmit:(e,n)=>{let s=te(h,e);(0,ep.A)({confirm:M,getRequestBody:(e,t)=>t,getSummary:()=>s,header:"Update install manifest ".concat(l.name," with the following?"),helpers:n,onError:()=>"Failed to update install manifest.",onSuccess:()=>{var e;return u(),null==(e=t.current)||e.setOpen(!1),"Successfully updated install manifest ".concat(l.name)},operation:"edit",slotProps:{confirm:{preActionArea:(0,r.jsx)(eu.A,{spacing:".3em",children:e5(s).messages})},summary:{maxDepth:6}},url:"/manifest/".concat(l.uuid),values:e})},validationSchema:ta(c,l.name)},operation:"edit",children:(0,r.jsx)(ew,{value:{hosts:x,template:h},children:(0,r.jsx)(em,{children:(0,r.jsx)(e$,{})})})})}),(0,r.jsx)(ed.K_,{header:"".concat((null==l?void 0:l.anvil)?"Rerun":"Run"," install manifest ").concat(null==l?void 0:l.name),loading:R,ref:n,showClose:!0,wide:!0,children:T}),O]})},{Form:ti,FormContext:to,useFormContext:tc}=(0,ej.A)();var td=n(56014);let tu="common-ups-input-ip-address",th="common-ups-input-host-name",tm="add-ups-select-ups-type-id",tp=(0,eh.Ay)(td.A)({color:L.Uv,display:"inline-flex",textDecorationColor:L.Uv}),tx=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s]=t,{loading:a,upsTemplate:l}=s,o=tc(to),c=(0,i.useMemo)(()=>Object.entries(l).map(e=>{let t,[n,{brand:s,description:a,links:{0:l}}]=e;if(l){let{linkHref:e,linkLabel:n}=l;t=(0,r.jsx)(tp,{href:e,onClick:e=>{e.stopPropagation()},target:"_blank",children:n})}return{displayValue:(0,r.jsxs)(eu.A,{spacing:0,children:[(0,r.jsx)(y.a3,{inverted:!0,children:s}),(0,r.jsxs)(y.a3,{inverted:!0,children:[a," (",t,")"]})]}),value:n}}),[l]);if(!o)return(0,r.jsx)(eb.A,{type:"error",children:"Missing form context."});let{changeFieldValue:d,formik:u,handleChange:h}=o.formikUtils;return a?(0,r.jsx)(ea.A,{}):(0,r.jsxs)(Y.A,{columns:{xs:1,sm:2},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(Y.A,{width:"100%",children:(0,r.jsx)(b.A,{id:tm,label:"UPS type",name:tm,onChange:e=>{let{value:t}=e.target;d(tm,t,!0)},required:!0,selectItems:c,selectProps:{onClearIndicatorClick:()=>{d(tm,"",!0)},renderValue:e=>{let{brand:t}=l[String(e)];return t}},value:u.values[tm]})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:th,label:"Host name",name:th,onChange:h,required:!0,value:u.values[th]})})}),(0,r.jsx)(Y.A,{size:1,children:(0,r.jsx)(C.A,{input:(0,r.jsx)(w.A,{id:tu,label:"IP address",name:tu,onChange:h,required:!0,value:u.values[tu]})})})]})},tf=(e,t)=>{var n,r,s;let a=null!=(n=Object.keys(e).find(n=>{let{[n]:r}=e;return(null==t?void 0:t.upsAgent)===r.agent}))?n:"";return{[tu]:null!=(r=null==t?void 0:t.upsIPAddress)?r:"",[th]:null!=(s=null==t?void 0:t.upsName)?s:"",[tm]:a}},tj=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(t);return U.Ik({[tu]:(0,eJ.W5)().required(),[th]:((e,t)=>{let n;e&&(n=t=>t.upsUUID!==e);let r=(0,eJ.fD)(t,e=>e.upsName,{filterBy:n});return U.Yj().notOneOf(r,"${path} already exists")})(n,e).required(),[tm]:U.Yj().required().oneOf(r)})},tg=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),n=(0,el.A)(),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(""),{data:c,loading:d}=(0,H.A)("/ups/template"),{data:u,loading:h,mutate:m}=(0,H.A)("/ups",{refreshInterval:6e4}),p=null==u?void 0:u[l],{buildDeleteDialogProps:x,checks:f,getCheck:j,hasChecks:g,resetChecks:v,setCheck:A}=(0,tn.A)({list:u}),w=(0,tr.A)([]),b=h||d;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(P.Zk,{children:[(0,r.jsx)(P.aO,{children:(0,r.jsx)(y.HM,{children:"Manage UPSes"})}),(0,r.jsx)(ef.A,{allowEdit:!0,allowItemButton:s,disableDelete:!g,edit:s,header:!0,listEmpty:"No Ups(es) registered.",listItems:u,loading:h,onAdd:()=>{var t;null==(t=e.current)||t.setOpen(!0)},onDelete:()=>{n.setConfirmDialogProps(x({getConfirmDialogTitle:e=>"Delete ".concat(e," UPSes?"),onProceedAppend:()=>{w.submitForm({body:{uuids:f},getErrorMsg:e=>(n.finishConfirm("Error",{children:"Failed to delete UPS(es). ".concat(e)}),null),method:"delete",onSuccess:()=>{v(),m(),n.setConfirmDialogOpen(!1)},url:"/ups"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(y.a3,{children:null==u?void 0:u[t].upsName})}})),n.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,t,n)=>{A(e,n)},onItemClick:e=>{var n;o(e.upsUUID),null==(n=t.current)||n.setOpen(!0)},renderListItemCheckboxState:e=>j(e),renderListItem:(e,t)=>{let{upsAgent:n,upsIPAddress:s,upsName:a}=t;return(0,r.jsxs)(eu.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(y.a3,{children:a}),(0,r.jsxs)(y.a3,{children:['agent="',n,'"']}),(0,r.jsxs)(y.a3,{children:['ip="',s,'"']})]})}})]}),(0,r.jsx)(ed.K_,{header:"Add a UPS",loading:b,ref:e,showClose:!0,wide:!0,children:u&&c&&(0,r.jsx)(ti,{config:{initialValues:tf(c),onSubmit:(t,s)=>{let{[tu]:a,[th]:l,[tm]:i}=t,{agent:o,brand:d}=c[i];(0,ep.A)({confirm:n,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:""}),getSummary:()=>({brand:d,name:l,ipAddress:a}),header:(0,r.jsx)(y.HM,{children:"Add a UPS with the following data?"}),helpers:s,onError:()=>"Failed to add UPS.",onSuccess:()=>{var t;return m(),null==(t=e.current)||t.setOpen(!1),"Successfully added UPS ".concat(l)},operation:"add",url:"/ups",values:t})},validationSchema:tj(u,c)},operation:"add",children:(0,r.jsx)(tx,{upsTemplate:c})})}),(0,r.jsx)(ed.K_,{header:p&&(0,r.jsxs)(y.HM,{children:["Update UPS"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:p.upsName})]}),loading:b,ref:t,showClose:!0,wide:!0,children:u&&c&&p&&(0,r.jsx)(ti,{config:{initialValues:tf(c,p),onSubmit:(e,s)=>{let{[tu]:a,[th]:l,[tm]:i}=e,{agent:o,brand:d}=c[i];(0,ep.A)({confirm:n,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:p.upsUUID}),getSummary:()=>({brand:d,name:l,ipAddress:a,uuid:p.upsUUID}),header:(0,r.jsxs)(y.HM,{children:["Update"," ",(0,r.jsx)(y.kp,{fontSize:"inherit",children:l})," ","with the following data?"]}),helpers:s,onError:()=>"Failed to update UPS.",onSuccess:()=>{var e;return m(),null==(e=t.current)||e.setOpen(!1),"Successfully updated UPS ".concat(p.upsName)},operation:"edit",url:"/ups/".concat(p.upsUUID),values:e})},validationSchema:tj(u,c,p.upsUUID)},operation:"edit",children:(0,r.jsx)(tx,{upsTemplate:c})})}),n.confirmDialog]})};var tv=n(4903);let tA="prepare-host",tw="prepare-network",tb="manage-fence",tk="manage-ups",ty="manage-manifest",tC={[tA]:"Prepare Host",[tw]:"Prepare Network",[tb]:"Manage Fence Devices",[tk]:"Manage UPSes",[ty]:"Manage Manifests"},tS="Loading",tI=()=>(0,r.jsx)(tv.A,{children:(0,r.jsx)(B.g,{})}),tM=()=>(0,r.jsx)(tv.A,{children:(0,r.jsx)(ec,{})}),tO=()=>(0,r.jsx)(tv.A,{children:(0,r.jsx)(_,{})}),tN=()=>(0,r.jsx)(tv.A,{children:(0,r.jsx)(tg,{})}),tP=()=>(0,r.jsx)(tv.A,{children:(0,r.jsx)(tl,{})}),tU=()=>{let{isReady:e,push:t,query:n}=(0,l.useRouter)(),[s,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(tS);return(0,i.useEffect)(()=>{if(!e)return;let{step:r}=n,a=(0,o.A)(r,{fallbackValue:tA});tC[a]||(a=tA),t({query:{...n,step:a}},void 0,{shallow:!0}),u===tS&&h(tC[a]),s||d(a)},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:u})}),(0,r.jsx)(c.A,{}),(0,r.jsx)(P.Zk,{children:(0,r.jsxs)(X.A,{onChange:(e,r)=>{d(r),h(tC[r]),t({query:{...n,step:r}},void 0,{shallow:!0})},orientation:{xs:"vertical",sm:"horizontal"},value:s,children:[(0,r.jsx)($.A,{label:"Prepare host",value:tA}),(0,r.jsx)($.A,{label:"Prepare network",value:tw}),(0,r.jsx)($.A,{label:"Manage fence devices",value:tb}),(0,r.jsx)($.A,{label:"Manage UPSes",value:tk}),(0,r.jsx)($.A,{label:"Manage manifests",value:ty})]})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:tA,children:(0,r.jsx)(tI,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:tw,children:(0,r.jsx)(tM,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:tb,children:(0,r.jsx)(tO,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:tk,children:(0,r.jsx)(tN,{})}),(0,r.jsx)(eo.A,{changingTabId:s,tabId:ty,children:(0,r.jsx)(tP,{})})]})}},36150:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(37876),s=n(66998),a=n(14232),l=n(48937);let i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s]=t,{formikUtils:a,operation:i,slotProps:o}=s,c={background:"blue",disabled:a.disabledSubmit,type:"submit",...null==o?void 0:o.submit};switch(i){case"add":c.children="Add";break;case"delete":c.background="red",c.children="Delete";break;default:c.children="Save"}return(0,r.jsx)(l.A,{actions:[c],...null==o?void 0:o.group})},o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[a]=t,{children:l,formikUtils:i,slotProps:o}=a;return(0,r.jsx)(s.A,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),i.formik.handleSubmit(e)},spacing:"1em",width:"100%",...null==o?void 0:o.grid,children:l})};var c=n(67820);let d=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s]=t,{formikUtils:a,slotProps:l}=s;return(0,r.jsx)(c.A,{count:1,messages:a.formikErrors,...null==l?void 0:l.messageGroup})};var u=n(93647);let h=e=>{var t,n;let l=(0,a.createContext)(null!=(n=null==e||null==(t=e.context)?void 0:t.defaultValue)?n:null);return{Form:e=>{let{children:t,config:n,operation:c,slotProps:h}=e,m=(0,u.A)(n),p=(0,a.useMemo)(()=>({formikUtils:m}),[m]);return(0,r.jsxs)(o,{formikUtils:m,...null==h?void 0:h.grid,children:[(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(l,{value:p,children:t})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(d,{formikUtils:m,...null==h?void 0:h.messages})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(i,{formikUtils:m,operation:c,...null==h?void 0:h.actions})})]})},FormContext:l,useFormContext:a.useContext}}},51553:(e,t,n)=>{"use strict";n.d(t,{A:()=>A});var r=n(14232),s=n(69241),a=n(4697),l=n(19770),i=n(98428),o=n(55818),c=n(90046),d=n(35268),u=n(42259),h=n(77573),m=n(87767),p=n(24369),x=n(37876);let f=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.edge&&t["edge".concat((0,i.A)(n.edge))],t["size".concat((0,i.A)(n.size))]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,["& .".concat(m.A.thumb)]:{width:16,height:16},["& .".concat(m.A.switchBase)]:{padding:4,["&.".concat(m.A.checked)]:{transform:"translateX(16px)"}}}}]}),j=(0,d.Ay)(c.A,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.switchBase,{["& .".concat(m.A.input)]:t.input},"default"!==n.color&&t["color".concat((0,i.A)(n.color))]]}})((0,u.A)(e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:"".concat("light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]),transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),["&.".concat(m.A.checked)]:{transform:"translateX(20px)"},["&.".concat(m.A.disabled)]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:"".concat("light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600])},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{opacity:.5},["&.".concat(m.A.disabled," + .").concat(m.A.track)]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:"".concat("light"===t.palette.mode?.12:.2)},["& .".concat(m.A.input)]:{left:"-100%",width:"300%"}}}),(0,u.A)(e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter((0,o.A)(["light"])).map(e=>{let[n]=e;return{props:{color:n},style:{["&.".concat(m.A.checked)]:{color:(t.vars||t).palette[n].main,"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[n].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.X4)(t.palette[n].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(m.A.disabled)]:{color:t.vars?t.vars.palette.Switch["".concat(n,"DisabledColor")]:"".concat("light"===t.palette.mode?(0,l.a)(t.palette[n].main,.62):(0,l.e$)(t.palette[n].main,.55))}},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{backgroundColor:(t.vars||t).palette[n].main}}}})]}})),g=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})((0,u.A)(e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:"".concat("light"===t.palette.mode?t.palette.common.black:t.palette.common.white),opacity:t.vars?t.vars.opacity.switchTrack:"".concat("light"===t.palette.mode?.38:.3)}})),v=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})((0,u.A)(e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),A=r.forwardRef(function(e,t){let n=(0,h.b)({props:e,name:"MuiSwitch"}),{className:r,color:l="primary",edge:o=!1,size:c="medium",sx:d,slots:u={},slotProps:A={},...w}=n,b={...n,color:l,edge:o,size:c},k=(e=>{let{classes:t,edge:n,size:r,color:s,checked:l,disabled:o}=e,c={root:["root",n&&"edge".concat((0,i.A)(n)),"size".concat((0,i.A)(r))],switchBase:["switchBase","color".concat((0,i.A)(s)),l&&"checked",o&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},d=(0,a.A)(c,m.n,t);return{...t,...d}})(b),y={slots:u,slotProps:A},[C,S]=(0,p.A)("root",{className:(0,s.A)(k.root,r),elementType:f,externalForwardedProps:y,ownerState:b,additionalProps:{sx:d}}),[I,M]=(0,p.A)("thumb",{className:k.thumb,elementType:v,externalForwardedProps:y,ownerState:b}),O=(0,x.jsx)(I,{...M}),[N,P]=(0,p.A)("track",{className:k.track,elementType:g,externalForwardedProps:y,ownerState:b});return(0,x.jsxs)(C,{...S,children:[(0,x.jsx)(j,{type:"checkbox",icon:O,checkedIcon:O,ref:t,ownerState:b,...w,classes:{...k,root:k.switchBase},slots:{...u.switchBase&&{root:u.switchBase},...u.input&&{input:u.input}},slotProps:{...A.switchBase&&{root:"function"==typeof A.switchBase?A.switchBase(b):A.switchBase},...A.input&&{input:"function"==typeof A.input?A.input(b):A.input}}}),(0,x.jsx)(N,{...P})]})})},88851:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-element",function(){return n(36134)}])}},e=>{e.O(0,[347,766,845,107,422,632,238,8,926,847,337,508,466,446,960,454,636,593,792],()=>e(e.s=88851)),_N_E=e.O()}]);