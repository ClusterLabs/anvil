(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{16820:(e,n,i)=>{"use strict";i.r(n),i.d(n,{default:()=>T});var r=i(37876),t=i(87986),a=i(14232),s=i(23437),l=i(79982),o=i(64410),c=i(48171),d=i(63190),u=i(23934),m=i(86149),x=i(5806),h=i(89275),p=i(71401),A=i(69267),j=i(59571),y=i(91408);let f=y.Ik({adminPassword:y.Yj().required(),confirmAdminPassword:y.Yj().oneOf([y.KR("adminPassword")]).required(),domainName:y.Yj().required(),hostName:y.Yj().required(),hostNumber:y.ai().required(),organizationName:y.Yj().required(),organizationPrefix:y.Yj().min(1).max(5).required(),networkInit:h.hJ});var g=i(51677);let b=e=>{let{values:n}=e;return(0,r.jsxs)(o.Ay,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.a3,{children:"Organization name"})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.NA,{children:n.organizationName})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.a3,{children:"Organization prefix"})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.NA,{children:n.organizationPrefix})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.a3,{children:"Striker number"})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.NA,{children:n.hostNumber})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.a3,{children:"Domain name"})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.NA,{children:n.domainName})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.a3,{children:"Host name"})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(g.NA,{children:n.hostName})}),(0,r.jsx)(h.Sf,{...e})]})};var v=i(588),w=i(4064),k=i(71986);let N=e=>{let n="",i="",r="",t="",a="",s={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"}},l="",o="",c="";if(e){({domain:n="",organization:o="",prefix:c=""}=e.variables),i=e.name;let{sequence:d}=e.variables;r=d?String(d):"",{dns:t="",gateway:a="",ntp:l=""}=e.netconf;let{networks:u={}}=e.netconf;s=(0,v.A)(u)}return{adminPassword:"",confirmAdminPassword:"",domainName:n,hostName:i,hostNumber:r,networkInit:{dns:t,gateway:a,networks:s,ntp:l},organizationName:o,organizationPrefix:c}},C=(e,n,i)=>[e,n,i].every(e=>e.length>0)?"".concat(e,"-striker").concat((0,j.A)(n),".").concat(i):"",S=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=e.split(/\s+/).filter(e=>!/^(?:and|of)$/.test(e)).slice(0,n),r="";return i.length>1?r=i.map(e=>e.substring(0,1).toLocaleLowerCase()).join(""):1===i.length&&(r=i[0].substring(0,n).toLocaleLowerCase()),r},z=e=>{let{detail:n,onSubmitSuccess:i,tools:t}=e,s=(0,a.useRef)(null),l=(0,k.A)({initialValues:N(n),onSubmit:(e,n)=>{let{setSubmitting:a}=n,l=(0,m.A)(e,s.current);t.confirm.prepare({actionProceedText:"Initialize",content:s.current&&(0,r.jsx)(b,{gatewayIface:l.gatewayInterface,ifaces:s.current,values:e}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{t.confirm.loading(!0),u.A.put("/init",l).then(e=>{null==i||i.call(null,e.data),t.confirm.finish("Success",{children:(0,r.jsx)(r.Fragment,{children:"Successfully registered striker initialization job."})})}).catch(e=>{let n=(0,x.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to register striker initialization job. ",n.children]}),t.confirm.finish("Error",n),a(!1)})},titleText:"Initialize ".concat(e.hostName," with the following?")}),t.confirm.open()},validationSchema:f}),{disabledSubmit:j,formik:y,formikErrors:g,getFieldChanged:v,handleChange:z}=l,P=(0,a.useMemo)(()=>"adminPassword",[]),q=(0,a.useMemo)(()=>"confirmAdminPassword",[]),M=(0,a.useMemo)(()=>"domainName",[]),L=(0,a.useMemo)(()=>"hostName",[]),I=(0,a.useMemo)(()=>"hostNumber",[]),_=(0,a.useMemo)(()=>"organizationName",[]),D=(0,a.useMemo)(()=>"organizationPrefix",[]),Y=(0,a.useCallback)(e=>n=>{if(v(L))return;let{target:{value:i}}=n,{values:{domainName:r,hostNumber:t,organizationPrefix:a}}=y;switch(e){case M:r=i;break;case I:t=i;break;case D:a=i}let s=C(a,t,r);y.setFieldValue(L,s)},[M,y,v,L,I,D]);return(0,r.jsxs)(o.Ay,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),y.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsxs)(o.Ay,{columns:2,container:!0,spacing:"1em",children:[(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{id:_,label:"Organization Name",name:_,onBlur:e=>{if(v(D))return;let{target:{value:n}}=e,i=S(n);y.setFieldValue(D,i)},onChange:z,required:!0,value:y.values.organizationName})})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{baseInputProps:{maxLength:5},id:D,label:"Prefix",name:D,onBlur:Y(D),onChange:z,required:!0,value:y.values.organizationPrefix})})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{id:I,label:"Striker #",name:I,onBlur:Y(I),onChange:z,required:!0,value:y.values.hostNumber})})})]})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsxs)(o.Ay,{columns:1,container:!0,spacing:"1em",children:[(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{id:M,label:"Domain name",name:M,onBlur:Y(M),onChange:z,required:!0,value:y.values.domainName})})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:L,label:"Host name",name:L,onChange:z,required:!0,value:y.values.hostName})})})]})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,sm:2,md:1,children:(0,r.jsxs)(o.Ay,{columns:{xs:1,sm:2,md:1},container:!0,spacing:"1em",children:[(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:P,label:"Admin password",name:P,onChange:z,required:!0,type:c.A.password,value:y.values.adminPassword})})}),(0,r.jsx)(o.Ay,{item:!0,xs:1,children:(0,r.jsx)(w.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:q,label:"Confirm admin password",name:q,onChange:z,required:!0,type:c.A.password,value:y.values.confirmAdminPassword})})})]})}),(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsx)(h.VT,{formikUtils:l,host:{parentSequence:NaN,sequence:Number(y.values.hostNumber),type:"striker",uuid:"local"},onFetchSuccess:e=>{s.current=e}})}),(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsx)(p.A,{count:1,messages:g})}),(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsx)(d.A,{actions:[{background:"blue",children:"Initialize",disabled:j,type:"submit"}]})})]})};var P=i(64632),q=i(19659),M=i(85210),L=i(94923),I=i(59664),_=i(95779),D=i(81302);let Y=e=>{let{children:n}=e;return(0,r.jsx)(s.Zk,{sx:{marginLeft:{xs:"1em",sm:"auto"},marginRight:{xs:"1em",sm:"auto"},marginTop:"calc(50vh - 30vh - 6em)",width:{xs:void 0,sm:"90vw",md:"80vw",lg:"70vw",xl:"60vw"}},children:n})},R=e=>{let{jobUuid:n,reinit:i}=e,t=(0,a.useRef)(null),c=(0,a.useMemo)(()=>{let e="login",n="/login";return i&&(e="striker config",n="/config"),{label:e,path:n}},[i]),d=(0,D.A)({follow:!0}),{data:u}=(0,I.A)("/init/job/".concat(n),{onSuccess:e=>{let{progress:n}=e;null===t.current&&100===n&&(t.current=setTimeout(e=>{window.location.replace(e)},3e3,c.path))},refreshInterval:2e3}),m=(0,_.A)(null==u?void 0:u.status);return u?(0,r.jsx)(Y,{children:(0,r.jsxs)(o.Ay,{columns:1,container:!0,rowGap:".6em",children:[(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(g.a3,{children:["You will be auto redirected to ",c.label," after initialization completes. If not, you can manually access"," ",(0,r.jsx)(q.A,{display:"inline-flex",href:c.path,children:c.label})," ","after completion."]})}),(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsx)(P.z2,{progressPercentage:u.progress})}),(0,r.jsx)(o.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(s.t$,{mb:0,mt:0,children:[(0,r.jsx)(s.WJ,{children:(0,r.jsx)(g.a3,{children:"Status"})}),(0,r.jsx)(s.BF,{children:(0,r.jsx)(L.A,{height:"60vh",lineHeight:"2",ref:d.callbackRef,children:(0,r.jsx)(M.A,{children:m.string})},"status")})]})})]})}):(0,r.jsx)(Y,{children:(0,r.jsx)(l.A,{mt:0})})};var F=i(30764);let O=()=>{let[e,n]=(0,a.useState)(),{confirmDialog:i,finishConfirm:t,setConfirmDialogLoading:o,setConfirmDialogOpen:c,setConfirmDialogProps:d}=(0,F.A)({initial:{scrollContent:!0,wide:!0}}),u=(0,a.useMemo)(()=>({add:{open:()=>null},confirm:{finish:t,loading:o,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return c(e)},prepare:d},edit:{open:()=>null}}),[t,o,c,d]),{data:m,loading:x}=(0,I.A)("/host/local");return x?(0,r.jsx)(s.Zk,{children:(0,r.jsx)(l.A,{})}):e?(0,r.jsx)(R,{jobUuid:e,reinit:!!m}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.Zk,{children:[(0,r.jsx)(s.aO,{children:(0,r.jsxs)(g.HM,{children:[m?"Rei":"I","nitialize striker"]})}),(0,r.jsx)(z,{detail:m,onSubmitSuccess:e=>{n(e.jobUuid)},tools:u})]}),i]})},T=()=>(0,r.jsx)(t.A,{children:(0,r.jsx)(O,{})})},71495:(e,n,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/init",function(){return i(16820)}])},94760:(e,n,i)=>{"use strict";i.d(n,{A:()=>N});var r=i(14232),t=i(69241),a=i(40393),s=i(4697),l=i(97369),o=i(80027),c=i(54773),d=i(30566),u=i(29548),m=i(78457),x=i(52196),h=i(77018),p=i(47951),A=i(45879);function j(e){return(0,A.Ay)("MuiLink",e)}let y=(0,p.A)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var f=i(16829);let g=e=>{let{theme:n,ownerState:i}=e,r=i.color,t=(0,f.Yn)(n,"palette.".concat(r,".main"),!1)||(0,f.Yn)(n,"palette.".concat(r),!1)||i.color,s=(0,f.Yn)(n,"palette.".concat(r,".mainChannel"))||(0,f.Yn)(n,"palette.".concat(r,"Channel"));return"vars"in n&&s?"rgba(".concat(s," / 0.4)"):(0,a.X4)(t,.4)};var b=i(37876);let v={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},w=e=>{let{classes:n,component:i,focusVisible:r,underline:t}=e,a={root:["root","underline".concat((0,o.A)(t)),"button"===i&&"button",r&&"focusVisible"]};return(0,s.A)(a,j,n)},k=(0,c.Ay)(h.A,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:i}=e;return[n.root,n["underline".concat((0,o.A)(i.underline))],"button"===i.component&&n.button]}})((0,u.A)(e=>{let{theme:n}=e;return{variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:e=>{let{underline:n,ownerState:i}=e;return"always"===n&&"inherit"!==i.color},style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(n.palette).filter((0,m.A)()).map(e=>{let[i]=e;return{props:{underline:"always",color:i},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette[i].mainChannel," / 0.4)"):(0,a.X4)(n.palette[i].main,.4)}}}),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette.text.primaryChannel," / 0.4)"):(0,a.X4)(n.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette.text.secondaryChannel," / 0.4)"):(0,a.X4)(n.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(n.vars||n).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(y.focusVisible)]:{outline:"auto"}}}]}})),N=r.forwardRef(function(e,n){let i=(0,x.b)({props:e,name:"MuiLink"}),a=(0,d.A)(),{className:s,color:o="primary",component:c="a",onBlur:u,onFocus:m,TypographyClasses:h,underline:p="always",variant:A="inherit",sx:j,...y}=i,[f,N]=r.useState(!1),C={...i,color:o,component:c,focusVisible:f,underline:p,variant:A},S=w(C);return(0,b.jsx)(k,{color:o,className:(0,t.A)(S.root,s),classes:h,component:c,onBlur:e=>{(0,l.A)(e.target)||N(!1),u&&u(e)},onFocus:e=>{(0,l.A)(e.target)&&N(!0),m&&m(e)},ref:n,ownerState:C,variant:A,...y,sx:[...void 0===v[o]?[{color:o}]:[],...Array.isArray(j)?j:[j]],style:{...y.style,..."always"===p&&"inherit"!==o&&!v[o]&&{"--Link-underlineColor":g({theme:a,ownerState:C})}}})})}},e=>{var n=n=>e(e.s=n);e.O(0,[325,208,925,623,296,901,133,223,437,636,593,792],()=>n(71495)),_N_E=e.O()}]);