(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{9982:(e,n,t)=>{"use strict";t.d(n,{A:()=>v});var r=t(14232),i=t(69241),a=t(19770),s=t(4697),o=t(97369),l=t(98428),c=t(35268),u=t(66703),d=t(42259),m=t(55818),h=t(77573),x=t(92003),p=t(47951),A=t(45879);function j(e){return(0,A.Ay)("MuiLink",e)}let f=(0,p.A)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var g=t(47170),y=t(37876);let b={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},w=(0,c.Ay)(x.A,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.root,n["underline".concat((0,l.A)(t.underline))],"button"===t.component&&n.button]}})((0,d.A)(e=>{let{theme:n}=e;return{variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:e=>{let{underline:n,ownerState:t}=e;return"always"===n&&"inherit"!==t.color},style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(n.palette).filter((0,m.A)()).map(e=>{let[t]=e;return{props:{underline:"always",color:t},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette[t].mainChannel," / 0.4)"):(0,a.X4)(n.palette[t].main,.4)}}}),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette.text.primaryChannel," / 0.4)"):(0,a.X4)(n.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":n.vars?"rgba(".concat(n.vars.palette.text.secondaryChannel," / 0.4)"):(0,a.X4)(n.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(n.vars||n).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(f.focusVisible)]:{outline:"auto"}}}]}})),v=r.forwardRef(function(e,n){let t=(0,h.b)({props:e,name:"MuiLink"}),c=(0,u.A)(),{className:d,color:m="primary",component:x="a",onBlur:p,onFocus:A,TypographyClasses:f,underline:v="always",variant:k="inherit",sx:C,...N}=t,[P,S]=r.useState(!1),z={...t,color:m,component:x,focusVisible:P,underline:v,variant:k},L=(e=>{let{classes:n,component:t,focusVisible:r,underline:i}=e,a={root:["root","underline".concat((0,l.A)(i)),"button"===t&&"button",r&&"focusVisible"]};return(0,s.A)(a,j,n)})(z);return(0,y.jsx)(w,{color:m,className:(0,i.A)(L.root,d),classes:f,component:x,onBlur:e=>{(0,o.A)(e.target)||S(!1),p&&p(e)},onFocus:e=>{(0,o.A)(e.target)&&S(!0),A&&A(e)},ref:n,ownerState:z,variant:k,...N,sx:[...void 0===b[m]?[{color:m}]:[],...Array.isArray(C)?C:[C]],style:{...N.style,..."always"===v&&"inherit"!==m&&!b[m]&&{"--Link-underlineColor":(e=>{let{theme:n,ownerState:t}=e,r=t.color,i=(0,g.Yn)(n,"palette.".concat(r,".main"),!1)||(0,g.Yn)(n,"palette.".concat(r),!1)||t.color,s=(0,g.Yn)(n,"palette.".concat(r,".mainChannel"))||(0,g.Yn)(n,"palette.".concat(r,"Channel"));return"vars"in n&&s?"rgba(".concat(s," / 0.4)"):(0,a.X4)(i,.4)})({theme:c,ownerState:z})}}})})},61931:(e,n,t)=>{"use strict";t.d(n,{A:()=>o});var r=t(37876),i=t(14232),a=t(39294),s=t(40038);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:n="",content:t="",titleText:o="",...l}={}}=e,c=(0,i.useRef)(null),[u,d]=(0,i.useState)({actionProceedText:n,content:t,titleText:o}),m=(0,i.useCallback)(e=>d(n=>{let{loading:t,...r}=n;return{...r,loading:e}}),[]),h=(0,i.useCallback)(e=>{var n,t;return null==c||null==(t=c.current)||null==(n=t.setOpen)?void 0:n.call(null,e)},[]),x=(0,i.useCallback)((e,n)=>d({actionProceedText:"",content:(0,r.jsx)(s.A,{...n}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,i.useMemo)(()=>(0,r.jsx)(a.A,{...l,...u,ref:c}),[u,l]),confirmDialogRef:c,setConfirmDialogLoading:m,setConfirmDialogOpen:h,setConfirmDialogProps:d,finishConfirm:x}}},71495:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/init",function(){return t(73497)}])},73497:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>F});var r=t(37876),i=t(4903),a=t(14232),s=t(35755),o=t(11457),l=t(41316),c=t(11910),u=t(48937),d=t(28850),m=t(68872),h=t(74235),x=t(99308),p=t(67820),A=t(69146),j=t(95968),f=t(91408);let g=f.Ik({adminPassword:f.Yj().required(),confirmAdminPassword:f.Yj().oneOf([f.KR("adminPassword")]).required(),domainName:f.Yj().required(),hostName:f.Yj().required(),hostNumber:f.ai().required(),organizationName:f.Yj().required(),organizationPrefix:f.Yj().min(1).max(5).required(),networkInit:x.hJ});var y=t(20795);let b=e=>{let{values:n}=e;return(0,r.jsxs)(l.Ay,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Organization name"})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.organizationName})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Organization prefix"})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.organizationPrefix})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Striker number"})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.hostNumber})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Domain name"})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.domainName})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.a3,{children:"Host name"})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.NA,{children:n.hostName})}),(0,r.jsx)(x.Sf,{...e})]})};var w=t(6759),v=t(88259),k=t(93647);let C=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,t=e.split(/\s+/).filter(e=>!/^(?:and|of)$/.test(e)).slice(0,n),r="";return t.length>1?r=t.map(e=>e.substring(0,1).toLocaleLowerCase()).join(""):1===t.length&&(r=t[0].substring(0,n).toLocaleLowerCase()),r},N=e=>{let{detail:n,ipRef:t,onSubmitSuccess:i,tools:s}=e,o=(0,a.useRef)(null),f=(0,k.A)({initialValues:(e=>{let n="",t="",r="",i="",a="",s={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"}},o="",l="",c="";if(e){({domain:n="",organization:l="",prefix:c=""}=e.variables),t=e.name;let{sequence:u}=e.variables;r=u?String(u):"",{dns:i="",gateway:a="",ntp:o=""}=e.netconf;let{networks:d={}}=e.netconf;s=(0,w.A)(d)}return{adminPassword:"",confirmAdminPassword:"",domainName:n,hostName:t,hostNumber:r,networkInit:{dns:i,gateway:a,networks:s,ntp:o},organizationName:l,organizationPrefix:c}})(n),onSubmit:(e,n)=>{let{setSubmitting:a}=n,l=(0,m.A)(e,o.current);t&&l.networks.forEach(e=>{let{ipAddress:n,sequence:r,type:i}=e;"".concat(i).concat(r)===l.gatewayInterface&&(t.current=n)}),s.confirm.prepare({actionProceedText:"Initialize",content:o.current&&(0,r.jsx)(b,{gatewayIface:l.gatewayInterface,ifaces:o.current,values:e}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{s.confirm.loading(!0),d.A.put("/init",l).then(e=>{null==i||i.call(null,e.data),s.confirm.finish("Success",{children:(0,r.jsx)(r.Fragment,{children:"Successfully registered striker initialization job."})})}).catch(e=>{let n=(0,h.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to register striker initialization job. ",n.children]}),s.confirm.finish("Error",n),a(!1)})},titleText:"Initialize ".concat(e.hostName," with the following?")}),s.confirm.open()},validationSchema:g}),{disabledSubmit:y,formik:N,formikErrors:P,getFieldChanged:S,handleChange:z}=f,L=(0,a.useMemo)(()=>"adminPassword",[]),q=(0,a.useMemo)(()=>"confirmAdminPassword",[]),M=(0,a.useMemo)(()=>"domainName",[]),R=(0,a.useMemo)(()=>"hostName",[]),D=(0,a.useMemo)(()=>"hostNumber",[]),I=(0,a.useMemo)(()=>"organizationName",[]),T=(0,a.useMemo)(()=>"organizationPrefix",[]),Y=(0,a.useCallback)(e=>n=>{if(S(R))return;let{target:{value:t}}=n,{values:{domainName:r,hostNumber:i,organizationPrefix:a}}=N;switch(e){case M:r=t;break;case D:i=t;break;case T:a=t}let s=((e,n,t)=>[e,n,t].every(e=>e.length>0)?"".concat(e,"-striker").concat((0,j.A)(n),".").concat(t):"")(a,i,r);N.setFieldValue(R,s)},[M,N,S,R,D,T]);return(0,r.jsxs)(l.Ay,{columns:{xs:1,sm:2,md:3},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),N.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsxs)(l.Ay,{columns:2,container:!0,spacing:"1em",children:[(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{id:I,label:"Organization Name",name:I,onBlur:e=>{if(S(T))return;let{target:{value:n}}=e,t=C(n);N.setFieldValue(T,t)},onChange:z,required:!0,value:N.values.organizationName})})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{baseInputProps:{maxLength:5},id:T,label:"Prefix",name:T,onBlur:Y(T),onChange:z,required:!0,value:N.values.organizationPrefix})})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{id:D,label:"Striker #",name:D,onBlur:Y(D),onChange:z,required:!0,value:N.values.hostNumber})})})]})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsxs)(l.Ay,{columns:1,container:!0,spacing:"1em",children:[(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{id:M,label:"Domain name",name:M,onBlur:Y(M),onChange:z,required:!0,value:N.values.domainName})})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:R,label:"Host name",name:R,onChange:z,required:!0,value:N.values.hostName})})})]})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,sm:2,md:1,children:(0,r.jsxs)(l.Ay,{columns:{xs:1,sm:2,md:1},container:!0,spacing:"1em",children:[(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:L,label:"Admin password",name:L,onChange:z,required:!0,type:c.A.password,value:N.values.adminPassword})})}),(0,r.jsx)(l.Ay,{item:!0,xs:1,children:(0,r.jsx)(v.A,{input:(0,r.jsx)(A.A,{disableAutofill:!0,id:q,label:"Confirm admin password",name:q,onChange:z,required:!0,type:c.A.password,value:N.values.confirmAdminPassword})})})]})}),(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsx)(x.VT,{formikUtils:f,host:{parentSequence:NaN,sequence:Number(N.values.hostNumber),type:"striker",uuid:"local"},onFetchSuccess:e=>{o.current=e}})}),(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsx)(p.A,{count:1,messages:P})}),(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsx)(u.A,{actions:[{background:"blue",children:"Initialize",disabled:y,type:"submit"}]})})]})};var P=t(89099),S=t(98496),z=t(34318),L=t(56014),q=t(7525),M=t(79692),R=t(61931),D=t(30827),I=t(13886),T=t(20525);let Y=e=>{let{children:n}=e;return(0,r.jsx)(s.Zk,{sx:{marginLeft:{xs:"1em",sm:"auto"},marginRight:{xs:"1em",sm:"auto"},marginTop:"calc(50vh - 30vh - 6em)",width:{xs:void 0,sm:"90vw",md:"80vw",lg:"70vw",xl:"60vw"}},children:n})},_=e=>{let{ipRef:n,jobUuid:t,reinit:i}=e,c=(0,P.useRouter)(),u=(0,a.useRef)(0),d=(0,a.useRef)(null),m=(0,R.A)(),h=(0,a.useMemo)(()=>{let e="login",t="/login";return i&&(e="striker config",t="/config"),(null==n?void 0:n.current)&&(e+=" (at ".concat(n.current,")")),{label:e,path:t}},[n,i]),x=(0,T.A)({follow:!0}),{data:p}=(0,D.A)("/init/job/".concat(t),{onError:()=>{u.current+=1,(null==n?void 0:n.current)&&u.current>2&&(m.setConfirmDialogProps({actionProceedText:"Try to redirect",actionCancelText:"Change URL manually",content:(0,r.jsxs)(z.A,{children:[(0,r.jsx)(y.a3,{children:"Lost connection to the striker, which will happen if you changed its IFN IP address."}),(0,r.jsx)(y.a3,{children:"You can try the auto-redirect option, which will fail if you're taking additional steps in connecting, i.e., port fowarding. Otherwise, please manually change the URL in your browser accordingly."})]}),onProceedAppend:()=>{m.setConfirmDialogLoading(!0),c.replace("http://".concat(n.current).concat(h.path))},titleText:"Lost connection, try redirecting to ".concat(h.label,"?")}),m.setConfirmDialogOpen(!0))},onSuccess:e=>{u.current=0;let{progress:n}=e;null===d.current&&100===n&&(d.current=setTimeout(e=>{c.replace(e)},3e3,h.path))},refreshInterval:2e3}),A=(0,I.A)(null==p?void 0:p.status);return p?(0,r.jsxs)(Y,{children:[(0,r.jsxs)(l.Ay,{columns:1,container:!0,rowGap:".6em",children:[(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(y.a3,{children:["You will be auto redirected to ",h.label," after initialization completes. If not, you can manually access"," ",(0,r.jsx)(L.A,{display:"inline-flex",href:h.path,children:h.label})," ","after completion."]})}),(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsx)(S.z2,{progressPercentage:p.progress})}),(0,r.jsx)(l.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(s.t$,{mb:0,mt:0,children:[(0,r.jsx)(s.WJ,{children:(0,r.jsx)(y.a3,{children:"Status"})}),(0,r.jsx)(s.BF,{children:(0,r.jsx)(M.A,{height:"60vh",lineHeight:"2",ref:x.callbackRef,children:(0,r.jsx)(q.A,{children:A.string})},"status")})]})})]}),m.confirmDialog]}):(0,r.jsx)(Y,{children:(0,r.jsx)(o.A,{mt:0})})},O=()=>{let e=(0,a.useRef)(""),[n,t]=(0,a.useState)(),{confirmDialog:i,finishConfirm:l,setConfirmDialogLoading:c,setConfirmDialogOpen:u,setConfirmDialogProps:d}=(0,R.A)({initial:{scrollContent:!0,wide:!0}}),m=(0,a.useMemo)(()=>({add:{open:()=>null},confirm:{finish:l,loading:c,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return u(e)},prepare:d},edit:{open:()=>null}}),[l,c,u,d]),{data:h,loading:x}=(0,D.A)("/host/local");return x?(0,r.jsx)(s.Zk,{children:(0,r.jsx)(o.A,{})}):n?(0,r.jsx)(_,{ipRef:e,jobUuid:n,reinit:!!h}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.Zk,{children:[(0,r.jsx)(s.aO,{children:(0,r.jsxs)(y.HM,{children:[h?"Rei":"I","nitialize striker"]})}),(0,r.jsx)(N,{detail:h,ipRef:e,onSubmitSuccess:e=>{t(e.jobUuid)},tools:m})]}),i]})},F=()=>(0,r.jsx)(i.A,{children:(0,r.jsx)(O,{})})}},e=>{e.O(0,[347,766,107,422,238,847,337,466,960,636,593,792],()=>e(e.s=71495)),_N_E=e.O()}]);