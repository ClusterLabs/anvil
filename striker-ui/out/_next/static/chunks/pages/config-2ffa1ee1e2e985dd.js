(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{14453:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/config",function(){return n(78138)}])},11399:function(e,t,n){"use strict";var l=n(85893),s=n(67294),r=n(77583);let o=(0,s.forwardRef)((e,t)=>{let{children:n,contentContainerProps:o,dialogProps:i,onSubmitAppend:c,proceedButtonProps:a,scrollBoxProps:d,scrollContent:u,...h}=e,p=(0,s.useMemo)(()=>({...o,component:"form",onSubmit:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l]=t;l.preventDefault(),null==c||c.call(null,...t)}}),[o,c]),x=(0,s.useMemo)(()=>({...d,sx:u?{overflowX:"hidden",paddingTop:".6em",...null==d?void 0:d.sx}:null==d?void 0:d.sx}),[d,u]);return(0,l.jsx)(r.Z,{dialogProps:i,contentContainerProps:p,proceedButtonProps:{...a,type:"submit"},scrollContent:u,scrollBoxProps:x,wide:!0,...h,ref:t,children:n})});o.displayName="FormDialog",t.Z=o},82777:function(e,t,n){"use strict";var l=n(85893),s=n(67294),r=n(99514),o=n(14440);t.Z=e=>{let{calculateItemBreakpoints:t=()=>({xs:1}),layout:n,wrapperBoxProps:i,...c}=e,a=(0,s.useMemo)(()=>Object.entries(n).map((e,n)=>{let[l,o]=e;return o?(0,s.createElement)(r.ZP,{...t(n,l),key:l,item:!0,...o}):void 0}),[t,n]);return(0,l.jsx)(o.Z,{...i,children:(0,l.jsx)(r.ZP,{container:!0,...c,children:a})})}},28293:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var l=n(23279),s=n.n(l),r=n(67294),o=n(14879),i=function(){let{postSet:e,preSet:t,set:n,setType:l="string",valueKey:s="value"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r=>{let{target:{[s]:i}}=r,c=o.Z[l](i);null==t||t.call(null,r),null==n||n.call(null,c),null==e||e.call(null,r)}},c=n(52675);let a="input",d={boolean:!1,number:0,string:""},u={createInputOnChangeHandlerOptions:{},debounceWait:500,required:!1,valueType:"string"},h=(0,r.forwardRef)((e,t)=>{let{debounceWait:n=u.debounceWait,input:l,inputTestBatch:o,onBlurAppend:h,onFirstRender:p,onFocusAppend:x,onUnmount:m,required:f=u.required,valueKey:g,valueType:j=u.valueType,createInputOnChangeHandlerOptions:{postSet:v,valueKey:Z=g,...P}=u.createInputOnChangeHandlerOptions}=e,{props:w}=l,b=(0,r.useMemo)(()=>null!=Z?Z:"checked"in w?"checked":"value",[w,Z]),{onBlur:k,onChange:y,onFocus:A,[b]:C=d[j],...S}=w,[T,M]=(0,r.useState)(C),[I,O]=(0,r.useState)(!1),[E,F]=(0,r.useState)(!1),R=(0,r.useCallback)(e=>{M(e)},[]),D=(0,r.useMemo)(()=>{let e;return o&&(o.isRequired=f,e=(0,c.LT)({[a]:o})),e},[o,f]),N=(0,r.useCallback)(e=>{var t;let n=null!==(t=null==D?void 0:D.call(null,{inputs:{[a]:{value:e}},isIgnoreOnCallbacks:!0}))&&void 0!==t&&t;null==p||p.call(null,{isValid:n}),F(n)},[p,D]),B=(0,r.useMemo)(()=>s()(N,n),[n,N]),U=(0,r.useMemo)(()=>null!=k?k:D&&function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let{0:{target:{value:l}}}=t;F(D({inputs:{[a]:{value:l}}})),null==h||h.call(null,...t)},[k,h,D]),_=(0,r.useMemo)(()=>i({postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];O(!0),null==y||y.call(null,...t),null==v||v.call(null,...t)},set:e=>{R(e),B(e)},setType:j,valueKey:b,...P}),[B,y,v,P,R,b,j]),L=(0,r.useMemo)(()=>null!=A?A:o&&function(){for(var e,t,n=arguments.length,l=Array(n),s=0;s<n;s++)l[s]=arguments[s];null===(t=o.defaults)||void 0===t||null===(e=t.onSuccess)||void 0===e||e.call(null,{append:{}}),null==x||x.call(null,...l)},[A,o,x]);return(0,r.useEffect)(()=>(N(T),m),[]),(0,r.useEffect)(()=>{!I&&T!==C&&C&&(N(C),M(C))},[N,C,T,I]),(0,r.useImperativeHandle)(t,()=>({getIsChangedByUser:()=>I,getValue:()=>T,isValid:()=>E,setValue:R}),[T,I,E,R]),(0,r.cloneElement)(l,{...S,onBlur:U,onChange:_,onFocus:L,required:f,[b]:T})});h.defaultProps=u,h.displayName="InputWithRef";var p=h},86549:function(e,t,n){"use strict";var l=n(85893),s=n(11632),r=n(77574),o=n(77831),i=n(56903);t.Z=e=>{let{children:t,sx:n,...c}=e;return(0,l.jsx)(r.Z,{underline:"hover",variant:"subtitle1",...c,sx:{color:o.lD,textDecorationColor:o.s7,...n},children:(0,l.jsxs)(i.Z,{row:!0,children:[t,(0,l.jsx)(s.Z,{sx:{marginLeft:".3em"}})]})})}},62848:function(e,t,n){"use strict";var l=n(67294);t.Z=function(){let{actionProceedText:e="",content:t="",titleText:n="",...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.useState)({actionProceedText:e,content:t,titleText:n,...s})}},56907:function(e,t,n){"use strict";var l=n(67294),s=n(98484),r=n(8534),o=n(97607);t.Z=(e,t)=>{var n;let[i,c]=(0,l.useState)(!1),[a,d]=(0,l.useState)({}),u=(0,l.useCallback)(e=>{var n,l;return null==t?void 0:null===(l=t.current)||void 0===l?void 0:null===(n=l.setMessage)||void 0===n?void 0:n.call(null,"api",e)},[t]),h=(0,l.useCallback)((e,n)=>{var l,s;null==t||null===(s=t.current)||void 0===s||null===(l=s.setMessage)||void 0===l||l.call(null,String(e),n)},[t]),p=(0,l.useCallback)((e,n)=>{var l,s;null==t||null===(s=t.current)||void 0===s||null===(l=s.setMessageRe)||void 0===l||l.call(null,e,n)},[t]),x=(0,l.useCallback)((e,t)=>{d((0,r.ZP)(e,t))},[]),m=(0,l.useCallback)((e,t)=>{d((0,r.Um)(e,t))},[]),f=(0,l.useCallback)(e=>{h(e),x(e)},[h,x]),g=(0,l.useCallback)(e=>{p(e),m(e)},[p,m]),j=(0,l.useCallback)(e=>t=>{x(e,t)},[x]),v=(0,l.useCallback)(e=>t=>{let{isValid:n}=t;x(e,n)},[x]),Z=(0,l.useCallback)(e=>()=>{f(e)},[f]),P=(0,l.useCallback)(e=>{let{body:l,getErrorMsg:r,msgKey:i="api",method:a,onError:d,onSuccess:u,setMsg:h=null==t?void 0:null===(n=t.current)||void 0===n?void 0:n.setMessage,successMsg:p,url:x}=e;c(!0),s.Z.request({data:l,method:a,url:x}).then(()=>{null==h||h.call(null,i,{children:p,type:"info"}),null==u||u.call(null)}).catch(e=>{let t=(0,o.Z)(e);t.children=r(t.children),null==h||h.call(null,i,t),null==d||d.call(null)}).finally(()=>{c(!1)})},[t,c]),w=(0,l.useMemo)(()=>Object.values(a).some(e=>!e),[a]);return{buildFinishInputTestBatchFunction:j,buildInputFirstRenderFunction:v,buildInputUnmountFunction:Z,formValidity:a,isFormInvalid:w,isFormSubmitting:i,setApiMessage:u,setFormValidity:d,setMessage:h,setMessageRe:p,setValidity:x,setValidityRe:m,submitForm:P,unsetKey:f,unsetKeyRe:g}}},26339:function(e,t){"use strict";t.default={bcn:"Back-Channel Network",ifn:"Internet-Facing Network",mn:"Migration Network",sn:"Storage Network"}},78138:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eh}});var l=n(85893),s=n(99514),r=n(9008),o=n.n(r),i=n(67294),c=n(92230),a=n(77583),d=n(39937),u=n(48430),h=n(26339),p=n(37842),x=n(98484);let m=function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,s=n=>{var l;null===(l=t.current.setMessage)||void 0===l||l.call(null,e,n)};return n&&(n[l]=s),s};var f=(e,t)=>{let n={};return e instanceof Array?e.reduce((e,n)=>(m(n,t,e),e),n):Object.entries(e).reduce((e,n)=>{let[l,s]=n;return m(s,t,e,l),e},n)},g=n(8534),j=n(41553),v=n(45486),Z=n(59278),P=e=>{let{checkboxProps:t,checked:n,formControlLabelProps:s,label:r,onChange:o}=e,c=(0,i.useMemo)(()=>"string"==typeof r?(0,l.jsx)(Z.Ac,{children:r}):r,[r]);return(0,l.jsx)(j.Z,{...s,control:(0,l.jsx)(v.Z,{...t,checked:n,onChange:o}),label:c})},w=n(56903),b=n(82777),k=n(97607),y=n(65895),A=n(28293),C=n(81208),S=n(91029),T=n(52675);let M={dbPort:"dbPort",ipAddress:"ipAddress",password:"password",sshPort:"sshPort",user:"user"},I="IP address",O="Password",E=(0,i.forwardRef)((e,t)=>{let{formGridColumns:n=2}=e,s=(0,i.useRef)({}),r=(0,i.useRef)({}),o=(0,i.useRef)({}),c=(0,i.useRef)({}),d=(0,i.useRef)({}),u=(0,i.useRef)({}),[h,m]=(0,i.useState)({}),[j,v]=(0,i.useState)(!0),[E,F]=(0,i.useState)(!1),R=(0,i.useCallback)(e=>t=>{let{isValid:n}=t;m((0,g.ZP)(e,n))},[]),D=(0,i.useCallback)(e=>t=>{m((0,g.ZP)(e,t))},[]),N=(0,i.useCallback)(e=>{var t;null===(t=u.current.setMessage)||void 0===t||t.call(null,"api",e)},[]),B=(0,i.useMemo)(()=>Object.values(h).some(e=>!e),[h]),U=(0,i.useMemo)(()=>f(M,u),[]);return(0,l.jsx)(a.Z,{actionProceedText:"Add",content:(0,l.jsx)(b.Z,{columns:{xs:1,sm:n},layout:{"add-peer-ip-address":{children:(0,l.jsx)(w.Z,{row:!0,spacing:".3em",children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:"add-peer-ip-address-input",inputProps:{readOnly:!0,onFocus:e=>{e.target.readOnly=!1}},label:I}),inputTestBatch:(0,T._)(I,()=>{U.ipAddress()},{onFinishBatch:D(M.ipAddress)},e=>{U.ipAddress({children:e})}),onFirstRender:R(M.ipAddress),ref:r,required:!0})})},"add-peer-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:"add-peer-password-input",label:O,type:p.Z.password}),inputTestBatch:(0,T.Gn)(O,()=>{U.password()},{onFinishBatch:D(M.password)},e=>{U.password({children:e})}),onFirstRender:R(M.password),ref:o,required:!0})},"add-peer-is-ping":{children:(0,l.jsx)(P,{checked:j,label:"Ping",onChange:(e,t)=>{v(t)}}),sx:{display:"flex"}},"add-peer-message-group":{children:(0,l.jsx)(C.Z,{count:1,defaultMessageType:"warning",ref:u}),sm:n}},spacing:"1em"}),dialogProps:{PaperProps:{sx:{minWidth:"16em"}}},loadingAction:E,onActionAppend:()=>{N()},onProceedAppend:()=>{var e,t,n,l,i;F(!0),x.Z.post("/host/connection",{ipAddress:null===(e=r.current.getValue)||void 0===e?void 0:e.call(null),isPing:j,password:null===(t=o.current.getValue)||void 0===t?void 0:t.call(null),port:null===(n=s.current.getValue)||void 0===n?void 0:n.call(null),sshPort:null===(l=c.current.getValue)||void 0===l?void 0:l.call(null),user:null===(i=d.current.getValue)||void 0===i?void 0:i.call(null)}).then(()=>{N({children:"Successfully initiated the peer addition. You can continue to edit the field(s) to add another peer.",type:"info"})}).catch(e=>{let t=(0,k.Z)(e);t.children="Failed to add the given peer. ".concat(t.children),N(t)}).finally(()=>{F(!1)})},proceedButtonProps:{disabled:B},ref:t,titleText:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.z,{children:"Add a peer"}),(0,l.jsx)(y.Z,{mapPreset:"close",onClick:()=>{if(t&&"current"in t){var e;null===(e=t.current.setOpen)||void 0===e||e.call(null,!1)}},variant:"redcontained"})]})})});E.displayName="AddPeerDialog";var F=n(83916),R=n(99576),D=n(23930),N=n(12641),B=n(74443),U=n(77831);let _={small:Z.KI,medium:Z.Ac},L={size:"small",stateMap:new Map([[!1,(0,l.jsx)(N.Z,{sx:{color:U.Wd}},"state-false")],[!0,(0,l.jsx)(B.Z,{sx:{color:U.Ej}},"state-true")]])},q=e=>{let{label:t,size:n=L.size,state:s,stateMap:r=L.stateMap}=e,o=r.get(s);return(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",children:[o&&(0,i.cloneElement)(o,{fontSize:n}),(0,i.createElement)(_[n],{},t)]})};q.defaultProps=L;var H=e=>{let{refreshInterval:t=6e4}=e,n=(0,i.useRef)({}),r=(0,i.useRef)({}),[o,d]=(0,i.useState)(void 0),[p,m]=(0,i.useState)({actionProceedText:"",content:"",titleText:""}),[f,g]=(0,i.useState)({}),[j,v]=(0,i.useState)(!1),[P,b]=(0,i.useState)({}),y=(0,i.useMemo)(()=>o&&(0,l.jsx)(s.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(R.Z,{...o})}),[o]),{isLoading:A}=(0,u.Z)("".concat(c.Z,"/host/connection"),{refreshInterval:t,onError:e=>{d({children:"Failed to get connection data. Error: ".concat(e),type:"error"})},onSuccess:e=>{let{local:{inbound:{ipAddress:t,port:n,user:l},peer:s}}=e;g(e=>Object.entries(t).reduce((t,s)=>{let[r,{ifaceId:o,networkLinkNumber:i,networkNumber:c,networkType:a}]=s;return t[r]={...e[r],dbPort:n,dbUser:l,ifaceId:o,ipAddress:r,networkLinkNumber:i,networkNumber:c,networkType:a},t},{})),b(e=>Object.entries(s).reduce((t,n)=>{let[l,{hostUUID:s,isPing:r,port:o,user:i}]=n,c="".concat(i,"@").concat(l,":").concat(o);return t[c]={...e[c],dbPort:o,dbUser:i,hostUUID:s,ipAddress:l,isPingTest:r},t},{}))}});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(D.TZ,{header:"Configure striker peers",loading:A,children:(0,l.jsxs)(s.ZP,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(s.ZP,{item:!0,xs:1,children:(0,l.jsx)(F.Z,{header:"Inbound connections",listEmpty:(0,l.jsx)(Z.Ac,{align:"center",children:"No inbound connections found."}),listItemKeyPrefix:"config-peers-inbound-connection",listItems:f,renderListItem:(e,t)=>{let{dbPort:n,dbUser:s,ifaceId:r,networkNumber:o,networkType:i}=t,c=h.default[i]&&o?"".concat(h.default[i]," ").concat(o):"Unknown network; interface: ".concat(r);return(0,l.jsxs)(w.Z,{spacing:0,sx:{width:"100%"},children:[(0,l.jsx)(Z.$_,{children:"".concat(s,"@").concat(e,":").concat(n)}),(0,l.jsx)(Z.KI,{children:c})]})}})}),(0,l.jsx)(s.ZP,{item:!0,xs:1,children:(0,l.jsx)(F.Z,{header:"Peer connections",allowEdit:!0,edit:j,listEmpty:(0,l.jsx)(Z.Ac,{align:"center",children:"No peer connections found."}),listItemKeyPrefix:"config-peers-peer-connection",listItems:P,onAdd:()=>{var e;null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{let e=Object.entries(P).reduce((e,t)=>{let[,{hostUUID:n,isChecked:l}]=t;return l&&e.local.push(n),e},{local:[]}),t=e.local.length;if(t>0){var n;m({actionProceedText:"Delete",content:"The peer relationship between this striker and the selected ".concat(t," host(s) will terminate. The removed peer(s) can be re-added later."),onProceedAppend:()=>{x.Z.delete("/host/connection",{data:e}).catch(e=>{let t=(0,k.Z)(e);t.children="Failed to delete peer connection(s). ".concat(t.children),d(t)})},proceedColour:"red",titleText:"Delete ".concat(t," peer(s) from this striker?")}),null===(n=r.current.setOpen)||void 0===n||n.call(null,!0)}},onEdit:()=>{v(e=>!e)},onItemCheckboxChange:(e,t,n)=>{P[e].isChecked=n,b(e=>({...e}))},renderListItem:(e,t)=>{let{isPingTest:n=!1}=t;return(0,l.jsx)(w.Z,{row:!0,spacing:0,children:(0,l.jsxs)(w.Z,{spacing:0,children:[(0,l.jsx)(Z.$_,{children:e}),(0,l.jsx)(q,{label:"Ping",state:n})]})})}})}),y]})}),(0,l.jsx)(E,{ref:n}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...p,ref:r})]})},V=n(29535),W=n(86549),G=n(85291),K=e=>{let{mitmExternalHref:t="https://en.wikipedia.org/wiki/Man-in-the-middle_attack",refreshInterval:n=6e4}=e,s=(0,i.useRef)({}),[r,o]=(0,i.useState)(),[d,h]=(0,i.useState)({}),[p,m]=(0,i.useState)({actionProceedText:"",content:"",titleText:""}),{checks:f,getCheck:g,hasAllChecks:j,hasChecks:v,setAllChecks:P,setCheck:b}=(0,G.Z)({list:d}),y=(0,i.useMemo)(()=>r&&(0,l.jsx)(R.Z,{...r}),[r]),A=(0,i.useMemo)(()=>Object.keys(d).length>1,[d]),{isLoading:C}=(0,u.Z)("".concat(c.Z,"/ssh-key/conflict"),{onError:e=>{o({children:"Failed to fetch SSH key conflicts. Error: ".concat(e),type:"error"})},onSuccess:e=>{h(t=>Object.values(e).reduce((e,n)=>(Object.values(n).forEach(n=>{let{hostName:l,hostUUID:s,ipAddress:r,stateUUID:o}=n;e[o]={...t[o],hostName:l,hostUUID:s,ipAddress:r}}),e),{}))},refreshInterval:n});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(D.TZ,{header:"Manage changed SSH keys",loading:C,children:[(0,l.jsxs)(w.Z,{spacing:".2em",children:[(0,l.jsx)(Z.Ac,{children:"The identity of the following targets have unexpectedly changed."}),(0,l.jsxs)(R.Z,{type:"warning",isAllowClose:!0,children:["If you haven't rebuilt the listed targets, then you could be experiencing a"," ",(0,l.jsx)(W.Z,{href:t,sx:{display:"inline-flex"},target:"_blank",children:'"Man In The Middle"'})," ","attack. Please verify the targets have changed for a known reason before proceeding to remove the broken keys."]}),(0,l.jsx)(F.Z,{header:(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{width:"100%","& > :not(:last-child)":{display:{xs:"none",sm:"flex"}},"& > :last-child":{display:{xs:"initial",sm:"none"},marginLeft:0}},children:[(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{flexBasis:"calc(50% + 1em)"},children:[(0,l.jsx)(Z.Ac,{children:"Host name"}),(0,l.jsx)(V.Z,{sx:{flexGrow:1}})]}),(0,l.jsxs)(w.Z,{row:!0,spacing:".3em",sx:{flexGrow:1},children:[(0,l.jsx)(Z.Ac,{children:"IP address"}),(0,l.jsx)(V.Z,{sx:{flexGrow:1}})]}),(0,l.jsx)(V.Z,{sx:{flexGrow:1}})]}),allowCheckAll:A,allowCheckItem:!0,allowDelete:!0,allowEdit:!1,disableDelete:!v,edit:!0,getListCheckboxProps:()=>({checked:j}),listEmpty:(0,l.jsx)(Z.Ac,{align:"center",children:"No conflicting keys found."}),listItems:d,onAllCheckboxChange:(e,t)=>{P(t)},onDelete:()=>{var e;let t=f.reduce((e,t)=>{if(!g(t))return e;let{hostUUID:n}=d[t];return e[n]||(e[n]=[]),e[n].push(t),e},{});m({actionProceedText:"Delete",content:"Resolve ".concat(f.length," SSH key conflicts. Please make sure the identity change(s) are expected to avoid MITM attacks."),onProceedAppend:()=>{x.Z.delete("/ssh-key/conflict",{data:t}).catch(e=>{let t=(0,k.Z)(e);t.children="Failed to delete selected SSH key conflicts. ".concat(t.children),o(t)})},proceedColour:"red",titleText:"Delete ".concat(f.length," conflicting SSH keys?")}),null===(e=s.current.setOpen)||void 0===e||e.call(null,!0)},onItemCheckboxChange:(e,t,n)=>{b(e,n)},renderListItem:(e,t)=>{let{hostName:n,ipAddress:s}=t;return(0,l.jsxs)(w.Z,{spacing:0,sm:"row",sx:{width:"100%","& > *":{flexBasis:"50%"}},xs:"column",children:[(0,l.jsx)(Z.Ac,{children:n}),(0,l.jsx)(Z.Ac,{children:s})]})},renderListItemCheckboxState:e=>g(e)})]}),y]}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...p,ref:s})]})};let z="common-user-input-confirm-password",X="common-user-input-name",$="common-user-input-password",J="Username",Y="Password";var Q=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,setMessage:s,setValidity:r},previous:{name:o}={},readOnlyUserName:c,requirePassword:a=!1,showPasswordField:d}=e,u=(0,i.useRef)({}),h=(0,i.useRef)({}),[x,m]=(0,i.useState)(a),f=(0,i.useMemo)(()=>d?{"common-user-input-cell-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:$,label:Y,type:p.Z.password}),inputTestBatch:(0,T.Gn)(Y,()=>{s($)},{onFinishBatch:t($)},e=>{s($,{children:e})}),onBlurAppend:e=>{var t;let{target:{value:n}}=e;m(n.length>0),r(z,n===(null===(t=h.current.getValue)||void 0===t?void 0:t.call(null)))},onFirstRender:n($),ref:u,required:a})},"common-user-input-cell-confirm-password":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:z,inputProps:{readOnly:!x},label:"Confirm password",type:p.Z.password}),inputTestBatch:{defaults:{onSuccess:()=>{s(z)}},onFinishBatch:t(z),tests:[{test:T.HJ},{onFailure:()=>{s(z,{children:"The passwords do not match."})},test:e=>{var t;let{value:n}=e;return n===(null===(t=u.current.getValue)||void 0===t?void 0:t.call(null))}}]},onFirstRender:n(z),ref:h,required:x})}}:void 0,[t,n,x,a,s,r,d]);return(0,l.jsx)(b.Z,{columns:{xs:1,sm:2,md:3},layout:{"common-user-input-cell-name":{children:(0,l.jsx)(A.Z,{input:(0,l.jsx)(S.Z,{id:X,inputProps:{readOnly:c},label:J,value:o}),inputTestBatch:(0,T.Gn)(J,()=>{s(X)},{onFinishBatch:t(X)},e=>{s(X,{children:e})}),onFirstRender:n(X),required:!0}),md:1,sm:2},...f},spacing:"1em"})},ee=n(11399),et=n(44089),en=n(62848),el=n(56907);let es=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[{target:l}]=t,{elements:s}=l,{value:r}=s.namedItem(X),o=s.namedItem($),i="";return o&&({value:i}=o),{password:i,userName:r}};var er=()=>{let e=(0,i.useRef)({}),t=(0,i.useRef)({}),n=(0,i.useRef)({}),s=(0,i.useRef)({}),[r,o]=(0,en.Z)(),[d,h]=(0,i.useState)(!1),[p,x]=(0,i.useState)({children:"No users found."}),[m,f]=(0,i.useState)(),{data:g,isLoading:j}=(0,u.Z)("".concat(c.Z,"/user"),{onError:e=>{x((0,k.Z)(e))}}),v=(0,el.Z)([z,X,$],s),{isFormInvalid:P,isFormSubmitting:w,submitForm:b}=v,{buildDeleteDialogProps:y,checks:A,getCheck:S,hasChecks:T,setCheck:M}=(0,G.Z)({list:g}),{userName:I,userUUID:O}=(0,i.useMemo)(()=>null!=m?m:{},[m]),E=(0,i.useMemo)(()=>({actionProceedText:"Add",content:(0,l.jsx)(Q,{formUtils:v,requirePassword:!0,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,s=Array(n),r=0;r<n;r++)s[r]=arguments[r];let i=es(...s);o({actionProceedText:"Add",content:(0,l.jsx)(et.Z,{entries:i,hasPassword:!0}),onProceedAppend:()=>{b({body:i,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Add user failed. ",e]}),method:"post",successMsg:"Created user ".concat(i.userName,"."),url:"/user"})},titleText:"Add the following new user?"}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Add a web interface user"}),[v,o,b]),N=(0,i.useMemo)(()=>({actionProceedText:"Edit",content:(0,l.jsx)(Q,{formUtils:v,previous:{name:I},readOnlyUserName:"admin"===I,showPasswordField:!0}),onSubmitAppend:function(){for(var e,n=arguments.length,s=Array(n),r=0;r<n;r++)s[r]=arguments[r];let i=es(...s);o({actionProceedText:"Update",content:(0,l.jsx)(et.Z,{entries:i,hasPassword:!0}),onProceedAppend:()=>{b({body:i,getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Update user failed. ",e]}),method:"put",successMsg:"Updated user ".concat(I),url:"/user/".concat(O)})},titleText:"Update user ".concat(I," with the following?")}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Edit user ".concat(I)}),[v,o,b,I,O]),B=(0,i.useMemo)(()=>(0,l.jsx)(C.Z,{count:1,defaultMessageType:"warning",ref:s}),[]),U=(0,i.useMemo)(()=>{var e;return(null==g?void 0:null===(e=g.current)||void 0===e?void 0:e.userName)==="admin"},[g]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(D.TZ,{header:"Manage users",loading:j,children:(0,l.jsx)(F.Z,{allowAddItem:U,allowDelete:U,allowEdit:!0,allowItemButton:d,disableDelete:!T,edit:d,getListItemCheckboxProps:(e,t)=>{let{userName:n}=t;return{disabled:"admin"===n}},header:!0,listEmpty:(0,l.jsx)(R.Z,{...p}),listItems:g,onAdd:()=>{var t;null===(t=e.current.setOpen)||void 0===t||t.call(null,!0)},onDelete:()=>{var e;o(y({confirmDialogProps:{onProceedAppend:()=>{b({body:{uuids:A},getErrorMsg:e=>(0,l.jsxs)(l.Fragment,{children:["Delete user(s) failed. ",e]}),method:"delete",url:"/user"})}},formSummaryProps:{renderEntry:e=>{let{key:t}=e;return(0,l.jsx)(Z.Ac,{children:null==g?void 0:g[t].userName})}},getConfirmDialogTitle:e=>"Delete the following ".concat(e," users?")})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>h(e=>!e),onItemCheckboxChange:(e,t,n)=>M(e,n),onItemClick:e=>{if(d){var t;f(e),null===(t=n.current.setOpen)||void 0===t||t.call(null,!0)}},renderListItemCheckboxState:e=>S(e),renderListItem:(e,t)=>{let{userName:n}=t;return(0,l.jsx)(Z.Ac,{children:n})}})}),(0,l.jsx)(ee.Z,{...E,disableProceed:P,loadingAction:w,preActionArea:B,ref:e}),(0,l.jsx)(ee.Z,{...N,disableProceed:P,loadingAction:w,preActionArea:B,ref:n}),(0,l.jsx)(a.Z,{closeOnProceed:!0,...r,ref:t})]})},eo=()=>(0,l.jsxs)(D.s_,{children:[(0,l.jsx)(H,{}),(0,l.jsx)(K,{}),(0,l.jsx)(er,{})]}),ei=n(11901),ec=n(99429),ea=n(53541);let ed=e=>(0,l.jsx)(ec.Z,{...e,sx:{width:"100%"}});var eu=e=>{let{installTarget:t="disabled",onSubmit:n,title:r}=e,[o,c]=(0,i.useState)(),a=(0,i.useMemo)(()=>r?(0,l.jsx)(Z.z,{sx:{textAlign:"center"},children:r}):(0,l.jsx)(ea.Z,{mt:0}),[r]),d=(0,i.useMemo)(()=>o&&(0,l.jsx)(s.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(R.Z,{...o,onClose:()=>{c(void 0)}})}),[o,c]);return(0,l.jsxs)(D.s_,{children:[(0,l.jsx)(D.V9,{children:a}),(0,l.jsxs)(s.ZP,{columns:{xs:1,sm:2},container:!0,spacing:"1em",children:[(0,l.jsx)(s.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsxs)(w.Z,{row:!0,children:[(0,l.jsx)(Z.Ac,{sx:{flexGrow:1},children:"Install target"}),(0,l.jsx)(ei.Z,{checked:"enabled"===t,edge:"end",onChange:(e,t)=>{let s="disable",o="Disable";t&&(s="enable",o="Enable"),null==n||n.call(null,{actionProceedText:o,content:(0,l.jsxs)(Z.Ac,{children:["Would you like to ",s,' "Install target" on this striker? It\'ll take a few moments to complete.']}),onProceedAppend:()=>{x.Z.put("/host/local",{isEnableInstallTarget:t},{params:{handler:"install-target"}}).catch(e=>{let t=(0,k.Z)(e);t.children="Failed to ".concat(s,' "Install target". ').concat(t.children),c(t)})},titleText:"".concat(o,' "Install target" on ').concat(r,"?")})}})]})}),(0,l.jsx)(s.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Update",content:(0,l.jsx)(Z.Ac,{children:"Would you like to update the operating system on this striker? It'll be placed into maintenance mode until the update completes."}),onProceedAppend:()=>{x.Z.put("/command/update-system").catch(e=>{let t=(0,k.Z)(e);t.children="Failed to initiate system update. ".concat(t.children),c(t)})},titleText:"Update operating system on ".concat(r,"?")})},children:"Update system"})}),(0,l.jsx)(s.ZP,{item:!0,sm:2,xs:1,children:(0,l.jsx)(ed,{href:"/init?re=1",children:"Reconfigure striker"})}),(0,l.jsx)(s.ZP,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Reboot",content:(0,l.jsx)(Z.Ac,{children:"Would you like to reboot this striker?"}),onProceedAppend:()=>{x.Z.put("/command/reboot-host").catch(e=>{let t=(0,k.Z)(e);t.children="Failed to initiate system reboot. ".concat(t.children),c(t)})},titleText:"Reboot ".concat(r,"?")})},children:"Reboot"})}),(0,l.jsx)(s.ZP,{item:!0,xs:1,children:(0,l.jsx)(ed,{onClick:()=>{null==n||n.call(null,{actionProceedText:"Shutdown",content:(0,l.jsx)(Z.Ac,{children:"Would you like to shutdown this striker?"}),onProceedAppend:()=>{x.Z.put("/command/poweroff-host").catch(e=>{let t=(0,k.Z)(e);t.children="Failed to initiate system shutdown. ".concat(t.children),c(t)})},titleText:"Shutdown ".concat(r,"?")})},children:"Shutdown"})}),d]})]})},eh=e=>{let{refreshInterval:t=6e4}=e,[n,r]=(0,i.useState)(!1),[h,p]=(0,i.useState)({actionProceedText:"",closeOnProceed:!0,content:"",dialogProps:{open:n},onCancelAppend:()=>{r(!1)},onProceedAppend:()=>{r(!1)},titleText:""}),[x,m]=(0,i.useState)(),[f,g]=(0,i.useState)(""),{data:j,isLoading:v}=(0,u.Z)("".concat(c.Z,"/host/local"),{onError:()=>{g("Unknown")},onSuccess:e=>{let{installTarget:t,shortHostName:n}=e;m(t),g(n)},refreshInterval:t});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o(),{children:(0,l.jsx)("title",{children:v?"Loading...":"".concat(null==j?void 0:j.shortHostName," Config")})}),(0,l.jsx)(d.Z,{}),(0,l.jsxs)(s.ZP,{container:!0,columns:{xs:1,md:3,lg:4},children:[(0,l.jsx)(s.ZP,{item:!0,xs:1,children:(0,l.jsx)(eu,{installTarget:x,onSubmit:e=>{let{onProceedAppend:t,...n}=e;p(e=>({...e,...n,onProceedAppend:function(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];null==t||t.call(null,...n),r(!1)}})),r(!0)},title:f})}),(0,l.jsx)(s.ZP,{item:!0,md:2,xs:1,children:(0,l.jsx)(eo,{})})]}),(0,l.jsx)(a.Z,{...h,dialogProps:{open:n}})]})}}},function(e){e.O(0,[162,442,318,461,982,26,133,321,888,774,179],function(){return e(e.s=14453)}),_N_E=e.O()}]);