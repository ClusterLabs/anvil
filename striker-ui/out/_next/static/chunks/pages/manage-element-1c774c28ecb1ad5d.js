(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{40663:(e,n,t)=>{"use strict";t.d(n,{A:()=>h});var r=t(37876),s=t(35656),a=t(57212),l=t(54773),i=t(14232),o=t(90890),c=t(46316),d=t(51677);let u=(0,l.Ay)(s.A)({height:"3.5em",marginLeft:0,width:"100%"}),h=e=>{let{baseInputProps:n,checked:t,formControlLabelProps:s,id:l,label:h,name:m,onChange:p,switchProps:x}=e,f=(0,i.useMemo)(()=>(0,c.A)(h,d.a3,{color:"".concat(o.Qu,"AF"),inheritColour:!0}),[h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{control:(0,r.jsx)(a.A,{checked:t,edge:"end",name:m,onChange:p,...x}),label:f,labelPlacement:"start",slotProps:{typography:{flexGrow:1}},...s}),(0,r.jsx)("input",{checked:t,hidden:!0,id:l,readOnly:!0,type:"checkbox",...n})]})}},44193:(e,n,t)=>{"use strict";t.d(n,{A:()=>o});var r=t(14232),s=t(23934),a=t(12698),l=t(5806);let i=(e,n)=>{let{key:t,re:r,replace:s,value:l}=n;return t?e[t]===l?e:(0,a.Ay)(t,l)(e):r?(0,a.WT)(r,l)(e):s||e},o=(e,n)=>{var t;let[a,o]=(0,r.useState)(!1),[c,d]=(0,r.useReducer)(i,{}),u=(0,r.useCallback)(e=>{var t,r;return null==n||null==(r=n.current)||null==(t=r.setMessage)?void 0:t.call(null,"api",e)},[n]),h=(0,r.useCallback)((e,t)=>{var r,s;null==n||null==(s=n.current)||null==(r=s.setMessage)||r.call(null,String(e),t)},[n]),m=(0,r.useCallback)((e,t)=>{var r,s;null==n||null==(s=n.current)||null==(r=s.setMessageRe)||r.call(null,e,t)},[n]),p=(0,r.useCallback)(e=>{d({replace:e})},[]),x=(0,r.useCallback)((e,n)=>{d({key:e,value:n})},[]),f=(0,r.useCallback)((e,n)=>{d({re:e,value:n})},[]),j=(0,r.useCallback)(e=>{h(e),x(e)},[h,x]),g=(0,r.useCallback)(e=>{m(e),f(e)},[m,f]),A=(0,r.useCallback)(e=>n=>{x(e,n)},[x]),v=(0,r.useCallback)(e=>n=>{let{isValid:t}=n;x(e,t)},[x]),w=(0,r.useCallback)(e=>()=>{j(e)},[j]),b=(0,r.useCallback)(e=>{let{body:r,getErrorMsg:a,msgKey:i="api",method:c,onError:d,onSuccess:u,setMsg:h=null==n||null==(t=n.current)?void 0:t.setMessage,successMsg:m,url:p}=e;o(!0),s.A.request({data:r,method:c,url:p}).then(()=>{null==h||h.call(null,i,{children:m,type:"info"}),null==u||u.call(null)}).catch(e=>{let n=(0,l.A)(e);n.children=a(n.children),null==h||h.call(null,i,n),null==d||d.call(null)}).finally(()=>{o(!1)})},[n,o]),k=(0,r.useMemo)(()=>Object.values(c).some(e=>!e),[c]);return{buildFinishInputTestBatchFunction:A,buildInputFirstRenderFunction:v,buildInputUnmountFunction:w,formValidity:c,isFormInvalid:k,isFormSubmitting:a,setApiMessage:u,setFormValidity:p,setMessage:h,setMessageRe:m,setValidity:x,setValidityRe:f,submitForm:b,unsetKey:j,unsetKeyRe:g}}},45997:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>nG});var r=t(37876),s=t(77328),a=t.n(s),l=t(89099),i=t(14232),o=t(99955),c=t(86732),d=t(64410),u=t(96043),h=t(19603),m=t(12981),p=t(52076),x=t.n(p),f=t(63190),j=t(23934),g=t(57763);let A=(e,n)=>{let t;return"boolean"===n?e?"1":"":String(e)};var v=t(22430),w=t(48171),b=t(69267),k=t(65873),y=t(40663),C=t(51677),S=t(4064);let I=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,id:l,parameter:o,required:c}=s,{content_type:d,default:h,description:p,options:x=[]}=o,{changeFieldValue:f,formik:j,handleChange:g}=a,A="parameters.".concat(l,".value"),I=(0,i.useMemo)(()=>{let e;if("boolean"===d){let e=!!j.values.parameters[l].value;return(0,r.jsx)(y.A,{checked:e,id:A,label:l,name:A,onChange:(e,n)=>{f(A,n,!0)}})}let n=String(j.values.parameters[l].value);return"select"===d?(0,r.jsx)(k.A,{id:A,label:l,name:A,onChange:j.handleChange,required:c,selectItems:x,selectProps:{onClearIndicatorClick:()=>{f(A,"",!0)}},value:n}):(u.sX.test(l)?e=w.A.password:"string"!==d&&(e=w.A.number),(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{disableAutofill:!0,id:A,inputProps:{placeholder:h},label:l,name:A,onChange:g,required:c,type:e,value:n})}))},[A,f,j,g,l,x,h,d,c]);return(0,i.useMemo)(()=>(0,r.jsx)(v.A,{disableInteractive:!0,placement:"top-start",slotProps:{tooltip:{sx:{maxWidth:{md:"63em"}}}},title:(0,r.jsx)(C.a3,{children:p}),children:(0,r.jsx)(m.A,{children:I})},"".concat(l,"-tooltip")),[p,l,I])};var M=t(52627);let O=(e,n)=>{let t=!1;return[/plug|port/i.test(e),Number(n.deprecated),n.replacement].some(e=>!!e)?t=!1:1===Number(n.required)&&(t=!0),t},N=e=>{let n={optional:{},required:{}};if(!e)return n;let{parameters:t}=e;return Object.entries(t).sort((e,n)=>{let[t]=e,[r]=n;return t.localeCompare(r)}).reduce((e,n)=>{let[t,r]=n;return e[O(t,r)?"required":"optional"][t]=r,e},n)};var P=t(5806),U=t(71401),q=t(23437),D=t(91408);let F=(e,n)=>{let t=Object.values(n);e&&(t=t.filter(n=>n.fenceUUID!==e));let r=t.map(e=>e.fenceName);return D.Yj().min(1).max(32).notOneOf(r,"${path} already exists")},E=["integer","second"],R=(e,n)=>{let t,{content_type:r,options:s}=n;return t="boolean"===r?D.zM():E.includes(r)?D.ai():D.Yj(),O(e,n)&&(t=t.required()),s&&(t=t.oneOf(s)),t};var T=t(2062);let z=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(n);return D.Ik({agent:D.Yj().required().oneOf(r),name:F(t,e).required(),parameters:D.RZ((e,t)=>{var r;let{context:s}=t,a=null!=(r=null==s?void 0:s.agent)?r:"",l=(0,T.A)(e,e=>{let{[a]:t}=n;if(!t)return D.Ik({value:D.gl()});let{[e]:r}=t.parameters,s=R(e,r);return D.Ik({value:s})});return D.Ik(l)})})};var H=t(71986);let V=(e,n)=>Object.entries(e.parameters).reduce((e,t)=>{var r,s;let a,[l,i]=t,{content_type:o}=i,c=null!=(s=null!=(r=null==n?void 0:n.fenceParameters[l])?r:i.default)?s:"";return a="boolean"===o?["1","on"].some(e=>e===c):String(c),e[l]={value:a},e},{}),_=(e,n)=>{let t={agent:null,name:"",parameters:{},uuid:""};if(n){let{fenceAgent:r,fenceName:s,fenceUUID:a}=n;t.agent=r,t.name=s,t.parameters=V(e[r],n),t.uuid=a}return t},B=(e,n,t)=>Object.entries(n).reduce((n,s)=>{let[a,l]=s,{deprecated:i,replacement:o}=l;return Number(i)||o||n.push((0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(I,{formikUtils:e,id:a,parameter:l,required:t})},"".concat(a,"-parameter-input"))),n},[]),W=e=>{let{fence:n,fences:t,template:s,tools:a}=e,l=void 0!==n,o=(0,i.useMemo)(()=>{let e,t,r,s;return l?(t="put",r="/fence/".concat(n.fenceUUID),s="update"):(t="post",r="/fence",s="add"),{capped:x()(s),method:t,url:r,value:s}},[l,null==n?void 0:n.fenceUUID]),c=(0,i.useMemo)(()=>Object.keys(s).sort((e,n)=>e.localeCompare(n)),[s]),u=(0,i.useMemo)(()=>_(s,n),[n,s]),h=(0,H.A)({initialValues:u,onSubmit:(e,n)=>{let{setSubmitting:t}=n,{name:i,parameters:c}=e,d=String(e.agent),u={agent:d,name:i,parameters:Object.entries(c).reduce((e,n)=>{let[t,{value:r}]=n,{[d]:a}=s;if(!a)return e;let{[t]:i}=a.parameters,o=A(r,i.content_type);return(l||o)&&o!==i.default&&(e[t]=o),e},{})};a.confirm.prepare({actionProceedText:o.capped,content:(0,r.jsx)(M.A,{entries:u,hasPassword:!0,getEntryLabel:e=>{let{cap:n,depth:t,key:r}=e;return t?r:n(r)}}),onCancelAppend:()=>t(!1),onProceedAppend:()=>{a.confirm.loading(!0),j.A.request({data:u,method:o.method,url:o.url}).then(()=>{a.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:[o.capped,"ed fence device ",i]})}),a.add.open(!1)}).catch(e=>{let n=(0,P.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to ",o.value," fence device. ",n.children]}),a.confirm.finish("Error",n),t(!1)})},titleText:"".concat(o.capped," fence device with the following?")}),a.confirm.open()},validationSchema:z(t,s,null==n?void 0:n.fenceUUID)}),{disabledSubmit:p,formik:v,formikErrors:w,handleChange:k}=h,y=(0,i.useMemo)(()=>({agent:"agent",name:"name",parameters:"parameters"}),[]),I=(0,i.useMemo)(()=>{let e;return v.values.agent&&({[v.values.agent]:e}=s),N(e)},[v.values.agent,s]),O=(0,i.useMemo)(()=>B(h,I.optional),[h,I.optional]),D=(0,i.useMemo)(()=>B(h,I.required,!0),[h,I.required]);return(0,r.jsxs)(d.Ay,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),v.submitForm()},rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{container:!0,maxHeight:"50vh",overflow:"scroll",rowSpacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(g.A,{disabled:l,id:y.agent,label:"Fence device type",noOptionsText:"No matching fence device type",onChange:(e,t)=>{let r={...v.values,agent:t};if(t){let{[t]:e}=s;r.parameters=V(e,n)}v.setValues(r,!0)},openOnFocus:!0,options:c,renderOption:(e,n)=>{let{[n]:t}=s,a="string"==typeof t.description?t.description:"None";return(0,i.createElement)("li",{...e,key:"fence-agent-".concat(n)},(0,r.jsxs)(m.A,{children:[(0,r.jsx)(C.a3,{inheritColour:!0,children:n}),(0,r.jsx)(C.a3,{selected:!1,children:a})]}))},required:!0,value:v.values.agent})}),v.values.agent&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(q.l8,{expandInitially:!0,header:"Required parameters",panelProps:{mv:0},children:(0,r.jsxs)(d.Ay,{container:!0,rowSpacing:"0.6em",children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:y.name,label:"Fence device name",name:y.name,onChange:k,required:!0,value:v.values.name})})}),D]})})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(q.l8,{header:"Optional parameters",panelProps:{mv:0},children:(0,r.jsx)(d.Ay,{container:!0,rowSpacing:"0.6em",children:O})})})]})]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(U.A,{count:1,messages:w})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:o.capped,disabled:p,type:"submit"}]})})]})};var Y=t(59664);let Z=()=>{let{data:e,loading:n}=(0,Y.A)("/fence/template");return(0,r.jsx)(h.A,{addHeader:"Add a fence device",editHeader:e=>(0,r.jsxs)(C.HM,{children:["Update fence device"," ",(0,r.jsx)(C.kp,{fontSize:"inherit",children:null==e?void 0:e.fenceName})," ","parameters"]}),entriesUrl:"/fence",formDialogProps:{common:{wide:!0}},getAddLoading:e=>e||n,getEditLoading:e=>e||n,getDeleteErrorMessage:function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];return{...t,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete fence device(s). ",e]})}},getDeleteHeader:e=>"Delete ".concat(e," fence device(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted fence device(s)"})}),listEmpty:"No fence device(s) found.",onItemClick:(e,n)=>{let{args:t,entry:r,tools:s}=n,[a]=t;r.set(a),s.edit.open(!0)},renderAddForm:(n,t)=>t&&e&&(0,r.jsx)(W,{fences:t,template:e,tools:n}),renderDeleteItem:(e,n)=>{let{key:t}=n,s=null==e?void 0:e[t];return(0,r.jsx)(C.a3,{children:null==s?void 0:s.fenceName})},renderEditForm:(n,t,s)=>s&&e&&(0,r.jsx)(W,{fence:t,fences:s,template:e,tools:n}),renderListItem:(e,n)=>{let{fenceAgent:t,fenceName:s,fenceParameters:a}=n;return(0,r.jsxs)(d.Ay,{columnSpacing:"1em",container:!0,children:[(0,r.jsx)(d.Ay,{item:!0,children:(0,r.jsx)(C.a3,{children:s})}),(0,r.jsx)(d.Ay,{item:!0,xs:!0,children:(0,r.jsx)(C.a3,{noWrap:!0,children:Object.entries(a).sort((e,n)=>{let[t]=e,[r]=n;return t.localeCompare(r)}).reduce((e,n)=>{let[t,s]=n,a=(0,r.jsxs)(r.Fragment,{children:[t,'="']});return a=u.sX.test(t)?(0,r.jsxs)(r.Fragment,{children:[a,(0,r.jsx)(C.EN,{wrapper:"mono",wrapperProps:{noWrap:!0},children:s})]}):(0,r.jsxs)(r.Fragment,{children:[a,s]}),(0,r.jsxs)(r.Fragment,{children:[e," ",a,'"']})},t)})})]})}})},L=()=>(0,r.jsxs)(q.Zk,{children:[(0,r.jsx)(q.aO,{children:(0,r.jsx)(C.HM,{children:"Manage fence devices"})}),(0,r.jsx)(Z,{})]});var $=t(58085),X=t(30198),G=t(88824),K=t(2126),J=t(90890),Q=t(65832),ee=t(98927);let en=e=>{let{list:n,setValue:t,value:s}=e;return 0===n.length?(0,r.jsx)(C.a3,{children:"No host(s) found."}):(0,r.jsx)(ee.A,{centered:!0,onChange:(e,n)=>{t(n)},orientation:"vertical",value:s,children:n.map(e=>{let{hostConfigured:n,hostStatus:t,hostType:s,hostUUID:a,shortHostName:l}=e,i=s.replace("dr","DR").replace("node","Subnode");return(0,r.jsx)(Q.A,{label:(0,r.jsxs)(G.A,{columnSpacing:"1em",container:!0,sx:{width:"100%",["& > .".concat(K.A.root,":not(:first-child)")]:{borderLeft:"thin solid ".concat(J.eT),paddingLeft:"1em"}},children:[(0,r.jsx)(G.A,{size:"grow",children:(0,r.jsx)(C.a3,{noWrap:!0,children:i})}),(0,r.jsx)(G.A,{size:"grow",children:(0,r.jsx)(C.NA,{noWrap:!0,children:l})}),(0,r.jsx)(G.A,{size:"grow",children:(0,r.jsxs)(C.a3,{noWrap:!0,children:[t,n?", configured":""]})})]}),sx:{textAlign:"left"},value:a},"host-".concat(a))})})};var et=t(40123),er=t.n(et),es=t(86149),ea=t(89275);let el=D.Ik({hostName:D.Yj().required(),networkInit:ea.hJ}),ei=e=>{let{values:n}=e;return(0,r.jsxs)(d.Ay,{container:!0,spacing:".6em",columns:{xs:2},children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"Host name"})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{children:n.hostName})}),(0,r.jsx)(ea.Sf,{...e})]})};var eo=t(588);let ec=e=>{let{dns:n="",gateway:t="",networks:r,ntp:s=""}=e.netconf,a={defaultbcn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"bcn"},defaultifn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"ifn"},defaultsn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"sn"},defaultmn:{interfaces:["",""],ip:"",sequence:"1",subnetMask:"",type:"mn"}};er()(r)||(a=(0,eo.A)(r));let{name:l}=e;return{hostName:l,mini:!1,networkInit:{dns:n,gateway:t,networks:a,ntp:s}}},ed=e=>{let{detail:n,tools:t,uuid:s}=e,a=(0,i.useRef)(null),l=(0,H.A)({initialValues:ec(n),onSubmit:(e,s)=>{let{setSubmitting:l}=s,i=(0,es.A)(e,a.current);t.confirm.prepare({actionProceedText:"Prepare network",content:a.current&&(0,r.jsx)(ei,{gatewayIface:i.gatewayInterface,ifaces:a.current,values:e}),onCancelAppend:()=>l(!1),onProceedAppend:()=>{t.confirm.loading(!0),j.A.put("/host/".concat(n.uuid,"?handler=subnode-network"),i).then(()=>{t.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started network config on ",n.short]})})}).catch(e=>{let s=(0,P.A)(e);s.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare network on ",n.short,". ",s.children]}),t.confirm.finish("Error",s),l(!1)})},titleText:"Prepare network on ".concat(n.short," with the following?")}),t.confirm.open()},validationSchema:el}),{disabledSubmit:o,formik:c,formikErrors:u,handleChange:h}=l,m=(0,i.useMemo)(()=>n.type.replace("node","subnode"),[n.type]),{parentSequence:p,sequence:x}=(0,i.useMemo)(()=>{let[e,t]=n.short.replace(/^.*a(\d+).*(?:n|dr)(\d+)$/,"$1,$2").split(",",2);return{parentSequence:Number(e),sequence:Number(t)}},[n.short]),g=(0,i.useMemo)(()=>({hostName:"hostName",mini:"mini",networks:"networkInit.networks"}),[]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2,md:3,lg:4},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),c.handleSubmit(e)},spacing:"1em",children:[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:g.hostName,label:"Host name",name:g.hostName,onChange:h,required:!0,value:c.values.hostName})})}),(0,r.jsx)(d.Ay,{display:{xs:"none",md:"initial"},flexGrow:1,item:!0}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(y.A,{id:g.mini,label:"Minimal config",name:g.mini,onChange:(e,n)=>{if(n){let{defaultbcn:e}=c.values.networkInit.networks;c.setFieldValue(g.networks,{defaultbcn:e},!0)}else c.resetForm();c.handleChange(e)},checked:c.values.mini})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(ea.VT,{formikUtils:l,host:{parentSequence:p,sequence:x,type:m,uuid:s},onFetchSuccess:e=>{a.current=e}})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(U.A,{count:1,messages:u})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Prepare network",disabled:o,type:"submit"}]})})]})};var eu=t(79982),eh=t(30764);let em=e=>{let{uuid:n}=e,{confirmDialog:t,finishConfirm:s,setConfirmDialogLoading:a,setConfirmDialogOpen:l,setConfirmDialogProps:o}=(0,eh.A)({initial:{scrollContent:!0,wide:!0}}),c=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:s,loading:a,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return l(e)},prepare:o},edit:{open:()=>null}}),[s,a,l,o]),{data:d}=(0,Y.A)("/host/".concat(n));return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ed,{detail:d,tools:c,uuid:n}),t]}):(0,r.jsx)(eu.A,{mt:0})};var ep=t(19383);let ex=()=>{let[e,n]=(0,i.useState)(!1),{data:t}=(0,Y.A)("/host?type=dr&type=subnode"),s=(0,i.useMemo)(()=>t&&Object.values(t),[t]);return s?(0,r.jsxs)(q.Zk,{children:[(0,r.jsx)(en,{list:s,setValue:n,value:e}),e&&(0,r.jsx)(X.A,{sx:{margin:"2em 0"}}),s.map(n=>(0,r.jsx)(ep.A,{changingTabId:e,tabId:n.hostUUID,children:(0,r.jsx)(em,{uuid:n.hostUUID})},"cell-".concat(n.hostUUID)))]}):(0,r.jsx)(q.Zk,{children:(0,r.jsx)(eu.A,{})})};var ef=t(57547),ej=t(31465),eg=t(54773);let eA=(0,eg.Ay)("div")({["& > .".concat(K.A.container,":first-child")]:{maxHeight:"60vh",overflowX:"hidden",overflowY:"scroll",paddingRight:".4em",paddingTop:".6em"}});var ev=t(91686),ew=t(22481),eb=t(74799),ek=t(67281);let{Form:ey,FormContext:eC,useFormContext:eS}=(0,ek.A)(),eI=(0,i.createContext)(null);var eM=t(5755);let eO="an-id-input-domain",eN="an-id-input-prefix",eP="an-id-input-sequence",eU="an-network-config-input-dns",eq="an-network-config-input-ntp",eD="gateway",eF="min-ip",eE="network-type",eR="network-number",eT="subnet-mask",ez="port",eH="ipmi-ip",eV="power-host",e_=e=>{let{hostSequence:n}=e,t=eS(eC),s=(0,i.useContext)(eI),a=(0,i.useMemo)(()=>{let e="hosts.".concat(n);return{[eH]:"".concat(e,".").concat(eH),fences:"".concat(e,".fences"),networks:"".concat(e,".networks"),upses:"".concat(e,".upses")}},[n]);if(!t||!s)return null;let{changeFieldValue:l,formik:o,handleChange:c}=t.formikUtils,{fences:d,upses:u}=s.template,h=Object.entries(o.values.hosts[n].fences),m=Object.entries(o.values.hosts[n].networks),p=Object.entries(o.values.hosts[n].upses);return(0,r.jsxs)(q.t$,{mv:0,children:[(0,r.jsx)(q.WJ,{children:(0,r.jsxs)(C.a3,{children:["Subnode ",n]})}),(0,r.jsx)(q.BF,{children:(0,r.jsxs)(G.A,{container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsxs)(G.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(eM.A,{children:"It is recommended to provide at least 1 fence device plug."})}),m.map(e=>{let[t,s]=e,{ip:l}=s,i="".concat(a.networks,".").concat(t,".").concat("ip"),{[eR]:d,[eE]:u=""}=o.values.netconf.networks[t],h="".concat(u.toUpperCase()," ").concat(d," IP");return(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:i,label:h,name:i,onChange:c,required:!0,value:l})})},"host-".concat(n,"-network-").concat(t))}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:a[eH],label:"IPMI IP",name:a[eH],onChange:c,value:o.values.hosts[n][eH]})})}),h.map(e=>{let[t,s]=e,{[ez]:l}=s,i="".concat(a.fences,".").concat(t,".").concat(ez),{[t]:o}=d,u="Plug on ".concat(o.fenceName);return(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:i,label:u,name:i,onChange:c,value:l})})},"host-".concat(n,"-fence-").concat(t))})]})}),p.length&&(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(G.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:p.map(e=>{let[t,s]=e,{[eV]:i}=s,o="".concat(a.upses,".").concat(t,".").concat(eV),{[t]:c}=u,d="Uses ".concat(c.upsName);return(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(y.A,{checked:i,id:o,label:d,name:o,onChange:(e,n)=>{l(o,n,!0)}})},"host-".concat(n,"-ups-").concat(t))})})})]})})]})},eB=e=>{let{slotProps:n}=e,t=eS(eC);if(!t)return null;let{formik:s}=t.formikUtils;return(0,r.jsx)(G.A,{container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:Object.keys(s.values.hosts).map(e=>(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(e_,{hostSequence:e})},"host-".concat(e)))})};var eW=t(61057),eY=t(40143);let eZ=e=>{let{getFieldChanged:n,hosts:t,values:r}=e,{[eO]:s,[eN]:a,[eP]:l}=r,i={...r},o=Object.entries(r.netconf.networks);return o.forEach(e=>{let[t,r]=e,{[eR]:s=0,[eE]:a}=r,l={...i.netconf.networks[t]};if(!(null==n?void 0:n("".concat("netconf.networks.".concat(t),".").concat(eF)))){let e,n=0;switch(a){case"bcn":n=200+Number(s),e="10.".concat(n,".0.0");break;case"mn":n=199,e="10.".concat(n,".0.0");break;case"sn":n=100+Number(s),e="10.".concat(n,".0.0");break;default:e=""}l[eF]=e}i.netconf.networks[t]=l}),Object.values(t).filter(e=>{let{name:n}=e;return new RegExp("^".concat(a,"-a").concat(String(l).padStart(2,"0"),"n\\d{2}\\.").concat(s,"$")).test(n)}).forEach(e=>{let t=Number(e.short.replace(/^.*n(\d+)$/,"$1")),{[t]:r}=i.hosts;r&&(i.hosts[t]={...i.hosts[t],[eH]:e.ipmi.ip},o.forEach(r=>{let[s,a]=r,{[eR]:l,[eE]:o}=a,c="".concat(o).concat(l),{[c]:d}=e.netconf.networks;if(!d)return;let{ip:u,subnetMask:h}=d,m={...i.netconf.networks[s]},p="netconf.networks.".concat(s);if(!(null==n?void 0:n("".concat(p,".").concat(eF)))){let e;try{e=new eY.Netmask("".concat(u,"/").concat(h))}catch(e){return}m[eF]=e.base}(null==n?void 0:n("".concat(p,".").concat(eT)))||(m[eT]=h),c!==e.netconf.gatewayInterface||(null==n?void 0:n("".concat(p,".").concat(eD)))||(m[eD]=e.netconf.gateway),i.netconf.networks[s]=m;let x={...i.hosts[t].networks[s]},f="hosts.".concat(t,".networks.").concat(s);(null==n?void 0:n("".concat(f,".").concat("ip")))||(x.ip=u),i.hosts[t].networks[s]=x}))}),i},eL=(e,n)=>{let t={...e},{[n]:r,...s}=t.netconf.networks;return t.netconf.networks=s,Object.keys(t.hosts).forEach(e=>{let{[e]:r}=t.hosts,{[n]:s,...a}=r.networks;r.networks=a}),t},e$=["bcn","ifn","mn","sn"].map(e=>{var n;return{displayValue:null!=(n=eW.A[e])?n:"Unknown network",value:e}}),eX=e=>{let{networkId:n,showGateway:t}=e,s=eS(eC),a=(0,i.useContext)(eI),l=(0,i.useMemo)(()=>{let e="".concat("netconf.networks",".").concat(n);return{[eD]:"".concat(e,".").concat(eD),[eF]:"".concat(e,".").concat(eF),[eR]:"".concat(e,".").concat(eR),[eE]:"".concat(e,".").concat(eE),[eT]:"".concat(e,".").concat(eT)}},[n]);if(!s||!a)return null;let{changeFieldValue:o,formik:c,getFieldChanged:d,handleChange:u,setValuesKai:h}=s.formikUtils,{hosts:m}=a;return(0,r.jsxs)(q.t$,{mv:0,children:[(0,r.jsxs)(q.WJ,{children:[(0,r.jsxs)(G.A,{container:!0,spacing:"0.1em",width:"100%",children:[(0,r.jsx)(G.A,{width:{xs:"100%",sm:"calc(100% - ".concat("4em",")")},children:(0,r.jsx)(k.A,{id:l[eE],name:l[eE],onChange:e=>{let{value:t}=e.target;h({event:e,values:e=>{let r={...e};return r.netconf.networks[n]={...r.netconf.networks[n],[eE]:t},eZ({getFieldChanged:d,hosts:m,values:r})}}),o(l[eE],t,!0)},required:!0,selectItems:e$,selectProps:{renderValue:e=>"".concat(eW.A[e])},value:c.values.netconf.networks[n][eE]})}),(0,r.jsx)(G.A,{size:"grow",width:{xs:"100%",sm:"4em"},children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:l[eR],label:"#",name:l[eR],onChange:e=>{let{value:t}=e.target;h({debounce:!0,event:e,values:e=>{let r={...e};return r.netconf.networks[n]={...r.netconf.networks[n],[eR]:Number(t)},eZ({getFieldChanged:d,hosts:m,values:r})}})},required:!0,value:c.values.netconf.networks[n][eR]})})})]}),(0,r.jsx)(ew.A,{mapPreset:"delete",onClick:()=>{c.setValues(eL(c.values,n),!0)},sx:{padding:".2em",position:"absolute",right:"-.5em",top:"-.2em"}})]}),(0,r.jsx)(q.BF,{children:(0,r.jsxs)(G.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:l[eF],label:"IP address",name:l[eF],onChange:u,required:!0,value:c.values.netconf.networks[n][eF]})})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:l[eT],label:"Subnet mask",name:l[eT],onChange:u,required:!0,value:c.values.netconf.networks[n][eT]})})}),t&&(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:l[eD],label:"Gateway",name:l[eD],onChange:u,value:c.values.netconf.networks[n][eD]})})})]})})]})};var eG=t(91423);let eK=e=>{let n,t=Object.values(e.netconf.networks);if(t.some(e=>"mn"===e[eE])){let e=t.reduce((e,n)=>{let{[eR]:t=0,[eE]:r}=n;return"ifn"===r?Math.max(e,t):e},0);n={[eD]:"",[eF]:"",[eR]:e+1,[eE]:"ifn",[eT]:""}}else n={[eD]:"",[eF]:"10.199.0.0",[eR]:1,[eE]:"mn",[eT]:"255.255.0.0"};let r={ip:""},s=(0,eG.A)(),a={...e};return a.netconf.networks={...a.netconf.networks,[s]:n},Object.keys(a.hosts).forEach(e=>{let{[e]:n}=a.hosts;n.networks={...n.networks,[s]:r}}),a},eJ=e=>{let{slotProps:n}=e,t=eS(eC),s=(0,i.useMemo)(()=>{let e="netconf";return{[eU]:"".concat(e,".").concat(eU),[eq]:"".concat(e,".").concat(eq),netconf:e,networks:"".concat(e,".networks")}},[]);if(!t)return null;let{formik:a,handleChange:l}=t.formikUtils,o=Object.entries(a.values.netconf.networks);return(0,r.jsxs)(G.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:[o.map(e=>{let[n,t]=e;return(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(eX,{networkId:n,showGateway:"ifn"===t[eE]})},"netconf-network-".concat(n))}),(0,r.jsx)(G.A,{display:"flex",justifyContent:"center",width:"100%",children:(0,r.jsx)(ew.A,{mapPreset:"add",onClick:()=>{a.setValues(eK(a.values),!0)}})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:s[eU],label:"DNS",name:s[eU],onChange:l,value:a.values.netconf[eU]})})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:s[eq],label:"NTP",name:s[eq],onChange:l,value:a.values.netconf[eq]})})})]})},eQ=e=>{let{slotProps:n}=e,t=eS(eC),s=(0,i.useContext)(eI);if(!t||!s)return null;let{formik:a,getFieldChanged:l,setValuesKai:o}=t.formikUtils,{hosts:c}=s;return(0,r.jsxs)(G.A,{columns:{xs:1,sm:2,md:3},container:!0,spacing:"1em",...null==n?void 0:n.container,children:[(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:eN,label:"Prefix",name:eN,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[eN]=n,eZ({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[eN]})})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:eO,label:"Domain name",name:eO,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[eO]=n,eZ({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[eO]})})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:eP,label:"Sequence",name:eP,onChange:e=>{let{value:n}=e.target;o({debounce:!0,event:e,values:e=>{let t={...e};return t[eP]=Number(n),eZ({getFieldChanged:l,hosts:c,values:t})}})},required:!0,value:a.values[eP]})})})]})},e0=e=>{let{slotProps:n}=e;return eS(eC)?(0,r.jsxs)(G.A,{container:!0,spacing:"1em",width:"100%",...null==n?void 0:n.container,children:[(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(eQ,{})}),(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(eJ,{})}),(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(eB,{})})]}):(0,r.jsx)(eM.A,{children:"Missing form context."})};var e1=t(72649),e2=t.n(e1),e3=t(79232),e6=t(45566);let e5=D.Ik({name:D.Yj().required(),uuid:(0,e6.ZC)().required()}),e4=D.Ik({anvil:D.RZ(e=>void 0!==e?e5:D.gl().optional()),number:D.ai(),type:D.Yj(),uuid:(0,e6.ZC)().required()}),e8=D.Yj().when(["rerun"],(e,n)=>e[0]?n.optional():n.required()),e9=D.Ik({confirmPassword:e8.oneOf([D.KR("password")]),description:e8,hosts:D.RZ(e=>D.Ik((0,T.A)(e,e4))),password:e8,rerun:D.zM().required(),reuseHosts:D.zM().when(["hosts"],(e,n)=>{let t=e[0];return t&&Object.values(t).some(e=>!!e.anvil)?n.isTrue():n.isFalse()})}),e7=e=>{let{detail:n,knownFences:t,knownHosts:s,knownUpses:a,onSubmitSuccess:l,tools:o}=e,{anvil:c,domain:u,hostConfig:h,networkConfig:m}=n,{hosts:p}=h,{dnsCsv:x,networks:g,ntpCsv:A}=m,v=(0,i.useMemo)(()=>Object.entries(p),[p]),y=(0,i.useMemo)(()=>Object.entries(g),[g]),I=(0,i.useMemo)(()=>Object.entries(t),[t]),O=(0,i.useMemo)(()=>Object.entries(s),[s]),N=(0,i.useMemo)(()=>Object.entries(a),[a]),q=(0,i.useMemo)(()=>O.map(e=>{let[,{anvil:n,name:t,uuid:s}]=e;return{displayValue:(0,r.jsxs)(ej.A,{spacing:0,children:[(0,r.jsx)(C.a3,{inverted:!0,children:t}),(0,r.jsx)(C.xF,{inverted:!0,children:n?"Used by ".concat(n.name):"Ready"})]}),value:s}}),[O]),{disabledSubmit:D,formik:F,formikErrors:E,handleChange:R}=(0,H.A)({initialValues:{confirmPassword:"",description:"",hosts:v.reduce((e,n)=>{let t,[r,{hostName:a,hostNumber:l,hostType:i}]=n,o="";if(c){let{hosts:{[l]:{uuid:e}}}=c;o=e;let n=s[e];n&&(t=n.anvil)}else if(a){let e=O.find(e=>{let[,{short:n}]=e;return n===a});if(e){let[,n]=e;t=n.anvil,o=n.uuid}}return e[r]={anvil:t,number:l,type:i,uuid:o},e},{}),password:"",rerun:!!c,reuseHosts:!1},onSubmit:(e,t)=>{let{setSubmitting:a}=t,{confirmPassword:i,rerun:c,reuseHosts:d,hosts:h,...m}=e,x={...c?null:m,hosts:Object.values(h).reduce((e,n)=>{let{number:t,type:r,uuid:a}=n,l="".concat(r).concat(t);return e["".concat(r.replace("node","Subnode")," ").concat(t)]={useHost:s[a].name,renameTo:"".concat(p[l].hostName,".").concat(u)},e},{})};o.confirm.prepare({actionProceedText:"Run",content:(0,r.jsx)(M.A,{entries:x,hasPassword:!0}),onCancelAppend:()=>a(!1),onProceedAppend:()=>{o.confirm.loading(!0),j.A.put("/command/run-manifest/".concat(n.uuid),e).then(()=>{o.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Successfully started installing ",n.name]})}),null==l||l.call(null),o.edit.open(!1)}).catch(e=>{let n=(0,P.A)(e);n.children=(0,r.jsxs)(r.Fragment,{children:["Failed to run install manifest. ",n.children]}),o.confirm.finish("Error",n),a(!1)})},titleText:"Run install manifest ".concat(n.name," with the following?")}),o.confirm.open()},validationSchema:e9}),T=(0,i.useMemo)(()=>"confirmPassword",[]),z=(0,i.useMemo)(()=>"description",[]),V=(0,i.useMemo)(()=>"hosts",[]),_=(0,i.useMemo)(()=>"password",[]),B=(0,i.useMemo)(()=>"reuseHosts",[]),W=(0,i.useMemo)(()=>v.reduce((e,n)=>{let[t,{hostNumber:a,hostType:l}]=n,i="".concat(V,".").concat(t),o="".concat(i,".uuid"),c="".concat(l.replace("node","Subnode")," ").concat(a);return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(k.A,{id:o,label:c,name:o,onChange:e=>{let{target:{value:n}}=e,{[n]:{anvil:r}}=s,i=e2()(F.values.hosts),o=Object.entries(i).find(e=>{let[r,{uuid:s}]=e;return r!==t&&s===n});if(o){let[e,n]=o,{number:r,type:s}=n;i[e]={...i[t],number:r,type:s}}return i[t]={anvil:r,number:a,type:l,uuid:n},F.setFieldValue(V,i)},required:!0,selectItems:q,selectProps:{renderValue:e=>{let{[e]:{name:n}}=s;return n}},value:F.values.hosts[t].uuid})},"".concat(t,"-selector"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"Use host"})},"host-selector-header")]),[F,v,q,V,s]),Y=(0,i.useMemo)(()=>v.reduce((e,n)=>{let[t,{hostName:s}]=n;return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(C.NA,{noWrap:!0,children:[s,".",u]})},"".concat(t,"-rename"))),e},[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"New hostname"})},"host-rename-header")]),[v,u]),Z=(0,i.useMemo)(()=>y.reduce((e,n)=>{let[t,s]=n,{networkNumber:a,networkType:l}=s,i="".concat(l.toLocaleUpperCase()).concat(a),o=v.map(e=>{let[n,{networks:s}]=e,a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{children:e})},"".concat(t,"-").concat(n,"-ip"))};if(!s)return a();let{[t]:l}=s;if(!l)return a();let{networkIp:i}=l;return a(i)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:i})},"".concat(t,"-header")),...o),e},[]),[v,y]),L=(0,i.useMemo)(()=>I.reduce((e,n)=>{let[t,s]=n,{fenceName:a}=s,l=v.map(e=>{let[n,{fences:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{children:e})},"".concat(t,"-").concat(n,"-port"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{fencePort:o}=i;return l(o)});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(C.a3,{children:["Plug on ",a]})},"".concat(t,"-header")),...l),e},[]),[v,I]),$=(0,i.useMemo)(()=>N.reduce((e,n)=>{let[t,s]=n,{upsName:a}=s,l=v.map(e=>{let[n,{upses:s}]=e,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{children:e})},"".concat(t,"-").concat(n,"-used"))};if(!s)return l();let{[a]:i}=s;if(!i)return l();let{isUsed:o}=i;return l(o?"yes":"no")});return e.push((0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsxs)(C.a3,{children:["Uses ",a]})},"".concat(t,"-header")),...l),e},[]),[v,N]),X=(0,i.useMemo)(()=>{let e,n=y.find(e=>{let{1:{networkGateway:n}}=e;return!!n}),t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{justifyContent:"end",children:e})},"gateway-value")};if(n){let[,{networkGateway:r}]=n;e=r&&r.length>0?t(r):t()}else e=t();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"Gateway"})},"gateway-header"),e]},[y]),G=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{justifyContent:"end",children:e})},"dns-value")},n=x&&x.length>0?e(x):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"DNS"})},"dns-header"),n]},[x]),K=(0,i.useMemo)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"--";return(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.NA,{justifyContent:"end",children:e})},"ntp-value")},n=A&&A.length>0?e(A):e();return[(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(C.a3,{children:"NTP"})},"ntp-header"),n]},[A]),J=(0,i.useMemo)(()=>{let e=Object.values(F.values.hosts).filter(e=>!!e.anvil);if(0===e.length)return null;let n=e.slice(1).reduce((e,n)=>"".concat(e,", ").concat(s[n.uuid].short),s[e[0].uuid].short);return(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(eM.A,{children:[(0,r.jsx)(e3.A,{id:B,invert:!0,name:B,onChange:F.handleChange,required:!0,sx:{marginRight:".5em"},thinPadding:!0,value:F.values.reuseHosts}),"Confirm reusing host(s): ",n,"."]})})},[F,s,B]);return(0,r.jsxs)(d.Ay,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),F.submitForm()},spacing:"1em",children:[c?(0,r.jsxs)(d.Ay,{item:!0,width:"100%",children:[(0,r.jsx)(C.a3,{children:"Description"}),(0,r.jsx)(C.a3,{children:c.description})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:z,label:"Description",name:z,onChange:R,required:!0,value:F.values.description})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{disableAutofill:!0,id:_,label:"Password",name:_,onChange:R,required:!0,type:w.A.password,value:F.values.password})})}),(0,r.jsx)(d.Ay,{item:!0,xs:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{disableAutofill:!0,id:T,label:"Confirm password",name:T,onChange:R,required:!0,type:w.A.password,value:F.values.confirmPassword})})})]}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{alignItems:"center",columns:v.length+1,columnSpacing:"1em",container:!0,rowSpacing:".6em",children:[...W,...Y,...Z,...L,...$]})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsxs)(d.Ay,{columns:2,container:!0,spacing:".6em",children:[...X,...G,...K]})}),J,(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(U.A,{count:1,messages:E})}),(0,r.jsx)(d.Ay,{item:!0,width:"100%",children:(0,r.jsx)(f.A,{actions:[{background:"blue",children:"Run",disabled:D,type:"submit"}]})})]})},ne=e=>{let{hostConfig:{hosts:n}}=e,t=Object.values(n).reduce((e,n)=>{let{fences:t,hostType:r,hostNumber:s}=n,a="".concat(r.replace(/node/,"subnode")).concat(s);return t?e[a]=Object.values(t).reduce((e,n)=>{let{fencePort:t}=n;return e+ +!!t.length},0):e[a]=0,e},{}),r=Object.entries(t).map(e=>{let[n,t]=e;return t?null:(0,i.createElement)(eM.A,{key:"".concat(n,"-no-fence-port-message")},"No fence device port specified for ".concat(n,"."))});return{counts:t,messages:r}},nn=function(e,n,t){var r,s;let a,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{[eR]:i=0,[eE]:o}=t,c="".concat(o).concat(i),d=10+2*(e-1),u=0;switch(o){case"bcn":u=200+Number(i),a="10.".concat(u,".").concat(d,".").concat(n);break;case"mn":u=199,a="10.".concat(u,".").concat(d,".").concat(n);break;case"sn":u=100+Number(i),a="10.".concat(u,".").concat(d,".").concat(n);break;default:a=""}return null!=(s=null==(r=l[c])?void 0:r.networkIp)?s:a},nt=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,t)=>{var r,s;let{fenceName:a,fenceUUID:l}=t;return e[l]={[ez]:null!=(s=null==(r=n[a])?void 0:r.fencePort)?s:""},e},t)},nr=function(e,n,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t.reduce((t,s)=>{let[a,l]=s;return t[a]={ip:nn(e,n,l,r)},t},s)},ns=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.reduce((e,t)=>{var r,s;let{upsName:a,upsUUID:l}=t;return e[l]={[eV]:null!=(s=null==(r=n[a])?void 0:r.isUsed)&&s},e},t)},na=(e,n,t)=>{let r={[eO]:"",[eN]:"",[eP]:1,netconf:{[eU]:"",[eq]:"",networks:{}},hosts:{}},s=Object.values(e.fences),a=Object.values(e.upses);if(t){r[eO]=t.domain,r[eN]=t.prefix,r[eP]=t.sequence;let{hostConfig:e,networkConfig:n}=t;r.netconf[eU]=n.dnsCsv,r.netconf[eq]=n.ntpCsv,Object.values(n.networks).forEach(e=>{let{networkGateway:n,networkMinIp:t,networkNumber:s,networkSubnetMask:a,networkType:l}=e,i=(0,eG.A)();r.netconf.networks[i]={[eD]:n,[eF]:t,[eR]:s,[eE]:l,[eT]:a}}),Object.values(e.hosts).forEach(e=>{let{hostNumber:n,ipmiIp:l=""}=e;r.hosts[n]={[eH]:l,fences:nt(s,e.fences),networks:nr(t.sequence,n,Object.entries(r.netconf.networks),e.networks),upses:ns(a,e.upses)}})}else r[eO]=e.domain,r[eN]=e.prefix,r[eP]=e.sequence,r.netconf.networks={defaultbcn:{[eD]:"",[eF]:"10.201.0.0",[eR]:1,[eE]:"bcn",[eT]:"255.255.0.0"},defaultifn:{[eD]:"",[eF]:"",[eR]:1,[eE]:"ifn",[eT]:""},defaultmn:{[eD]:"",[eF]:"10.199.0.0",[eR]:1,[eE]:"mn",[eT]:"255.255.0.0"},defaultsn:{[eD]:"",[eF]:"10.101.0.0",[eR]:1,[eE]:"sn",[eT]:"255.255.0.0"}},r.netconf[eU]="8.8.8.8,8.8.4.4",[1,2].forEach(n=>{r.hosts[n]={[eH]:"",fences:nt(s),networks:nr(e.sequence,n,Object.entries(r.netconf.networks)),upses:ns(a)}}),r=eZ({hosts:n,values:r});return r},nl=(e,n)=>Object.entries(n).reduce((n,t)=>{let[r,s]=t,{[ez]:a=""}=s,{[r]:l}=e;return n[r]={fenceName:l.fenceName,fencePort:a},n},{}),ni=(e,n)=>Object.entries(n).reduce((n,t)=>{let[r,s]=t,{ip:a}=s,{[r]:l}=e,{[eR]:i=0,[eE]:o=""}=l;return n["".concat(o).concat(i)]={networkIp:a,networkNumber:i,networkType:o},n},{}),no=(e,n)=>Object.entries(n).reduce((n,t)=>{let[r,s]=t,{[eV]:a=!1}=s,{[r]:l}=e;return n[r]={isUsed:a,upsName:l.upsName},n},{}),nc=(e,n)=>Object.entries(n.hosts).reduce((t,r)=>{let[s,a]=r,{[eH]:l,fences:i,networks:o,upses:c}=a,d="node";return t["".concat(d).concat(s)]={fences:nl(e.fences,i),hostNumber:Number(s),hostType:d,ipmiIp:l,networks:ni(n.netconf.networks,o),upses:no(e.upses,c)},t},{}),nd=e=>Object.values(e).reduce((e,n)=>{let{[eD]:t,[eF]:r="",[eR]:s=0,[eE]:a="",[eT]:l=""}=n;return e["".concat(a).concat(s)]={networkGateway:t,networkMinIp:r,networkNumber:s,networkSubnetMask:l,networkType:a},e},{}),nu=(e,n)=>{let{[eO]:t,[eN]:r,[eP]:s,netconf:a}=n,{[eU]:l="",[eq]:i="",networks:o}=a;return{domain:t,hostConfig:{hosts:nc(e,n)},networkConfig:{dnsCsv:l,networks:nd(o),ntpCsv:i},prefix:r,sequence:s}};var nh=t(23192),nm=t(57656),np=t(44193);let nx=e=>({exclusive:!0,message:"${path} already exists",name:"duplicate-name",test:(n,t)=>{let{createError:r,parent:s}=t,{[eN]:a,[eP]:l}=s,i=String(l).padStart(2,"0"),o="".concat(a,"-anvil-").concat(i);return!e.includes(o)||r({message:"".concat(o," already exists")})}}),nf=()=>D.Ik({[ez]:D.Yj()}),nj=()=>D.Ik({ip:(0,e6.W5)().required()}),ng=()=>D.Ik({[eV]:D.zM()}),nA=()=>D.Ik({[eH]:(0,e6.W5)(),fences:D.RZ(e=>D.Ik((0,T.A)(e,nf()))),networks:D.RZ(e=>D.Ik((0,T.A)(e,nj()))),upses:D.RZ(e=>D.Ik((0,T.A)(e,ng())))}),nv=()=>D.Ik({[eD]:(0,e6.W5)(),[eF]:(0,e6.W5)(),[eE]:D.Yj().oneOf(["bcn","ifn","mn","sn"]),[eR]:D.ai().min(1),[eT]:(0,e6.W5)()}),nw=()=>D.Ik({[eU]:D.Yj(),[eq]:D.Yj(),networks:D.RZ(e=>D.Ik((0,T.A)(e,nv())))}),nb=function(e){let n,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t&&(n=e=>e.manifestName!==t);let r=(0,e6.fD)(e,e=>e.manifestName,{filterBy:n});return D.Ik({[eO]:D.Yj().required(),[eN]:D.Yj().min(1).max(5).required().test(nx(r)),[eP]:D.ai().min(1).required().test(nx(r)),netconf:nw(),hosts:D.RZ(e=>D.Ik((0,T.A)(e,nA())))})},nk=()=>{let e=(0,i.useRef)(null),n=(0,i.useRef)(null),t=(0,i.useRef)(null),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(),{data:c,loading:d,mutate:u}=(0,Y.A)("/manifest",{refreshInterval:6e4}),{data:h,loading:m,mutate:p}=(0,Y.A)("/manifest/template"),{data:x,loading:f,mutate:j}=(0,Y.A)("/host?detail=1&type=subnode"),{fetch:g,loading:A}=(0,nh.A)({onData:e=>o(e),url:"/manifest"}),v=(0,np.A)([]),{buildDeleteDialogProps:w,checks:b,getCheck:k,hasChecks:y,resetChecks:S,setCheck:I}=(0,nm.A)({list:c}),M=(0,eh.A)({initial:{scrollContent:!0,wide:!0}}),{confirmDialog:O,finishConfirm:N,setConfirmDialogLoading:P,setConfirmDialogOpen:U,setConfirmDialogProps:D}=M,F=(0,i.useMemo)(()=>({add:{open:()=>null},confirm:{finish:N,loading:P,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return U(e)},prepare:D},edit:{open:function(){var e;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==t||null==(e=t.current)?void 0:e.setOpen(n)}}}),[N,P,U,D]),E=d||m||f,R=E||A,T=(0,i.useMemo)(()=>h&&x&&l&&(0,r.jsx)(e7,{detail:l,knownFences:h.fences,knownHosts:x,knownUpses:h.upses,onSubmitSuccess:()=>{p(),j()},tools:F}),[F,j,p,x,l,h]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(q.Zk,{children:[(0,r.jsx)(q.aO,{children:(0,r.jsx)(C.HM,{children:"Manage manifests"})}),(0,r.jsx)(eb.A,{allowEdit:!0,allowItemButton:s,disableDelete:!y,edit:s,header:!0,listEmpty:"No manifest(s) registered.",listItems:c,loading:E,onAdd:()=>{var n;null==(n=e.current)||n.setOpen(!0)},onDelete:()=>{M.setConfirmDialogProps(w({getConfirmDialogTitle:e=>"Delete ".concat(e," manifest(s)?"),onProceedAppend:()=>{v.submitForm({body:{uuids:b},getErrorMsg:e=>(M.finishConfirm("Error",{children:"Delete manifest(s) failed. ".concat(e)}),null),method:"delete",onSuccess:()=>{S(),u(),M.setConfirmDialogOpen(!1)},url:"/manifest"})},renderEntry:e=>{let{key:n}=e;return(0,r.jsx)(C.a3,{children:null==c?void 0:c[n].manifestName})}})),M.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,n,t)=>{I(e,t)},onItemClick:e=>{var t;let{manifestUUID:r}=e;null==(t=n.current)||t.setOpen(!0),g("/".concat(r))},renderListItemCheckboxState:e=>k(e),renderListItem:(e,n)=>{let{manifestName:a}=n;return(0,r.jsxs)(ej.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(ew.A,{disabled:s,mapPreset:"play",onClick:()=>{var n;null==(n=t.current)||n.setOpen(!0),g("/".concat(e))},variant:"normal"}),(0,r.jsx)(C.a3,{children:a})]})}})]}),(0,r.jsx)(ef.K_,{header:"Add an install manifest",loading:E,ref:e,showClose:!0,wide:!0,children:c&&h&&x&&(0,r.jsx)(ey,{config:{initialValues:na(h,x),onSubmit:(n,t)=>{let s=nu(h,n);(0,ev.A)({confirm:M,getRequestBody:(e,n)=>n,getSummary:()=>s,header:"Add install manifest with the following?",helpers:t,onError:()=>"Failed to add install manifest.",onSuccess:()=>{var n;return u(),null==(n=e.current)||n.setOpen(!1),"Successfully added install manifest"},operation:"add",slotProps:{confirm:{preActionArea:(0,r.jsx)(ej.A,{spacing:".3em",children:ne(s).messages})},summary:{maxDepth:6}},url:"/manifest",values:n})},validationSchema:nb(c)},operation:"add",children:(0,r.jsx)(eI,{value:{hosts:x,template:h},children:(0,r.jsx)(eA,{children:(0,r.jsx)(e0,{})})})})}),(0,r.jsx)(ef.K_,{header:"Update install manifest ".concat(null==l?void 0:l.name),loading:R,ref:n,showClose:!0,wide:!0,children:c&&h&&x&&l&&(0,r.jsx)(ey,{config:{initialValues:na(h,x,l),onSubmit:(e,t)=>{let s=nu(h,e);(0,ev.A)({confirm:M,getRequestBody:(e,n)=>n,getSummary:()=>s,header:"Update install manifest ".concat(l.name," with the following?"),helpers:t,onError:()=>"Failed to update install manifest.",onSuccess:()=>{var e;return u(),null==(e=n.current)||e.setOpen(!1),"Successfully updated install manifest ".concat(l.name)},operation:"edit",slotProps:{confirm:{preActionArea:(0,r.jsx)(ej.A,{spacing:".3em",children:ne(s).messages})},summary:{maxDepth:6}},url:"/manifest/".concat(l.uuid),values:e})},validationSchema:nb(c,l.name)},operation:"edit",children:(0,r.jsx)(eI,{value:{hosts:x,template:h},children:(0,r.jsx)(eA,{children:(0,r.jsx)(e0,{})})})})}),(0,r.jsx)(ef.K_,{header:"".concat((null==l?void 0:l.anvil)?"Rerun":"Run"," install manifest ").concat(null==l?void 0:l.name),loading:R,ref:t,showClose:!0,wide:!0,children:T}),O]})},{Form:ny,FormContext:nC,useFormContext:nS}=(0,ek.A)();var nI=t(19659);let nM="common-ups-input-ip-address",nO="common-ups-input-host-name",nN="add-ups-select-ups-type-id",nP=(0,eg.Ay)(nI.A)({color:J.Uv,display:"inline-flex",textDecorationColor:J.Uv}),nU=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{loading:a,upsTemplate:l}=s,o=nS(nC),c=(0,i.useMemo)(()=>Object.entries(l).map(e=>{let n,[t,{brand:s,description:a,links:{0:l}}]=e;if(l){let{linkHref:e,linkLabel:t}=l;n=(0,r.jsx)(nP,{href:e,onClick:e=>{e.stopPropagation()},target:"_blank",children:t})}return{displayValue:(0,r.jsxs)(ej.A,{spacing:0,children:[(0,r.jsx)(C.a3,{inverted:!0,children:s}),(0,r.jsxs)(C.a3,{inverted:!0,children:[a," (",n,")"]})]}),value:t}}),[l]);if(!o)return(0,r.jsx)(eM.A,{type:"error",children:"Missing form context."});let{changeFieldValue:d,formik:u,handleChange:h}=o.formikUtils;return a?(0,r.jsx)(eu.A,{}):(0,r.jsxs)(G.A,{columns:{xs:1,sm:2},container:!0,spacing:"1em",width:"100%",children:[(0,r.jsx)(G.A,{width:"100%",children:(0,r.jsx)(k.A,{id:nN,label:"UPS type",name:nN,onChange:e=>{let{value:n}=e.target;d(nN,n,!0)},required:!0,selectItems:c,selectProps:{onClearIndicatorClick:()=>{d(nN,"",!0)},renderValue:e=>{let{brand:n}=l[String(e)];return n}},value:u.values[nN]})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:nO,label:"Host name",name:nO,onChange:h,required:!0,value:u.values[nO]})})}),(0,r.jsx)(G.A,{size:1,children:(0,r.jsx)(S.A,{input:(0,r.jsx)(b.A,{id:nM,label:"IP address",name:nM,onChange:h,required:!0,value:u.values[nM]})})})]})},nq=(e,n)=>{var t,r,s;let a=null!=(t=Object.keys(e).find(t=>{let{[t]:r}=e;return(null==n?void 0:n.upsAgent)===r.agent}))?t:"";return{[nM]:null!=(r=null==n?void 0:n.upsIPAddress)?r:"",[nO]:null!=(s=null==n?void 0:n.upsName)?s:"",[nN]:a}},nD=(e,n)=>{let t;e&&(t=n=>n.upsUUID!==e);let r=(0,e6.fD)(n,e=>e.upsName,{filterBy:t});return D.Yj().notOneOf(r,"${path} already exists")},nF=function(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Object.keys(n);return D.Ik({[nM]:(0,e6.W5)().required(),[nO]:nD(t,e).required(),[nN]:D.Yj().required().oneOf(r)})},nE=()=>{let e=(0,i.useRef)(null),n=(0,i.useRef)(null),t=(0,eh.A)(),[s,a]=(0,i.useState)(!1),[l,o]=(0,i.useState)(""),{data:c,loading:d}=(0,Y.A)("/ups/template"),{data:u,loading:h,mutate:m}=(0,Y.A)("/ups",{refreshInterval:6e4}),p=null==u?void 0:u[l],{buildDeleteDialogProps:x,checks:f,getCheck:j,hasChecks:g,resetChecks:A,setCheck:v}=(0,nm.A)({list:u}),w=(0,np.A)([]),b=h||d;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(q.Zk,{children:[(0,r.jsx)(q.aO,{children:(0,r.jsx)(C.HM,{children:"Manage UPSes"})}),(0,r.jsx)(eb.A,{allowEdit:!0,allowItemButton:s,disableDelete:!g,edit:s,header:!0,listEmpty:"No Ups(es) registered.",listItems:u,loading:h,onAdd:()=>{var n;null==(n=e.current)||n.setOpen(!0)},onDelete:()=>{t.setConfirmDialogProps(x({getConfirmDialogTitle:e=>"Delete ".concat(e," UPSes?"),onProceedAppend:()=>{w.submitForm({body:{uuids:f},getErrorMsg:e=>(t.finishConfirm("Error",{children:"Failed to delete UPS(es). ".concat(e)}),null),method:"delete",onSuccess:()=>{A(),m(),t.setConfirmDialogOpen(!1)},url:"/ups"})},renderEntry:e=>{let{key:n}=e;return(0,r.jsx)(C.a3,{children:null==u?void 0:u[n].upsName})}})),t.setConfirmDialogOpen(!0)},onEdit:()=>{a(e=>!e)},onItemCheckboxChange:(e,n,t)=>{v(e,t)},onItemClick:e=>{var t;o(e.upsUUID),null==(t=n.current)||t.setOpen(!0)},renderListItemCheckboxState:e=>j(e),renderListItem:(e,n)=>{let{upsAgent:t,upsIPAddress:s,upsName:a}=n;return(0,r.jsxs)(ej.A,{fullWidth:!0,row:!0,children:[(0,r.jsx)(C.a3,{children:a}),(0,r.jsxs)(C.a3,{children:['agent="',t,'"']}),(0,r.jsxs)(C.a3,{children:['ip="',s,'"']})]})}})]}),(0,r.jsx)(ef.K_,{header:"Add a UPS",loading:b,ref:e,showClose:!0,wide:!0,children:u&&c&&(0,r.jsx)(ny,{config:{initialValues:nq(c),onSubmit:(n,s)=>{let{[nM]:a,[nO]:l,[nN]:i}=n,{agent:o,brand:d}=c[i];(0,ev.A)({confirm:t,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:""}),getSummary:()=>({brand:d,name:l,ipAddress:a}),header:(0,r.jsx)(C.HM,{children:"Add a UPS with the following data?"}),helpers:s,onError:()=>"Failed to add UPS.",onSuccess:()=>{var n;return m(),null==(n=e.current)||n.setOpen(!1),"Successfully added UPS ".concat(l)},operation:"add",url:"/ups",values:n})},validationSchema:nF(u,c)},operation:"add",children:(0,r.jsx)(nU,{upsTemplate:c})})}),(0,r.jsx)(ef.K_,{header:p&&(0,r.jsxs)(C.HM,{children:["Update UPS"," ",(0,r.jsx)(C.kp,{fontSize:"inherit",children:p.upsName})]}),loading:b,ref:n,showClose:!0,wide:!0,children:u&&c&&p&&(0,r.jsx)(ny,{config:{initialValues:nq(c,p),onSubmit:(e,s)=>{let{[nM]:a,[nO]:l,[nN]:i}=e,{agent:o,brand:d}=c[i];(0,ev.A)({confirm:t,getRequestBody:()=>({agent:o,brand:d,ipAddress:a,name:l,typeId:i,uuid:p.upsUUID}),getSummary:()=>({brand:d,name:l,ipAddress:a,uuid:p.upsUUID}),header:(0,r.jsxs)(C.HM,{children:["Update"," ",(0,r.jsx)(C.kp,{fontSize:"inherit",children:l})," ","with the following data?"]}),helpers:s,onError:()=>"Failed to update UPS.",onSuccess:()=>{var e;return m(),null==(e=n.current)||e.setOpen(!1),"Successfully updated UPS ".concat(p.upsName)},operation:"edit",url:"/ups/".concat(p.upsUUID),values:e})},validationSchema:nF(u,c,p.upsUUID)},operation:"edit",children:(0,r.jsx)(nU,{upsTemplate:c})})}),t.confirmDialog]})};var nR=t(87986);let nT="prepare-host",nz="prepare-network",nH="manage-fence",nV="manage-ups",n_="manage-manifest",nB={[nT]:"Prepare Host",[nz]:"Prepare Network",[nH]:"Manage Fence Devices",[nV]:"Manage UPSes",[n_]:"Manage Manifests"},nW="Loading",nY=()=>(0,r.jsx)(nR.A,{children:(0,r.jsx)($.g,{})}),nZ=()=>(0,r.jsx)(nR.A,{children:(0,r.jsx)(ex,{})}),nL=()=>(0,r.jsx)(nR.A,{children:(0,r.jsx)(L,{})}),n$=()=>(0,r.jsx)(nR.A,{children:(0,r.jsx)(nE,{})}),nX=()=>(0,r.jsx)(nR.A,{children:(0,r.jsx)(nk,{})}),nG=()=>{let{isReady:e,push:n,query:t}=(0,l.useRouter)(),[s,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(nW);return(0,i.useEffect)(()=>{if(!e)return;let{step:r}=t,a=(0,o.A)(r,{fallbackValue:nT});nB[a]||(a=nT),n({query:{...t,step:a}},void 0,{shallow:!0}),u===nW&&h(nB[a]),s||d(a)},[e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{children:(0,r.jsx)("title",{children:u})}),(0,r.jsx)(c.A,{}),(0,r.jsx)(q.Zk,{children:(0,r.jsxs)(ee.A,{onChange:(e,r)=>{d(r),h(nB[r]),n({query:{...t,step:r}},void 0,{shallow:!0})},orientation:{xs:"vertical",sm:"horizontal"},value:s,children:[(0,r.jsx)(Q.A,{label:"Prepare host",value:nT}),(0,r.jsx)(Q.A,{label:"Prepare network",value:nz}),(0,r.jsx)(Q.A,{label:"Manage fence devices",value:nH}),(0,r.jsx)(Q.A,{label:"Manage UPSes",value:nV}),(0,r.jsx)(Q.A,{label:"Manage manifests",value:n_})]})}),(0,r.jsx)(ep.A,{changingTabId:s,tabId:nT,children:(0,r.jsx)(nY,{})}),(0,r.jsx)(ep.A,{changingTabId:s,tabId:nz,children:(0,r.jsx)(nZ,{})}),(0,r.jsx)(ep.A,{changingTabId:s,tabId:nH,children:(0,r.jsx)(nL,{})}),(0,r.jsx)(ep.A,{changingTabId:s,tabId:nV,children:(0,r.jsx)(n$,{})}),(0,r.jsx)(ep.A,{changingTabId:s,tabId:n_,children:(0,r.jsx)(nX,{})})]})}},57212:(e,n,t)=>{"use strict";t.d(n,{A:()=>w});var r=t(14232),s=t(69241),a=t(4697),l=t(40393),i=t(80027),o=t(78457),c=t(26872),d=t(54773),u=t(29548),h=t(52196),m=t(48452),p=t(67360),x=t(37876);let f=e=>{let{classes:n,edge:t,size:r,color:s,checked:l,disabled:o}=e,c={root:["root",t&&"edge".concat((0,i.A)(t)),"size".concat((0,i.A)(r))],switchBase:["switchBase","color".concat((0,i.A)(s)),l&&"checked",o&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},d=(0,a.A)(c,m.n,n);return{...n,...d}},j=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.root,t.edge&&n["edge".concat((0,i.A)(t.edge))],n["size".concat((0,i.A)(t.size))]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,["& .".concat(m.A.thumb)]:{width:16,height:16},["& .".concat(m.A.switchBase)]:{padding:4,["&.".concat(m.A.checked)]:{transform:"translateX(16px)"}}}}]}),g=(0,d.Ay)(c.A,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.switchBase,{["& .".concat(m.A.input)]:n.input},"default"!==t.color&&n["color".concat((0,i.A)(t.color))]]}})((0,u.A)(e=>{let{theme:n}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:"".concat("light"===n.palette.mode?n.palette.common.white:n.palette.grey[300]),transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),["&.".concat(m.A.checked)]:{transform:"translateX(20px)"},["&.".concat(m.A.disabled)]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:"".concat("light"===n.palette.mode?n.palette.grey[100]:n.palette.grey[600])},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{opacity:.5},["&.".concat(m.A.disabled," + .").concat(m.A.track)]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:"".concat("light"===n.palette.mode?.12:.2)},["& .".concat(m.A.input)]:{left:"-100%",width:"300%"}}}),(0,u.A)(e=>{let{theme:n}=e;return{"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette.action.activeChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,l.X4)(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(n.palette).filter((0,o.A)(["light"])).map(e=>{let[t]=e;return{props:{color:t},style:{["&.".concat(m.A.checked)]:{color:(n.vars||n).palette[t].main,"&:hover":{backgroundColor:n.vars?"rgba(".concat(n.vars.palette[t].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,l.X4)(n.palette[t].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(m.A.disabled)]:{color:n.vars?n.vars.palette.Switch["".concat(t,"DisabledColor")]:"".concat("light"===n.palette.mode?(0,l.a)(n.palette[t].main,.62):(0,l.e$)(n.palette[t].main,.55))}},["&.".concat(m.A.checked," + .").concat(m.A.track)]:{backgroundColor:(n.vars||n).palette[t].main}}}})]}})),A=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,n)=>n.track})((0,u.A)(e=>{let{theme:n}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:"".concat("light"===n.palette.mode?n.palette.common.black:n.palette.common.white),opacity:n.vars?n.vars.opacity.switchTrack:"".concat("light"===n.palette.mode?.38:.3)}})),v=(0,d.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,n)=>n.thumb})((0,u.A)(e=>{let{theme:n}=e;return{boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),w=r.forwardRef(function(e,n){let t=(0,h.b)({props:e,name:"MuiSwitch"}),{className:r,color:a="primary",edge:l=!1,size:i="medium",sx:o,slots:c={},slotProps:d={},...u}=t,m={...t,color:a,edge:l,size:i},w=f(m),b={slots:c,slotProps:d},[k,y]=(0,p.A)("root",{className:(0,s.A)(w.root,r),elementType:j,externalForwardedProps:b,ownerState:m,additionalProps:{sx:o}}),[C,S]=(0,p.A)("thumb",{className:w.thumb,elementType:v,externalForwardedProps:b,ownerState:m}),I=(0,x.jsx)(C,{...S}),[M,O]=(0,p.A)("track",{className:w.track,elementType:A,externalForwardedProps:b,ownerState:m});return(0,x.jsxs)(k,{...y,children:[(0,x.jsx)(g,{type:"checkbox",icon:I,checkedIcon:I,ref:n,ownerState:m,...u,classes:{...w,root:w.switchBase},slots:{...c.switchBase&&{root:c.switchBase},...c.input&&{input:c.input}},slotProps:{...d.switchBase&&{root:"function"==typeof d.switchBase?d.switchBase(m):d.switchBase},...d.input&&{input:"function"==typeof d.input?d.input(m):d.input}}}),(0,x.jsx)(M,{...O})]})})},67281:(e,n,t)=>{"use strict";t.d(n,{A:()=>h});var r=t(37876),s=t(88824),a=t(14232),l=t(63190);let i=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,operation:i,slotProps:o}=s,c={background:"blue",disabled:a.disabledSubmit,type:"submit",...null==o?void 0:o.submit};switch(i){case"add":c.children="Add";break;case"delete":c.background="red",c.children="Delete";break;default:c.children="Save"}return(0,r.jsx)(l.A,{actions:[c],...null==o?void 0:o.group})},o=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[a]=n,{children:l,formikUtils:i,slotProps:o}=a;return(0,r.jsx)(s.A,{component:"form",container:!0,onSubmit:e=>{e.preventDefault(),i.formik.handleSubmit(e)},spacing:"1em",width:"100%",...null==o?void 0:o.grid,children:l})};var c=t(71401);let d=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let[s]=n,{formikUtils:a,slotProps:l}=s;return(0,r.jsx)(c.A,{count:1,messages:a.formikErrors,...null==l?void 0:l.messageGroup})};var u=t(71986);let h=e=>{var n,t;let l=(0,a.createContext)(null!=(t=null==e||null==(n=e.context)?void 0:n.defaultValue)?t:null);return{Form:e=>{let{children:n,config:t,operation:c,slotProps:h}=e,m=(0,u.A)(t),p=(0,a.useMemo)(()=>({formikUtils:m}),[m]);return(0,r.jsxs)(o,{formikUtils:m,...null==h?void 0:h.grid,children:[(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(l,{value:p,children:n})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(d,{formikUtils:m,...null==h?void 0:h.messages})}),(0,r.jsx)(s.A,{width:"100%",children:(0,r.jsx)(i,{formikUtils:m,operation:c,...null==h?void 0:h.actions})})]})},FormContext:l,useFormContext:a.useContext}}},88851:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-element",function(){return t(45997)}])},91686:(e,n,t)=>{"use strict";t.d(n,{A:()=>d});var r=t(14232),s=t(52627),a=t(23934),l=t(5806);let i=e=>({finish:e.finishConfirm,loading:e.setConfirmDialogLoading,open:function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e.setConfirmDialogOpen(n)},prepare:e.setConfirmDialogProps}),o=e=>{switch(e){case"add":return"post";case"delete":return"delete";default:return"put"}},c=e=>{switch(e){case"add":return"Add";case"delete":return"Delete";default:return"Save"}},d=e=>{let{description:n,getRequestBody:t,getSummary:d,header:u,helpers:h,onError:m,onSuccess:p,operation:x,slotProps:f,tools:j,url:g,values:A,method:v=o(x)}=e,w=e.confirm?i(e.confirm):null==j?void 0:j.confirm,b=null==d?void 0:d(A),k={actionProceedText:c(x),content:null!=n?n:(0,r.createElement)(s.A,{entries:null!=b?b:A,...null==f?void 0:f.summary}),onCancelAppend:()=>h.setSubmitting(!1),onProceedAppend:()=>{null==w||w.loading(!0);let e=null==t?void 0:t(A,b);a.A.request({data:e,method:v,url:g}).then(()=>{null==w||w.finish("Success",{children:null==p?void 0:p()}),null==j||j.add.open(!1),null==j||j.edit.open(!1)}).catch(e=>{let n=(0,l.A)(e);n.children=(0,r.createElement)(r.Fragment,null,null==m?void 0:m(e)," ",n.children),null==w||w.finish("Error",n)})},proceedColour:"delete"===x?"red":"blue",titleText:u,...null==f?void 0:f.confirm};null==w||w.prepare(k),null==w||w.open(!0)}}},e=>{var n=n=>e(e.s=n);e.O(0,[325,208,3,925,623,261,296,82,923,901,133,732,223,603,437,679,636,593,792],()=>n(88851)),_N_E=e.O()}]);