(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{29582:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-element",function(){return n(28923)}])},96674:function(e,t,n){"use strict";var r=n(85893),s=n(89256),l=n(62191),a=n(89262),o=n(59879),i=n(324),c=n(28721),d=n(73315),u=n(14440),h=n(55074),m=n(67294),p=n(77831),x=n(34635),f=n(91029);let g=e=>(0,r.jsx)(s.Z,{in:!0,children:(0,r.jsx)(l.Z,{...e})}),j=(0,a.ZP)("ul")({padding:0}),v=o.Z;t.Z=e=>{let{componentsProps:t,extendRenderInput:n,getGroupLabel:s,label:l,messageBoxProps:a,renderGroup:o,renderInput:Z,sx:b,...w}=e,k=(0,m.useMemo)(()=>({paper:{sx:{backgroundColor:p.lD,["& .".concat(i.Z.groupLabel)]:{backgroundColor:p.lD}}},...t}),[t]),y=(0,m.useMemo)(()=>o||s&&(e=>(0,r.jsxs)("li",{children:[(0,r.jsx)(v,{component:"div",className:i.Z.groupLabel,children:s(e.group)}),(0,r.jsx)(j,{className:i.Z.groupUl,children:e.children})]},e.key)),[s,o]),M=(0,m.useMemo)(()=>null!=Z?Z:e=>{let{fullWidth:t,InputProps:s,InputLabelProps:a,inputProps:o}=e,i={formControlProps:{fullWidth:t,ref:s.ref},inputLabelProps:a,inputProps:{className:s.className,endAdornment:s.endAdornment,inputProps:o,startAdornment:s.startAdornment},label:l};return null==n||n.call(null,i,e),(0,r.jsx)(f.Z,{...i})},[n,l,Z]),P=(0,m.useMemo)(()=>({["& .".concat(c.Z.root," .").concat(i.Z.endAdornment)]:{right:"7px",["& .".concat(d.Z.root)]:{color:p.s7}},...b}),[b]);return(0,r.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,r.jsx)(h.Z,{PaperComponent:g,...w,componentsProps:k,renderGroup:y,renderInput:M,sx:P}),(0,r.jsx)(x.Z,{...a})]})}},78533:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(98484),a=n(33544),o=n(97607),i=n(83916),c=n(68805),d=n(85291),u=n(2188),h=n(77510);let m=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"function"==typeof e?e(...n):e};t.Z=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[p]=t,{addHeader:x,editHeader:f,entriesUrl:g,formDialogProps:j,getAddLoading:v,getDeleteErrorMessage:Z,getDeleteHeader:b,getDeletePromiseChain:w=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},getDeleteSuccessMessage:k,getEditLoading:y=e=>e,listEmpty:M,listProps:P,onItemClick:C=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e(...n)},refreshInterval:S=5e3,renderAddForm:I,renderDeleteItem:A,renderEditForm:F,renderListItem:T,entryUrlPrefix:U=g}=p,O=(0,s.useRef)(null),N=(0,s.useRef)(null),{confirmDialog:R,finishConfirm:E,setConfirmDialogLoading:D,setConfirmDialogOpen:q,setConfirmDialogProps:B}=(0,u.Z)({initial:{scrollContent:!0}}),[_,H]=(0,s.useState)(!1),[L,z]=(0,s.useState)(),{data:V,mutate:G,loading:$}=(0,h.Z)(g,{refreshInterval:S}),{fetch:W,loading:J}=(0,c.Z)({onData:e=>z(e),url:U}),Q=(0,s.useMemo)(()=>m(x),[x]),K=(0,s.useMemo)(()=>m(f,L),[L,f]),X=(0,s.useMemo)(()=>({add:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==O?void 0:null===(e=O.current)||void 0===e?void 0:e.setOpen(t)}},confirm:{finish:E,loading:D,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return q(e)},prepare:B},edit:{open:function(){var e;let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return null==N?void 0:null===(e=N.current)||void 0===e?void 0:e.setOpen(t)}}}),[E,D,q,B]),{buildDeleteDialogProps:Y,checks:ee,getCheck:et,hasAllChecks:en,hasChecks:er,multipleItems:es,resetChecks:el,setAllChecks:ea,setCheck:eo}=(0,d.Z)({list:V});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{allowCheckAll:es,allowEdit:!0,allowItemButton:_,disableDelete:!er,edit:_,getListCheckboxProps:()=>({checked:en,onChange:(e,t)=>ea(t)}),getListItemCheckboxProps:e=>({checked:et(e),onChange:(t,n)=>eo(e,n)}),header:!0,listEmpty:M,listItems:V,loading:$,onAdd:()=>{var e;return null==O?void 0:null===(e=O.current)||void 0===e?void 0:e.setOpen(!0)},onDelete:()=>{B(Y({onProceedAppend:()=>{D(!0),Promise.all(w((e,t)=>e.map(e=>l.Z.delete("".concat(t,"/").concat(e))),ee,g)).then(()=>{E("Success",k()),G()}).catch(e=>{E("Error",Z((0,o.Z)(e)))}).finally(()=>{el()})},getConfirmDialogTitle:b,renderEntry:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return A(V,...t)}})),q(!0)},onEdit:()=>H(e=>!e),onItemClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return C((e,t)=>{var n;null==N||null===(n=N.current)||void 0===n||n.setOpen(!0),W("/".concat(t))},...t)},renderListItem:T,...P}),(0,r.jsx)(a.Js,{header:Q,loading:null==v?void 0:v.call(null),ref:O,showClose:!0,...null==j?void 0:j.common,...null==j?void 0:j.add,children:I(X)}),(0,r.jsx)(a.Js,{header:K,loading:y(J),ref:N,showClose:!0,...null==j?void 0:j.common,...null==j?void 0:j.edit,children:F(X,L)}),R]})}},11399:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(77583);let a=(0,s.forwardRef)((e,t)=>{let{children:n,contentContainerProps:a,dialogProps:o,onSubmitAppend:i,proceedButtonProps:c,scrollBoxProps:d,scrollContent:u,...h}=e,m=(0,s.useMemo)(()=>({...a,component:"form",onSubmit:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[r]=t;r.preventDefault(),null==i||i.call(null,...t)}}),[a,i]),p=(0,s.useMemo)(()=>({...d,sx:u?{overflowX:"hidden",paddingTop:".6em",...null==d?void 0:d.sx}:null==d?void 0:d.sx}),[d,u]);return(0,r.jsx)(l.Z,{dialogProps:o,contentContainerProps:m,proceedButtonProps:{...c,type:"submit"},scrollContent:u,scrollBoxProps:p,wide:!0,...h,ref:t,children:n})});a.displayName="FormDialog",t.Z=a},2188:function(e,t,n){"use strict";var r=n(85893),s=n(67294),l=n(77583),a=n(99576);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:t="",content:n="",titleText:o="",...i}={}}=e,c=(0,s.useRef)(null),[d,u]=(0,s.useState)({actionProceedText:t,content:n,titleText:o}),h=(0,s.useCallback)(e=>u(t=>{let{loading:n,...r}=t;return{...r,loading:e}}),[]),m=(0,s.useCallback)(e=>{var t,n;return null==c?void 0:null===(n=c.current)||void 0===n?void 0:null===(t=n.setOpen)||void 0===t?void 0:t.call(null,e)},[]),p=(0,s.useCallback)((e,t)=>u({actionProceedText:"",content:(0,r.jsx)(a.Z,{...t}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,s.useMemo)(()=>(0,r.jsx)(l.Z,{...i,...d,ref:c}),[d,i]),confirmDialogRef:c,setConfirmDialogLoading:h,setConfirmDialogOpen:m,setConfirmDialogProps:u,finishConfirm:p}}},62848:function(e,t,n){"use strict";var r=n(67294);t.Z=function(){let{actionProceedText:e="",content:t="",titleText:n="",...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.useState)({actionProceedText:e,content:t,titleText:n,...s})}},56907:function(e,t,n){"use strict";var r=n(67294),s=n(98484),l=n(8534),a=n(97607);t.Z=(e,t)=>{var n;let[o,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)({}),u=(0,r.useCallback)(e=>{var n,r;return null==t?void 0:null===(r=t.current)||void 0===r?void 0:null===(n=r.setMessage)||void 0===n?void 0:n.call(null,"api",e)},[t]),h=(0,r.useCallback)((e,n)=>{var r,s;null==t||null===(s=t.current)||void 0===s||null===(r=s.setMessage)||void 0===r||r.call(null,String(e),n)},[t]),m=(0,r.useCallback)((e,n)=>{var r,s;null==t||null===(s=t.current)||void 0===s||null===(r=s.setMessageRe)||void 0===r||r.call(null,e,n)},[t]),p=(0,r.useCallback)((e,t)=>{d((0,l.ZP)(e,t))},[]),x=(0,r.useCallback)((e,t)=>{d((0,l.Um)(e,t))},[]),f=(0,r.useCallback)(e=>{h(e),p(e)},[h,p]),g=(0,r.useCallback)(e=>{m(e),x(e)},[m,x]),j=(0,r.useCallback)(e=>t=>{p(e,t)},[p]),v=(0,r.useCallback)(e=>t=>{let{isValid:n}=t;p(e,n)},[p]),Z=(0,r.useCallback)(e=>()=>{f(e)},[f]),b=(0,r.useCallback)(e=>{let{body:r,getErrorMsg:l,msgKey:o="api",method:c,onError:d,onSuccess:u,setMsg:h=null==t?void 0:null===(n=t.current)||void 0===n?void 0:n.setMessage,successMsg:m,url:p}=e;i(!0),s.Z.request({data:r,method:c,url:p}).then(()=>{null==h||h.call(null,o,{children:m,type:"info"}),null==u||u.call(null)}).catch(e=>{let t=(0,a.Z)(e);t.children=l(t.children),null==h||h.call(null,o,t),null==d||d.call(null)}).finally(()=>{i(!1)})},[t,i]),w=(0,r.useMemo)(()=>Object.values(c).some(e=>!e),[c]);return{buildFinishInputTestBatchFunction:j,buildInputFirstRenderFunction:v,buildInputUnmountFunction:Z,formValidity:c,isFormInvalid:w,isFormSubmitting:o,setApiMessage:u,setFormValidity:d,setMessage:h,setMessageRe:m,setValidity:p,setValidityRe:x,submitForm:b,unsetKey:f,unsetKeyRe:g}}},82547:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(55066),s=n(18446),l=n.n(s),a=n(13218),o=n.n(a),i=n(67294),c=n(23279),d=n.n(c),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{wait:n=500,...r}=t;return d()(e,n,r)},h=n(87196);let m=(e,t,n)=>{let[r,...s]=e;if(!(r in t))return!1;let a=t[r],i=n[r];return o()(a)&&o()(i)&&s.length?m(s,a,i):!l()(a,i)};var p=e=>{let[t,n]=(0,i.useState)(!1),s=(0,r.TA)({...e}),l=(0,i.useCallback)(e=>m(e.split("."),s.values,s.initialValues),[s.initialValues,s.values]),a=(0,i.useMemo)(()=>{let e=u(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.handleChange(...t),n(!1)});return function(){for(var t=arguments.length,r=Array(t),s=0;s<t;s++)r[s]=arguments[s];n(!0),e(...r)}},[s.handleChange]),o=(0,i.useMemo)(()=>t||!s.dirty||!s.isValid||s.isValidating||s.isSubmitting,[t,s.dirty,s.isSubmitting,s.isValid,s.isValidating]),c=(0,i.useMemo)(()=>(0,h.Z)(s.errors,{skip:e=>!l(e)}),[s.errors,l]);return{disabledSubmit:o,formik:s,formikErrors:c,handleChange:a}}},28923:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return nh}});var r=n(85893),s=n(9008),l=n.n(s),a=n(11163),o=n(67294),i=n(98484),c=function(e){let{fallbackValue:t="",joinSeparator:n="",limit:r=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof Array?e.slice(0,r).join(n):null!=e?e:t},d=n(82777),u=n(97607),h=n(39937),m=n(92230),p=n(38189),x=n(14440),f=n(96674),g=n(89262),j=n(51050),v=n(37842),Z=n(56903),b=n(28293),w=n(91029),k=n(23930),y=n(6189),M=n(41553),P=n(11901),C=n(77831),S=n(59278);let I=(0,g.ZP)(M.Z)({height:"3.5em",marginLeft:0,width:"100%"});var A=e=>{let{baseInputProps:t,checked:n,formControlLabelProps:s,id:l,label:a,name:i,onChange:c,switchProps:d}=e,u=(0,o.useMemo)(()=>"string"==typeof a?(0,r.jsx)(S.Ac,{inheritColour:!0,color:"".concat(C.s7,"AF"),children:a}):(0,r.jsx)(r.Fragment,{children:a}),[a]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I,{componentsProps:{typography:{flexGrow:1}},control:(0,r.jsx)(P.Z,{checked:n,edge:"end",name:i,onChange:c,...d}),label:u,labelPlacement:"start",...s}),(0,r.jsx)("input",{checked:n,hidden:!0,id:l,readOnly:!0,...t})]})},F=n(52675);let T=["1","on"],U=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,setMessage:n},id:r,label:s}=e,l=t(r),a=()=>{n(r)};return"ip"===s.toLowerCase()?(0,F._)(s,a,{onFinishBatch:l},e=>{n(r,{children:e})}):{defaults:{onSuccess:a},onFinishBatch:l,tests:[{test:F.HJ}]}},O=e=>{let{formUtils:t,id:n,isRequired:s,label:l="",name:a=n,value:o}=e,{buildFinishInputTestBatchFunction:i,buildInputFirstRenderFunction:c,setMessage:d}=t;return(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:n,label:l,name:a,value:o}),inputTestBatch:(0,F.qY)(l,()=>{d(n)},{onFinishBatch:i(n)},e=>{d(n,{children:e})}),onFirstRender:c(n),required:s,valueType:"number"},"".concat(n,"-wrapper"))},N={boolean:e=>{let{id:t,isChecked:n=!1,label:s,name:l=t}=e;return(0,r.jsx)(b.Z,{input:(0,r.jsx)(A,{checked:n,id:t,label:s,name:l}),valueType:"boolean"},"".concat(t,"-wrapper"))},integer:O,second:O,select:e=>{let{formUtils:t,id:n,isRequired:s,label:l,name:a=n,selectOptions:o=[],value:i=""}=e,{buildFinishInputTestBatchFunction:c,buildInputFirstRenderFunction:d,setMessage:u}=t;return(0,r.jsx)(b.Z,{input:(0,r.jsx)(y.Z,{id:n,label:l,name:a,selectItems:o,value:i}),inputTestBatch:{defaults:{onSuccess:()=>{u(n)}},onFinishBatch:c(n),tests:[{test:F.HJ}]},onFirstRender:d(n),required:s},"".concat(n,"-wrapper"))},string:e=>{let t;let{formUtils:n,id:s,isRequired:l,isSensitive:a=!1,label:o="",name:i=s,value:c}=e,{buildInputFirstRenderFunction:d}=n;return a&&(t=v.Z.password),(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:s,label:o,name:i,type:t,value:c}),inputTestBatch:U({formUtils:n,id:s,label:o}),onFirstRender:d(s),required:l},"".concat(s,"-wrapper"))}},R=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("-")},E=(0,g.ZP)(Z.Z)({margin:".4em 0"});var D=e=>{let{fenceId:t,fenceParameterTooltipProps:n,fenceTemplate:s,formUtils:l,previousFenceName:a,previousFenceParameters:i}=e,{buildFinishInputTestBatchFunction:c,buildInputFirstRenderFunction:d,setMessage:u}=l,h=(0,o.useMemo)(()=>{let e;if(s&&t){let{parameters:o}=s[t],h={};i&&(h=Object.entries(i).reduce((e,n)=>{let[r,s]=n;return e[R(t,r)]=s,e},{}));let{optional:m,required:f}=Object.entries(o).sort((e,t)=>{let[n]=e,[r]=t;return n>r?1:-1}).reduce((e,s)=>{var a,o;let[i,{content_type:c,default:d,deprecated:u,description:m,options:f,required:g}]=s;if("1"===String(u))return e;let{optional:v,required:Z}=e,b=null!==(a=N[c])&&void 0!==a?a:N.string,w=R(t,i),k=null!==(o=h[w])&&void 0!==o?o:d,y="1"===String(g),M=p.JW.test(i),P=b({formUtils:l,id:w,isChecked:T.includes(k),isRequired:y,isSensitive:M,label:i,selectOptions:f,value:k}),C=(0,r.jsx)(j.Z,{componentsProps:{tooltip:{sx:{maxWidth:{md:"62.6em"}}}},disableInteractive:!0,placement:"top-start",title:(0,r.jsx)(S.Ac,{children:m}),...n,children:(0,r.jsx)(x.Z,{children:P})},"".concat(w,"-tooltip"));return y?Z.push(C):v.push(C),e},{optional:[],required:[]}),g=R(t,"name"),v="Fence device name";e=(0,r.jsxs)(Z.Z,{sx:{"& > div:first-child":{marginTop:0},"& > div":{marginBottom:0}},children:[(0,r.jsx)(k.TZ,{expandInitially:!0,header:"Required parameters",children:(0,r.jsxs)(E,{children:[(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:g,label:v,name:g,value:a}),inputTestBatch:(0,F.Gn)(v,()=>{u(g)},{onFinishBatch:c(g)},e=>{u(g,{children:e})}),onFirstRender:d(g),required:!0},"".concat(g,"-wrapper")),f]})}),(0,r.jsx)(k.TZ,{header:"Optional parameters",children:(0,r.jsx)(E,{children:m})})]})}return e},[c,d,t,n,s,l,a,i,u]);return(0,r.jsx)(r.Fragment,{children:h})},q=n(25137),B=n(6631);let _="add-fence-input-agent";var H=e=>{let{fenceTemplate:t,formUtils:n,loading:s}=e,{setValidity:l}=n,a=(0,B.Z)(),[i,c]=(0,o.useState)(null),d=(0,o.useMemo)(()=>t?Object.entries(t).sort((e,t)=>{let[n]=e,[r]=t;return n>r?1:-1}).map(e=>{let[t,{description:n}]=e;return{fenceDescription:"string"==typeof n?n:"No description.",fenceId:t,label:t}}):[],[t]),u=(0,o.useMemo)(()=>(0,r.jsx)(f.Z,{id:_,isOptionEqualToValue:(e,t)=>e.fenceId===t.fenceId,label:"Fence device type",onChange:(e,t)=>{l(_,null!==t),c(t)},openOnFocus:!0,options:d,renderOption:(e,t,n)=>{let{fenceDescription:s,fenceId:l}=t,{selected:a}=n;return(0,r.jsxs)(x.Z,{component:"li",sx:{display:"flex",flexDirection:"column","& > *":{width:"100%"}},...e,children:[(0,r.jsx)(S.Ac,{inverted:!0,sx:{fontSize:"1.2em",fontWeight:a?400:void 0},children:l}),(0,r.jsx)(S.Ac,{selected:!1,children:s})]})},sx:{marginTop:".3em"},value:i}),[d,i,l]),h=(0,o.useMemo)(()=>(0,r.jsx)(D,{fenceId:null==i?void 0:i.fenceId,fenceTemplate:t,formUtils:n}),[t,null==i?void 0:i.fenceId,n]),m=(0,o.useMemo)(()=>s?(0,r.jsx)(q.Z,{}):(0,r.jsxs)(Z.Z,{children:[u,h]}),[u,h,s]);return(0,o.useEffect)(()=>{a&&l(_,null!==i)},[i,a,l]),(0,r.jsx)(r.Fragment,{children:m})},L=n(77583),z=e=>{let{fenceId:t,fenceTemplate:n,formUtils:s,loading:l,previousFenceName:a,previousFenceParameters:i}=e,c=(0,o.useMemo)(()=>l?(0,r.jsx)(q.Z,{}):(0,r.jsx)(D,{fenceId:t,fenceTemplate:n,formUtils:s,previousFenceName:a,previousFenceParameters:i}),[n,t,s,l,a,i]);return(0,r.jsx)(r.Fragment,{children:c})},V=n(11399),G=n(44089),$=n(83916),W=n(81208),J=n(48430),Q=n(85291),K=n(62848),X=n(56907);let Y=e=>{let{id:t}=e,n=new RegExp("^(fence[^-]+)".concat("-","([^\\s]+)$")),r=t.match(n);if(!r)throw Error("Not target input element");return r},ee=(e,t,n)=>{if("name"===e)throw t.name=n,Error("Not child parameter")},et=e=>{if(!e)throw Error("Not parameter specification")},en=(e,t)=>{if([t,"",null,void 0].some(t=>e===t))throw Error("Skippable parameter value")},er=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[{target:s}]=n,{elements:l}=s;return Object.values(l).reduce((t,n)=>{try{let[,r,s]=Y(n);t.agent=r;let{checked:l,value:a}=n;ee(s,t,a);let{[r]:{parameters:{[s]:o}}}=e;et(o);let{content_type:i,default:c}=o,d=a;"boolean"===i&&(d=l?"1":""),en(d,c),t.parameters[s]=d}catch(e){}return t},{agent:"",name:"",parameters:{}})};var es=()=>{let e=(0,B.Z)(),t=(0,o.useRef)({}),n=(0,o.useRef)({}),s=(0,o.useRef)({}),[l,a]=(0,K.Z)(),[c,d]=(0,K.Z)(),[h,x]=(0,o.useState)(),[f,g]=(0,o.useState)(),[j,v]=(0,o.useState)(!1),[b,w]=(0,o.useState)(!0),{isLoading:y}=(0,J.Z)("".concat(m.Z,"/fence"),{onSuccess:e=>x(e),refreshInterval:6e4}),M=(0,o.useCallback)(()=>{i.Z.get("/fence").then(e=>{let{data:t}=e;x(t)})},[x]),P=(0,X.Z)([_],s),{isFormInvalid:C,isFormSubmitting:I,submitForm:A}=P,{buildDeleteDialogProps:F,checks:T,getCheck:U,hasChecks:O,resetChecks:N,setCheck:R}=(0,Q.Z)({list:h}),E=(0,o.useCallback)(e=>{let{cap:t,depth:n,key:r}=e;return 0===n?t(r):r},[]),D=(0,o.useMemo)(()=>(0,r.jsx)($.Z,{allowEdit:!0,allowItemButton:j,disableDelete:!O,edit:j,header:!0,listItems:h,onAdd:()=>{var e;d({actionProceedText:"Add",content:(0,r.jsx)(H,{fenceTemplate:f,formUtils:P}),onSubmitAppend:e=>{var n;if(!f)return;let s=er(f,e),{agent:l,name:o}=s;a({actionProceedText:"Add",content:(0,r.jsx)(G.Z,{entries:s,hasPassword:!0,getEntryLabel:E}),onProceedAppend:()=>{A({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add fence device. ",e]}),method:"post",onSuccess:()=>M(),successMsg:"Added fence device ".concat(o),url:"/fence"})},titleText:(0,r.jsxs)(S.z,{children:["Add a"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:l})," ","fence device with the following parameters?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:"Add a fence device"}),null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var e;a(F({getConfirmDialogTitle:e=>"Delete ".concat(e," fence device(s)?"),onProceedAppend:()=>{A({body:{uuids:T},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to delete fence device(s). ",e]}),method:"delete",onSuccess:()=>{M(),N()},url:"/fence"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(S.Ac,{children:null==h?void 0:h[t].fenceName})}})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>{v(e=>!e)},onItemCheckboxChange:(e,t,n)=>{R(e,n)},onItemClick:e=>{var s;let{fenceAgent:l,fenceName:o,fenceParameters:i,fenceUUID:c}=e;d({actionProceedText:"Update",content:(0,r.jsx)(z,{fenceId:l,fenceTemplate:f,formUtils:P,previousFenceName:o,previousFenceParameters:i}),onSubmitAppend:e=>{var n;if(!f)return;let s=er(f,e);a({actionProceedText:"Update",content:(0,r.jsx)(G.Z,{entries:s,hasPassword:!0,getEntryLabel:E}),onProceedAppend:()=>{A({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update fence device. ",e]}),method:"put",onSuccess:()=>M(),successMsg:"Updated fence device ".concat(o),url:"/fence/".concat(c)})},titleText:(0,r.jsxs)(S.z,{children:["Update"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:o})," ","fence device with the following parameters?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:(0,r.jsxs)(S.z,{children:["Update fence device"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:o})," ","parameters"]})}),null===(s=n.current.setOpen)||void 0===s||s.call(null,!0)},renderListItemCheckboxState:e=>U(e),renderListItem:(e,t)=>{let{fenceAgent:n,fenceName:s,fenceParameters:l}=t;return(0,r.jsxs)(Z.Z,{row:!0,children:[(0,r.jsx)(S.Ac,{children:s}),(0,r.jsx)(S.Ac,{children:Object.entries(l).reduce((e,t)=>{let[n,s]=t,l=(0,r.jsxs)(r.Fragment,{children:[n,'="']});return l=p.JW.test(n)?(0,r.jsxs)(r.Fragment,{children:[l,(0,r.jsx)(S.PJ,{children:s})]}):(0,r.jsxs)(r.Fragment,{children:[l,s]}),(0,r.jsxs)(r.Fragment,{children:[e," ",l,'"']})},n)})]})}}),[F,T,h,f,P,U,M,E,O,j,N,R,a,d,A]),Y=(0,o.useMemo)(()=>b||y?(0,r.jsx)(q.Z,{}):D,[y,b,D]),ee=(0,o.useMemo)(()=>(0,r.jsx)(W.Z,{count:1,defaultMessageType:"warning",ref:s}),[]);return e&&i.Z.get("/fence/template").then(e=>{let{data:t}=e;g(t)}).catch(e=>{(0,u.Z)(e)}).finally(()=>{w(!1)}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(k.s_,{children:[(0,r.jsx)(k.V9,{children:(0,r.jsx)(S.z,{children:"Manage fence devices"})}),Y]}),(0,r.jsx)(V.Z,{dialogProps:{PaperProps:{sx:{minWidth:{xs:"90%",md:"50em"}}}},scrollBoxProps:{padding:".3em .5em"},...c,disableProceed:C,loadingAction:I,preActionArea:ee,ref:n,scrollContent:!0,showClose:!0}),(0,r.jsx)(L.Z,{closeOnProceed:!0,scrollBoxProps:{paddingRight:"1em"},...l,ref:t,scrollContent:!0})]})},el=n(42458),ea=n(29535);let eo={online:"ok",offline:"off"},ei={dr:"DR",node:"Subnode"};var ec=e=>{var t;let{data:n}=e,{hostName:s,hostStatus:l,hostType:a,shortHostName:o}=n;return(0,r.jsxs)(Z.Z,{row:!0,spacing:".5em",children:[(0,r.jsx)(el.Z,{colour:null!==(t=eo[l])&&void 0!==t?t:"warning",sx:{alignSelf:"stretch",height:"auto"}}),(0,r.jsxs)(Z.Z,{flexGrow:1,spacing:0,children:[(0,r.jsxs)(Z.Z,{sm:"row",spacing:".5em",children:[(0,r.jsx)(S.Ac,{children:ei[a]}),(0,r.jsx)(S.$_,{whiteSpace:"nowrap",children:o}),(0,r.jsx)(ea.Z,{orientation:"vertical",sx:{alignSelf:"stretch",height:"auto"}}),(0,r.jsx)(S.$_,{sx:{display:{xs:"none",sm:"flex"}},whiteSpace:"nowrap",children:s})]}),(0,r.jsx)(S.Ac,{children:l})]})]})},ed=n(78533),eu=n(33544),eh=n(65895),em=n(99514),ep=n(4845),ex=n(98479),ef=n(66950),eg=n(51714),ej=n(17586),ev=n(60504),eZ=e=>{let{formControlProps:t,formControlLabelProps:n,formLabelProps:s,id:l,label:a,name:i,onChange:c,radioItems:d,radioProps:{sx:u,...h}={},radioGroupProps:m,value:p}=e,x=(0,o.useMemo)(()=>"string"==typeof a?(0,r.jsx)(S.Ac,{children:a}):a,[a]),f=(0,o.useMemo)(()=>Object.entries(d).map(e=>{let[t,{label:s,value:a}]=e,o="string"==typeof s?(0,r.jsx)(S.Ac,{children:s}):s;return(0,r.jsx)(M.Z,{control:(0,r.jsx)(ex.Z,{...h,sx:{["&.".concat(ef.Z.root)]:{color:C.s7},...u}}),value:a,label:o,...n},"".concat(l,"-").concat(t))}),[n,l,d,u,h]);return(0,r.jsxs)(eg.Z,{...t,children:[(0,r.jsx)(ej.Z,{...s,children:x}),(0,r.jsx)(ev.Z,{id:l,name:i,onChange:c,row:!0,value:p,...m,children:f})]})},eb=n(16310),ew=n(74077);let ek=eb.Ry().shape({enterpriseKey:(0,ew.u)().optional(),ip:(0,ew.T)().required(),name:eb.Z_().required(),redhatConfirmPassword:eb.Z_().when("redhatPassword",(e,t)=>String(e).length>0?t.required().oneOf([eb.iH("redhatPassword")]):t.optional()),redhatPassword:eb.Z_().when("redhatUsername",(e,t)=>String(e).length>0?t.required():t.optional()),redhatUsername:eb.Z_().when("redhatPassword",(e,t)=>String(e).length>0?t.required():t.optional()),type:eb.Z_().oneOf(["dr","subnode"]).required(),uuid:(0,ew.u)().required()},[["redhatUsername","redhatPassword"]]);var ey=n(12387),eM=n(82547);let eP={subnode:{label:"Subnode",value:"subnode"},dr:{label:"Disaster Recovery (DR) host",value:"dr"}};var eC=e=>{let{host:t,tools:n}=e,{disabledSubmit:s,formik:l,formikErrors:a,handleChange:c}=(0,eM.Z)({initialValues:{ip:t.hostIpAddress,name:t.hostName,password:t.hostPassword,type:"",uuid:t.hostUUID},onSubmit:(e,t)=>{let{setSubmitting:s}=t,{enterpriseKey:l,ip:a,name:o,password:c,type:d,uuid:h,redhatPassword:m,redhatUsername:p}=e;n.confirm.prepare({actionProceedText:"Prepare",content:(0,r.jsx)(G.Z,{entries:e,hasPassword:!0}),onCancelAppend:()=>s(!1),onProceedAppend:()=>{n.confirm.loading(!0),i.Z.put("/host/prepare",{enterpriseUUID:l,hostIPAddress:a,hostName:o,hostPassword:c,hostType:"subnode"===d?"node":d,hostUUID:h,redhatPassword:m,redhatUser:p}).then(()=>{n.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Started job to prepare host at ",a,"."]})}),n.add.open(!1)}).catch(e=>{let t=(0,u.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to prepare host at ",a,". ",t.children]}),n.confirm.finish("Error",t),s(!1)})},titleText:"Prepare host at ".concat(e.ip," with the following?")}),n.confirm.open()},validationSchema:ek}),d=(0,o.useMemo)(()=>"enterpriseKey",[]),h=(0,o.useMemo)(()=>"name",[]),m=(0,o.useMemo)(()=>"redhatConfirmPassword",[]),p=(0,o.useMemo)(()=>"redhatPassword",[]),x=(0,o.useMemo)(()=>"redhatUsername",[]),f=(0,o.useMemo)(()=>"type",[]),g=(0,o.useMemo)(()=>t.isInetConnected&&/rhel/i.test(t.hostOS)&&!t.isOSRegistered,[t.hostOS,t.isInetConnected,t.isOSRegistered]);return(0,r.jsxs)(em.ZP,{columns:{xs:1,sm:2},component:"form",container:!0,onSubmit:e=>{e.preventDefault(),l.submitForm()},spacing:"1em",children:[(0,r.jsx)(em.ZP,{item:!0,width:"100%",children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(eZ,{id:f,label:"Host type",name:f,onChange:c,radioItems:eP,value:l.values.type})})}),(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{id:h,label:"Host name",name:h,onChange:c,required:!0,value:l.values.name})})}),(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{id:d,label:"Alteeve enterprise key",name:d,onChange:c,value:l.values.enterpriseKey})})}),g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{disableAutofill:!0,id:x,label:"RedHat username",name:x,onChange:c,value:l.values.redhatUsername})})}),(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{disableAutofill:!0,id:p,label:"RedHat password",name:p,onChange:c,type:"password",value:l.values.redhatPassword})})}),(0,r.jsx)(em.ZP,{display:{xs:"none",sm:"initial"},item:!0,sm:1}),(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{disableAutofill:!0,id:m,label:"Confirm RedHat password",name:m,onChange:c,type:"password",value:l.values.redhatConfirmPassword})})})]}),(0,r.jsx)(em.ZP,{item:!0,width:"100%",children:(0,r.jsx)(W.Z,{count:1,messages:a})}),(0,r.jsx)(em.ZP,{item:!0,width:"100%",children:(0,r.jsx)(ep.Z,{actions:[{background:"blue",children:"Prepare host",disabled:s,type:"submit"}]})})]})};let eS=eb.Ry({ip:(0,ew.T)().required(),password:eb.Z_().required()});var eI=e=>{let{setResponse:t,tools:n}=e,s=(0,o.useRef)(null),[l,a]=(0,o.useState)(!1),[c,d]=(0,o.useState)([]),h=(0,o.useCallback)(e=>{var t,n;return null===(n=s.current)||void 0===n?void 0:null===(t=n.setMessage)||void 0===t?void 0:t.call(null,"api",e)},[]),{disabledSubmit:m,formik:p,formikErrors:x,handleChange:f}=(0,eM.Z)({initialValues:{ip:"",password:""},onSubmit:(e,s)=>{let{setSubmitting:l}=s;h(),a(!0),d([]),t(void 0);let{ip:o,password:c}=e;i.Z.put("/command/inquire-host",{ipAddress:o,password:c}).then(e=>{let{data:s}=e,{badSshKeys:l,isConnected:a}=s;if(l){h({children:(0,r.jsxs)(r.Fragment,{children:["Host identification at ",o," changed. If this is valid, please delete the conflicting SSH host key."]}),type:"warning"}),d([{background:"red",children:"Delete keys",onClick:()=>{n.confirm.prepare({actionProceedText:"Delete",content:(0,r.jsxs)(S.Ac,{children:["There's a different host key on ",o,", which could mean a MITM attack. But if this change is expected, you can delete the known host key(s) to resolve the conflict."]}),onProceedAppend:()=>{n.confirm.loading(!0),i.Z.delete("/ssh-key/conflict",{data:l}).then(()=>{n.confirm.finish("Success",{children:(0,r.jsxs)(r.Fragment,{children:["Started job to delete host key(s) for ",o,"."]})}),d([])}).catch(e=>{let t=(0,u.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to delete host key(s). ",t.children]}),n.confirm.finish("Error",t)})},proceedColour:"red",titleText:"Delete all known SSH host key(s) for ".concat(o,"?")}),n.confirm.open(!0)},type:"button"}]);return}if(!a){h({children:(0,r.jsx)(r.Fragment,{children:"Failed to connect. Please make sure the credentials are correct, and the host is reachable from this striker."}),type:"warning"});return}t({...s,hostIpAddress:o,hostPassword:c}),h()}).catch(e=>{let t=(0,u.Z)(e);t.children=(0,r.jsxs)(r.Fragment,{children:["Failed to access ",o,". ",t.children]}),h(t)}).finally(()=>{l(!1),a(!1)})},validationSchema:eS}),g=(0,o.useMemo)(()=>"ip",[]),j=(0,o.useMemo)(()=>"password",[]);return(0,r.jsxs)(em.ZP,{component:"form",container:!0,columns:{xs:1,sm:2},onSubmit:e=>{e.preventDefault(),p.submitForm()},spacing:"1em",children:[(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{disableAutofill:!0,id:g,label:"IP address",name:g,onChange:f,required:!0,value:p.values.ip})})}),(0,r.jsx)(em.ZP,{item:!0,xs:1,children:(0,r.jsx)(ey.Z,{input:(0,r.jsx)(w.Z,{disableAutofill:!0,id:j,label:"Password",name:j,onChange:f,required:!0,type:"password",value:p.values.password})})}),(0,r.jsx)(em.ZP,{item:!0,width:"100%",children:(0,r.jsx)(W.Z,{count:1,messages:x,ref:s})}),(0,r.jsx)(em.ZP,{item:!0,width:"100%",children:l?(0,r.jsx)(q.Z,{mt:0}):(0,r.jsx)(ep.Z,{actions:[...c,{background:"blue",children:"Test access",disabled:m,type:"submit"}]})})]})},eA=()=>{let[e,t]=(0,o.useState)();return(0,r.jsx)(ed.Z,{formDialogProps:{common:{onClose:function(e){let{handlers:{base:n}}=e;for(var r=arguments.length,s=Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];null==n||n.call(null,...s),setTimeout(t,500)}}},addHeader:"Initialize host",editHeader:"",entriesUrl:"/host?types=dr,node",entryUrlPrefix:"/host",getDeleteErrorMessage:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return{...n,children:(0,r.jsxs)(r.Fragment,{children:["Failed to delete host(s). ",e]})}},getDeleteHeader:e=>"Delete the following ".concat(e," host(s)?"),getDeleteSuccessMessage:()=>({children:(0,r.jsx)(r.Fragment,{children:"Successfully deleted host(s)"})}),listEmpty:"No host(s) found",listProps:{allowAddItem:!0,allowEdit:!1,allowItemButton:!0},renderAddForm:n=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eI,{setResponse:t,tools:n}),e&&(0,r.jsx)(eC,{host:e,tools:n})]}),renderDeleteItem:(e,t)=>{let{key:n}=t,s=null==e?void 0:e[n];return(0,r.jsx)(S.Ac,{children:null==s?void 0:s.shortHostName})},renderEditForm:(e,t)=>t&&(0,r.jsx)(eu.VZ,{children:(0,r.jsx)(G.Z,{entries:t,renderEntryValue:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];let{0:{entry:l,key:a}}=n;return"command"===a?(0,r.jsx)(eh.Z,{iconProps:{fontSize:"small"},mapPreset:"copy",onClick:()=>navigator.clipboard.writeText(String(l)),size:"small"}):e(...n)},hasPassword:!0})}),renderListItem:(e,t)=>(0,r.jsx)(ec,{data:t})})},eF=n(28951),eT=n(99576);let eU="an-host-input",eO="".concat(eU,"-cell"),eN="IPMI IP",eR={fence:(e,t)=>{let{dataset:{hostId:n="",fenceId:r="",fenceName:s=""},value:l}=t,{hostConfig:{hosts:{[n]:a}}}=e,{fences:o={}}=a;o[r]={fenceName:s,fencePort:l},a.fences=o},host:(e,t)=>{let{dataset:{hostId:n="",hostNumber:r="",hostType:s=""}}=t,l=Number.parseInt(r,10);e.hostConfig.hosts[n]={hostNumber:l,hostType:s}},ipmi:(e,t)=>{let{dataset:{hostId:n=""},value:r}=t,{hostConfig:{hosts:{[n]:s}}}=e;s.ipmiIp=r},network:(e,t)=>{let{dataset:{hostId:n="",networkId:r="",networkNumber:s="",networkType:l=""},value:a}=t,{hostConfig:{hosts:{[n]:o}}}=e,{networks:i={}}=o,c=Number.parseInt(s,10);i[r]={networkIp:a,networkNumber:c,networkType:l},o.networks=i},ups:(e,t)=>{let{checked:n,dataset:{hostId:r="",upsId:s="",upsName:l=""}}=t,{hostConfig:{hosts:{[r]:a}}}=e,{upses:o={}}=a;o[s]={isUsed:n,upsName:l},a.upses=o}},eE={xs:1,sm:2,md:3},eD=(e,t)=>"".concat(eU,"-").concat(e,"-").concat(t,"-port"),eq=e=>"".concat(eU,"-").concat(e,"-ipmi-ip"),eB=(e,t)=>"".concat(eU,"-").concat(e,"-").concat(t,"-ip"),e_=(e,t)=>"".concat(eU,"-").concat(e,"-").concat(t,"-power-host");var eH=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,buildInputUnmountFunction:s,setMessage:l},hostId:a,hostNumber:i,hostType:c,previous:{fences:u={},ipmiIp:h,networks:m={},upses:p={}}={},hostLabel:x="".concat(c.replace("node","subnode")," ").concat(i)}=e,f=(0,o.useMemo)(()=>Object.entries(u),[u]),g=(0,o.useMemo)(()=>Object.entries(m),[m]),j=(0,o.useMemo)(()=>Object.entries(p),[p]),v=(0,o.useMemo)(()=>!!j.length,[j.length]),y=(0,o.useMemo)(()=>"".concat(eU,"-").concat(a),[a]),M=(0,o.useMemo)(()=>eq(a),[a]),P=(0,o.useMemo)(()=>"".concat(eO,"-").concat(a,"-ipmi-ip"),[a]),C=(0,o.useMemo)(()=>f.reduce((e,s)=>{let[o,{fenceName:i,fencePort:c}]=s,d="".concat(eO,"-").concat(a,"-").concat(o,"-port"),u=eD(a,o),h="Port on ".concat(i);return e[d]={children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"fence","data-host-id":a,"data-fence-id":o,"data-fence-name":i},id:u,label:h,value:c}),inputTestBatch:(0,F.Gn)("".concat(a," ").concat(h),()=>{l(u)},{onFinishBatch:t(u)},e=>{l(u,{children:e})}),onFirstRender:n(u)})},e},{}),[t,n,f,a,l]),I=(0,o.useMemo)(()=>g.reduce((e,o)=>{let[i,{networkIp:c,networkNumber:d,networkType:u}]=o,h="".concat(eO,"-").concat(a,"-").concat(i,"-ip"),m=eB(a,i),p="".concat(u.toUpperCase()," ").concat(d," IP");return e[h]={children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"network","data-host-id":a,"data-network-id":i,"data-network-number":d,"data-network-type":u},id:m,label:p,value:c}),inputTestBatch:(0,F._)("".concat(a," ").concat(p),()=>{l(m)},{onFinishBatch:t(m)},e=>{l(m,{children:e})}),onFirstRender:n(m),onUnmount:s(m),required:!0})},e},{}),[g,a,t,n,s,l]),T=(0,o.useMemo)(()=>j.reduce((e,t)=>{let[n,{isUsed:s,upsName:l}]=t,o="".concat(eO,"-").concat(a,"-").concat(n,"-power-host"),i=e_(a,n),c="Uses ".concat(l);return e[o]={children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(A,{baseInputProps:{"data-handler":"ups","data-host-id":a,"data-ups-id":n,"data-ups-name":l},checked:s,id:i,label:c}),valueType:"boolean"})},e},{}),[a,j]),U=(0,o.useMemo)(()=>v&&(0,r.jsx)(d.Z,{columns:eE,layout:T,spacing:"1em"}),[v,T]);return(0,r.jsxs)(k.Lg,{mv:0,children:[(0,r.jsx)(k.CH,{children:(0,r.jsx)(S.Ac,{children:x})}),(0,r.jsxs)(k.bc,{children:[(0,r.jsx)("input",{hidden:!0,id:y,readOnly:!0,"data-handler":"host","data-host-id":a,"data-host-number":i,"data-host-type":c}),(0,r.jsxs)(Z.Z,{children:[(0,r.jsx)(d.Z,{columns:eE,layout:{"fence-message":{children:(0,r.jsx)(eT.Z,{children:"It is recommended to provide 2 fence device ports."}),width:"100%",xs:0},...I,[P]:{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"ipmi","data-host-id":a},id:M,label:eN,value:h}),inputTestBatch:(0,F._)("".concat(a," ").concat(eN),()=>{l(M)},{onFinishBatch:t(M)},e=>{l(M,{children:e})}),onFirstRender:n(M),onUnmount:s(M)})},...C},spacing:"1em"}),U]})]})]})};let eL="".concat("".concat("an-host-config-input","-group"),"-cell"),ez={node1:{hostNumber:1,hostType:"node"},node2:{hostNumber:2,hostType:"node"}},eV=e=>{let{anSeq:t,minIp:n,offset3:r=10,step3:s=2,subnetMask:l,subSeq:a}=e;try{let e=new eF.Netmask("".concat(n,"/").concat(l));if(16!==e.bitmask)return"".concat(e.base.replace(/\.0/g,""),".");return n.replace(/^((\d+\.){2})\d+\.\d+$/,"$1".concat((t-1)*s+r,".").concat(a))}catch(e){return""}};var eG=e=>{let{anSequence:t,formUtils:n,knownFences:s={},knownUpses:l={},networkListEntries:a,previous:{hosts:i=ez}={}}=e,c=(0,o.useMemo)(()=>Object.entries(i),[i]),u=(0,o.useMemo)(()=>Object.values(s),[s]),h=(0,o.useMemo)(()=>Object.values(l),[l]),m=(0,o.useMemo)(()=>c.reduce((e,s)=>{let[l,o]=s,{fences:i={},hostNumber:c,hostType:d,ipmiIp:m,networks:p={},upses:x={}}=o,f=m,g=u.reduce((e,t)=>{let{fenceName:n}=t,{[n]:{fencePort:r=""}={}}=i;return e[n]={fenceName:n,fencePort:r},e},{}),j=a.reduce((e,n)=>{let[r,{networkMinIp:s,networkNumber:l,networkSubnetMask:a,networkType:o}]=n,{[r]:{networkIp:i=""}={}}=p;return i||(i=eV({anSeq:t,minIp:s,subnetMask:a,subSeq:c})),f||"bcn"!==o||1!==l||(f=eV({anSeq:t,minIp:s,offset3:11,subnetMask:a,subSeq:c})),e[r]={networkIp:i,networkNumber:l,networkType:o},e},{}),v=h.reduce((e,t)=>{let{upsName:n}=t,{[n]:{isUsed:r=!0}={}}=x;return e[n]={isUsed:r,upsName:n},e},{});return e["".concat(eL,"-").concat(l)]={children:(0,r.jsx)(eH,{formUtils:n,hostId:l,hostNumber:c,hostType:d,previous:{fences:g,ipmiIp:f,networks:j,upses:v}}),md:3,sm:2},e},{}),[t,n,c,u,h,a]);return(0,r.jsx)(d.Z,{columns:{xs:1,sm:2,md:3},layout:m,spacing:"1em"})},e$=n(23279),eW=n.n(e$);let eJ="an-id-input",eQ="".concat(eJ,"-domain"),eK="".concat(eJ,"-prefix"),eX="".concat(eJ,"-sequence"),eY="Domain name",e0="Prefix",e1="Sequence";var e2=e=>{let{debounceWait:t=500,formUtils:{buildFinishInputTestBatchFunction:n,buildInputFirstRenderFunction:s,setMessage:l},onSequenceChange:a,previous:{domain:i,prefix:c,sequence:u}={}}=e,h=(0,o.useMemo)(()=>a&&eW()(a,t),[t,a]);return(0,r.jsx)(d.Z,{columns:{xs:1,sm:2,md:3},layout:{"an-id-input-cell-prefix":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:eK,label:e0,value:c}),inputTestBatch:(0,F.Gn)(e0,()=>{l(eK)},{onFinishBatch:n(eK)},e=>{l(eK,{children:e})}),onFirstRender:s(eK),required:!0})},"an-id-input-cell-domain":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:eQ,label:eY,value:i}),inputTestBatch:(0,F.Gn)(eY,()=>{l(eQ)},{onFinishBatch:n(eQ)},e=>{l(eQ,{children:e})}),onFirstRender:s(eQ),required:!0})},"an-id-input-cell-sequence":{children:(0,r.jsx)(b.Z,{createInputOnChangeHandlerOptions:{postSet:h},input:(0,r.jsx)(w.Z,{id:eX,label:e1,value:u}),inputTestBatch:(0,F.qY)(e1,()=>{l(eX)},{onFinishBatch:n(eX)},e=>{l(eX,{children:e})}),onFirstRender:s(eX),required:!0,valueType:"number"})}},spacing:"1em"})},e8=n(25934),e5=n(26339);let e9="an-network-input",e4="".concat(e9,"-cell"),e3={gateway:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkGateway=r},minip:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkMinIp=r},network:(e,t)=>{let{dataset:{networkId:n="",networkNumber:r="",networkType:s=""}}=t,{networkConfig:{networks:l}}=e,a=Number.parseInt(r,10);l[n]={networkNumber:a,networkType:s}},subnetmask:(e,t)=>{let{dataset:{networkId:n=""},value:r}=t,{networkConfig:{networks:s}}=e;s[n].networkSubnetMask=r}},e7=e=>"".concat(e9,"-").concat(e,"-gateway"),e6=e=>"".concat(e9,"-").concat(e,"-min-ip"),te=e=>"".concat(e9,"-").concat(e,"-network-type"),tt=e=>"".concat(e9,"-").concat(e,"-subnet-mask");var tn=e=>{let{debounceWait:t=500,formUtils:{buildFinishInputTestBatchFunction:n,buildInputFirstRenderFunction:s,buildInputUnmountFunction:l,setMessage:a},inputGatewayLabel:i="Gateway",inputMinIpLabel:c="IP address",inputSubnetMaskLabel:u="Subnet mask",networkId:h,networkNumber:m,networkType:p,networkTypeOptions:x,onClose:f,onNetworkGatewayChange:g,onNetworkMinIpChange:j,onNetworkSubnetMaskChange:v,onNetworkTypeChange:Z,previous:{gateway:M,minIp:P,subnetMask:C}={},readonlyNetworkName:S,showCloseButton:I,showGateway:A}=e,T=(0,o.useMemo)(()=>"".concat(e5.default[p]," ").concat(m),[m,p]),U=(0,o.useMemo)(()=>"".concat(e4,"-").concat(h,"-gateway"),[h]),O=(0,o.useMemo)(()=>"".concat(e4,"-").concat(h,"-ip"),[h]),N=(0,o.useMemo)(()=>"".concat(e4,"-").concat(h,"-subnet-mask"),[h]),R=(0,o.useMemo)(()=>"".concat(e9,"-").concat(h),[h]),E=(0,o.useMemo)(()=>e7(h),[h]),D=(0,o.useMemo)(()=>e6(h),[h]),q=(0,o.useMemo)(()=>te(h),[h]),B=(0,o.useMemo)(()=>tt(h),[h]),_=(0,o.useMemo)(()=>A?void 0:"none",[A]),H=(0,o.useMemo)(()=>g&&eW()(g,t),[t,g]),L=(0,o.useMemo)(()=>j&&eW()(j,t),[t,j]),z=(0,o.useMemo)(()=>v&&eW()(v,t),[t,v]),V=(0,o.useMemo)(()=>I&&(0,r.jsx)(eh.Z,{mapPreset:"close",iconProps:{fontSize:"small"},onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==f||f.call(null,{networkId:h,networkType:p},...t)},sx:{padding:".2em",position:"absolute",right:"-.6rem",top:"-.2rem"}}),[I,h,p,f]),G=(0,o.useMemo)(()=>{let e;return A&&E&&(e=(0,r.jsx)(b.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==H?void 0:H.call(null,{networkId:h,networkType:p},...t)}},input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"gateway","data-network-id":h},id:E,label:i,value:M}),inputTestBatch:(0,F._)("".concat(T," ").concat(i),()=>{a(E)},{onFinishBatch:n(E)},e=>{a(E,{children:e})}),onFirstRender:s(E),onUnmount:l(E),required:A})),e},[A,E,h,i,M,T,n,s,l,H,p,a]);return(0,r.jsxs)(k.Lg,{mv:0,children:[(0,r.jsxs)(k.CH,{children:[(0,r.jsx)(b.Z,{input:(0,r.jsx)(y.Z,{id:q,isReadOnly:S,onChange:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==Z||Z.call(null,{networkId:h,networkType:p},...t)},selectItems:x,selectProps:{renderValue:()=>T},value:p})}),V]}),(0,r.jsxs)(k.bc,{children:[(0,r.jsx)("input",{hidden:!0,id:R,readOnly:!0,"data-handler":"network","data-network-id":h,"data-network-number":m,"data-network-type":p}),(0,r.jsx)(d.Z,{columns:{xs:1,sm:2,md:3},layout:{[O]:{children:(0,r.jsx)(b.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==L?void 0:L.call(null,{networkId:h,networkType:p},...t)}},input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"minip","data-network-id":h},id:D,label:c,value:P}),inputTestBatch:(0,F._)("".concat(T," ").concat(c),()=>{a(D)},{onFinishBatch:n(D)},e=>{a(D,{children:e})}),onFirstRender:s(D),onUnmount:l(D),required:!0})},[N]:{children:(0,r.jsx)(b.Z,{createInputOnChangeHandlerOptions:{postSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==z?void 0:z.call(null,{networkId:h,networkType:p},...t)}},input:(0,r.jsx)(w.Z,{baseInputProps:{"data-handler":"subnetmask","data-network-id":h},id:B,label:u,value:C}),inputTestBatch:(0,F._)("".concat(T," ").concat(u),()=>{a(B)},{onFinishBatch:n(B)},e=>{a(B,{children:e})}),onFirstRender:s(B),onUnmount:l(B),required:!0})},[U]:{children:G,display:_}},spacing:"1em"})]})]})},tr=n(8534);let ts="an-network-config-input",tl="".concat(ts,"-cell"),ta="".concat(ts,"-dns"),to="".concat(ts,"-ntp"),ti=Object.entries(e5.default),tc={bcn:{base:"10.201.0.0",mask:"255.255.0.0"},mn:{base:"10.199.0.0",mask:"255.255.0.0"},sn:{base:"10.101.0.0",mask:"255.255.0.0"}},td=e=>"ifn"===e,tu=e=>"mn"===e,th=e=>{let{entries:t,type:n}=e,r=t.filter(e=>{let[,{networkType:t}]=e;return t===n}).sort((e,t)=>{let[,{networkNumber:n}]=e,[,{networkNumber:r}]=t;return n>r?1:-1}).pop();if(!r){var s;return null!==(s=tc[n])&&void 0!==s?s:{}}let[,{networkMinIp:l,networkSubnetMask:a}]=r;try{let{base:e,mask:t}=new eF.Netmask("".concat(l,"/").concat(a)).next();return{base:e,mask:t}}catch(e){return{}}};var tm=e=>{let{formUtils:t,networkListEntries:n,previous:{dnsCsv:s="8.8.8.8,8.8.4.4",ntpCsv:l}={},setNetworkList:a}=e,{buildFinishInputTestBatchFunction:i,buildInputFirstRenderFunction:c,setMessage:u,setMessageRe:h}=t,m=(0,o.useCallback)(function(e){let{input:t=n,end:r=n.length}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r-1,l=0;return t.every((t,n)=>{let[,{networkType:r}]=t;return r===e&&(l+=1),n<s}),l},[n]),p=(0,o.useMemo)(()=>ti.map(e=>{let[t,n]=e;return{displayValue:n,value:t}}),[]),x=(0,o.useCallback)(function(){let{networkMinIp:e="",networkSubnetMask:t="",networkType:r=n.some(e=>{let[,{networkType:t}]=e;return tu(t)})?"ifn":"mn",networkGateway:s=td(r)?"":void 0,networkNumber:l=m(r)+1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{base:a=e,mask:o=t}=th({entries:n,type:r});return{network:{networkGateway:s,networkMinIp:a,networkNumber:l,networkSubnetMask:o,networkType:r},networkId:(0,e8.Z)()}},[m,n]),f=(0,o.useCallback)((e,t)=>a((0,tr.ZP)(e,t)),[a]),g=(0,o.useCallback)((e,t,n)=>a(r=>{let s={...r},{[e]:l}=s;return l&&(l[t]=n),s}),[a]),j=(0,o.useCallback)((e,t)=>{let{networkId:r,networkType:s}=e,{target:{value:l}}=t,o=String(l),i=!1,c=0;a(n.reduce((e,t)=>{let[l,a]=t,{networkNumber:d,networkType:u,networkMinIp:m,networkSubnetMask:p,...x}=a,f=d,g=u;l===r&&(i=!0,g=o,h(RegExp(l)));let j=g===o;if(j&&(c+=1),i){j?f=c:g===s&&(f-=1);let{base:t=m,mask:r=p}=th({entries:n,type:g});e[l]={...x,networkMinIp:t,networkSubnetMask:r,networkNumber:f,networkType:g}}else e[l]=a;return e},{}))},[n,h,a]),v=(0,o.useCallback)(e=>{let{networkId:t,networkType:r}=e,s=!1,l=0;a(n.reduce((e,n)=>{let[a,o]=n;if(a===t)return s=!0,e;let{networkType:i}=o,c=i===r;return c&&(l+=1),e[a]=s&&c?{...o,networkNumber:l}:o,e},{}))},[n,a]),Z=(0,o.useMemo)(()=>n.reduce((e,n)=>{let[s,{networkGateway:l,networkMinIp:a,networkNumber:o,networkSubnetMask:i,networkType:c}]=n,d="".concat(tl,"-").concat(s),u=1===o,h=td(c),m=tu(c)||!u;return e[d]={children:(0,r.jsx)(tn,{formUtils:t,networkId:s,networkNumber:o,networkType:c,networkTypeOptions:p,onClose:v,onNetworkMinIpChange:(e,t)=>{let{networkId:n}=e,{target:{value:r}}=t;return g(n,"networkMinIp",r)},onNetworkSubnetMaskChange:(e,t)=>{let{networkId:n}=e,{target:{value:r}}=t;return g(n,"networkSubnetMask",r)},onNetworkTypeChange:j,previous:{gateway:l,minIp:a,subnetMask:i},readonlyNetworkName:!m,showCloseButton:m,showGateway:h}),md:3,sm:2},e},{}),[n,t,p,v,j,g]);return(0,r.jsx)(d.Z,{columns:{xs:1,sm:2,md:3},layout:{...Z,"an-network-config-cell-add-network":{children:(0,r.jsx)(eh.Z,{mapPreset:"add",onClick:()=>{let{network:e,networkId:t}=x();f(t,e)}}),display:"flex",justifyContent:"center",md:3,sm:2},"an-network-config-input-cell-dns":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:ta,label:"DNS",value:s}),inputTestBatch:(0,F.dg)("DNS",()=>{u(ta)},{onFinishBatch:i(ta)},e=>{u(ta,{children:e})}),onFirstRender:c(ta),required:!0})},"an-network-config-input-cell-ntp":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:to,label:"NTP",value:l}),inputTestBatch:(0,F.dg)("NTP",()=>{u(to)},{onFinishBatch:i(to)},e=>{u(to,{children:e})}),onFirstRender:c(to)})}},spacing:"1em"})};let tp={bcn1:{networkMinIp:"10.201.0.0",networkNumber:1,networkSubnetMask:"255.255.0.0",networkType:"bcn"},sn1:{networkMinIp:"10.101.0.0",networkNumber:1,networkSubnetMask:"255.255.0.0",networkType:"sn"},ifn1:{networkMinIp:"",networkNumber:1,networkSubnetMask:"",networkType:"ifn"}};var tx=e=>{var t;let{formUtils:n,knownFences:s,knownUpses:l,previous:{hostConfig:a,networkConfig:i={},...c}={}}=e,{networks:d=tp}=i,[u,h]=(0,o.useState)(null!==(t=null==c?void 0:c.sequence)&&void 0!==t?t:0),[m,p]=(0,o.useState)(d),x=(0,o.useMemo)(()=>Object.entries(m),[m]);return(0,r.jsxs)(Z.Z,{children:[(0,r.jsx)(e2,{formUtils:n,onSequenceChange:e=>{let{target:{value:t}}=e;h(Number(t))},previous:c}),(0,r.jsx)(tm,{formUtils:n,networkListEntries:x,previous:i,setNetworkList:p}),(0,r.jsx)(eG,{anSequence:u,formUtils:n,knownFences:s,knownUpses:l,networkListEntries:x,previous:a})]})},tf=e=>{let{formUtils:t,knownFences:n,knownUpses:s,previous:l}=e;return(0,r.jsx)(tx,{formUtils:t,knownFences:n,knownUpses:s,previous:l})};let tg="run-manifest-input",tj="".concat(tg,"-host"),tv="".concat(tg,"-an-description"),tZ="".concat(tg,"-an-password"),tb="".concat(tg,"-an-confirm-password"),tw="Description",tk="Password",ty="Confirm password",tM=(0,g.ZP)(S.$_)({justifyContent:"end"}),tP=e=>"".concat(tj,"-").concat(e);var tC=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,setMessage:s},knownFences:l={},knownHosts:a={},knownUpses:i={},previous:{domain:c,hostConfig:u={},networkConfig:h={}}={}}=e,m=(0,o.useRef)({}),{hosts:p={}}=u,{dnsCsv:x,networks:f={},ntpCsv:g}=h,j=(0,o.useMemo)(()=>Object.entries(p),[p]),k=(0,o.useMemo)(()=>Object.entries(l),[l]),M=(0,o.useMemo)(()=>Object.entries(a),[a]),P=(0,o.useMemo)(()=>Object.entries(i),[i]),C=(0,o.useMemo)(()=>Object.entries(f),[f]),I=(0,o.useMemo)(()=>M.map(e=>{let[,{hostName:t,hostUUID:n}]=e;return{displayValue:t,value:n}}),[M]),{headers:A,hosts:T,hostNames:U}=(0,o.useMemo)(()=>j.reduce((e,l)=>{let[a,{hostName:o,hostNumber:i,hostType:d}]=l,{headers:u,hosts:h,hostNames:m}=e,p="".concat(d.replace("node","subnode")," ").concat(i);u["run-manifest-column-header-cell-".concat(a)]={children:(0,r.jsx)(S.Ac,{children:p})};let x=tP(a),f="".concat(p," host");return h["run-manifest-host-cell-".concat(a)]={children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(y.Z,{id:x,label:f,selectItems:I,value:""}),inputTestBatch:(0,F.Gn)(f,()=>{s(x)},{onFinishBatch:t(x)},e=>{s(x,{children:e})}),onFirstRender:n(x),required:!0})},m["run-manifest-new-host-name-cell-".concat(a)]={children:(0,r.jsxs)(S.$_,{children:[o,".",c]})},e},{headers:{"run-manifest-column-header-cell-offset":{}},hosts:{"run-manifest-host-cell-header":{children:(0,r.jsx)(S.Ac,{children:"Uses host"})}},hostNames:{"run-manifest-new-host-name-cell-header":{children:(0,r.jsx)(S.Ac,{children:"New hostname"})}}}),[c,t,n,j,I,s]),{gateway:O,hostNetworks:N}=(0,o.useMemo)(()=>C.reduce((e,t)=>{let[n,{networkGateway:s,networkNumber:l,networkType:a}]=t,{gateway:o,hostNetworks:i}=e,c="run-manifest-host-network-cell-".concat(n),d="".concat(a.toUpperCase()).concat(l);i["".concat(c,"-header")]={children:(0,r.jsx)(S.Ac,{children:d})},j.forEach(e=>{let[t,{networks:s={}}]=e,{[n]:{networkIp:l=""}={}}=s;i["".concat(c,"-").concat(t,"-ip")]={children:(0,r.jsx)(S.$_,{children:l||"--"})}});let u="run-manifest-gateway-cell";return s&&!o[u]&&(o[u]={children:(0,r.jsx)(tM,{children:s})}),e},{gateway:{"run-manifest-gateway-cell-header":{children:(0,r.jsx)(S.Ac,{children:"Gateway"})}},hostNetworks:{}}),[j,C]),R=(0,o.useMemo)(()=>k.reduce((e,t)=>{let[n,{fenceName:s}]=t,l="run-manifest-fence-cell-".concat(n);return e["".concat(l,"-header")]={children:(0,r.jsxs)(S.Ac,{children:["Port on ",s]})},j.forEach(t=>{let[n,{fences:a={}}]=t,{[s]:{fencePort:o=""}={}}=a;e["".concat(l,"-").concat(n,"-port")]={children:(0,r.jsx)(S.$_,{children:o||"--"})}}),e},{}),[j,k]),E=(0,o.useMemo)(()=>P.reduce((e,t)=>{let[n,{upsName:s}]=t,l="run-manifest-ups-cell-".concat(n);return e["".concat(l,"-header")]={children:(0,r.jsxs)(S.Ac,{children:["Uses ",s]})},j.forEach(t=>{let[n,{upses:a={}}]=t,{[s]:{isUsed:o=!1}={}}=a;e["".concat(l,"-").concat(n,"-is-used")]={children:(0,r.jsx)(S.$_,{children:o?"yes":"no"})}}),e},{}),[j,P]),D=(0,o.useMemo)(()=>{let e=(0,F.Gn)(ty,()=>{s(tb)},{onFinishBatch:t(tb)},e=>{s(tb,{children:e})}),l=n(tb);return e.tests.push({onFailure:()=>{s(tb,{children:(0,r.jsx)(r.Fragment,{children:"Confirm password must match password."})})},test:e=>{var t;let{value:n}=e;return(null===(t=m.current.getValue)||void 0===t?void 0:t.call(null))===n}}),{inputTestBatch:e,onFirstRender:l}},[t,n,s]);return(0,r.jsxs)(Z.Z,{children:[(0,r.jsx)(d.Z,{columns:{xs:1,sm:2},layout:{"run-manifest-input-cell-an-description":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:tv,label:tw}),inputTestBatch:(0,F.Gn)(tw,()=>{s(tv)},{onFinishBatch:t(tv)},e=>{s(tv,{children:e})}),onFirstRender:n(tv),required:!0}),sm:2},"run-manifest-input-cell-an-password":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:tZ,label:tk,type:v.Z.password}),inputTestBatch:(0,F.Gn)(tk,()=>{s(tZ)},{onFinishBatch:t(tZ)},e=>{s(tZ,{children:e})}),onFirstRender:n(tZ),ref:m,required:!0})},"run-manifest-input-cell-an-confirm-password":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:tb,label:ty,type:v.Z.password}),required:!0,...D})}},spacing:"1em"}),(0,r.jsx)(d.Z,{alignItems:"center",columns:{xs:j.length+1},layout:{...A,...T,...U,...N,...R,...E},columnSpacing:"1em",rowSpacing:"0.4em"}),(0,r.jsx)(d.Z,{columns:{xs:2},layout:{...O,"run-manifest-dns-csv-cell-header":{children:(0,r.jsx)(S.Ac,{children:"DNS"})},"run-manifest-dns-csv-cell":{children:(0,r.jsx)(tM,{children:x||"--"})},"run-manifest-ntp-csv-cell-header":{children:(0,r.jsx)(S.Ac,{children:"NTP"})},"run-manifest-ntp-csv-cell":{children:(0,r.jsx)(tM,{children:g||"--"})}},spacing:"0.4em"})]})};let tS=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[{target:r}]=t,{elements:s}=r,{value:l}=s.namedItem(eQ),{value:a}=s.namedItem(eK),{value:o}=s.namedItem(eX),{value:i}=s.namedItem(ta),{value:c}=s.namedItem(to),d=Number.parseInt(o,10);return Object.values(s).reduce((e,t)=>{var n,r;let{id:s}=t;if(RegExp("^".concat(eU)).test(s)){let{dataset:{handler:r=""}}=t;null===(n=eR[r])||void 0===n||n.call(null,e,t)}else if(RegExp("^".concat(e9)).test(s)){let{dataset:{handler:n=""}}=t;null===(r=e3[n])||void 0===r||r.call(null,e,t)}return e},{domain:l,hostConfig:{hosts:{}},networkConfig:{dnsCsv:i,networks:{},ntpCsv:c},prefix:a,sequence:d})},tI=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[{target:s}]=n,{elements:l}=s,{value:a}=l.namedItem(tv),{value:o}=l.namedItem(tZ);return{description:a,hosts:Object.entries(e).reduce((e,t)=>{let[n,{hostNumber:r,hostType:s}]=t,a=tP(n),{value:o}=l.namedItem(a);return e[n]={hostNumber:r,hostType:s,hostUuid:o},e},{}),password:o}};var tA=()=>{let e=(0,B.Z)(),t=(0,o.useRef)({}),n=(0,o.useRef)({}),s=(0,o.useRef)({}),l=(0,o.useRef)({}),a=(0,o.useRef)({}),[c,d]=(0,K.Z)(),[h,p]=(0,o.useState)(),[x,f]=(0,o.useState)(!1),[g,j]=(0,o.useState)(!0),[v,b]=(0,o.useState)(!0),[w,y]=(0,o.useState)(!0),[M,P]=(0,o.useState)(),[C,I]=(0,o.useState)(),[A,F]=(0,o.useState)(),{isLoading:T}=(0,J.Z)("".concat(m.Z,"/manifest"),{onSuccess:e=>P(e),refreshInterval:6e4}),U=(0,o.useCallback)(()=>{i.Z.get("/manifest").then(e=>{let{data:t}=e;P(t)})},[P]),O=(0,X.Z)([eQ,eK,eX,ta,to],a),{isFormInvalid:N,isFormSubmitting:R,submitForm:E}=O,D=(0,X.Z)([tb,tv,tZ],a),{isFormInvalid:_,isFormSubmitting:H,submitForm:z}=D,{buildDeleteDialogProps:Y,checks:ee,getCheck:et,hasChecks:en,resetChecks:er,setCheck:es}=(0,Q.Z)({list:M}),{hostConfig:{hosts:el={}}={},name:ea,uuid:eo}=(0,o.useMemo)(()=>null!=C?C:{},[C]),{domain:ei,fences:ec,prefix:ed,sequence:eu,upses:em}=(0,o.useMemo)(()=>null!=A?A:{},[A]),ep=(0,o.useCallback)(e=>{let{hostConfig:{hosts:t}}=e,n=Object.values(t).reduce((e,t)=>{let{fences:n,hostType:r,hostNumber:s}=t,l="".concat(r.replace(/node/,"subnode")).concat(s);return n?e[l]=Object.values(n).reduce((e,t)=>{let{fencePort:n}=t;return e+(n.length?1:0)},0):e[l]=0,e},{}),s=Object.entries(n).map(e=>{let[t,n]=e;return n?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(eT.Z,{children:["No fence device port specified for ",t,"."]},"".concat(t,"-no-fence-port-message"))});return{counts:n,messages:s}},[]),ex=(0,o.useMemo)(()=>({actionProceedText:"Add",content:(0,r.jsx)(tx,{formUtils:O,knownFences:ec,knownUpses:em,previous:{domain:ei,prefix:ed,sequence:eu}}),onSubmitAppend:function(){for(var e,n=arguments.length,s=Array(n),l=0;l<n;l++)s[l]=arguments[l];let a=tS(...s),{messages:o}=ep(a);d({actionProceedText:"Add",content:(0,r.jsx)(G.Z,{entries:a,maxDepth:6}),onProceedAppend:()=>{E({body:a,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add install manifest. ",e]}),method:"post",onSuccess:()=>U(),successMsg:"Successfully added install manifest",url:"/manifest"})},preActionArea:(0,r.jsx)(Z.Z,{spacing:".3em",children:o}),titleText:"Add install manifest?"}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Add an install manifest"}),[ep,O,U,ec,em,ei,ed,eu,d,E]),ef=(0,o.useMemo)(()=>({actionProceedText:"Edit",content:(0,r.jsx)(tf,{formUtils:O,knownFences:ec,knownUpses:em,previous:C}),onSubmitAppend:function(){for(var e,n=arguments.length,s=Array(n),l=0;l<n;l++)s[l]=arguments[l];let a=tS(...s),{messages:o}=ep(a);d({actionProceedText:"Edit",content:(0,r.jsx)(G.Z,{entries:a,maxDepth:6}),onProceedAppend:()=>{E({body:a,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update install manifest. ",e]}),method:"put",onSuccess:()=>U(),successMsg:"Successfully updated install manifest ".concat(ea),url:"/manifest/".concat(eo)})},preActionArea:(0,r.jsx)(Z.Z,{spacing:".3em",children:o}),titleText:"Update install manifest ".concat(ea,"?")}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},loading:v,titleText:"Update install manifest ".concat(ea)}),[ep,O,U,v,ec,em,C,ea,eo,d,E]),eg=(0,o.useMemo)(()=>({actionProceedText:"Run",content:(0,r.jsx)(tC,{formUtils:D,knownFences:ec,knownHosts:h,knownUpses:em,previous:C}),loading:v,onSubmitAppend:function(){for(var e,n=arguments.length,s=Array(n),l=0;l<n;l++)s[l]=arguments[l];let a=tI(el,...s);d({actionProceedText:"Run",content:(0,r.jsx)(G.Z,{entries:a,hasPassword:!0}),onProceedAppend:()=>{z({body:a,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to run install manifest. ",e]}),method:"put",successMsg:"Successfully ran install manifest ".concat(ea),url:"/command/run-manifest/".concat(eo)})},titleText:"Run install manifest ".concat(ea,"?")}),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},titleText:"Run install manifest ".concat(ea)}),[D,ec,h,em,C,v,ea,el,d,z,eo]),ej=(0,o.useCallback)((e,t)=>{b(!0),i.Z.get("manifest/".concat(e)).then(t=>{let{data:n}=t;n.uuid=e,I(n)}).catch(e=>{(0,u.Z)(e)}).finally(()=>{b(!1),null==t||t.call(null)})},[b,I]),ev=(0,o.useMemo)(()=>(0,r.jsx)($.Z,{allowEdit:!0,allowItemButton:x,disableDelete:!en,edit:x,header:!0,listEmpty:"No manifest(s) registered.",listItems:M,onAdd:()=>{var e;null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var e;d(Y({onProceedAppend:()=>{E({body:{uuids:ee},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Delete manifest(s) failed. ",e]}),method:"delete",onSuccess:()=>{U(),er()},url:"/manifest"})},getConfirmDialogTitle:e=>"Delete ".concat(e," manifest(s)?"),renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(S.Ac,{children:null==M?void 0:M[t].manifestName})}})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>{f(e=>!e)},onItemCheckboxChange:(e,t,n)=>{es(e,n)},onItemClick:e=>{var t;let{manifestName:n,manifestUUID:r}=e;I({name:n,uuid:r}),null===(t=s.current.setOpen)||void 0===t||t.call(null,!0),ej(r)},renderListItemCheckboxState:e=>et(e),renderListItem:(e,t)=>{let{manifestName:n}=t;return(0,r.jsxs)(Z.Z,{fullWidth:!0,row:!0,children:[(0,r.jsx)(eh.Z,{disabled:x,mapPreset:"play",onClick:()=>{var t;I({name:n,uuid:e}),null===(t=l.current.setOpen)||void 0===t||t.call(null,!0),ej(e)},variant:"normal"}),(0,r.jsx)(S.Ac,{children:n})]})}}),[Y,ee,et,ej,U,en,x,M,er,es,d,I,E]),eZ=(0,o.useMemo)(()=>g||w||T?(0,r.jsx)(q.Z,{}):ev,[g,T,w,ev]),eb=(0,o.useMemo)(()=>(0,r.jsx)(W.Z,{count:1,defaultMessageType:"warning",ref:a}),[]);return e&&(i.Z.get("/manifest/template").then(e=>{let{data:t}=e;F(t)}).catch(e=>{(0,u.Z)(e)}).finally(()=>{y(!1)}),i.Z.get("/host",{params:{types:"node"}}).then(e=>{let{data:t}=e;p(t)}).catch(e=>{(0,u.Z)(e)}).finally(()=>{j(!1)})),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(k.s_,{children:[(0,r.jsx)(k.V9,{children:(0,r.jsx)(S.z,{children:"Manage manifests"})}),eZ]}),(0,r.jsx)(V.Z,{...ex,disableProceed:N,loadingAction:R,preActionArea:eb,ref:n,scrollContent:!0,showClose:!0}),(0,r.jsx)(V.Z,{...ef,disableProceed:N,loadingAction:R,preActionArea:eb,ref:s,scrollContent:!0,showClose:!0}),(0,r.jsx)(V.Z,{...eg,disableProceed:_,loadingAction:H,preActionArea:eb,ref:l,scrollContent:!0,showClose:!0}),(0,r.jsx)(L.Z,{closeOnProceed:!0,...c,ref:t,scrollContent:!0,wide:!0})]})};let tF="common-ups-input-ip-address",tT="common-ups-input-host-name",tU="IP address",tO="Host name";var tN=e=>{let{formUtils:{buildFinishInputTestBatchFunction:t,buildInputFirstRenderFunction:n,setMessage:s},previous:{upsIPAddress:l,upsName:a}={}}=e;return(0,r.jsx)(d.Z,{columns:{xs:1,sm:2},layout:{"common-ups-input-cell-host-name":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:tT,label:tO,value:a}),inputTestBatch:(0,F.Gn)(tO,()=>{s(tT)},{onFinishBatch:t(tT)},e=>{s(tT,{children:e})}),onFirstRender:n(tT),required:!0})},"common-ups-input-cell-ip-address":{children:(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{id:tF,label:tU,value:l}),inputTestBatch:(0,F._)(tU,()=>{s(tF)},{onFinishBatch:t(tF)},e=>{s(tF,{children:e})}),onFirstRender:n(tF),required:!0})}},spacing:"1em"})},tR=n(86549);let tE="add-ups-select-ups-type-id";var tD=e=>{let{formUtils:t,loading:n,previous:s={},upsTemplate:l}=e,{buildInputFirstRenderFunction:a,setValidity:i}=t,{upsTypeId:c=""}=s,d=(0,B.Z)(),[u,h]=(0,o.useState)(c),m=(0,o.useMemo)(()=>l?Object.entries(l).map(e=>{let t,[n,{brand:s,description:l,links:{0:a}}]=e;if(a){let{linkHref:e,linkLabel:n}=a;t=(0,r.jsx)(tR.Z,{href:e,onClick:e=>{e.stopPropagation()},sx:{display:"inline-flex",color:C.E5},target:"_blank",children:n})}return{displayValue:(0,r.jsxs)(Z.Z,{spacing:0,children:[(0,r.jsx)(S.Ac,{inverted:!0,children:s}),(0,r.jsxs)(S.Ac,{inverted:!0,children:[l," (",t,")"]})]}),value:n}}):[],[l]),p=(0,o.useMemo)(()=>l&&(0,r.jsx)(y.Z,{formControlProps:{sx:{marginTop:".3em"}},id:tE,label:"UPS type",onChange:e=>{let{target:{value:t}}=e,n=String(t);i(tE,!0),h(n)},required:!0,selectItems:m,selectProps:{onClearIndicatorClick:()=>{i(tE,!1),h("")},renderValue:e=>{let{brand:t}=l[String(e)];return t}},value:u}),[l,m,u,i]),x=(0,o.useMemo)(()=>n?(0,r.jsx)(q.Z,{}):(0,r.jsxs)(Z.Z,{children:[p,u&&(0,r.jsx)(tN,{formUtils:t,previous:s})]}),[t,u,n,p,s]);return(0,o.useEffect)(()=>{d&&a(tE)({isValid:!!u})},[a,u,d]),x};let tq="edit-ups-input-ups-uuid";var tB=e=>{let{formUtils:t,loading:n,previous:s,upsTemplate:l,upsUUID:a}=e;return(0,o.useMemo)(()=>n?(0,r.jsx)(q.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tD,{formUtils:t,previous:s,upsTemplate:l}),(0,r.jsx)("input",{hidden:!0,id:tq,readOnly:!0,value:a})]}),[t,n,s,l,a])};let t_=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let[{target:s}]=n,{elements:l}=s,{value:a}=l.namedItem(tT),{value:o}=l.namedItem(tF),i=l.namedItem(tE),c="",d="",u="";i&&({value:u}=i,{agent:c,brand:d}=e[u]);let h=l.namedItem(tq),m="";return h&&({value:m}=h),{agent:c,brand:d,ipAddress:o,name:a,typeId:u,uuid:m}},tH=e=>{let{brand:t,ipAddress:n,name:s,uuid:l}=e;return(0,r.jsx)($.Z,{listItems:{"ups-brand":{label:"Brand",value:t},"ups-name":{label:"Host name",value:s},"ups-ip-address":{label:"IP address",value:n}},listItemProps:{sx:{padding:0}},renderListItem:(e,t)=>{let{label:n,value:s}=t;return(0,r.jsxs)(Z.Z,{fullWidth:!0,growFirst:!0,row:!0,children:[(0,r.jsx)(S.Ac,{children:n}),(0,r.jsx)(S.$_,{children:s})]},"confirm-ups-".concat(l,"-").concat(e))}})};var tL=()=>{let e=(0,B.Z)(),t=(0,o.useRef)({}),n=(0,o.useRef)({}),s=(0,o.useRef)({}),[l,a]=(0,K.Z)(),[c,d]=(0,K.Z)(),[h,p]=(0,o.useState)(!1),[x,f]=(0,o.useState)(!0),[g,j]=(0,o.useState)(),{data:v,isLoading:b}=(0,J.Z)("".concat(m.Z,"/ups"),{refreshInterval:6e4}),w=(0,X.Z)([tF,tT,tE],s),{isFormInvalid:y,isFormSubmitting:M,submitForm:P}=w,{buildDeleteDialogProps:C,checks:I,getCheck:A,hasChecks:F,setCheck:T}=(0,Q.Z)({list:v}),U=(0,o.useCallback)(e=>{var n,s;let{upsAgent:l,upsIPAddress:o,upsName:i,upsUUID:c}=e,d=null!==(s=null===(n=Object.entries(null!=g?g:{}).find(e=>{let[,{agent:t}]=e;return l===t}))||void 0===n?void 0:n[0])&&void 0!==s?s:"";return{actionProceedText:"Update",content:(0,r.jsx)(tB,{formUtils:w,previous:{upsIPAddress:o,upsName:i,upsTypeId:d},upsTemplate:g,upsUUID:c}),onSubmitAppend:e=>{var n;if(!g)return;let s=t_(g,e),{name:l}=s;a({actionProceedText:"Update",content:tH(s),onProceedAppend:()=>{P({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to update UPS. ",e]}),method:"put",successMsg:"Successfully updated UPS ".concat(i),url:"/ups/".concat(c)})},titleText:(0,r.jsxs)(S.z,{children:["Update"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:l})," ","with the following data?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:(0,r.jsxs)(S.z,{children:["Update UPS"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:i})]})}},[w,a,P,g]),O=(0,o.useMemo)(()=>({actionProceedText:"Add",content:(0,r.jsx)(tD,{formUtils:w,upsTemplate:g}),onSubmitAppend:e=>{var n;if(!g)return;let s=t_(g,e),{brand:l,name:o}=s;a({actionProceedText:"Add",content:tH(s),onProceedAppend:()=>{P({body:s,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to add UPS. ",e]}),method:"post",successMsg:"Successfully added UPS ".concat(o),url:"/ups"})},titleText:(0,r.jsxs)(S.z,{children:["Add a"," ",(0,r.jsx)(S.Q0,{fontSize:"inherit",children:l})," UPS with the following data?"]})}),null===(n=t.current.setOpen)||void 0===n||n.call(null,!0)},titleText:"Add a UPS"}),[w,a,P,g]),N=(0,o.useMemo)(()=>(0,r.jsx)($.Z,{allowEdit:!0,allowItemButton:h,disableDelete:!F,edit:h,header:!0,listEmpty:"No Ups(es) registered.",listItems:v,onAdd:()=>{var e;d(O),null===(e=n.current.setOpen)||void 0===e||e.call(null,!0)},onDelete:()=>{var e;a(C({getConfirmDialogTitle:e=>"Delete ".concat(e," UPSes?"),onProceedAppend:()=>{P({body:{uuids:I},getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to delete UPS(es). ",e]}),method:"delete",url:"/ups"})},renderEntry:e=>{let{key:t}=e;return(0,r.jsx)(S.Ac,{children:null==v?void 0:v[t].upsName})}})),null===(e=t.current.setOpen)||void 0===e||e.call(null,!0)},onEdit:()=>{p(e=>!e)},onItemCheckboxChange:(e,t,n)=>{T(e,n)},onItemClick:e=>{var t;d(U(e)),null===(t=n.current.setOpen)||void 0===t||t.call(null,!0)},renderListItemCheckboxState:e=>A(e),renderListItem:(e,t)=>{let{upsAgent:n,upsIPAddress:s,upsName:l}=t;return(0,r.jsxs)(Z.Z,{fullWidth:!0,row:!0,children:[(0,r.jsx)(S.Ac,{children:l}),(0,r.jsxs)(S.Ac,{children:['agent="',n,'"']}),(0,r.jsxs)(S.Ac,{children:['ip="',s,'"']})]})}}),[O,C,U,I,A,F,h,T,a,d,P,v]),R=(0,o.useMemo)(()=>x||b?(0,r.jsx)(q.Z,{}):N,[x,b,N]),E=(0,o.useMemo)(()=>(0,r.jsx)(W.Z,{count:1,defaultMessageType:"warning",ref:s}),[]);return e&&i.Z.get("/ups/template").then(e=>{let{data:t}=e;j(t)}).catch(e=>{(0,u.Z)(e)}).finally(()=>{f(!1)}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(k.s_,{children:[(0,r.jsx)(k.V9,{children:(0,r.jsx)(S.z,{children:"Manage UPSes"})}),R]}),(0,r.jsx)(V.Z,{...c,disableProceed:y,loadingAction:M,preActionArea:E,ref:n,showClose:!0}),(0,r.jsx)(L.Z,{closeOnProceed:!0,...l,ref:t})]})},tz=n(99429),tV=n(4244);let tG="prepare-network-host-name-input",t$="prepare-network-netconf-input-group",tW="Host name",tJ=function(e){let{netconf:t}=e;for(var n,r=arguments.length,s=Array(r>1?r-1:0),l=1;l<r;l++)s[l-1]=arguments[l];let[{target:a}]=s,{elements:o}=a,{value:i}=o.namedItem(tG);return{hostName:i,...null===(n=t.get)||void 0===n?void 0:n.call(null)}},tQ=e=>{let{networks:t=[],...n}=e,r=t.reduce((e,t)=>{let{interfaces:n,ipAddress:r,name:s="",type:l,typeCount:a,subnetMask:o}=t,i="".concat(l).concat(a),c=n.reduce((e,t,n)=>{if(t){let{networkInterfaceName:r}=t;e["link".concat(n+1)]=r}return e},{});return e[i]={name:s,network:"".concat(r,"/").concat(o),...c},e},{});return{...n,networks:r}};var tK=e=>{let{expectUUID:t=!1,hostUUID:n}=e,{isReady:s,query:{host_uuid:l}}=(0,a.useRouter)(),d=(0,o.useRef)({}),h=(0,o.useRef)({}),m=(0,o.useRef)({}),[p,x]=(0,K.Z)(),[f,g]=(0,o.useState)(),[j,v]=(0,o.useState)(),[y,M]=(0,o.useState)(!0),[P,C]=(0,o.useState)(),{buildFinishInputTestBatchFunction:I,buildInputFirstRenderFunction:A,isFormInvalid:T,setMessage:U,setValidity:O,submitForm:N}=(0,X.Z)([tG,t$],m),R=(0,o.useMemo)(()=>n!==P,[n,P]),E=(0,o.useMemo)(()=>!!n&&R,[n,R]),D=(0,o.useMemo)(()=>(0,r.jsx)(k.V9,{children:(0,r.jsxs)(S.z,{children:["Prepare network on ",null==f?void 0:f.shortHostName]})}),[f]),B=(0,o.useMemo)(()=>(0,r.jsx)(tV.Z,{expectHostDetail:!0,hostDetail:f,ref:h,toggleSubmitDisabled:e=>{O(t$,e)}}),[f,O]),_=(0,o.useMemo)(()=>(0,r.jsx)(W.Z,{count:1,defaultMessageType:"warning",ref:m}),[]),H=(0,o.useMemo)(()=>y?(0,r.jsx)(q.Z,{mt:0}):j?(0,r.jsx)(eT.Z,{...j}):(0,r.jsxs)(r.Fragment,{children:[D,(0,r.jsxs)(Z.Z,{component:"form",onSubmit:function(){for(var e,t=arguments.length,s=Array(t),l=0;l<t;l++)s[l]=arguments[l];let[a]=s;a.preventDefault();let o=tJ({netconf:h.current},...s);x({actionProceedText:"Prepare",content:(0,r.jsx)(G.Z,{entries:tQ(o),getEntryLabel:e=>{let{cap:t,key:n}=e;return/^(dns|[a-z]+n\d+)/.test(n)?n.toUpperCase():t(n)}}),onProceedAppend:()=>{var e;N({body:o,getErrorMsg:e=>(0,r.jsxs)(r.Fragment,{children:["Failed to prepare network. ",e]}),method:"put",setMsg:null==h?void 0:null===(e=h.current)||void 0===e?void 0:e.setMessage,successMsg:"Initiated prepare network on ".concat(null==f?void 0:f.shortHostName),url:"/host/".concat(n,"?handler=subnode-network")})},titleText:"Prepare ".concat(null==f?void 0:f.shortHostName," network?")}),null===(e=d.current.setOpen)||void 0===e||e.call(null,!0)},children:[(0,r.jsx)(b.Z,{input:(0,r.jsx)(w.Z,{formControlProps:{sx:{maxWidth:"20em"}},id:tG,label:tW,value:null==f?void 0:f.hostName}),inputTestBatch:(0,F.Gn)(tW,()=>{U(tG)},{onFinishBatch:I(tG)},e=>{U(tG,{children:e})}),onFirstRender:A(tG),required:!0}),_,B,(0,r.jsx)(Z.Z,{row:!0,justifyContent:"flex-end",children:(0,r.jsx)(tz.Z,{disabled:T,type:"submit",children:"Prepare network"})})]})]}),[y,j,D,null==f?void 0:f.hostName,null==f?void 0:f.shortHostName,I,A,_,B,T,x,N,n,U]),z=(0,o.useCallback)(e=>{M(!0),y&&i.Z.get("/host/".concat(e)).then(e=>{let{data:t}=e;C(t.hostUUID),g(t)}).catch(e=>{let{children:t}=(0,u.Z)(e);v({children:"Failed to get target host information; cannot continue. ".concat(t),type:"error"})}).finally(()=>{M(!1)})},[M,y,C,g,v]);return(0,o.useEffect)(()=>{t?E&&z(n):s&&!j&&(l?z(c(l)):(v({children:"No host UUID provided; cannot continue.",type:"error"}),M(!1)))},[j,z,n,t,s,l,v,g,M,E]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.s_,{children:H}),(0,r.jsx)(L.Z,{closeOnProceed:!0,scrollContent:!0,...p,ref:d})]})},tX=n(7111),tY=n(16826),t0=e=>{let{label:t,...n}=e,s=(0,o.useMemo)(()=>"string"==typeof t?(0,r.jsx)(S.Ac,{inheritColour:!0,children:t}):t,[t]);return(0,r.jsx)(tX.Z,{...n,label:s,sx:{borderRadius:C.n_,color:C.s7,padding:".4em .8em",textTransform:"none",["&.".concat(tY.Z.selected)]:{color:C.Ej}}})},t1=e=>{let{changingTabId:t,children:n,retain:s=!1,tabId:l}=e,a=(0,o.useMemo)(()=>t===l,[t,l]),i=(0,o.useMemo)(()=>s?(0,r.jsx)(x.Z,{sx:{display:a?"initial":"none"},children:n}):a&&n,[n,a,s]);return(0,r.jsx)(r.Fragment,{children:i})},t2=n(49360),t8=n(63885),t5=n(17038),t9=n(93124);let t4="1.8em";var t3=e=>{let{orientation:t,variant:n="fullWidth",...s}=e,l=(0,t2.Z)(),a=(0,o.useCallback)(e=>l.breakpoints.up(e),[l]),i=(0,t8.Z)(a("xs")),c=(0,t8.Z)(a("sm")),d=(0,t8.Z)(a("md")),u=(0,t8.Z)(a("lg")),h=(0,t8.Z)(a("xl")),m=(0,o.useMemo)(()=>[["xs",i],["sm",c],["md",d],["lg",u],["xl",h]],[u,d,c,h,i]),p=(0,o.useMemo)(()=>{let e;return"object"==typeof t?m.some(n=>{let[r,s]=n;return s&&t[r]&&(e=t[r]),!s}):e=t,e},[m,t]);return(0,r.jsx)(t5.Z,{...s,orientation:p,variant:n,sx:{minHeight:"1em",["&.".concat(t9.Z.vertical)]:{minHeight:t4,["& .".concat(tY.Z.root)]:{alignItems:"flex-start",minHeight:t4,paddingLeft:"2em"},["& .".concat(t9.Z.indicator)]:{right:"initial"}},["& .".concat(tY.Z.root)]:{minHeight:"1em"},["& .".concat(t9.Z.indicator)]:{backgroundColor:C.Ej,borderRadius:C.n_}}})};let t7="prepare-host",t6="prepare-network",ne="manage-fence",nt="manage-ups",nn="manage-manifest",nr={[t7]:"Prepare Host",[t6]:"Prepare Network",[ne]:"Manage Fence Devices",[nt]:"Manage UPSes",[nn]:"Manage Manifests"},ns="Loading",nl={md:8,sm:6,xs:1},na={md:6,sm:4,xs:1},no=()=>(0,r.jsx)(d.Z,{columns:nl,layout:{"preparehost-left-column":{},"preparehost-center-column":{children:(0,r.jsxs)(k.s_,{children:[(0,r.jsx)(k.V9,{children:(0,r.jsx)(S.z,{children:"Hosts"})}),(0,r.jsx)(eA,{})]}),...na}}}),ni=()=>{let e=(0,B.Z)(),[t,n]=(0,o.useState)(),[s,l]=(0,o.useState)(!1),a=(0,o.useMemo)(()=>{let e;if(t){let n=Object.entries(t);e=(0,r.jsx)(t3,{onChange:(e,t)=>{l(t)},orientation:"vertical",value:s,children:n.map(e=>{let[t,{shortHostName:n}]=e;return(0,r.jsx)(t0,{label:n,value:t},"".concat(t6,"-").concat(t))})})}else e=(0,r.jsx)(q.Z,{mt:0});return e},[t,s]);return e&&i.Z.get("/host",{params:{types:["dr","node"]}}).then(e=>{let{data:t}=e;n(t),l(Object.keys(t)[0])}).catch(e=>{(0,u.Z)(e)}),(0,r.jsx)(d.Z,{columns:nl,layout:{"preparenetwork-left-column":{children:(0,r.jsx)(k.s_,{children:a}),sm:2},"preparenetwork-center-column":{children:(0,r.jsx)(tK,{expectUUID:!0,hostUUID:s||void 0}),...na}}})},nc=()=>(0,r.jsx)(d.Z,{columns:nl,layout:{"managefence-left-column":{},"managefence-center-column":{children:(0,r.jsx)(es,{}),...na}}}),nd=()=>(0,r.jsx)(d.Z,{columns:nl,layout:{"manageups-left-column":{},"manageups-center-column":{children:(0,r.jsx)(tL,{}),...na}}}),nu=()=>(0,r.jsx)(d.Z,{columns:nl,layout:{"managemanifest-left-column":{},"managemanifest-center-column":{children:(0,r.jsx)(tA,{}),...na}}});var nh=()=>{let{isReady:e,query:{step:t}}=(0,a.useRouter)(),[n,s]=(0,o.useState)(!1),[i,d]=(0,o.useState)(ns);return(0,o.useEffect)(()=>{if(e){let e=c(t,{fallbackValue:t7});nr[e]||(e=t7),i===ns&&d(nr[e]),n||s(e)}},[e,n,i,t]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l(),{children:(0,r.jsx)("title",{children:i})}),(0,r.jsx)(h.Z,{}),(0,r.jsx)(k.s_,{children:(0,r.jsxs)(t3,{onChange:(e,t)=>{s(t),d(nr[t])},orientation:{xs:"vertical",sm:"horizontal"},value:n,children:[(0,r.jsx)(t0,{label:"Prepare host",value:t7}),(0,r.jsx)(t0,{label:"Prepare network",value:t6}),(0,r.jsx)(t0,{label:"Manage fence devices",value:ne}),(0,r.jsx)(t0,{label:"Manage UPSes",value:nt}),(0,r.jsx)(t0,{label:"Manage manifests",value:nn})]})}),(0,r.jsx)(t1,{changingTabId:n,tabId:t7,children:(0,r.jsx)(no,{})}),(0,r.jsx)(t1,{changingTabId:n,tabId:t6,children:(0,r.jsx)(ni,{})}),(0,r.jsx)(t1,{changingTabId:n,tabId:ne,children:(0,r.jsx)(nc,{})}),(0,r.jsx)(t1,{changingTabId:n,tabId:nt,children:(0,r.jsx)(nd,{})}),(0,r.jsx)(t1,{changingTabId:n,tabId:nn,children:(0,r.jsx)(nu,{})})]})}}},function(e){e.O(0,[572,442,318,341,514,242,74,461,602,982,161,858,616,762,761,512,784,888,774,179],function(){return e(e.s=29582)}),_N_E=e.O()}]);