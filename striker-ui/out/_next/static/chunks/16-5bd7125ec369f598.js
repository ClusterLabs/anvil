"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{93016:function(e,n,t){t.d(n,{S:function(){return R},M:function(){return X}});var l=t(85893),r=t(53183),s=t(24378),i=t(12641),o=t(55278),c=t(89262),a=t(14440),u=t(65086),d=t(94246),x=t(5152),h=t.n(x),f=t(67294),v=t(65895);let j="0xffe3",m="0xffe9";var p=[{keys:"Ctrl + Alt + Delete",scans:[]},{keys:"Ctrl + Alt + F1",scans:[j,m,"0xffbe"]},{keys:"Ctrl + Alt + F2",scans:[j,m,"0xffbf"]},{keys:"Ctrl + Alt + F3",scans:[j,m,"0xffc0"]},{keys:"Ctrl + Alt + F4",scans:[j,m,"0xffc1"]},{keys:"Ctrl + Alt + F5",scans:[j,m,"0xffc2"]},{keys:"Ctrl + Alt + F6",scans:[j,m,"0xffc3"]},{keys:"Ctrl + Alt + F7",scans:[j,m,"0xffc4"]},{keys:"Ctrl + Alt + F8",scans:[j,m,"0xffc5"]},{keys:"Ctrl + Alt + F9",scans:[j,m,"0xffc6"]}],C=t(23833),g=t(23930),Z=t(5552),w=t(98484),k=t(14789),b=t(99429),y=t(60207),S=e=>{let{getItemDisabled:n,items:t={},muiMenuProps:r,onItemClick:s,open:i,renderItem:o}=e,c=(0,f.useMemo)(()=>Object.entries(t),[t]),a=(0,f.useMemo)(()=>c.map(e=>{let[t,r]=e;return(0,l.jsx)(C.Z,{disabled:null==n?void 0:n.call(null,t,r),onClick:function(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];return null==s?void 0:s.call(null,t,r,...n)},children:null==o?void 0:o.call(null,t,r)},t)}),[n,s,c,o]);return(0,l.jsx)(u.Z,{open:i,...r,children:a})},A=e=>{let{children:n,containedButtonProps:t,iconButtonProps:r,muiMenuProps:s,onButtonClick:i,onItemClick:o,variant:c="icon",...u}=e,[d,x]=(0,f.useState)(null),h=(0,f.useMemo)(()=>!!d,[d]),v=(0,f.useMemo)(()=>n||("icon"===c?(0,l.jsx)(k.Z,{fontSize:null==r?void 0:r.size}):"Options"),[n,null==r?void 0:r.size,c]),j=(0,f.useCallback)(function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];let{0:{currentTarget:l}}=n;return x(l),null==i?void 0:i.call(null,...n)},[i]),m=(0,f.useMemo)(()=>"contained"===c?(0,l.jsx)(b.Z,{onClick:j,...t,children:v}):(0,l.jsx)(y.Z,{onClick:j,...r,children:v}),[j,v,t,r,c]),p=(0,f.useCallback)(function(e,n){for(var t=arguments.length,l=Array(t>2?t-2:0),r=2;r<t;r++)l[r-2]=arguments[r];return x(null),null==o?void 0:o.call(null,e,n,...l)},[o]);return(0,l.jsxs)(a.Z,{children:[m,(0,l.jsx)(S,{muiMenuProps:{anchorEl:d,keepMounted:!0,onClose:()=>x(null),...s},onItemClick:p,open:h,...u})]})},F=t(97607),P=t(59278),M=t(2188),z=e=>{var n;let{getItemDisabled:t,items:r,onItemClick:s,renderItem:i,serverName:o,serverState:c,serverUuid:u,...d}=e,{confirmDialog:x,setConfirmDialogOpen:h,setConfirmDialogProps:v,finishConfirm:j}=(0,M.Z)(),m=(0,f.useMemo)(()=>({"force-off":{colour:"red",description:(0,l.jsx)(l.Fragment,{children:"This is equal to pulling the power cord, which may cause data loss or system corruption."}),label:"Force off",path:"/command/stop-server/".concat(u,"?force=1")},"power-off":{description:(0,l.jsx)(l.Fragment,{children:"This is equal to pushing the power button. If the server doesn't respond to the corresponding signals, you may have to manually shut it down."}),label:"Power off",path:"/command/stop-server/".concat(u)},"power-on":{description:(0,l.jsx)(l.Fragment,{children:"This is equal to pushing the power button."}),label:"Power on",path:"/command/start-server/".concat(u)}}),[u]);return(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(A,{getItemDisabled:e=>"running"===c===e.includes("on"),items:m,onItemClick:(e,n)=>{let{colour:t,description:r,label:s,path:i}=n,c=s.toLocaleLowerCase();v({actionProceedText:s,content:(0,l.jsx)(P.Ac,{children:r}),onProceedAppend:()=>{v(e=>({...e,loading:!0})),w.Z.put(i).then(()=>{j("Success",{children:(0,l.jsxs)(l.Fragment,{children:["Successfully registered ",c," job on ",o,"."]})})}).catch(e=>{let n=(0,F.Z)(e);n.children=(0,l.jsxs)(l.Fragment,{children:["Failed to register ",c," job on ",o,"; CAUSE:"," ",n.children,"."]}),j("Error",n)})},proceedColour:t,titleText:"".concat(s," server ").concat(o,"?")}),h(!0)},renderItem:(e,n)=>{let t;let{colour:r,label:s}=n;return r&&(t=b.D[r]),(0,l.jsx)(P.Ac,{inheritColour:!0,color:t,children:s})},...d,children:(0,l.jsx)(Z.Z,{fontSize:null==d?void 0:null===(n=d.iconButtonProps)||void 0===n?void 0:n.size})}),x]})},E=t(53541),B=t(6946),I=t(6631);let T="FullSize",U={displayBox:"".concat(T,"-displayBox"),spinnerBox:"".concat(T,"-spinnerBox")},N=(0,c.ZP)("div")(()=>({["& .".concat(U.displayBox)]:{width:"75vw",height:"75vh"},["& .".concat(U.spinnerBox)]:{flexDirection:"column",width:"75vw",height:"75vh",alignItems:"center",justifyContent:"center"}})),_=h()(()=>Promise.all([t.e(460),t.e(724)]).then(t.bind(t,38724)),{loadableGenerated:{webpack:()=>[38724]},ssr:!1}),D={1e3:"in-use by another process?",1006:"destination is down?"},L=(e,n)=>"ws://".concat(e,"/ws/server/vnc/").concat(n);var R=e=>{let{onClickCloseButton:n,serverUUID:t,serverName:c,vncReconnectTimerStart:x=10}=e,{buildCookieJar:h}=(0,B.Z)(),j=(0,I.Z)(),[m,Z]=(0,f.useState)(null),[w,k]=(0,f.useState)(void 0),[b,y]=(0,f.useState)(!1),[S,A]=(0,f.useState)(!1),[F,M]=(0,f.useState)(),[T,R]=(0,f.useState)(),[q,O]=(0,f.useState)(x),G=(0,f.useRef)(null),H=(0,f.useRef)(null),K=e=>{Z(e.currentTarget)},V=e=>{if(G.current){if(e.length){for(let n=0;n<=e.length-1;n+=1)G.current.sendKey(e[n],1);for(let n=e.length-1;n>=0;n-=1)G.current.sendKey(e[n],0)}else G.current.sendCtrlAltDel();Z(null)}},J=(0,f.useCallback)(()=>{y(!0),A(!1),k({url:L(window.location.host,t)})},[t]),W=(0,f.useCallback)(()=>{(null==G?void 0:G.current)&&(G.current.disconnect(),G.current=null),k(void 0)},[]),$=(0,f.useCallback)(()=>{W(),J()},[J,W]),Q=(0,f.useCallback)(()=>{let e=setInterval(()=>{O(n=>{let t=n-1;return t<1&&clearInterval(e),t})},1e3)},[]),X=(0,f.useCallback)(()=>{y(!1)},[]),Y=(0,f.useCallback)(e=>{let{detail:n}=e,{clean:t}=n;t||(y(!1),A(!0),Q())},[Q]),ee=(0,f.useCallback)(e=>{if(!e){M(void 0);return}let{code:n,reason:l}=e,r="ws: ".concat(n),s=D[n];s&&(r+=" (".concat(s,")")),l&&(r+=", ".concat(l)),M(r);let i=h()["suiapi.vncerror.".concat(t)];if(!i){R(void 0);return}let{code:o,message:c}=i;R("api: ".concat(o,", ").concat(c))},[h,t]),en=(0,f.useMemo)(()=>!b&&!S,[b,S]),et=(0,f.useMemo)(()=>(0,l.jsx)(a.Z,{children:(0,l.jsx)(v.Z,{onClick:()=>{var e;null===(e=H.current)||void 0===e||e.requestFullscreen()},children:(0,l.jsx)(r.Z,{})})}),[]),el=(0,f.useMemo)(()=>(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(v.Z,{onClick:K,children:(0,l.jsx)(s.Z,{})}),(0,l.jsx)(u.Z,{anchorEl:m,keepMounted:!0,open:!!m,onClose:()=>Z(null),children:p.map(e=>{let{keys:n,scans:t}=e;return(0,l.jsx)(C.Z,{onClick:()=>V(t),children:(0,l.jsx)(d.Z,{variant:"subtitle1",children:n})},n)})})]}),[m]),er=(0,f.useMemo)(()=>(0,l.jsx)(a.Z,{children:(0,l.jsx)(v.Z,{onClick:function(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];W(),null==n||n.call(null,...t)},children:(0,l.jsx)(i.Z,{})})}),[W,n]),es=(0,f.useMemo)(()=>(0,l.jsx)(a.Z,{children:(0,l.jsx)(v.Z,{onClick:()=>{window&&(W(),window.location.assign("/"))},children:(0,l.jsx)(o.Z,{})})}),[W]),ei=(0,f.useMemo)(()=>en&&(0,l.jsxs)(l.Fragment,{children:[et,el,(0,l.jsx)(z,{serverName:c,serverState:"running",serverUuid:t}),es,er]}),[et,el,es,c,t,en,er]);return(0,f.useEffect)(()=>{0===q&&(O(x),$())},[$,q,x]),(0,f.useEffect)(()=>{j&&J()},[J,j]),(0,l.jsxs)(g.s_,{children:[(0,l.jsxs)(g.V9,{children:[(0,l.jsx)(P.z,{text:"Server: ".concat(c)}),ei]}),(0,l.jsxs)(N,{children:[(0,l.jsx)(a.Z,{display:en?"flex":"none",className:U.displayBox,children:(0,l.jsx)(_,{onConnect:X,onDisconnect:Y,onWsClose:ee,rfb:G,rfbConnectArgs:w,rfbScreen:H})}),!en&&(0,l.jsxs)(a.Z,{display:"flex",className:U.spinnerBox,textAlign:"center",children:[b&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(P.z,{children:["Connecting to ",c,"."]}),(0,l.jsx)(E.Z,{})]}),S&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.z,{children:"Can't connect to the server."}),(0,l.jsx)(P.Ac,{children:T}),(0,l.jsx)(P.Ac,{children:F}),(0,l.jsxs)(P.z,{mt:".5em",children:["Retrying in ",q,"."]})]})]})]})]})},q=t(59826),O=t(27095),G=t(80594),H=t(77831),K=t(56903),V=t(41021);let J={externalPreview:"",externalTimestamp:0,headerEndAdornment:null,hrefPreview:void 0,isExternalLoading:!1,isExternalPreviewStale:!1,isFetchPreview:!0,isShowControls:!0,isUseInnerPanel:!1,onClickConnectButton:void 0,onClickPreview:void 0,serverName:"",serverState:""},W=e=>{let{children:n,isUseInnerPanel:t}=e;return t?(0,l.jsx)(g.Lg,{children:n}):(0,l.jsx)(g.s_,{children:n})},$=e=>{let{children:n,isUseInnerPanel:t,text:r}=e;return t?(0,l.jsxs)(g.CH,{children:[r?(0,l.jsx)(P.Ac,{text:r}):(0,l.jsx)(l.Fragment,{}),n]}):(0,l.jsxs)(g.V9,{children:[r?(0,l.jsx)(P.z,{text:r}):(0,l.jsx)(l.Fragment,{}),n]})},Q=e=>{let{externalPreview:n=J.externalPreview,externalTimestamp:t=J.externalTimestamp,headerEndAdornment:r,hrefPreview:s,isExternalLoading:i=J.isExternalLoading,isExternalPreviewStale:o=J.isExternalPreviewStale,isFetchPreview:c=J.isFetchPreview,isShowControls:u=J.isShowControls,isUseInnerPanel:d=J.isUseInnerPanel,onClickPreview:x,serverName:h=J.serverName,serverState:j=J.serverState,serverUUID:m,onClickConnectButton:p=x}=e,[C,g]=(0,f.useState)(!0),[Z,k]=(0,f.useState)(!1),[b,y]=(0,f.useState)(""),[S,A]=(0,f.useState)(0),F=(0,V.zO)(),M=(0,f.useMemo)(()=>"running"===j?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Z,{alt:"Preview is temporarily unavailable, but the server is ".concat(j,"."),component:"img",src:"data:image;base64,".concat(b),sx:{height:"100%",minHeight:"10em",opacity:Z?"0.4":"1",padding:d?".2em":0,width:"100%"}}),Z&&(e=>{let{unit:n,value:t}=(0,V._J)(F-e);return(0,l.jsxs)(P.Ac,{position:"absolute",children:["Updated ~",t," ",n," ago"]})})(S)]}):(0,l.jsx)(q.Z,{sx:{color:H.UZ,height:"80%",width:"80%"}}),[Z,d,F,b,S,j]),B=(0,f.useMemo)(()=>{if(C)return(0,l.jsx)(E.Z,{mb:"1em",mt:"1em"});let e=!b,n={borderRadius:H.n_,color:H.s7,padding:0};return s?(0,l.jsx)(G.Z,{disabled:e,href:s,sx:n,children:M}):(0,l.jsx)(G.Z,{component:"span",disabled:e,onClick:x,sx:n,children:M})},[s,C,b,M,x]);return(0,f.useEffect)(()=>{c?(async()=>{try{let{data:e}=await w.Z.get("/server/".concat(m,"?ss=1")),{screenshot:n,timestamp:t}=e;y(n),A(t),k(!(0,V.Z$)(t,300))}catch(e){k(!0)}finally{g(!1)}})():i||(y(n),A(t),k(o),g(!1))},[n,t,i,o,c,m]),(0,l.jsxs)(W,{isUseInnerPanel:d,children:[(0,l.jsxs)($,{isUseInnerPanel:d,text:h,children:[r,(0,l.jsx)(z,{iconButtonProps:{size:d?"small":void 0},serverName:h,serverState:j,serverUuid:m})]}),(0,l.jsxs)(K.Z,{row:!0,sx:{"& > :first-child":{flexGrow:1}},children:[(0,l.jsx)(a.Z,{textAlign:"center",children:B}),u&&b&&(0,l.jsx)(K.Z,{spacing:".3em",children:(0,l.jsx)(v.Z,{onClick:p,children:(0,l.jsx)(O.Z,{})})})]})]})};Q.defaultProps=J;var X=Q},2188:function(e,n,t){var l=t(85893),r=t(67294),s=t(77583),i=t(99576);n.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{initial:{actionProceedText:n="",content:t="",titleText:o="",...c}={}}=e,a=(0,r.useRef)(null),[u,d]=(0,r.useState)({actionProceedText:n,content:t,titleText:o}),x=(0,r.useCallback)(e=>d(n=>{let{loading:t,...l}=n;return{...l,loading:e}}),[]),h=(0,r.useCallback)(e=>{var n,t;return null==a?void 0:null===(t=a.current)||void 0===t?void 0:null===(n=t.setOpen)||void 0===n?void 0:n.call(null,e)},[]),f=(0,r.useCallback)((e,n)=>d({actionProceedText:"",content:(0,l.jsx)(i.Z,{...n}),showActionArea:!1,showClose:!0,titleText:e}),[]);return{confirmDialog:(0,r.useMemo)(()=>(0,l.jsx)(s.Z,{...c,...u,ref:a}),[u,c]),confirmDialogRef:a,setConfirmDialogLoading:x,setConfirmDialogOpen:h,setConfirmDialogProps:d,finishConfirm:f}}}}]);