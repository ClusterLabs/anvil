"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23],{96674:function(e,t,n){var s=n(85893),i=n(89256),l=n(62191),o=n(89262),r=n(59879),a=n(324),c=n(28721),u=n(73315),d=n(14440),p=n(55074),x=n(67294),m=n(77831),h=n(34635),g=n(91029);let v=e=>(0,s.jsx)(i.Z,{in:!0,children:(0,s.jsx)(l.Z,{...e})}),f=(0,o.ZP)("ul")({padding:0}),j=r.Z;t.Z=e=>{let{componentsProps:t,extendRenderInput:n,getGroupLabel:i,label:l,messageBoxProps:o,renderGroup:r,renderInput:U,sx:Z,...S}=e,b=(0,x.useMemo)(()=>({paper:{sx:{backgroundColor:m.lD,["& .".concat(a.Z.groupLabel)]:{backgroundColor:m.lD}}},...t}),[t]),I=(0,x.useMemo)(()=>r||i&&(e=>(0,s.jsxs)("li",{children:[(0,s.jsx)(j,{component:"div",className:a.Z.groupLabel,children:i(e.group)}),(0,s.jsx)(f,{className:a.Z.groupUl,children:e.children})]},e.key)),[i,r]),y=(0,x.useMemo)(()=>null!=U?U:e=>{let{fullWidth:t,InputProps:i,InputLabelProps:o,inputProps:r}=e,a={formControlProps:{fullWidth:t,ref:i.ref},inputLabelProps:o,inputProps:{className:i.className,endAdornment:i.endAdornment,inputProps:r,startAdornment:i.startAdornment},label:l};return null==n||n.call(null,a,e),(0,s.jsx)(g.Z,{...a})},[n,l,U]),D=(0,x.useMemo)(()=>({["& .".concat(c.Z.root," .").concat(a.Z.endAdornment)]:{right:"7px",["& .".concat(u.Z.root)]:{color:m.s7}},...Z}),[Z]);return(0,s.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column"},children:[(0,s.jsx)(p.Z,{PaperComponent:v,...S,componentsProps:b,renderGroup:I,renderInput:y,sx:D}),(0,s.jsx)(h.Z,{...o})]})}},77583:function(e,t,n){var s=n(85893),i=n(14440),l=n(67294),o=n(33544),r=n(56903),a=n(87006),c=n(59278);let u=(0,l.forwardRef)((e,t)=>{let{actionCancelText:n="Cancel",actionProceedText:u,children:d,closeOnProceed:p=!1,contentContainerProps:x,dialogProps:m,disableProceed:h,loading:g,loadingAction:v=!1,onActionAppend:f,onCancelAppend:j,onProceedAppend:U,openInitially:Z,preActionArea:S,proceedButtonProps:b,proceedColour:I="blue",scrollContent:y=!1,scrollBoxProps:D,showActionArea:P=!0,showCancel:C,showClose:M,titleText:k,wide:w,content:A=d}=e,G=(0,l.useRef)(null),B=(0,l.useMemo)(()=>(0,a.Z)(A,c.Ac),[A]),z=(0,l.useMemo)(()=>(0,l.createElement)(y?o.VZ:i.Z,D,B),[B,D,y]),N=(0,l.useMemo)(()=>P&&(0,s.jsx)(o.ux,{cancelProps:{children:n,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==f||f.call(null,...t),null==j||j.call(null,...t)}},closeOnProceed:p,loading:v,proceedProps:{background:I,children:u,disabled:h,onClick:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];null==f||f.call(null,...t),null==U||U.call(null,...t)},...b},showCancel:C}),[n,u,p,h,v,f,j,U,b,I,P,C]);return(0,l.useImperativeHandle)(t,()=>({setOpen:e=>{var t;return null===(t=G.current)||void 0===t?void 0:t.setOpen(e)}}),[]),(0,s.jsx)(o.Js,{dialogProps:m,header:k,loading:g,openInitially:Z,ref:G,showClose:M,wide:w,children:(0,s.jsxs)(r.Z,{...x,children:[z,S,N]})})});u.displayName="ConfirmDialog",t.Z=u},39937:function(e,t,n){n.d(t,{Z:function(){return z}});var s=n(85893),i=n(19338),l=n(89262),o=n(32653),r=n(14440),a=n(34815),c=n(80594),u=n(67294),d=n(77831),p=n(55278),x=n(26076),m=n(8489),h=n(37969),g=n(54965),v=n(49520);let f=[{text:"Anvil",image:"/pngs/anvil_icon_on.png",uri:"/manage-element"},{text:"Files",image:"/pngs/files_on.png",uri:"/file-manager"},{text:"Configure",image:"/pngs/configure_icon_on.png",uri:"/config"},{text:"Mail",image:"/pngs/email_on.png",uri:"/mail-config"},{text:"Help",image:"/pngs/help_icon_on.png",uri:"https://alteeve.com/w/Support"}],j={width:"40em",height:"40em"};var U=n(98484),Z=n(29535),S=n(56903),b=n(97607),I=n(59278),y=n(6946);let D="AnvilDrawer",P={actionIcon:"".concat(D,"-actionIcon"),list:"".concat(D,"-list")},C=(0,l.ZP)(m.ZP)(()=>({["& .".concat(P.list)]:{width:"200px"},["& .".concat(P.actionIcon)]:{fontSize:"2.3em",color:d.of}}));var M=e=>{let{open:t,setOpen:n}=e,{getSessionUser:i}=(0,y.Z)(),l=i();return(0,s.jsx)(C,{BackdropProps:{invisible:!0},anchor:"left",open:t,onClose:()=>n(!t),children:(0,s.jsx)("div",{role:"presentation",children:(0,s.jsxs)(h.Z,{className:P.list,children:[(0,s.jsx)(g.ZP,{children:(0,s.jsx)(I.Ac,{children:l?(0,s.jsxs)(s.Fragment,{children:["Welcome, ",l.name]}):"Unregistered"})}),(0,s.jsx)(Z.Z,{}),(0,s.jsx)(v.Z,{component:"a",href:"/index.html",children:(0,s.jsxs)(S.Z,{fullWidth:!0,row:!0,spacing:"2em",children:[(0,s.jsx)(p.Z,{className:P.actionIcon}),(0,s.jsx)(I.Ac,{children:"Dashboard"})]})}),f.map(e=>(0,s.jsx)(v.Z,{component:"a",href:e.uri,children:(0,s.jsxs)(S.Z,{fullWidth:!0,row:!0,spacing:"2em",children:[(0,s.jsx)("img",{alt:e.text,src:e.image,...j}),(0,s.jsx)(I.Ac,{children:e.text})]})},"anvil-drawer-".concat(e.image))),(0,s.jsx)(v.Z,{onClick:()=>{U.Z.put("/auth/logout").then(()=>{window.location.replace("/login")}).catch(e=>{(0,b.Z)(e)})},children:(0,s.jsxs)(S.Z,{fullWidth:!0,row:!0,spacing:"2em",children:[(0,s.jsx)(x.Z,{className:P.actionIcon}),(0,s.jsx)(I.Ac,{children:"Logout"})]})})]})})})},k=n(85838),w=n(56399);let A="Header",G={input:"".concat(A,"-input"),barElement:"".concat(A,"-barElement"),iconBox:"".concat(A,"-iconBox"),searchBar:"".concat(A,"-searchBar"),icons:"".concat(A,"-icons")},B=(0,l.ZP)(o.Z)(e=>{let{theme:t}=e;return{paddingTop:t.spacing(.5),paddingBottom:t.spacing(.5),paddingLeft:t.spacing(3),paddingRight:t.spacing(3),borderBottom:"solid 1px",borderBottomColor:d.hM,position:"static",["& .".concat(G.input)]:{height:"2.8em",width:"30vw",backgroundColor:t.palette.secondary.main,borderRadius:d.n_},["& .".concat(G.barElement)]:{padding:0},["& .".concat(G.iconBox)]:{[t.breakpoints.down("sm")]:{display:"none"}},["& .".concat(G.searchBar)]:{[t.breakpoints.down("sm")]:{flexGrow:1,paddingLeft:"15vw"}},["& .".concat(G.icons)]:{paddingLeft:".1em",paddingRight:".1em"}}});var z=()=>{let e=(0,u.useRef)({}),t=(0,u.useRef)({}),[n,l]=(0,u.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{children:(0,s.jsxs)(r.Z,{display:"flex",justifyContent:"space-between",flexDirection:"row",children:[(0,s.jsx)(S.Z,{row:!0,children:(0,s.jsx)(a.Z,{onClick:()=>l(!n),children:(0,s.jsx)("img",{alt:"",src:"/pngs/logo.png",width:"160",height:"40"})})}),(0,s.jsx)(S.Z,{className:G.iconBox,row:!0,spacing:0,children:(0,s.jsx)(r.Z,{children:(0,s.jsx)(c.Z,{onClick:e=>{var n,s;let{currentTarget:i}=e;null===(n=t.current.setAnchor)||void 0===n||n.call(null,i),null===(s=t.current.setOpen)||void 0===s||s.call(null,!0)},sx:{color:d.of,padding:"0 .1rem"},children:(0,s.jsx)(k.Z,{icon:i.Z,ref:e})})})})]})}),(0,s.jsx)(M,{open:n,setOpen:l}),(0,s.jsx)(w.Z,{onFetchSuccessAppend:t=>{var n;null===(n=e.current.indicate)||void 0===n||n.call(null,Object.keys(t).length>0)},ref:t})]})}},23833:function(e,t,n){var s=n(85893),i=n(73970),l=n(85959),o=n(77831);t.Z=e=>{let{children:t,sx:n}=e,r={backgroundColor:o.lD,paddingRight:"3em",["&.".concat(i.Z.selected)]:{backgroundColor:o.s7,fontWeight:400,["&.".concat(i.Z.focusVisible)]:{backgroundColor:o.s7},"&:hover":{backgroundColor:o.s7}},["&.".concat(i.Z.focusVisible)]:{backgroundColor:o.s7},"&:hover":{backgroundColor:o.s7},...n};return(0,s.jsx)(l.Z,{...e,sx:r,children:t})}},56466:function(e,t,n){let s,i;n.d(t,{Z:function(){return V}});var l=n(85893),o=n(67294),r=n(14440),a=n(99514),c=n(92309),u=n(12641),d=n(25934),p=n(77831),x=n(98484),m=n(96674),h=n(77583),g=n(99429),v=n(56903),f=n(62800),j=n(65895),U=n(99576),Z=n(91029),S=n(20408),b=n(28721),I=n(34635),y=n(6189);let D={inputWithLabelProps:{},messageBoxProps:{},selectWithLabelProps:{}},P=e=>{let{id:t,label:n,inputWithLabelProps:s=D.inputWithLabelProps,messageBoxProps:i=D.messageBoxProps,selectItems:o,selectWithLabelProps:a=D.selectWithLabelProps}=e;return(0,l.jsxs)(r.Z,{children:[(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"row","& > :first-child":{flexGrow:1},"& > :not(:last-child)":{marginRight:".5em"},["&:hover\n          .".concat(S.Z.root,"\n          .").concat(b.Z.root,"\n          .").concat(b.Z.notchedOutline)]:{borderColor:p.s7}},children:[(0,l.jsx)(Z.Z,{id:t,label:n,...s}),(0,l.jsx)(y.Z,{formControlProps:{fullWidth:!1,sx:{minWidth:"min-content"}},id:"".concat(t,"-nested-select"),selectItems:o,...a})]}),(0,l.jsx)(I.Z,{...i})]})};P.defaultProps=D;var C=n(23930),M=n(53541),k=n(52675),w=n(59278);let A=BigInt(0),G=[{value:"B"},{value:"KiB"},{value:"MiB"},{value:"GiB"},{value:"TiB"}],B=BigInt(65536),z=BigInt(104857600),N={backgroundColor:p.Ej,color:p.lD,"&:hover":{backgroundColor:p.Ej}},O=(e,t)=>{let{onButtonClick:n}=t;return(0,l.jsx)(g.Z,{disabled:void 0===n,onClick:n,sx:{minWidth:"unset",whiteSpace:"nowrap"},children:"Max: ".concat(e)})},F=function(){let{endAdornment:e,mainLabel:t,subLabel:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.jsxs)(r.Z,{sx:{alignItems:"center",display:"flex",flexDirection:"row",width:"100%","& > :first-child":{flexGrow:1}},children:[(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column"},children:[t&&(0,l.jsx)(w.Ac,{inverted:!0,text:t}),n&&(0,l.jsx)(w.Ac,{inverted:!0,text:n})]}),e]})},T=e=>{let t={},n=e.reduce((e,n)=>{let{anvilUUID:s,anvilName:i,anvilTotalMemory:o,anvilTotalAllocatedMemory:a,anvilTotalAvailableMemory:c,hosts:u,servers:d,storageGroups:p,files:x}=n,{anvilStorageGroups:m,anvilStorageGroupUUIDs:h}=p.reduce((t,n)=>{let o={...n,anvilUUID:s,anvilName:i,storageGroupSize:BigInt(n.storageGroupSize),storageGroupFree:BigInt(n.storageGroupFree),humanizedStorageGroupFree:""};return(0,f.Bh)(n.storageGroupFree,{fromUnit:"B",onSuccess:{string:(e,t)=>{o.humanizedStorageGroupFree="".concat(e," ").concat(t)}},precision:0,toUnit:"ibyte"}),t.anvilStorageGroupUUIDs.push(n.storageGroupUUID),t.anvilStorageGroups.push(o),e.storageGroups.push(o),e.storageGroupSelectItems.push({displayValue:F({endAdornment:(0,l.jsx)(w.Ac,{inverted:!0,text:"~".concat(o.humanizedStorageGroupFree," free")}),mainLabel:n.storageGroupName,subLabel:i}),value:n.storageGroupUUID}),e.storageGroupUUIDMapToData[n.storageGroupUUID]=o,t},{anvilStorageGroups:[],anvilStorageGroupUUIDs:[]}),g=[];x.forEach(e=>{let{fileUUID:n}=e;g.push(n),t[n]=e});let v={...n,anvilTotalMemory:BigInt(o),anvilTotalAllocatedMemory:BigInt(a),anvilTotalAvailableMemory:BigInt(c),humanizedAnvilTotalAvailableMemory:"",hosts:u.map(e=>({...e,hostMemory:BigInt(e.hostMemory)})),servers:d.map(t=>{let{serverMemory:n,serverName:s,...i}=t,l={...i,serverMemory:BigInt(n),serverName:s};return e.serverNameMapToData[s]=l,l}),storageGroupUUIDs:h,storageGroups:m,fileUUIDs:g};return(0,f.Bh)(c,{fromUnit:"B",onSuccess:{string:(e,t)=>{v.humanizedAnvilTotalAvailableMemory="".concat(e," ").concat(t)}},precision:0,toUnit:"ibyte"}),e.anvils.push(v),e.anvilSelectItems.push({displayValue:F({endAdornment:(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",width:"8rem"},children:[(0,l.jsx)(w.Ac,{inverted:!0,text:"CPU: ".concat(v.anvilTotalCPUCores," cores")}),(0,l.jsx)(w.Ac,{inverted:!0,text:"Memory: ~".concat(v.humanizedAnvilTotalAvailableMemory)})]}),mainLabel:v.anvilName,subLabel:v.anvilDescription}),value:s}),e.anvilUUIDMapToData[s]=v,e},{anvils:[],anvilSelectItems:[],anvilUUIDMapToData:{},files:[],fileSelectItems:[],fileUUIDMapToData:{},serverNameMapToData:{},storageGroups:[],storageGroupSelectItems:[],storageGroupUUIDMapToData:{}});return Object.values(t).forEach(e=>{n.files.push(e),n.fileSelectItems.push({displayValue:e.fileName,value:e.fileUUID}),n.fileUUIDMapToData[e.fileUUID]=e}),n},R=function(e,t,n,s,i,l,o){let{includeAnvilUUIDs:r=[],includeFileUUIDs:a=[],includeStorageGroupUUIDs:c=[]}=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=()=>!0,d=()=>!0,p=()=>!0;r.length>0&&(u=e=>r.includes(e)),a.length>0&&(d=e=>a.includes(e)),c.length>0&&(p=e=>c.includes(e));let x={},m=l.reduce((e,t,n)=>{var s;let l=null!==(s=i[n])&&void 0!==s?s:A;return e.all+=l,""===t||(void 0===e[t]&&(e[t]=A),e[t]+=l),e},{all:A}),h=e.reduce((e,r)=>{let{anvilUUID:a}=r;if(u(a)){let{anvilTotalCPUCores:c,anvilTotalAvailableMemory:u,files:h,fileUUIDs:g,storageGroups:v}=r,f=[],j=A,U=A;v.forEach(e=>{let{storageGroupUUID:t,storageGroupFree:n}=e;p(t)&&(f.push(t),U+=n,n>j&&(j=n))}),[()=>v.length>0,()=>n<=c,()=>s<=u,()=>l.every((e,n)=>{var s;let l=null!==(s=i[n])&&void 0!==s?s:A,o=!0,r=l<=j;return""!==e&&(o=f.includes(e),r=l<=t[e].storageGroupFree),o&&r}),()=>Object.entries(m).every(e=>{let[n,s]=e;return"all"===n?s<=U:s<=t[n].storageGroupFree}),()=>o.every(e=>""===e||g.includes(e))].every(e=>e())&&(e.anvils.push(r),e.anvilUUIDs.push(a),e.maxCPUCores=Math.max(c,e.maxCPUCores),u>e.maxMemory&&(e.maxMemory=u),h.forEach(e=>{let{fileUUID:t}=e;d(t)&&(x[t]=!0)}),e.storageGroupUUIDs.push(...f),e.maxVirtualDiskSizes.fill(j))}return e},{anvils:[],anvilUUIDs:[],fileUUIDs:[],maxCPUCores:0,maxMemory:A,maxVirtualDiskSizes:l.map(()=>A),storageGroupUUIDs:[]});return h.fileUUIDs=Object.keys(x),l.forEach((e,n)=>{""!==e&&(h.maxVirtualDiskSizes[n]=t[e].storageGroupFree)}),h},L=(e,t,n,s,i,o,a,c)=>{let u=function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return e[n][s]},d=function(s,i){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e[s][l]=i,n({...e})},p=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A;d("sizes",n);let{formattedMaxVDSizes:s,maxVirtualDiskSizes:i}=o({virtualDisks:e});c({inputs:{["vd".concat(t,"Size")]:{displayMax:"".concat(s[t]),max:i[t],value:n}}})},x=e=>{let{value:t=u("inputSizes"),unit:n=u("inputUnits")}=e;t!==u("inputSizes")&&d("inputSizes",t),n!==u("inputUnits")&&d("inputUnits",n),(0,f.KY)(t,n,e=>p(e),()=>p())},m=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u("inputStorageGroupUUIDs");t!==u("inputStorageGroupUUIDs")&&d("inputStorageGroupUUIDs",t),o({virtualDisks:e})};return(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column","& > :not(:first-child)":{marginTop:"1em"}},children:[(0,l.jsx)(r.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,l.jsx)(P,{id:"ps-virtual-disk-size-".concat(t),label:"Disk size",messageBoxProps:u("inputSizeMessages"),inputWithLabelProps:{inputProps:{endAdornment:O("".concat(u("inputMaxes")," ").concat(u("inputUnits")),{onButtonClick:()=>{d("inputSizes",u("inputMaxes")),p(u("maxes"))}}),onChange:e=>{let{target:{value:t}}=e;x({value:t})},type:"number",value:u("inputSizes")},inputLabelProps:{isNotifyRequired:u("sizes")===A}},selectItems:G,selectWithLabelProps:{selectProps:{onChange:e=>{let{target:{value:t}}=e;x({unit:t})},value:u("inputUnits")}}})}),(0,l.jsx)(r.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,l.jsx)(y.Z,{id:"ps-storage-group-".concat(t),label:"Storage group",disableItem:e=>!(i.includes(e)&&u("sizes")<=a[e].storageGroupFree),inputLabelProps:{isNotifyRequired:0===u("inputStorageGroupUUIDs").length},messageBoxProps:u("inputStorageGroupUUIDMessages"),selectItems:s,selectProps:{onChange:e=>{let{target:{value:t}}=e;m(t)},onClearIndicatorClick:()=>m(""),renderValue:e=>{var t;let{anvilName:n="?",storageGroupName:s="Unknown (".concat(e,")")}=null!==(t=a[e])&&void 0!==t?t:{};return"".concat(s," (").concat(n,")")},value:u("inputStorageGroupUUIDs")}})})]},"ps-virtual-disk-".concat(u("stateIds")))},q=function(){let{existingVirtualDisks:e={stateIds:[],inputMaxes:[],inputSizeMessages:[],inputSizes:[],inputStorageGroupUUIDMessages:[],inputStorageGroupUUIDs:[],inputUnits:[],maxes:[],sizes:[]},stateId:t=(0,d.Z)(),inputMax:n="0",inputSize:s="",inputSizeMessage:i,inputStorageGroupUUID:l="",inputStorageGroupUUIDMessage:o,inputUnit:r="GiB",max:a=A,setVirtualDisks:c,size:u=A}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stateIds:p,inputMaxes:x,inputSizeMessages:m,inputSizes:h,inputStorageGroupUUIDMessages:g,inputStorageGroupUUIDs:v,inputUnits:f,maxes:j,sizes:U}=e;return p.push(t),x.push(n),m.push(i),h.push(s),g.push(o),v.push(l),f.push(r),j.push(a),U.push(u),null==c||c.call(null,{...e}),e},E=e=>e.filter(e=>""!==e),W=e=>({fromUnit:"B",onSuccess:{string:e},precision:0,toUnit:"ibyte"});(0,f.Bh)(B,W((e,t)=>{s="".concat(e," ").concat(t)})),(0,f.Bh)(z,W((e,t)=>{i="".concat(e," ").concat(t)}));var V=e=>{let{dialogProps:{open:t},onClose:n}=e,[d,S]=(0,o.useState)([]),[b,I]=(0,o.useState)({}),[D,F]=(0,o.useState)({}),[W,V]=(0,o.useState)({}),[Q,_]=(0,o.useState)({}),[H,J]=(0,o.useState)([]),[Y,K]=(0,o.useState)([]),[X,$]=(0,o.useState)([]),[ee,et]=(0,o.useState)([]),[en,es]=(0,o.useState)(""),[ei,el]=(0,o.useState)(),[eo,er]=(0,o.useState)(1),[ea,ec]=(0,o.useState)(0),[eu,ed]=(0,o.useState)(),[ep,ex]=(0,o.useState)(A),[em,eh]=(0,o.useState)(A),[eg,ev]=(0,o.useState)(),[ef,ej]=(0,o.useState)("0"),[eU,eZ]=(0,o.useState)(""),[eS,eb]=(0,o.useState)("GiB"),[eI,ey]=(0,o.useState)(q()),[eD,eP]=(0,o.useState)(""),[eC,eM]=(0,o.useState)(),[ek,ew]=(0,o.useState)(""),[eA]=(0,o.useState)(),[eG,eB]=(0,o.useState)(""),[ez,eN]=(0,o.useState)(),[eO,eF]=(0,o.useState)(null),[eT,eR]=(0,o.useState)(),[eL,eq]=(0,o.useState)([]),[eE,eW]=(0,o.useState)([]),[eV,eQ]=(0,o.useState)([]),[e_,eH]=(0,o.useState)(!1),[eJ,eY]=(0,o.useState)(!1),[eK,eX]=(0,o.useState)(!1),[e$,e0]=(0,o.useState)(0),e1=(0,o.useMemo)(()=>{let e=[];for(let t=1;t<=ea;t+=1)e.push(t);return e},[ea]),e9={serverName:{defaults:{onSuccess:()=>{el(void 0)},value:en},isRequired:!0,tests:[{onFailure:()=>{el({text:"The server name length must be 1 to 16 characters.",type:"warning"})},test:e=>{let{value:t}=e,{length:n}=t;return n>=1&&n<=16}},{onFailure:()=>{el({text:"The server name is expected to only contain alphanumeric, hyphen, or underscore characters.",type:"warning"})},test:e=>{let{value:t}=e;return/^[a-zA-Z0-9_-]+$/.test(t)}},{onFailure:()=>{el({text:"This server name already exists, please choose another name.",type:"warning"})},test:e=>{let{value:t}=e;return void 0===W[t]}}]},cpuCores:{defaults:{max:ea,min:1,onSuccess:()=>{ed(void 0)},value:eo},isRequired:!0,tests:[{onFailure:()=>{ed({text:"Non available.",type:"warning"})},test:k.X7},{onFailure:e=>{let{displayMax:t,displayMin:n}=e;ed({text:"The number of CPU cores is expected to be between ".concat(n," and ").concat(t,"."),type:"warning"})},test:k.SQ}]},memory:{defaults:{displayMax:"".concat(ef," ").concat(eS),displayMin:s,max:em,min:B,onSuccess:()=>{ev(void 0)},value:ep},isRequired:!0,tests:[{onFailure:()=>{ev({text:"Non available.",type:"warning"})},test:k.X7},{onFailure:e=>{let{displayMax:t,displayMin:n}=e;ev({text:"Memory is expected to be between ".concat(n," and ").concat(t,"."),type:"warning"})},test:k.SQ}]},installISO:{defaults:{onSuccess:()=>{eM(void 0)},value:eD},isRequired:!0,tests:[{test:k.HJ}]},anvil:{defaults:{onSuccess:()=>{eN(void 0)},value:eG},isRequired:!0,tests:[{test:k.HJ}]},optimizeForOS:{defaults:{onSuccess:()=>{eR(void 0)},value:null==eO?void 0:eO.key},isRequired:!0,tests:[{test:k.HJ}]}};eI.inputSizeMessages.forEach((e,t)=>{e9["vd".concat(t,"Size")]={defaults:{displayMax:"".concat(eI.inputMaxes[t]," ").concat(eI.inputUnits[t]),displayMin:i,max:eI.maxes[t],min:z,onSuccess:()=>{eI.inputSizeMessages[t]=void 0},value:eI.sizes[t]},isRequired:!0,onFinishBatch:()=>{ey({...eI})},tests:[{onFailure:()=>{eI.inputSizeMessages[t]={text:"Non available.",type:"warning"}},test:k.X7},{onFailure:e=>{let{displayMax:n,displayMin:s}=e;eI.inputSizeMessages[t]={text:"Virtual disk ".concat(t," size is expected to be between ").concat(s," and ").concat(n,"."),type:"warning"}},test:k.SQ}]},e9["vd".concat(t,"StorageGroup")]={defaults:{onSuccess:()=>{eI.inputStorageGroupUUIDMessages[t]=void 0},value:eI.inputStorageGroupUUIDs[t]},isRequired:!0,onFinishBatch:()=>{ey({...eI})},tests:[{test:k.HJ}]}});let e5=function(){let{allAnvils:e=d,cpuCores:t=eo,fileUUIDs:n=[eD,ek],includeAnvilUUIDs:s=E([eG]),includeFileUUIDs:i,includeStorageGroupUUIDs:l,inputMemoryUnit:o=eS,memory:r=ep,storageGroupUUIDMapToData:a=Q,virtualDisks:c=eI}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{anvilUUIDs:u,fileUUIDs:p,maxCPUCores:x,maxMemory:m,maxVirtualDiskSizes:h,storageGroupUUIDs:g}=R(e,a,t,r,c.sizes,c.inputStorageGroupUUIDs,n,{includeAnvilUUIDs:s,includeFileUUIDs:i,includeStorageGroupUUIDs:l});ec(x),eh(m);let v=[];c.maxes=h,c.maxes.forEach((e,t)=>{(0,f.Bh)(e,{fromUnit:"B",onSuccess:{string:(e,n)=>{c.inputMaxes[t]=e,v[t]="".concat(e," ").concat(n)}},toUnit:c.inputUnits[t]})}),ey({...c}),eq(u),eW(p),eQ(g);let j="";return(0,f.Bh)(m,{fromUnit:"B",onSuccess:{string:(e,t)=>{ej(e),j="".concat(e," ").concat(t)}},toUnit:o}),{formattedMaxMemory:j,formattedMaxVDSizes:v,maxCPUCores:x,maxMemory:m,maxVirtualDiskSizes:h}},e7=(0,o.useCallback)(e5,[]),e8=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[s,...i]=t;return(0,k.BD)({tests:e9,...s},...i)},e3=function(){let{cmValue:e=A,cmUnit:t=eS}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ex(e);let{formattedMaxMemory:n,maxMemory:s}=e5({inputMemoryUnit:t,memory:e});e8({inputs:{memory:{displayMax:n,max:s,value:e}}})},e4=function(){let{value:e=eU,unit:t=eS}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e!==eU&&eZ(e),t!==eS&&eb(t),(0,f.KY)(e,t,e=>e3({cmValue:e,cmUnit:t}),()=>e3({cmUnit:t}))},e2=e=>{eP(e),e5({fileUUIDs:[e,ek]})},e6=e=>{ew(e),e5({fileUUIDs:[eD,e]})},te=e=>{let t=E([e]);eB(e),e5({includeAnvilUUIDs:t})},tt=(0,o.useMemo)(()=>({"anvil node":!!Object.keys(b).length,file:!!Object.keys(D).length,"storage group":!!Object.keys(Q).length}),[b,D,Q]);return(0,o.useEffect)(()=>{x.Z.get("/anvil",{params:{anvilUUIDs:"all",isForProvisionServer:!0}}).then(e=>{let{data:t}=e,{anvils:n,anvilSelectItems:s,anvilUUIDMapToData:i,fileSelectItems:l,fileUUIDMapToData:o,serverNameMapToData:r,storageGroupSelectItems:a,storageGroupUUIDMapToData:c}=T(t.anvils);S(n),I(i),F(o),V(r),_(c),J(s),K(l),et(a);let u={allAnvils:n,storageGroupUUIDMapToData:c};if(1===s.length){let{0:{value:e}}=s;eB(e),u.includeAnvilUUIDs=[e]}if(1===l.length){let{0:{value:e}}=l;eP(e),u.fileUUIDs=[e,""]}if(1===a.length){let{0:{value:e}}=a;ey(t=>{let n={...t};return n.inputStorageGroupUUIDs[0]=e,u.virtualDisks=n,n})}e7(u),$(Object.entries(t.oses).map(e=>{let[t,n]=e;return{key:t,label:n}})),eH(!0)}).catch(()=>{})},[e7]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.Z,{fullWidth:!0,maxWidth:"sm",open:t,PaperComponent:C.s_,PaperProps:{sx:{overflow:"visible"}},children:[(0,l.jsxs)(C.V9,{children:[(0,l.jsx)(w.z,{text:"Provision a Server"}),(0,l.jsx)(j.Z,{onClick:n,sx:{backgroundColor:p.hM,color:p.lD,"&:hover":{backgroundColor:p.hM}},children:(0,l.jsx)(u.Z,{})})]}),(0,l.jsx)(v.Z,{spacing:".6em",children:Object.entries(tt).map(e=>{let[t,n]=e;return!n&&(0,l.jsxs)(U.Z,{type:"warning",children:["No ",t," available yet. Try refreshing after the resource gets created."]})})}),e_?(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",maxHeight:"50vh",overflowY:"scroll",paddingTop:".6em","& > :not(:first-child)":{marginTop:"1em"}},children:[(0,l.jsx)(r.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,l.jsx)(Z.Z,{id:"ps-server-name",label:"Server name",inputProps:{onChange:e=>{let{target:{value:t}}=e;es(t),e8({inputs:{serverName:{value:t}}})},value:en},inputLabelProps:{isNotifyRequired:0===en.length},messageBoxProps:ei})}),(0,l.jsx)(m.Z,{id:"ps-cpu-cores",disableClearable:!0,extendRenderInput:e=>{let{inputLabelProps:t={}}=e;t.isNotifyRequired=eo<=0},getOptionLabel:e=>String(e),label:"CPU cores",messageBoxProps:eu,noOptionsText:"No available number of cores.",onChange:(e,t)=>{if(!t||t===eo)return;er(t);let{maxCPUCores:n}=e5({cpuCores:t});e8({inputs:{cpuCores:{max:n,value:t}}})},openOnFocus:!0,options:e1,renderOption:(e,t)=>(0,o.createElement)("li",{...e,key:"ps-cpu-cores-".concat(t)},t),value:eo}),(0,l.jsx)(P,{id:"ps-memory",label:"Memory",messageBoxProps:eg,inputWithLabelProps:{inputProps:{endAdornment:O("".concat(ef," ").concat(eS),{onButtonClick:()=>{eZ(ef),e3({cmValue:em})}}),onChange:e=>{let{target:{value:t}}=e;e4({value:t})},type:"number",value:eU},inputLabelProps:{isNotifyRequired:ep===A}},selectItems:G,selectWithLabelProps:{selectProps:{onChange:e=>{let{target:{value:t}}=e;e4({unit:t})},value:eS}}}),eI.stateIds.map((e,t)=>L(eI,t,ey,ee,eV,e5,Q,e8)),(0,l.jsx)(y.Z,{disableItem:e=>e===ek,hideItem:e=>!eE.includes(e),id:"ps-install-image",inputLabelProps:{isNotifyRequired:0===eD.length},label:"Install ISO",messageBoxProps:eC,selectItems:Y,selectProps:{onChange:e=>{let{target:{value:t}}=e;e2(t)},onClearIndicatorClick:()=>e2(""),value:eD}}),(0,l.jsx)(y.Z,{disableItem:e=>e===eD,hideItem:e=>!eE.includes(e),id:"ps-driver-image",label:"Driver ISO",messageBoxProps:eA,selectItems:Y,selectProps:{onChange:e=>{let{target:{value:t}}=e;e6(t)},onClearIndicatorClick:()=>e6(""),value:ek}}),(0,l.jsx)(y.Z,{disableItem:e=>!eL.includes(e),id:"ps-anvil",inputLabelProps:{isNotifyRequired:0===eG.length},label:"Anvil node",messageBoxProps:ez,selectItems:H,selectProps:{onChange:e=>{let{target:{value:t}}=e;te(t)},onClearIndicatorClick:()=>te(""),renderValue:e=>{var t;let{anvilName:n="Unknown ".concat(e)}=null!==(t=b[e])&&void 0!==t?t:{};return n},value:eG}}),(0,l.jsx)(m.Z,{id:"ps-optimize-for-os",extendRenderInput:e=>{let{inputLabelProps:t={}}=e;t.isNotifyRequired=null===eO},isOptionEqualToValue:(e,t)=>e.key===t.key,label:"Optimize for OS",messageBoxProps:eT,noOptionsText:"No matching OS",onChange:(e,t)=>{eF(t)},openOnFocus:!0,options:X,renderOption:(e,t)=>(0,o.createElement)("li",{...e,key:"ps-optimize-for-os-".concat(t.key),children:[t.label," (",t.key,")"]}),value:eO})]}):(0,l.jsx)(M.Z,{}),(0,l.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",marginTop:"1em","& > :not(:first-child)":{marginTop:"1em"}},children:[e$>0&&(0,l.jsx)(U.Z,{isAllowClose:!0,text:"Provision server job registered. You can provision another server, or exit; it won't affect the registered job."}),eK?(0,l.jsx)(M.Z,{mt:0}):(0,l.jsx)(r.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"},children:(0,l.jsx)(g.Z,{disabled:!e8({isIgnoreOnCallbacks:!0}),onClick:()=>{eY(!0)},sx:N,children:"Provision"})})]})]}),eJ&&(0,l.jsx)(h.Z,{actionProceedText:"Provision",content:(0,l.jsxs)(a.ZP,{container:!0,columns:10,direction:"column",children:[(0,l.jsx)(a.ZP,{item:!0,xs:10,children:(0,l.jsxs)(w.Ac,{children:["Server ",(0,l.jsx)(w.Q0,{text:en})," will be created on anvil node"," ",(0,l.jsx)(w.Q0,{text:b[eG].anvilName})," ","with the following properties:"]})}),(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsx)(w.Ac,{text:"CPU"})}),(0,l.jsx)(a.ZP,{item:!0,xs:5,children:(0,l.jsxs)(w.Ac,{children:[(0,l.jsx)(w.Q0,{edge:"start",children:eo})," ","core(s)"]})}),(0,l.jsx)(a.ZP,{item:!0,xs:3,children:(0,l.jsxs)(w.Ac,{children:[(0,l.jsx)(w.Q0,{edge:"start",children:ea})," ","core(s) available"]})})]}),(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsx)(w.Ac,{text:"Memory"})}),(0,l.jsx)(a.ZP,{item:!0,xs:5,children:(0,l.jsx)(w.Ac,{children:(0,l.jsxs)(w.Q0,{edge:"start",children:[eU," ",eS]})})}),(0,l.jsx)(a.ZP,{item:!0,xs:3,children:(0,l.jsxs)(w.Ac,{children:[(0,l.jsxs)(w.Q0,{edge:"start",children:[ef," ",eS]})," ","available"]})})]}),eI.stateIds.map((e,t)=>{let n=eI.inputMaxes[t],s=eI.inputSizes[t],i=eI.inputUnits[t],o=Q[eI.inputStorageGroupUUIDs[t]].storageGroupName;return(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsxs)(w.Ac,{children:["Disk ",(0,l.jsx)(w.Q0,{text:t})]})}),(0,l.jsx)(a.ZP,{item:!0,xs:5,children:(0,l.jsxs)(w.Ac,{children:[(0,l.jsxs)(w.Q0,{edge:"start",children:[s," ",i]})," ","on ",(0,l.jsx)(w.Q0,{children:o})]})}),(0,l.jsx)(a.ZP,{item:!0,xs:3,children:(0,l.jsxs)(w.Ac,{children:[(0,l.jsxs)(w.Q0,{edge:"start",children:[n," ",i]})," ","available"]})})]},"ps-virtual-disk-".concat(e,"-summary"))}),(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsx)(w.Ac,{text:"Install ISO"})}),(0,l.jsx)(a.ZP,{item:!0,xs:8,children:(0,l.jsx)(w.Ac,{children:(0,l.jsx)(w.Q0,{edge:"start",children:D[eD].fileName})})})]}),(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsx)(w.Ac,{text:"Driver ISO"})}),(0,l.jsx)(a.ZP,{item:!0,xs:8,children:(0,l.jsx)(w.Ac,{children:D[ek]?(0,l.jsx)(w.Q0,{edge:"start",children:D[ek].fileName}):"none"})})]}),(0,l.jsxs)(a.ZP,{container:!0,direction:"row",item:!0,xs:10,children:[(0,l.jsx)(a.ZP,{item:!0,xs:2,children:(0,l.jsx)(w.Ac,{text:"Optimize for OS"})}),(0,l.jsx)(a.ZP,{item:!0,xs:8,children:(0,l.jsx)(w.Ac,{children:(0,l.jsx)(w.Q0,{edge:"start",children:"".concat(null==eO?void 0:eO.label)})})})]})]}),dialogProps:{open:eJ},onCancelAppend:()=>{eY(!1)},onProceedAppend:()=>{let e={serverName:en,cpuCores:eo,memory:ep.toString(),virtualDisks:eI.stateIds.map((e,t)=>({storageSize:eI.sizes[t].toString(),storageGroupUUID:eI.inputStorageGroupUUIDs[t]})),installISOFileUUID:eD,driverISOFileUUID:ek,anvilUUID:eG,optimizeForOS:null==eO?void 0:eO.key};eX(!0),x.Z.post("/server",e).then(()=>{eX(!1),e0(e$+1)}),eY(!1)},proceedButtonProps:{sx:N},titleText:"Provision ".concat(en,"?")})]})}},6189:function(e,t,n){n.d(t,{Z:function(){return Z}});var s=n(85893),i=n(84799),l=n(20869),o=n(51714),r=n(67294),a=n(34635),c=n(23833),u=n(15627),d=n(79237),p=n(12641),x=n(49440),m=n(80543),h=n(79588),g=n(99657),v=n(80594),f=n(64242),j=n(77831),U=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[l]=t,{onClearIndicatorClick:o,...a}=l,{sx:c,value:u,...d}=a,U=(0,r.useMemo)(()=>({["& .".concat(i.Z.icon)]:{color:j.s7},["& .".concat(x.Z.root)]:{marginRight:".8em"},["& .".concat(m.Z.root)]:{color:j.s7,visibility:"hidden"},["&:hover .".concat(x.Z.root," .").concat(m.Z.root,",\n      &.").concat(h.Z.focused," .").concat(x.Z.root," .").concat(m.Z.root)]:{visibility:"visible"},...c}),[c]),Z=(0,r.useMemo)(()=>String(u).length>0&&o&&(0,s.jsx)(g.Z,{position:"end",children:(0,s.jsx)(v.Z,{onClick:o,children:(0,s.jsx)(p.Z,{fontSize:"small"})})}),[o,u]);return(0,s.jsx)(f.Z,{endAdornment:Z,value:u,...d,sx:U})},Z=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let[p]=t,{id:x,label:m,selectItems:h,checkItem:g,disableItem:v,formControlProps:f,hideItem:j,inputLabelProps:Z={},isReadOnly:S=!1,messageBoxProps:b={},name:I,onBlur:y,onChange:D,onFocus:P,required:C,selectProps:{multiple:M,sx:k,...w}={},value:A,isCheckableItems:G=M}=p,B=(0,r.useMemo)(()=>S?{["& .".concat(i.Z.icon)]:{visibility:"hidden"},...k}:k,[S,k]),z=(0,r.useCallback)(e=>G&&(0,s.jsx)(l.Z,{checked:null==g?void 0:g.call(null,e)}),[g,G]),N=(0,r.useCallback)((e,t)=>(0,s.jsxs)(c.Z,{disabled:null==v?void 0:v.call(null,e),sx:{display:(null==j?void 0:j.call(null,e))?"none":void 0},value:e,children:[z(e),t]},"".concat(x,"-").concat(e)),[z,v,j,x]),O=(0,r.useMemo)(()=>"".concat(x,"-select-element"),[x]),F=(0,r.useMemo)(()=>(0,s.jsx)(u.Z,{id:x,label:m}),[x,m]),T=(0,r.useMemo)(()=>m&&(0,s.jsx)(d.Z,{htmlFor:O,isNotifyRequired:C,...Z,children:m}),[Z,C,m,O]),R=(0,r.useMemo)(()=>h.map(e=>{if("string"==typeof e)return N(e,e);let{value:t,displayValue:n=String(t)}=e;return N(t,n)}),[N,h]);return(0,s.jsxs)(o.Z,{fullWidth:!0,...f,children:[T,(0,s.jsx)(U,{id:O,input:F,multiple:M,name:I,onBlur:y,onChange:D,onFocus:P,readOnly:S,value:A,...w,sx:B,children:R}),(0,s.jsx)(a.Z,{...b})]})}},62800:function(e,t,n){n.d(t,{Bh:function(){return i},KY:function(){return l},MU:function(){return o}});var s=n(54490),i=function(e){let{fromUnit:t,onFailure:n,onSuccess:i,precision:l,toUnit:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,s.gO)(e,{fromUnit:t,precision:l,toUnit:o});if(r){let{value:e,unit:t}=r;try{var a,c,u;null==i||null===(a=i.bigint)||void 0===a||a.call(null,BigInt(e),t),null==i||null===(c=i.number)||void 0===c||c.call(null,parseFloat(e),t),null==i||null===(u=i.string)||void 0===u||u.call(null,e,t)}catch(s){null==n||n.call(null,s,e,t)}}else null==n||n.call(null)},l=(e,t,n,s)=>{i(e,{fromUnit:t,onFailure:s,onSuccess:{bigint:n},precision:0,toUnit:"B"})},o=e=>(0,s._d)(e,{toUnit:"ibyte"})}}]);