"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{19284:(e,n,r)=>{r.d(n,{A:()=>l});let t=e=>{let{free:n,size:r,used:t,...l}=e,o=BigInt(0),s=BigInt(0),i=BigInt(0);try{o=BigInt(n),s=BigInt(r),i=t?BigInt(t):s-o}catch(e){}return{...l,free:o,size:s,used:i}},l=e=>{let{storage:n,...r}=e,l=Object.values(n.volumeGroups).reduce((e,n)=>(e[n.uuid]=t(n),e),{}),o=t(n.volumeGroupTotals);return{...r,storage:{volumeGroups:l,volumeGroupTotals:o}}}},21129:(e,n,r)=>{r.d(n,{A:()=>s});var t=r(37876),l=r(28850),o=r(74235);let s=function(e,n,r){var s,i;let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{body:a,description:u,messages:d,method:h="put",onCancel:f,onFail:m,onProceed:x,onSuccess:v,dangerous:p=/delete/i.test(null!=(s=null==d?void 0:d.proceed)?s:"")}=c;e.confirm.prepare({actionProceedText:null!=(i=null==d?void 0:d.proceed)?i:"Confirm",content:u,onCancelAppend:()=>{null==f||f.call(null)},onProceedAppend:()=>{e.confirm.loading(!0),null==x||x.call(null),l.A.request({data:a,method:h,url:n}).then(()=>{e.confirm.finish("Success",{children:null==d?void 0:d.success}),null==v||v.call(null)}).catch(n=>{let r=(0,o.A)(n);r.children=(0,t.jsxs)(t.Fragment,{children:[null==d?void 0:d.fail," ",r.children]}),e.confirm.finish("Error",r),null==m||m.call(null)})},proceedColour:p?"red":void 0,titleText:r}),e.confirm.open(!0)}},27038:(e,n,r)=>{r.d(n,{A:()=>C});var t=r(37876),l=r(32529),o=r(53701),s=r(7254),i=r(41316),c=r(14232),a=r(72271),u=r(50046),d=r.n(u),h=r(89121),f=r(35367),m=r(12882);let x=function(){for(var e,n,r,l,i,a=arguments.length,u=Array(a),x=0;x<a;x++)u[x]=arguments[x];let[v]=u,{children:p,onClick:j,onItemClick:g,slotProps:A,variant:b="icon",...C}=v,[y,w]=(0,c.useState)(null),k=(0,c.useMemo)(()=>!!y,[y]),F=(0,c.useMemo)(()=>{if(p)return p;if("icon"===b){var e,n;return(0,t.jsx)(o.A,{fontSize:null==A||null==(n=A.button)||null==(e=n.icon)?void 0:e.size})}return"Options"},[p,null==A||null==(n=A.button)||null==(e=n.icon)?void 0:e.size,b]),M=(0,c.useCallback)(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let{0:{currentTarget:t}}=n;return w(t),null==j?void 0:j.call(null,...n)},[j]),B=(0,c.useMemo)(()=>{var e,n;return"contained"===b?(0,t.jsx)(h.A,{onClick:M,...null==A||null==(n=A.button)?void 0:n.contained,children:F}):(0,t.jsx)(f.A,{onClick:M,...null==A||null==(e=A.button)?void 0:e.icon,children:F})},[M,F,null==A||null==(r=A.button)?void 0:r.contained,null==A||null==(l=A.button)?void 0:l.icon,b]),I=(0,c.useCallback)(function(e,n){for(var r=arguments.length,t=Array(r>2?r-2:0),l=2;l<r;l++)t[l-2]=arguments[l];return w(null),null==g?void 0:g.call(null,e,n,...t)},[g]),S=(0,c.useMemo)(()=>{var e;return d()({menu:{anchorEl:y,keepMounted:!0,onClose:()=>w(null)}},null==A||null==(e=A.menu)?void 0:e.slotProps)},[y,null==A||null==(i=A.menu)?void 0:i.slotProps]);return(0,t.jsxs)(s.A,{children:[B,(0,t.jsx)(m.A,{onItemClick:I,open:k,...C,...null==A?void 0:A.menu,slotProps:S})]})};var v=r(28957),p=r(34318),j=r(88307),g=r(20795),A=r(21129),b=r(61931);let C=function(){for(var e,n,r,u,d=arguments.length,f=Array(d),m=0;m<d;m++)f[m]=arguments[m];let[C]=f,{node:y,server:w,slotProps:k}=C,{confirmDialog:F,setConfirmDialogLoading:M,setConfirmDialogOpen:B,setConfirmDialogProps:I,finishConfirm:S}=(0,b.A)(),P=(0,c.useRef)({add:{open:()=>null},confirm:{finish:S,loading:M,open:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return B(e)},prepare:I},edit:{open:()=>null}}),W=(0,c.useMemo)(()=>"shut off"===w.state,[w.state]),z=(0,c.useMemo)(()=>a.A.states.blocking.includes(w.state),[w.state]),E=(0,c.useMemo)(()=>{let e={ip:{onClick:()=>{navigator.clipboard.writeText(w.ip.address)},render:()=>(0,t.jsxs)(p.A,{growFirst:!0,row:!0,children:[(0,t.jsx)(j.A,{ip:w.ip,slotProps:{text:{inheritColour:!0}}}),(0,t.jsx)(l.A,{color:"inherit",fontSize:"small"})]})},server:{disabled:()=>z,href:()=>"/server?name=".concat(w.name),render:()=>(0,t.jsx)(g.a3,{inheritColour:!0,noWrap:!0,children:"Manage server"})},node:{href:()=>"/anvil?name=".concat(y.name),render:()=>(0,t.jsxs)(g.a3,{inheritColour:!0,noWrap:!0,children:["On node: ",y.name]})},"subheader-power":{render:()=>(0,t.jsx)(v.A,{orientation:"horizontal",sx:{margin:".4em 0"}})}};return e["power on"]={disabled:()=>!W,onClick:()=>{(0,A.A)(P.current,"/command/start-server/".concat(w.uuid),"Power on server ".concat(w.name,"?"),{description:(0,t.jsx)(g.a3,{children:"This is equal to pushing the power button."}),messages:{fail:(0,t.jsxs)(t.Fragment,{children:["Failed to register power on job on ",w.name,"."]}),proceed:"Power on",success:(0,t.jsxs)(t.Fragment,{children:["Successfully registered power on job on ",w.name,"."]})},method:"put"})},render:()=>(0,t.jsx)(g.a3,{inheritColour:!0,noWrap:!0,children:"Power on"})},e.reset={disabled:()=>W,onClick:()=>{(0,A.A)(P.current,"/server/".concat(w.uuid,"/reset"),"Reset server ".concat(w.name,"?"),{dangerous:!0,description:(0,t.jsxs)(i.Ay,{container:!0,spacing:"1em",children:[(0,t.jsx)(i.Ay,{item:!0,width:"100%",children:(0,t.jsx)(g.a3,{children:"This is equal to holding the power button to force shut down, followed by pushing the power button again to turn the machine back on."})}),(0,t.jsx)(i.Ay,{item:!0,width:"100%",children:(0,t.jsx)(g.a3,{children:"Reset is usually used to access the boot menu when you've missed it in the live VNC connection."})})]}),messages:{fail:(0,t.jsxs)(t.Fragment,{children:["Failed to register reset job on ",w.name,"."]}),proceed:"Reset",success:(0,t.jsxs)(t.Fragment,{children:["Successfully registered reset join on ",w.name,"."]})},method:"put"})},render:()=>(0,t.jsx)(g.a3,{color:h.S.red,inheritColour:!0,noWrap:!0,children:"Reset"})},e["power off"]={disabled:()=>W,onClick:()=>{(0,A.A)(P.current,"/command/stop-server/".concat(w.uuid),"Power off server ".concat(w.name,"?"),{description:(0,t.jsx)(g.a3,{children:"This is equal to pushing the power button. If the server doesn't respond to the corresponding signals, you may have to manually shut it down."}),messages:{fail:(0,t.jsxs)(t.Fragment,{children:["Failed to register power off job on ",w.name,"."]}),proceed:"Power off",success:(0,t.jsxs)(t.Fragment,{children:["Successfully registered power off job on ",w.name,"."]})},method:"put"})},render:()=>(0,t.jsx)(g.a3,{inheritColour:!0,noWrap:!0,children:"Power off"})},e["force off"]={disabled:()=>W,onClick:()=>{(0,A.A)(P.current,"/command/stop-server/".concat(w.uuid,"?force=1"),"Force off server ".concat(w.name,"?"),{dangerous:!0,description:(0,t.jsx)(g.a3,{children:"This is equal to pulling the power cord, which may cause data loss or system corruption."}),messages:{fail:(0,t.jsxs)(t.Fragment,{children:["Failed to register force off job on ",w.name,"."]}),proceed:"Force off",success:(0,t.jsxs)(t.Fragment,{children:["Successfully registered force off job on ",w.name,"."]})},method:"put"})},render:()=>(0,t.jsx)(g.a3,{color:h.S.red,inheritColour:!0,noWrap:!0,children:"Force off"})},e},[z,y.name,W,w.ip,w.name,w.uuid]);return(0,t.jsxs)(s.A,{children:[(0,t.jsx)(x,{getItemDisabled:(e,n)=>{var r;return null==(r=n.disabled)?void 0:r.call(null,e,n)},getItemHref:(e,n)=>{var r;return null==(r=n.href)?void 0:r.call(null,e,n)},items:E,onItemClick:(e,n)=>{var r;return null==(r=n.onClick)?void 0:r.call(null,e,n)},renderItem:(e,n)=>n.render(e,n),...null==k?void 0:k.button,children:(0,t.jsx)(o.A,{fontSize:null==k||null==(u=k.button)||null==(r=u.slotProps)||null==(n=r.button)||null==(e=n.icon)?void 0:e.size})}),F]})}},35781:(e,n,r)=>{r.d(n,{o3:()=>o,Wh:()=>i,qg:()=>a});var t=r(10595);let l={offline:t.Qu,optimal:t.ft},o=e=>l[e]||t.hr,s={none:t.Qu,offline:t.Qu,optimal:t.ft,syncing:t.Qu},i=e=>s[e]||t.hr,c={online:t.ft,"powered off":t.Qu},a=e=>c[e]||t.hr},62243:(e,n,r)=>{r.d(n,{A:()=>t});let t=e=>{let{allocated:n,available:r,reserved:t,total:l}=e,o=BigInt(n),s=BigInt(r);return{allocated:o,available:s,reserved:BigInt(t),total:BigInt(l)}}},77913:(e,n,r)=>{r.d(n,{pO:()=>S,lN:()=>G,i:()=>Q,wL:()=>K});var t=r(37876),l=r(44725),o=r(73885),s=r(61994),i=r(29430),c=r(7254),a=r(92003),u=r(35268),d=r(18847),h=r.n(d),f=r(14232),m=r(49948),x=r(92144);let v="0xffe3",p="0xffe9",j=[{keys:"Ctrl + Alt + Delete",scans:[]},{keys:"Ctrl + Alt + F1",scans:[v,p,"0xffbe"]},{keys:"Ctrl + Alt + F2",scans:[v,p,"0xffbf"]},{keys:"Ctrl + Alt + F3",scans:[v,p,"0xffc0"]},{keys:"Ctrl + Alt + F4",scans:[v,p,"0xffc1"]},{keys:"Ctrl + Alt + F5",scans:[v,p,"0xffc2"]},{keys:"Ctrl + Alt + F6",scans:[v,p,"0xffc3"]},{keys:"Ctrl + Alt + F7",scans:[v,p,"0xffc4"]},{keys:"Ctrl + Alt + F8",scans:[v,p,"0xffc5"]},{keys:"Ctrl + Alt + F9",scans:[v,p,"0xffc6"]}];var g=r(12882),A=r(77630),b=r(35755),C=r(27038),y=r(11457),w=r(20795);let k="FullSize",F={displayBox:"".concat(k,"-displayBox"),spinnerBox:"".concat(k,"-spinnerBox")},M=(0,u.Ay)("div")(()=>({["& .".concat(F.displayBox)]:{width:"75vw",height:"75vh"},["& .".concat(F.spinnerBox)]:{flexDirection:"column",width:"75vw",height:"75vh",alignItems:"center",justifyContent:"center"}})),B=h()(()=>Promise.all([r.e(346),r.e(228)]).then(r.bind(r,71228)),{loadableGenerated:{webpack:()=>[71228]},ssr:!1}),I={1e3:"in-use by another process?",1006:"destination is down?"},S=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[u]=n,{node:d,onClickCloseButton:h,server:v,vncReconnectTimerStart:p=3}=u,[k]=(0,m.lT)(["suiapi.vncerror.".concat(v.uuid)]),S=(()=>{let e=(0,f.useRef)(!0);return e.current?(e.current=!1,!0):e.current})(),[P,W]=(0,f.useState)(null),[z,E]=(0,f.useState)(void 0),[R,T]=(0,f.useState)(!1),[q,N]=(0,f.useState)(!1),[H,O]=(0,f.useState)(),[Q,D]=(0,f.useState)(),[_,G]=(0,f.useState)(p),K=(0,f.useRef)(null),L=(0,f.useRef)(null),V=e=>{W(e.currentTarget)},J=(0,f.useCallback)(()=>{let e,n;T(!0),N(!1),E({url:(e=window.location.host,n=v.uuid,"ws://".concat(e,"/ws/server/vnc/").concat(n))})},[v.uuid]),U=(0,f.useCallback)(()=>{(null==K?void 0:K.current)&&(K.current.disconnect(),K.current=null),E(void 0)},[]),X=(0,f.useCallback)(()=>{U(),J()},[J,U]),Z=(0,f.useCallback)(()=>{let e=setInterval(()=>{G(n=>{let r=n-1;return r<1&&clearInterval(e),r})},1e3)},[]),$=(0,f.useCallback)(()=>{T(!1)},[]),Y=(0,f.useCallback)(e=>{let{clean:n}=e.detail;n||(T(!1),N(!0),Z())},[Z]),ee=(0,f.useCallback)(e=>{if(!e)return void O(void 0);let{code:n,reason:r}=e,t="ws: ".concat(n),l=I[n];l&&(t+=" (".concat(l,")")),r&&(t+=", ".concat(r)),O(t);let o=k["suiapi.vncerror.".concat(v.uuid)];if(!o)return void D(void 0);let{code:s,message:i}=o;D("api: ".concat(s,", ").concat(i))},[k,v.uuid]),en=(0,f.useMemo)(()=>!R&&!q,[R,q]),er=(0,f.useMemo)(()=>(0,t.jsx)(c.A,{children:(0,t.jsx)(x.A,{onClick:()=>{var e;null==(e=L.current)||e.requestFullscreen()},children:(0,t.jsx)(s.A,{})})}),[]),et=(0,f.useMemo)(()=>(0,t.jsxs)(c.A,{children:[(0,t.jsx)(x.A,{onClick:V,children:(0,t.jsx)(i.A,{})}),(0,t.jsx)(g.A,{open:!!P,slotProps:{menu:{anchorEl:P,keepMounted:!0,onClose:()=>W(null)}},children:j.map(e=>{let{keys:n,scans:r}=e;return(0,t.jsx)(A.A,{onClick:()=>(e=>{if(K.current){if(e.length){for(let n=0;n<=e.length-1;n+=1)K.current.sendKey(e[n],1);for(let n=e.length-1;n>=0;n-=1)K.current.sendKey(e[n],0)}else K.current.sendCtrlAltDel();W(null)}})(r),children:(0,t.jsx)(a.A,{variant:"subtitle1",children:n})},n)})})]}),[P]),el=(0,f.useMemo)(()=>(0,t.jsx)(c.A,{children:(0,t.jsx)(x.A,{onClick:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];U(),null==h||h.call(null,...n)},children:(0,t.jsx)(l.A,{})})}),[U,h]),eo=(0,f.useMemo)(()=>(0,t.jsx)(c.A,{children:(0,t.jsx)(x.A,{onClick:()=>{window&&(U(),window.location.assign("/"))},children:(0,t.jsx)(o.A,{})})}),[U]),es=(0,f.useMemo)(()=>(0,t.jsxs)(t.Fragment,{children:[er,et,(0,t.jsx)(C.A,{node:d,server:v}),eo,el]}),[er,et,d,eo,v,el]);return(0,f.useEffect)(()=>{0===_&&(G(p),X())},[X,_,p]),(0,f.useEffect)(()=>{S&&J()},[J,S]),(0,t.jsxs)(b.Zk,{children:[(0,t.jsxs)(b.aO,{children:[(0,t.jsx)(w.HM,{text:"Server: ".concat(v.name)}),es]}),(0,t.jsxs)(M,{children:[(0,t.jsx)(c.A,{display:en?"flex":"none",className:F.displayBox,children:(0,t.jsx)(B,{onConnect:$,onDisconnect:Y,onWsClose:ee,rfb:K,rfbConnectArgs:z,rfbScreen:L})}),!en&&(0,t.jsxs)(c.A,{display:"flex",className:F.spinnerBox,textAlign:"center",children:[R&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(w.HM,{children:["Connecting to ",v.name,"."]}),(0,t.jsx)(y.A,{})]}),q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.HM,{children:"Can't connect to the server."}),(0,t.jsx)(w.a3,{children:Q}),(0,t.jsx)(w.a3,{children:H}),(0,t.jsxs)(w.HM,{mt:".5em",children:["Retrying in ",_,"."]})]})]})]})]})};var P=r(44235),W=r(70099),z=r(76759),E=r(52076),R=r.n(E),T=r(50046),q=r.n(T),N=r(10595),H=r(72271),O=r(39393);let Q=(0,u.Ay)(c.A)({alignItems:"center",display:"flex",justifyContent:"center",margin:".2em",overflow:"hidden",position:"relative"});var D=r(16650),_=r(30827);let G=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[l]=n,{onClick:o,server:s,slotProps:i,slots:a}=l,{href:u="/server?name=".concat(s.name,"&view=vnc")}=l,{data:d,loading:h}=(0,_.A)("/server/".concat(s.uuid,"?ss=1"),{refreshInterval:6e4}),m=null==d?void 0:d.screenshot,x=null==d?void 0:d.timestamp,v=(0,D.tB)(),p=(0,f.useMemo)(()=>!!x&&!(0,D.HV)(x,300),[x]),j=(0,f.useMemo)(()=>{var e;return null!=(e=null==a?void 0:a.screenshotBox)?e:(0,t.jsx)(Q,{})},[null==a?void 0:a.screenshotBox]),g=(0,f.useMemo)(()=>({...null==i?void 0:i.screenshotBox}),[null==i?void 0:i.screenshotBox]),A=(0,f.useMemo)(()=>H.A.states.blocking.includes(s.state),[s.state]),b=(0,f.useMemo)(()=>{let e,n;if(A){if(!s.jobs)return;return(0,f.cloneElement)(j,g,(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(w.a3,{children:[R()(s.state),"..."]}),Object.values(s.jobs).map((e,n)=>{let{peer:r,progress:l,uuid:o}=e;return(0,t.jsx)(O.A,{slotProps:{box:{sx:{position:"absolute"}},pie:{size:"calc(7em - ".concat(1.5*n,"em)"),sx:{opacity:r?.6:void 0,["& .".concat(W.A.circle)]:{strokeLinecap:"round"}},thickness:3},underline:{thickness:+!l}},value:l},"".concat(o,"-progress"))})]}))}if(h)return(0,f.cloneElement)(j,g,(0,t.jsx)(y.A,{mt:0}));if("running"!==s.state)return(0,f.cloneElement)(j,g,(0,t.jsx)(P.A,{sx:{color:N.XS,height:"100%",width:"auto"}}));let r="1";if(x&&p){r="0.4";let{unit:n,value:l}=(0,D.vk)(v-x);e=(0,t.jsxs)(w.a3,{position:"absolute",children:["Updated ~",l," ",n," ago"]})}let l=null==i?void 0:i.screenshot;return l&&({sx:n,...l}=l),(0,f.cloneElement)(j,g,(0,t.jsx)(c.A,{alt:"".concat(R()(s.state),". Preview unavailable"),component:"img",src:"data:image;base64,".concat(m),sx:q()({color:N.Qu,fontFamily:"Roboto Condensed",height:m?"100%":"auto",opacity:r,width:"auto"},n),...l}),e)},[A,h,v,m,s.jobs,s.state,null==i?void 0:i.screenshot,p,x,j,g]);return(0,f.useMemo)(()=>{let e,n=null==i?void 0:i.button;return n&&({sx:e,...n}=n),(0,f.createElement)(z.A,{disabled:A,href:u,onClick:o,sx:q()({padding:0,width:"calc(100% - 0em)"},e),...n},b)},[A,b,o,u,null==i?void 0:i.button])},K=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[l]=n,{children:o,getHeader:s=e=>{let{name:n}=e;return(0,t.jsx)(w.a3,{children:n})},server:i,showControls:c=!0,slotProps:a}=l;return(0,t.jsxs)(b.t$,{mb:0,mt:0,...null==a?void 0:a.panel,children:[(0,t.jsxs)(b.WJ,{...null==a?void 0:a.header,children:[s(i),c&&(0,t.jsx)(C.A,{node:i.anvil,server:i,slotProps:{button:{slotProps:{button:{icon:{size:"small"}}}}}})]}),o]})}},88307:(e,n,r)=>{r.d(n,{A:()=>i});var t=r(37876),l=r(7254),o=r(20795),s=r(16650);let i=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];let[i]=n,{ip:c,slotProps:a}=i,u=(0,s.tB)();return(0,t.jsx)(l.A,{...null==a?void 0:a.box,children:c.address?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.a3,{noWrap:!0,...null==a?void 0:a.text,children:c.address}),(0,t.jsxs)(o.a3,{noWrap:!0,variant:"caption",...null==a?void 0:a.text,children:["Changed ",(0,s.KN)(Math.round(u-c.timestamp))," ago"]})]}):(0,t.jsx)(o.a3,{noWrap:!0,...null==a?void 0:a.text,children:"IP: not found yet"})})}}}]);